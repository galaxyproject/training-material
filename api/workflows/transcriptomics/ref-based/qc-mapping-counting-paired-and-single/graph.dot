digraph main {
  node [fontname="Atkinson Hyperlegible", shape=box, color=white,style=filled,color=peachpuff,margin="0.2,0.2"];
  edge [fontname="Atkinson Hyperlegible"];
  0[color=lightblue,label="ℹ️ Input Collection\nsingle fastqs"]
  1[color=lightblue,label="ℹ️ Input Collection\npaired fastqs"]
  2[color=lightblue,label="ℹ️ Input Dataset\nDrosophila_melanogaster.BDGP6.32.109_UCSC.gtf.gz"]
  3[label="Cutadapt: remove bad quality bp"]
  0 -> 3 [label="output"]
  4[label="Flatten paired collection for FastQC"]
  1 -> 4 [label="output"]
  5[label="Cutadapt"]
  1 -> 5 [label="output"]
  6[label="Get gene length"]
  2 -> 6 [label="output"]
  k077640ccedbb41859eb1d11b522774af[color=lightseagreen,label="Output\nGene length"]
  6 -> k077640ccedbb41859eb1d11b522774af
  7[label="convert gtf to bed12"]
  2 -> 7 [label="output"]
  8[label="STAR: map single reads"]
  2 -> 8 [label="output"]
  3 -> 8 [label="out1"]
  9[label="Merge fastqs for FastQC"]
  4 -> 9 [label="output"]
  0 -> 9 [label="output"]
  10[label="Merge Cutadapt reports"]
  5 -> 10 [label="report"]
  3 -> 10 [label="report"]
  11[label="STAR: map paired reads"]
  2 -> 11 [label="output"]
  5 -> 11 [label="out_pairs"]
  12[label="count reads per gene for SR"]
  8 -> 12 [label="mapped_reads"]
  2 -> 12 [label="output"]
  13[label="FastQC check read qualities"]
  9 -> 13 [label="output"]
  14[label="Combine cutadapt results"]
  10 -> 14 [label="output"]
  kcab760db5c9d4a3cb768998bfbac6b57[color=lightseagreen,label="Output\nmultiqc_cutadapt_html"]
  14 -> kcab760db5c9d4a3cb768998bfbac6b57
  15[label="Merge STAR logs"]
  11 -> 15 [label="output_log"]
  8 -> 15 [label="output_log"]
  16[label="Merge STAR counts"]
  8 -> 16 [label="reads_per_gene"]
  11 -> 16 [label="reads_per_gene"]
  17[label="count fragments per gene for PE"]
  11 -> 17 [label="mapped_reads"]
  2 -> 17 [label="output"]
  k1527b5d7168149349d9e3a5f86ae0fee[color=lightseagreen,label="Output\nfeatureCounts_gene_length"]
  17 -> k1527b5d7168149349d9e3a5f86ae0fee
  18[label="Merge STAR BAM"]
  11 -> 18 [label="mapped_reads"]
  8 -> 18 [label="mapped_reads"]
  k802017f4fb1a4243b50d2ed46f746f11[color=lightseagreen,label="Output\nSTAR_BAM"]
  18 -> k802017f4fb1a4243b50d2ed46f746f11
  19[label="merge coverage unique strand 1"]
  8 -> 19 [label="signal_unique_str1"]
  11 -> 19 [label="signal_unique_str1"]
  20[label="merge coverage unique strand 2"]
  8 -> 20 [label="signal_unique_str2"]
  11 -> 20 [label="signal_unique_str2"]
  21[label="Combine FastQC results"]
  13 -> 21 [label="text_file"]
  k8d0ce9eee4e44c0c8261420ce756ecfd[color=lightseagreen,label="Output\nmultiqc_fastqc_html"]
  21 -> k8d0ce9eee4e44c0c8261420ce756ecfd
  22[label="Combine STAR Results"]
  15 -> 22 [label="output"]
  k204e3f6c6f5446f0b07c1f31113265e7[color=lightseagreen,label="Output\nmultiqc_star_html"]
  22 -> k204e3f6c6f5446f0b07c1f31113265e7
  23[label="Remove statistics from STAR counts"]
  16 -> 23 [label="output"]
  24[label="Determine library strandness with STAR"]
  16 -> 24 [label="output"]
  kfe7b84dd44664fe794a8408f4ac7ed1a[color=lightseagreen,label="Output\nmultiqc_star_counts_html"]
  24 -> kfe7b84dd44664fe794a8408f4ac7ed1a
  25[label="merge counts from featureCounts"]
  12 -> 25 [label="output_short"]
  17 -> 25 [label="output_short"]
  kc82388f8cb094fdf8a0e03cdad579f37[color=lightseagreen,label="Output\nfeatureCounts"]
  25 -> kc82388f8cb094fdf8a0e03cdad579f37
  26[label="merge featureCounts summary"]
  12 -> 26 [label="output_summary"]
  17 -> 26 [label="output_summary"]
  27[label="Determine library strandness with Infer Experiment"]
  18 -> 27 [label="output"]
  7 -> 27 [label="bed_file"]
  k940ec3ecdd2e4d50bbc4756945eb16b2[color=lightseagreen,label="Output\ninferexperiment"]
  27 -> k940ec3ecdd2e4d50bbc4756945eb16b2
  28[label="Read Distribution"]
  18 -> 28 [label="output"]
  7 -> 28 [label="bed_file"]
  29[label="Compute read distribution statistics"]
  18 -> 29 [label="output"]
  7 -> 29 [label="bed_file"]
  30[label="sample BAM"]
  18 -> 30 [label="output"]
  31[label="Get reads number per chromosome"]
  18 -> 31 [label="output"]
  32[label="Remove duplicates"]
  18 -> 32 [label="output"]
  33[label="Determine library strandness with STAR coverage"]
  19 -> 33 [label="output"]
  20 -> 33 [label="output"]
  2 -> 33 [label="output"]
  k89e1b05303c2467a95a0d2dc404670ec[color=lightseagreen,label="Output\npgt"]
  33 -> k89e1b05303c2467a95a0d2dc404670ec
  34[label="Select unstranded counts"]
  23 -> 34 [label="outfile"]
  kbce755beac3b43469ac51128a287bf00[color=lightseagreen,label="Output\ncounts_from_star"]
  34 -> kbce755beac3b43469ac51128a287bf00
  35[label="Sort counts to get gene with highest count on feature Counts"]
  25 -> 35 [label="output"]
  k6aeb4dd1445f4c66b1ce4bb8faac53db[color=lightseagreen,label="Output\nfeatureCounts_sorted"]
  35 -> k6aeb4dd1445f4c66b1ce4bb8faac53db
  36[label="Combine read asignments statistics"]
  26 -> 36 [label="output"]
  kfc72242af23c4ceb9a8b5280343ea5d6[color=lightseagreen,label="Output\nmultiqc_featureCounts_html"]
  36 -> kfc72242af23c4ceb9a8b5280343ea5d6
  37[label="Combine read distribution on known features"]
  29 -> 37 [label="output"]
  k07dca7320ac7432e9e612b77f921a23b[color=lightseagreen,label="Output\nmultiqc_read_distrib"]
  37 -> k07dca7320ac7432e9e612b77f921a23b
  38[label="Get gene body coverage"]
  30 -> 38 [label="outputsam"]
  7 -> 38 [label="bed_file"]
  39[label="Combine results on reads per chromosome"]
  31 -> 39 [label="output"]
  k7bfa8ae78ffd46a1a56e815ed2c9f1cf[color=lightseagreen,label="Output\nmultiqc_reads_per_chrom"]
  39 -> k7bfa8ae78ffd46a1a56e815ed2c9f1cf
  40[label="Combine results of duplicate reads"]
  32 -> 40 [label="metrics_file"]
  k66553d0fe851458b82c2f9b30e394bac[color=lightseagreen,label="Output\nmultiqc_dup"]
  40 -> k66553d0fe851458b82c2f9b30e394bac
  41[label="Sort counts to get gene with highest count on STAR"]
  34 -> 41 [label="out_file1"]
  k383df0080ccb4d6798dd33fa5e2db81e[color=lightseagreen,label="Output\ncounts_from_star_sorted"]
  41 -> k383df0080ccb4d6798dd33fa5e2db81e
  42[label="Combine gene body coverage"]
  38 -> 42 [label="outputtxt"]
  k8544ea5cfaf244c985d640658fc9b9eb[color=lightseagreen,label="Output\nmultiqc_gene_body_cov"]
  42 -> k8544ea5cfaf244c985d640658fc9b9eb
}