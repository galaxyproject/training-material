{"layout":"tutorial_hands_on","title":"Preparing genomic data for phylogeny reconstruction","zenodo_link":"https://zenodo.org/record/6610704","questions":["How do I find a set of common proteins (orthologs) across related species or strains?","How do I organize a set of orthologs to infer evolutionary relations between species or strains (phylogenetic reconstruction)?"],"objectives":["Mask repetitive elements from a genome","Annotate (predict protein-coding genes) the genomes of the samples to compare","Find a set of common proteins across the samples (orthologs)","Align orthologs across samples"],"time_estimation":"3H","requirements":[{"type":"internal","topic_name":"assembly","tutorials":["general-introduction"]}],"key_points":["You now are able to","Predict proteins in a nucleotide sequence *de-novo* using **funannotate_predict**","Find orthologs across different samples with **orthofinder**","Align orthologs with **ClustalW** in preparation for phylogeny reconstruction <!-- link to phylogeny reconstruction training. -->"],"tags":["phylogeny","data handling","functional annotation"],"contributors":[{"name":"Miguel Roncoroni","joined":"2021-08","email":"miguel.roncoroni@elixir-belgium.org","id":"roncoronimiguel","url":"https://training.galaxyproject.org/training-material/api/contributors/roncoronimiguel.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/roncoronimiguel/"},{"name":"Brigida Gallone","orcid":"0000-0003-3045-5949","joined":"2022-05","id":"brigidagallone","url":"https://training.galaxyproject.org/training-material/api/contributors/brigidagallone.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/brigidagallone/"}],"subtopic":"ecologyanalysis","js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00132","url":"/topics/ecology/tutorials/phylogeny-data-prep/tutorial.html","topic_name":"ecology","tutorial_name":"phylogeny-data-prep","dir":"topics/ecology/tutorials/phylogeny-data-prep","symlink":null,"id":"ecology/phylogeny-data-prep","hands_on":true,"slides":false,"mod_date":"2024-06-27 14:26:31 +0000","pub_date":"2022-10-21 11:45:57 +0000","version":23,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/phylogeny-data-prep/workflows/main_workflow.ga","url_html":"https://training.galaxyproject.org/training-material/topics/ecology/tutorials/phylogeny-data-prep/workflows/main_workflow.html","path":"topics/ecology/tutorials/phylogeny-data-prep/workflows/main_workflow.ga","wfid":"ecology-phylogeny-data-prep","wfname":"main-workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/ecology-phylogeny-data-prep/versions/main-workflow","license":"CC-BY-4.0","parent_id":"ecology/phylogeny-data-prep","topic_id":"ecology","tutorial_id":"phylogeny-data-prep","creators":[{"class":"Person","identifier":"","name":"Miguel Roncoroni"}],"name":"preparing genomic data for phylogeny recostruction (GTN)","title":"preparing genomic data for phylogeny recostruction (GTN)","version":2,"description":"This workflow begins from a set of genome assemblies of different samples, strains, species. The genome is first annotated with Funnanotate. Predicted proteins are furtner annotated with Busco. Next, 'ProteinOrtho' finds orthologs across the samples and makes orthogroups. Orthogroups where all samples are represented are extracted. Orthologs in each orthogroup are aligned with ClustalW. The alignments are cleaned with ClipKIT and the concatenation matrix is built using PhyKit. This can be used for phylogeny reconstruction.","tags":["ecology"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1264","history":[{"hash":"f7b9464bb24007d8f974decd05b331b67ff877ab","unix":"1656489327","message":"Update main_workflow.ga","short_hash":"f7b9464bb","num":2},{"hash":"d6ad32e2684e4274d081b593df3966220a6e0d55","unix":"1651848710","message":"create phylogenetic-data-prep training backbone","short_hash":"d6ad32e26","num":1}],"test_results":null,"modified":"2024-07-09 09:30:41 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Collection\\nInput genomes as collection\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"Replace Text\"];\n  0 -->|output| 1;\n  6a2d3fcd-b557-4440-910d-b4c537feef20[\"Output\\nheaders_shortened\"];\n  1 --> 6a2d3fcd-b557-4440-910d-b4c537feef20;\n  style 6a2d3fcd-b557-4440-910d-b4c537feef20 stroke:#2c3143,stroke-width:4px;\n  2[\"RepeatMasker\"];\n  1 -->|outfile| 2;\n  1db6607a-343a-4a61-9a3b-43101eb8223b[\"Output\\nrepeat_masked\"];\n  2 --> 1db6607a-343a-4a61-9a3b-43101eb8223b;\n  style 1db6607a-343a-4a61-9a3b-43101eb8223b stroke:#2c3143,stroke-width:4px;\n  3[\"Funannotate predict annotation\"];\n  2 -->|output_masked_genome| 3;\n  642c1c09-82f4-4ef4-bd53-d14a583044e2[\"Output\\nfunannotate_predicted_proteins\"];\n  3 --> 642c1c09-82f4-4ef4-bd53-d14a583044e2;\n  style 642c1c09-82f4-4ef4-bd53-d14a583044e2 stroke:#2c3143,stroke-width:4px;\n  4[\"Extract ORF\"];\n  3 -->|annot_gbk| 4;\n  07fb8c04-990e-4bc7-b607-9c4161b4786d[\"Output\\nextracted_ORFs\"];\n  4 --> 07fb8c04-990e-4bc7-b607-9c4161b4786d;\n  style 07fb8c04-990e-4bc7-b607-9c4161b4786d stroke:#2c3143,stroke-width:4px;\n  5[\"Regex Find And Replace\"];\n  4 -->|aa_output| 5;\n  8dc378a8-d485-42df-8322-6cf8230257a0[\"Output\\nsample_names_to_headers\"];\n  5 --> 8dc378a8-d485-42df-8322-6cf8230257a0;\n  style 8dc378a8-d485-42df-8322-6cf8230257a0 stroke:#2c3143,stroke-width:4px;\n  6[\"Collapse Collection\"];\n  5 -->|out_file1| 6;\n  e9a55459-4a2c-4238-8494-e99ec67307ea[\"Output\\nproteomes_to_one_file\"];\n  6 --> e9a55459-4a2c-4238-8494-e99ec67307ea;\n  style e9a55459-4a2c-4238-8494-e99ec67307ea stroke:#2c3143,stroke-width:4px;\n  7[\"Proteinortho\"];\n  5 -->|out_file1| 7;\n  ee688b7a-2a9e-4480-a27a-db8cf795b635[\"Output\\nProteinortho on input dataset(s): orthology-groups\"];\n  7 --> ee688b7a-2a9e-4480-a27a-db8cf795b635;\n  style ee688b7a-2a9e-4480-a27a-db8cf795b635 stroke:#2c3143,stroke-width:4px;\n  8[\"Busco\"];\n  5 -->|out_file1| 8;\n  9[\"Filter\"];\n  7 -->|proteinortho| 9;\n  10[\"Proteinortho grab proteins\"];\n  6 -->|output| 10;\n  9 -->|out_file1| 10;\n  8625e8b1-e3af-4afa-bf85-1a3258cbbfb2[\"Output\\nProteinortho_extract_by_orthogroup\"];\n  10 --> 8625e8b1-e3af-4afa-bf85-1a3258cbbfb2;\n  style 8625e8b1-e3af-4afa-bf85-1a3258cbbfb2 stroke:#2c3143,stroke-width:4px;\n  11[\"Regex Find And Replace\"];\n  10 -->|listproteinorthograbproteins| 11;\n  b072d32e-f725-4833-af0b-74f4df526d9a[\"Output\\nfasta_header_cleaned\"];\n  11 --> b072d32e-f725-4833-af0b-74f4df526d9a;\n  style b072d32e-f725-4833-af0b-74f4df526d9a stroke:#2c3143,stroke-width:4px;\n  12[\"ClustalW\"];\n  11 -->|out_file1| 12;\n  f704b4b2-5214-4393-8a85-6274bda27c8c[\"Output\\nClustalW on input dataset(s): clustal\"];\n  12 --> f704b4b2-5214-4393-8a85-6274bda27c8c;\n  style f704b4b2-5214-4393-8a85-6274bda27c8c stroke:#2c3143,stroke-width:4px;\n  13[\"ClipKIT. Alignment trimming software for phylogenetics.\"];\n  12 -->|output| 13;\n  37092981-191a-4413-8f60-51802dd95f9c[\"Output\\nTrimmed alignment.\"];\n  13 --> 37092981-191a-4413-8f60-51802dd95f9c;\n  style 37092981-191a-4413-8f60-51802dd95f9c stroke:#2c3143,stroke-width:4px;\n  14[\"PhyKit - Alignment-based functions\"];\n  13 -->|trimmed_output| 14;\n  09ad25e3-cd68-4fb4-9c57-3e79212b8e01[\"Output\\nConcatenated fasta alignment file\"];\n  14 --> 09ad25e3-cd68-4fb4-9c57-3e79212b8e01;\n  style 09ad25e3-cd68-4fb4-9c57-3e79212b8e01 stroke:#2c3143,stroke-width:4px;\n  1d546e4c-7e3c-499d-870c-4846feb7a46d[\"Output\\nA partition file ready for input into RAxML or IQ-tree\"];\n  14 --> 1d546e4c-7e3c-499d-870c-4846feb7a46d;\n  style 1d546e4c-7e3c-499d-870c-4846feb7a46d stroke:#2c3143,stroke-width:4px;\n  26846814-d43a-4ce7-9f26-cfb70f184dce[\"Output\\nAn occupancy file that summarizes the taxon occupancy per sequence\"];\n  14 --> 26846814-d43a-4ce7-9f26-cfb70f184dce;\n  style 26846814-d43a-4ce7-9f26-cfb70f184dce stroke:#2c3143,stroke-width:4px;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Collection\\nInput genomes as collection\"]\n  1[label=\"Replace Text\"]\n  0 -> 1 [label=\"output\"]\n  k6a2d3fcdb5574440910db4c537feef20[color=lightseagreen,label=\"Output\\nheaders_shortened\"]\n  1 -> k6a2d3fcdb5574440910db4c537feef20\n  2[label=\"RepeatMasker\"]\n  1 -> 2 [label=\"outfile\"]\n  k1db6607a343a4a619a3b43101eb8223b[color=lightseagreen,label=\"Output\\nrepeat_masked\"]\n  2 -> k1db6607a343a4a619a3b43101eb8223b\n  3[label=\"Funannotate predict annotation\"]\n  2 -> 3 [label=\"output_masked_genome\"]\n  k642c1c0982f44ef4bd53d14a583044e2[color=lightseagreen,label=\"Output\\nfunannotate_predicted_proteins\"]\n  3 -> k642c1c0982f44ef4bd53d14a583044e2\n  4[label=\"Extract ORF\"]\n  3 -> 4 [label=\"annot_gbk\"]\n  k07fb8c04990e4bc7b6079c4161b4786d[color=lightseagreen,label=\"Output\\nextracted_ORFs\"]\n  4 -> k07fb8c04990e4bc7b6079c4161b4786d\n  5[label=\"Regex Find And Replace\"]\n  4 -> 5 [label=\"aa_output\"]\n  k8dc378a8d48542df83226cf8230257a0[color=lightseagreen,label=\"Output\\nsample_names_to_headers\"]\n  5 -> k8dc378a8d48542df83226cf8230257a0\n  6[label=\"Collapse Collection\"]\n  5 -> 6 [label=\"out_file1\"]\n  ke9a554594a2c42388494e99ec67307ea[color=lightseagreen,label=\"Output\\nproteomes_to_one_file\"]\n  6 -> ke9a554594a2c42388494e99ec67307ea\n  7[label=\"Proteinortho\"]\n  5 -> 7 [label=\"out_file1\"]\n  kee688b7a2a9e4480a27adb8cf795b635[color=lightseagreen,label=\"Output\\nProteinortho on input dataset(s): orthology-groups\"]\n  7 -> kee688b7a2a9e4480a27adb8cf795b635\n  8[label=\"Busco\"]\n  5 -> 8 [label=\"out_file1\"]\n  9[label=\"Filter\"]\n  7 -> 9 [label=\"proteinortho\"]\n  10[label=\"Proteinortho grab proteins\"]\n  6 -> 10 [label=\"output\"]\n  9 -> 10 [label=\"out_file1\"]\n  k8625e8b1e3af4afabf851a3258cbbfb2[color=lightseagreen,label=\"Output\\nProteinortho_extract_by_orthogroup\"]\n  10 -> k8625e8b1e3af4afabf851a3258cbbfb2\n  11[label=\"Regex Find And Replace\"]\n  10 -> 11 [label=\"listproteinorthograbproteins\"]\n  kb072d32ef7254833af0b74f4df526d9a[color=lightseagreen,label=\"Output\\nfasta_header_cleaned\"]\n  11 -> kb072d32ef7254833af0b74f4df526d9a\n  12[label=\"ClustalW\"]\n  11 -> 12 [label=\"out_file1\"]\n  kf704b4b2521443938a856274bda27c8c[color=lightseagreen,label=\"Output\\nClustalW on input dataset(s): clustal\"]\n  12 -> kf704b4b2521443938a856274bda27c8c\n  13[label=\"ClipKIT. Alignment trimming software for phylogenetics.\"]\n  12 -> 13 [label=\"output\"]\n  k37092981191a44138f6051802dd95f9c[color=lightseagreen,label=\"Output\\nTrimmed alignment.\"]\n  13 -> k37092981191a44138f6051802dd95f9c\n  14[label=\"PhyKit - Alignment-based functions\"]\n  13 -> 14 [label=\"trimmed_output\"]\n  k09ad25e3cd684fb49c573e79212b8e01[color=lightseagreen,label=\"Output\\nConcatenated fasta alignment file\"]\n  14 -> k09ad25e3cd684fb49c573e79212b8e01\n  k1d546e4c7e3c499d870c4846feb7a46d[color=lightseagreen,label=\"Output\\nA partition file ready for input into RAxML or IQ-tree\"]\n  14 -> k1d546e4c7e3c499d870c4846feb7a46d\n  k26846814d43a4ce79f26cfb70f184dce[color=lightseagreen,label=\"Output\\nAn occupancy file that summarizes the taxon occupancy per sequence\"]\n  14 -> k26846814d43a4ce79f26cfb70f184dce\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2","toolshed.g2.bx.psu.edu/repos/bgruening/repeat_masker/repeatmasker_wrapper/4.1.2-p1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/funannotate_predict/funannotate_predict/1.8.9+galaxy2","toolshed.g2.bx.psu.edu/repos/bgruening/glimmer_gbk_to_orf/glimmer_gbk_to_orf/3.02","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regex1/1.0.1","toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/4.2","toolshed.g2.bx.psu.edu/repos/iuc/proteinortho/proteinortho/6.0.14+galaxy2.9.1","toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/4.1.4","Filter1","toolshed.g2.bx.psu.edu/repos/iuc/proteinortho_grab_proteins/proteinortho_grab_proteins/6.0.14+galaxy2.9.1","toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1","toolshed.g2.bx.psu.edu/repos/padge/clipkit/clipkit/0.1.0","toolshed.g2.bx.psu.edu/repos/padge/phykit/phykit_alignment_based/0.1.0"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/ecology/tutorials/phylogeny-data-prep/tutorial.json","tools":["Filter1","toolshed.g2.bx.psu.edu/repos/bgruening/glimmer_gbk_to_orf/glimmer_gbk_to_orf/3.02","toolshed.g2.bx.psu.edu/repos/bgruening/repeat_masker/repeatmasker_wrapper/4.1.2-p1+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2","toolshed.g2.bx.psu.edu/repos/devteam/clustalw/clustalw/2.1","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regex1/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/4.1.4","toolshed.g2.bx.psu.edu/repos/iuc/funannotate_predict/funannotate_predict/1.8.9+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/proteinortho/proteinortho/6.0.14+galaxy2.9.1","toolshed.g2.bx.psu.edu/repos/iuc/proteinortho_grab_proteins/proteinortho_grab_proteins/6.0.14+galaxy2.9.1","toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/4.2","toolshed.g2.bx.psu.edu/repos/padge/clipkit/clipkit/0.1.0","toolshed.g2.bx.psu.edu/repos/padge/phykit/phykit_alignment_based/0.1.0"],"supported_servers":{"exact":[],"inexact":[]},"topic_name_human":"Ecology","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"glimmer_gbk_to_orf","owner":"bgruening","revisions":"04861c9bbf45","tool_panel_section_label":"Ecology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"repeat_masker","owner":"bgruening","revisions":"39b40a9a6296","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"clustalw","owner":"devteam","revisions":"d6694932c5e0","tool_panel_section_label":"Multiple Alignments","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"ae8c4b2488e7","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"busco","owner":"iuc","revisions":"602fb8e63aa7","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"funannotate_predict","owner":"iuc","revisions":"2bba2ff070d9","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"proteinortho","owner":"iuc","revisions":"4850f0d15f01","tool_panel_section_label":"Proteomics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collapse_collections","owner":"nml","revisions":"830961c48e42","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"clipkit","owner":"padge","revisions":"770695339600","tool_panel_section_label":"Phylogenetics","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"phykit","owner":"padge","revisions":"1ac6ee298657","tool_panel_section_label":"Ecology","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: glimmer_gbk_to_orf\n  owner: bgruening\n  revisions: '04861c9bbf45'\n  tool_panel_section_label: Ecology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: repeat_masker\n  owner: bgruening\n  revisions: 39b40a9a6296\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: clustalw\n  owner: devteam\n  revisions: d6694932c5e0\n  tool_panel_section_label: Multiple Alignments\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: ae8c4b2488e7\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: busco\n  owner: iuc\n  revisions: 602fb8e63aa7\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: funannotate_predict\n  owner: iuc\n  revisions: 2bba2ff070d9\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: proteinortho\n  owner: iuc\n  revisions: 4850f0d15f01\n  tool_panel_section_label: Proteomics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collapse_collections\n  owner: nml\n  revisions: 830961c48e42\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: clipkit\n  owner: padge\n  revisions: '770695339600'\n  tool_panel_section_label: Phylogenetics\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: phykit\n  owner: padge\n  revisions: 1ac6ee298657\n  tool_panel_section_label: Ecology\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}