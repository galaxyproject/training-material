{"layout":"tutorial_hands_on","redirect_from":["/topics/admin/tutorials/singularity/tutorial","/short/admin/apptainer","/short/T00323"],"title":"Use Apptainer containers for running Galaxy jobs","zenodo_link":"","questions":null,"objectives":["Configure your Galaxy to use Apptainer and BioContainers for running jobs"],"time_estimation":"1h","key_points":null,"contributors":[{"name":"Torfinn Nome","email":"torfinn.nome@gmail.com","twitter":"torfinnnome","orcid":"0000-0003-1659-132X","joined":"2021-01","elixir_node":"no","affiliations":["elixir-europe"],"id":"torfinnnome","url":"https://training.galaxyproject.org/training-material/api/contributors/torfinnnome.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/torfinnnome/"},{"name":"Marius van den Beek","joined":"2018-06","id":"mvdbeek","url":"https://training.galaxyproject.org/training-material/api/contributors/mvdbeek.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mvdbeek/"},{"name":"Matthias Bernt","joined":"2017-09","elixir_node":"de","id":"bernt-matthias","url":"https://training.galaxyproject.org/training-material/api/contributors/bernt-matthias.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/bernt-matthias/"},{"name":"Helena Rasche","orcid":"0000-0001-9760-8992","maintainer_contact":"gitter","matrix":"hexylena:matrix.org","joined":"2017-09","elixir_node":"nl","affiliations":["gallantries","by-covid","erasmusmc","elixir-europe","elixir-converge"],"former_affiliations":["deNBI","avans-atgm","uni-freiburg"],"contact_for_training":false,"location":{"country":"NL","lat":51.91,"lon":4.46},"id":"hexylena","url":"https://training.galaxyproject.org/training-material/api/contributors/hexylena.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"},{"name":"Mira Kuntz","orcid":"0000-0003-4302-5091","matrix":"mira-miracoli:matrix.org","email":"kuntzm@informatik.uni-freiburg.de","joined":"2022-07","elixir_node":"de","affiliations":["uni-freiburg","elixir-europe","deNBI"],"id":"mira-miracoli","url":"https://training.galaxyproject.org/training-material/api/contributors/mira-miracoli.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/mira-miracoli/"}],"subtopic":"jobs","tags":["jobs","ansible","git-gat"],"requirements":[{"type":"internal","topic_name":"admin","tutorials":["ansible","ansible-galaxy"]}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00323","url":"/topics/admin/tutorials/apptainer/tutorial.html","topic_name":"admin","tutorial_name":"apptainer","dir":"topics/admin/tutorials/apptainer","symlink":null,"id":"admin/apptainer","ref_tutorials":["<p>In this tutorial you will learn how to configure Galaxy to run jobs using <a href=\"https://apptainer.org\">Apptainer</a> containers provided by the <a href=\"https://biocontainers.pro/\">BioContainers</a> community.\nMake sure to read the documentation on <a href=\"https://docs.galaxyproject.org/en/master/admin/special_topics/mulled_containers.html\">container in Galaxy</a> and in particular <a href=\"https://docs.galaxyproject.org/en/master/admin/container_resolvers.html\">container resolvers in Galaxy</a>.</p>\n\n<h2 id=\"background\">Background</h2>\n\n<blockquote class=\"quote\" cite=\"https://biocontainers-edu.readthedocs.io/en/latest/what_is_biocontainers.html\">\n  <p>BioContainers is a community-driven project that provides the infrastructure and basic guidelines to create, manage and distribute bioinformatics packages (e.g Conda) and containers (e.g Docker, Apptainer). BioContainers is based on the popular frameworks Conda, Docker and Apptainer.</p>\n\n</blockquote>\n\n<p>Apptainer is an alternative to Docker that is much friendlier for HPCs</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Apptainer, Singularity, SingularityCE?</comment-title>\n\n  <table>\n    <thead>\n      <tr>\n        <th>Name</th>\n        <th>Singularity</th>\n        <th>SingularityCE</th>\n        <th>Apptainer</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td>Origin</td>\n        <td>Original name, used by the project until 2021</td>\n        <td>Name of Sylabs‚Äô Fork (CE for <b>C</b>ommunity <b>E</b>dition)</td>\n        <td>Name change when the project joined the Linux Foundation</td>\n      </tr>\n      <tr>\n        <td>Status</td>\n        <td>renamed in 2021</td>\n        <td>currently active</td>\n        <td>currently active</td>\n      </tr>\n      <tr>\n        <td>RPM Package available</td>\n        <td>discontinued</td>\n        <td>‚ùå</td>\n        <td>‚úÖ</td>\n      </tr>\n      <tr>\n        <td>CLI name</td>\n        <td><code class=\"language-plaintext highlighter-rouge\">singularity</code></td>\n        <td><code class=\"language-plaintext highlighter-rouge\">singularity</code></td>\n        <td><code class=\"language-plaintext highlighter-rouge\">apptainer</code> or <code class=\"language-plaintext highlighter-rouge\">singularity</code></td>\n      </tr>\n    </tbody>\n  </table>\n\n  <p>Many people still know Apptainer under its former name, Singularity.\nSingularity was forked in 2021, with the non-commercial fork being renamed to Apptainer and joining the Linux Foundation.\nSylabs maintains their own free and open source fork, ‚ÄòSingularityCE‚Äô (for <u>C</u>ommunity <u>E</u>dition), as well as a commercial version, ‚ÄòSingularityPRO‚Äô.</p>\n\n  <p>We will use the Name Apptainer for our training material, because most rpm packages are now named Apptainer.</p>\n</blockquote>\n\n<blockquote class=\"quote\" cite=\"https://sylabs.io/guides/3.7/user-guide/introduction.html\">\n  <p>Apptainer is a container platform. It allows you to create and run containers that package up pieces of software in a way that is portable and reproducible.</p>\n</blockquote>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#background\" id=\"markdown-toc-background\">Background</a></li>\n  <li><a href=\"#installing-apptainer\" id=\"markdown-toc-installing-apptainer\">Installing Apptainer</a>    <ol>\n      <li><a href=\"#configure-galaxy-to-use-apptainer\" id=\"markdown-toc-configure-galaxy-to-use-apptainer\">Configure Galaxy to use Apptainer</a></li>\n    </ol>\n  </li>\n</ol>\n\n</blockquote>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-galaxy-admin-training-path\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Galaxy Admin Training Path</div>   <p>The yearly Galaxy Admin Training follows a specific ordering of tutorials. Use this timeline to help keep track of where you are in Galaxy Admin Training.</p>   <ol id=\"git-gat-timeline\">                    <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html\">             <div>Step 1</div>             <div>ansible-galaxy</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/backup-cleanup/tutorial.html\">             <div>Step 2</div>             <div>backup-cleanup</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/customization/tutorial.html\">             <div>Step 3</div>             <div>customization</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/tus/tutorial.html\">             <div>Step 4</div>             <div>tus</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/cvmfs/tutorial.html\">             <div>Step 5</div>             <div>cvmfs</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"active\">         <a href=\"/training-material/topics/admin/tutorials/apptainer/tutorial.html\">             <div>Step 6</div>             <div>apptainer</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/tool-management/tutorial.html\">             <div>Step 7</div>             <div>tool-management</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/reference-genomes/tutorial.html\">             <div>Step 8</div>             <div>reference-genomes</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/data-library/tutorial.html\">             <div>Step 9</div>             <div>data-library</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/dev/tutorials/bioblend-api/tutorial.html\">             <div>Step 10</div>             <div>dev/bioblend-api</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/connect-to-compute-cluster/tutorial.html\">             <div>Step 11</div>             <div>connect-to-compute-cluster</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/job-destinations/tutorial.html\">             <div>Step 12</div>             <div>job-destinations</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/pulsar/tutorial.html\">             <div>Step 13</div>             <div>pulsar</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/celery/tutorial.html\">             <div>Step 14</div>             <div>celery</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/gxadmin/tutorial.html\">             <div>Step 15</div>             <div>gxadmin</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/reports/tutorial.html\">             <div>Step 16</div>             <div>reports</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/monitoring/tutorial.html\">             <div>Step 17</div>             <div>monitoring</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/tiaas/tutorial.html\">             <div>Step 18</div>             <div>tiaas</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/sentry/tutorial.html\">             <div>Step 19</div>             <div>sentry</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/ftp/tutorial.html\">             <div>Step 20</div>             <div>ftp</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/beacon/tutorial.html\">             <div>Step 21</div>             <div>beacon</div>         </a>     </li>           </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<h1 id=\"installing-apptainer\">Installing Apptainer</h1>\n\n<p>First, we will install Apptainer using Ansible. Since there is a package available for major Linux distros now, we could simply install it in the pre tasks. However, we would have to enable additional repos, so we decided to create a role for this:</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Installing Apptainer with Ansible</hands-on-title>\n\n  <ol>\n    <li>\n      <p>In your working directory, add the Apptainer role to your <code class=\"language-plaintext highlighter-rouge\">requirements.yml</code> file:</p>\n\n      <div data-commit=\"Add Apptainer ansible roles\" class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- a/requirements.yml\n</span><span class=\"gi\">+++ b/requirements.yml\n</span><span class=\"p\">@@ -20,3 +20,6 @@</span>\n # CVMFS Support\n - src: galaxyproject.cvmfs\n   version: 0.2.21\n<span class=\"gi\">+# Singularity/Apptainer\n+- src: usegalaxy_eu.apptainer\n+  version: 0.0.1\n</span>   \n</code></pre></div>      </div>\n\n      <!--SNIPPET-->\n      <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-how-to-read-a-diff\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-how-to-read-a-diff\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: How to read a Diff</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <p>If you haven‚Äôt worked with diffs before, this can be something quite new or different.</p>   <p>If we have two files, let‚Äôs say a grocery list, in two files. We‚Äôll call them ‚Äòa‚Äô and ‚Äòb‚Äô.</p>   <blockquote class=\"code-2col\">   <blockquote class=\"code-in\">     <code-in-title>Old</code-in-title>     <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ cat old<br />üçé<br />üçê<br />üçä<br />üçã<br />üçí<br />ü•ë<br /></code></pre></div>    </div>   </blockquote>   <blockquote class=\"code-out\">     <code-out-title>New</code-out-title>     <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ cat new<br />üçé<br />üçê<br />üçä<br />üçã<br />üçç<br />ü•ë<br /></code></pre></div>    </div>   </blockquote> </blockquote>   <p>We can see that they have some different entries. We‚Äôve removed üçí because they‚Äôre awful, and replaced them with an üçç</p>   <p>Diff lets us compare these files</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>diff old new<br />5c5<br />&lt; üçí<br /><span class=\"nt\">---</span><br /><span class=\"o\">&gt;</span> üçç<br /></code></pre></div></div>   <p>Here we see that üçí is only in a, and üçç is only in b. But otherwise the files are identical.</p>   <p>There are a couple different formats to diffs, one is the ‚Äòunified diff‚Äô</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>diff <span class=\"nt\">-U2</span> old new<br /><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ new\t2022-02-16 14:06:36.340962616 +0100<br />@@ <span class=\"nt\">-3</span>,4 +3,4 @@<br /> üçä<br /> üçã<br />-üçí<br />+üçç<br /> ü•ë<br /></code></pre></div></div>   <p>This is basically what you see in the training materials which gives you a lot of context about the changes:</p>   <ul>   <li><code class=\"language-plaintext highlighter-rouge\">--- old</code> is the ‚Äòold‚Äô file in our view</li>   <li><code class=\"language-plaintext highlighter-rouge\">+++ new</code> is the ‚Äònew‚Äô file</li>   <li>@@ these lines tell us where the change occurs and how many lines are added or removed.</li>   <li>Lines starting with a - are removed from our ‚Äònew‚Äô file</li>   <li>Lines with a + have been added.</li> </ul>   <p>So when you go to apply these diffs to your files in the training:</p>   <ol>   <li>Ignore the header</li>   <li>Remove lines starting with - from your file</li>   <li>Add lines starting with + to your file</li> </ol>   <p>The other lines (üçä/üçã and ü•ë) above just provide ‚Äúcontext‚Äù, they help you know where a change belongs in a file, but <strong>should not be edited</strong> when you‚Äôre making the above change. Given the above diff, you would find a line with a üçí, and replace it with a üçç</p>   <h4 id=\"added--removed-lines\">Added &amp; Removed Lines</h4>   <p>Removals are very easy to spot, we just have removed lines</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ new\t2022-02-16 14:10:14.370722802 +0100<br />@@ <span class=\"nt\">-4</span>,3 +4,2 @@<br /> üçã<br /> üçí<br />-ü•ë<br /></code></pre></div></div>   <p>And additions likewise are very easy, just add a new line, between the other lines in your file.</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ new\t2022-02-16 14:11:11.422135393 +0100<br />@@ <span class=\"nt\">-1</span>,3 +1,4 @@<br /> üçé<br />+üçç<br /> üçê<br /> üçä<br /></code></pre></div></div>   <h4 id=\"completely-new-files\">Completely new files</h4>   <p>Completely new files look a bit different, there the ‚Äúold‚Äù file is <code class=\"language-plaintext highlighter-rouge\">/dev/null</code>, the empty file in a Linux machine.</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nv\">$ </span>diff <span class=\"nt\">-U2</span> /dev/null old<br /><span class=\"nt\">---</span> /dev/null\t2022-02-15 11:47:16.100000270 +0100<br />+++ old\t2022-02-16 14:06:19.697132568 +0100<br />@@ <span class=\"nt\">-0</span>,0 +1,6 @@<br />+üçé<br />+üçê<br />+üçä<br />+üçã<br />+üçí<br />+ü•ë<br /></code></pre></div></div>   <p>And removed files are similar, except with the new file being /dev/null</p>   <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nt\">---</span> old\t2022-02-16 14:06:19.697132568 +0100<br />+++ /dev/null\t2022-02-15 11:47:16.100000270 +0100<br />@@ <span class=\"nt\">-1</span>,6 +0,0 @@<br />-üçé<br />-üçê<br />-üçä<br />-üçã<br />-üçí<br />-ü•ë<br /></code></pre></div></div> </blockquote>\n      <p><!--END_SNIPPET--></p>\n    </li>\n    <li>\n      <p>Install the requirements with <code class=\"language-plaintext highlighter-rouge\">ansible-galaxy</code>:</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div data-cmd=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ansible-galaxy <span class=\"nb\">install</span> <span class=\"nt\">-p</span> roles <span class=\"nt\">-r</span> requirements.yml\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n    <li>\n      <p>Add the new roles to your <code class=\"language-plaintext highlighter-rouge\">galaxy.yml</code> playbook, before the Galaxy server itself. We‚Äôll do this because it‚Äôs a dependency of Galaxy to run, so it needs to be there before Galaxy starts.</p>\n\n      <div data-commit=\"Add the roles to the playbook\" class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- a/galaxy.yml\n</span><span class=\"gi\">+++ b/galaxy.yml\n</span><span class=\"p\">@@ -31,6 +31,7 @@</span>\n       when: ansible_os_family == 'Debian'\n   roles:\n     - galaxyproject.tusd\n<span class=\"gi\">+    - usegalaxy_eu.apptainer\n</span>     - galaxyproject.galaxy\n     - role: galaxyproject.miniconda\n       become: true\n   \n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Run the playbook</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div data-cmd=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ansible-playbook galaxy.yml\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n    <li>\n      <p>Apptainer should now be installed on your Galaxy server. You can test this by connecting\nto your server and run the following command:</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>apptainer run docker://hello-world\n</code></pre></div>        </div>\n      </blockquote>\n\n      <blockquote class=\"code-out\">\n        <code-out-title>Bash</code-out-title>\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>INFO:    Converting OCI blobs to SIF format\nINFO:    Starting build...\nGetting image source signatures\nCopying blob 0e03bdcc26d7 done\nCopying config b23a8f6569 done\nWriting manifest to image destination\nStoring signatures\n2021/01/08 11:25:12  info unpack layer: sha256:0e03bdcc26d7a9a57ef3b6f1bf1a210cff6239bff7c8cac72435984032851689\nINFO:    Creating SIF file...\nWARNING: passwd file doesn't exist in container, not updating\nWARNING: group file doesn't exist in container, not updating\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n...\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n  </ol>\n</blockquote>\n\n<h2 id=\"configure-galaxy-to-use-apptainer\">Configure Galaxy to use Apptainer</h2>\n\n<p>Now, we will configure Galaxy to run tools using Apptainer containers, which will be automatically fetched from <a href=\"https://quay.io/organization/biocontainers\">the BioContainers repository</a>.</p>\n\n<blockquote class=\"warning\">\n  <warning-title>Galaxy Calls It Singularity, not Apptainer</warning-title>\n  <p>Galaxy still uses <code class=\"language-plaintext highlighter-rouge\">singularity</code> in most variables, they will be replaced successively.</p>\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Configure Galaxy to use Apptainer</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Edit the <code class=\"language-plaintext highlighter-rouge\">group_vars/galaxyservers.yml</code> file and add a <code class=\"language-plaintext highlighter-rouge\">dependency_resolvers_config_file</code> entry and a corresponding <code class=\"language-plaintext highlighter-rouge\">galaxy_config_templates</code> entry:</p>\n    </li>\n    <li>\n      <p>Edit the <code class=\"language-plaintext highlighter-rouge\">group_vars/galaxyservers.yml</code> file and add a <code class=\"language-plaintext highlighter-rouge\">container_resolvers_config_file</code> entry and a corresponding <code class=\"language-plaintext highlighter-rouge\">galaxy_config_templates</code> entry:</p>\n\n      <div data-commit=\"Configure the container and dependency resolvers\" class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- a/group_vars/galaxyservers.yml\n</span><span class=\"gi\">+++ b/group_vars/galaxyservers.yml\n</span><span class=\"p\">@@ -75,6 +75,9 @@</span> galaxy_config:\n     tus_upload_store: \"{{ galaxy_tus_upload_store }}\"\n     # CVMFS\n     tool_data_table_config_path: /cvmfs/data.galaxyproject.org/byhand/location/tool_data_table_conf.xml,/cvmfs/data.galaxyproject.org/managed/location/tool_data_table_conf.xml\n<span class=\"gi\">+    # Tool Dependencies\n+    dependency_resolvers_config_file: \"{{ galaxy_config_dir }}/dependency_resolvers_conf.xml\"\n+    container_resolvers_config_file: \"{{ galaxy_config_dir }}/container_resolvers_conf.yml\"\n</span>   gravity:\n     process_manager: systemd\n     galaxy_root: \"{{ galaxy_root }}/server\"\n<span class=\"p\">@@ -114,6 +117,12 @@</span> galaxy_config_files:\n   - src: files/galaxy/themes.yml\n     dest: \"{{ galaxy_config.galaxy.themes_config_file }}\"\n    \n<span class=\"gi\">+galaxy_config_templates:\n+  - src: templates/galaxy/config/container_resolvers_conf.yml.j2\n+    dest: \"{{ galaxy_config.galaxy.container_resolvers_config_file }}\"\n+  - src: templates/galaxy/config/dependency_resolvers_conf.xml\n+    dest: \"{{ galaxy_config.galaxy.dependency_resolvers_config_file }}\"\n+\n</span> galaxy_extra_dirs:\n   - /data\n    \n   \n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Create the <code class=\"language-plaintext highlighter-rouge\">templates/galaxy/config</code> directory if it doesn‚Äôt exist:</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div data-cmd=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">mkdir</span> <span class=\"nt\">-p</span> templates/galaxy/config\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n    <li>\n      <p>Create the new file <code class=\"language-plaintext highlighter-rouge\">templates/galaxy/config/dependency_resolvers_conf.xml</code>. This will not enable any dependency resolvers like the legacy toolshed packages or Galaxy packages, and instead everything will be resolved through Apptainer.</p>\n\n      <div data-commit=\"Configure the dependency resolvers\" class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- /dev/null\n</span><span class=\"gi\">+++ b/templates/galaxy/config/dependency_resolvers_conf.xml\n</span><span class=\"p\">@@ -0,0 +1,2 @@</span>\n<span class=\"gi\">+&lt;dependency_resolvers&gt;\n+&lt;/dependency_resolvers&gt;\n</span>   \n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Create the new file <code class=\"language-plaintext highlighter-rouge\">templates/galaxy/config/container_resolvers_conf.yml.j2</code>, this specifies the order in which to attempt container resolution.</p>\n\n      <div data-commit=\"Configure the container resolver\" class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- /dev/null\n</span><span class=\"gi\">+++ b/templates/galaxy/config/container_resolvers_conf.yml.j2\n</span><span class=\"p\">@@ -0,0 +1,11 @@</span>\n<span class=\"gi\">+\n+- type: cached_explicit_singularity\n+  cache_directory: \"{{ galaxy_mutable_data_dir }}/cache/singularity/explicit/\"\n+- type: cached_mulled_singularity\n+  cache_directory: \"{{ galaxy_mutable_data_dir }}/cache/singularity/mulled/\"\n+- type: mulled_singularity\n+  auto_install: False\n+  cache_directory: \"{{ galaxy_mutable_data_dir }}/cache/singularity/mulled/\"\n+- type: build_mulled_singularity\n+  auto_install: False\n+  cache_directory: \"{{ galaxy_mutable_data_dir }}/cache/singularity/built/\"\n</span>   \n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Now, we want to make Galaxy run jobs using Apptainer. Modify the file <code class=\"language-plaintext highlighter-rouge\">group_vars/galaxyservers.yml</code>, by adding the <code class=\"language-plaintext highlighter-rouge\">singularity_enabled</code> parameter:</p>\n\n      <div data-commit=\"Update the job_conf with singularity destination\" class=\"language-diff highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"gd\">--- a/group_vars/galaxyservers.yml\n</span><span class=\"gi\">+++ b/group_vars/galaxyservers.yml\n</span><span class=\"p\">@@ -21,11 +21,24 @@</span> galaxy_job_config:\n   handling:\n     assign: ['db-skip-locked']\n   execution:\n<span class=\"gd\">-    default: local_env\n</span><span class=\"gi\">+    default: singularity\n</span>     environments:\n       local_env:\n         runner: local_runner\n         tmp_dir: true\n<span class=\"gi\">+      singularity:\n+        runner: local_runner\n+        singularity_enabled: true\n+        env:\n+        # Ensuring a consistent collation environment is good for reproducibility.\n+        - name: LC_ALL\n+          value: C\n+        # The cache directory holds the docker containers that get converted\n+        - name: APPTAINER_CACHEDIR\n+          value: /tmp/singularity\n+        # Apptainer uses a temporary directory to build the squashfs filesystem\n+        - name: APPTAINER_TMPDIR\n+          value: /tmp\n</span>   tools:\n     - class: local # these special tools that aren't parameterized for remote execution - expression tools, upload, etc\n       environment: local_env\n   \n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p>Re-run the playbook</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div data-cmd=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ansible-playbook galaxy.yml\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n    <li>\n      <p>In your Galaxy admin interface, install the minimap2 tool.</p>\n\n      <ul>\n        <li>Login to Galaxy as the admin user</li>\n        <li>Click the ‚Äúadmin‚Äù menu at the top</li>\n        <li>Under ‚ÄúTool Management‚Äù on the left select ‚ÄúInstall and Uninstall‚Äù</li>\n        <li>search for <code class=\"language-plaintext highlighter-rouge\">minimap2</code> and install the latest version with the Target Section ‚ÄúMapping‚Äù</li>\n      </ul>\n\n      <p><a href=\"../../images/install-minimap2.png\" rel=\"noopener noreferrer\"><img src=\"../../images/install-minimap2.png\" alt=\"Screenshot of the install interface, minimap2 is entered in the search box and the latest revision shows it is currently cloning. \" width=\"1304\" height=\"615\" loading=\"lazy\" /></a></p>\n    </li>\n    <li>\n      <p>Upload the following fasta file</p>\n\n      <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>&gt;testing\nGATTACAGATHISISJUSTATESTGATTACA\n</code></pre></div>      </div>\n    </li>\n    <li>\n      <p><strong>Map with minimap2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span> with the following parameters</p>\n      <ul>\n        <li><em>‚ÄúWill you select a reference genome from your history or use a built-in index‚Äù</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code></li>\n        <li><em>‚ÄúUse the following dataset as the reference sequence‚Äù</em>: The fasta file you uploaded</li>\n        <li><em>‚ÄúSingle or Paired-end reads‚Äù</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>‚ÄúSelect fastq dataset‚Äù</em>: The fasta file you uploaded</li>\n          </ul>\n        </li>\n      </ul>\n\n      <p>Your job should be executed using Apptainer with a BioContainer! You can watch the logs of Galaxy to see this happening.</p>\n\n      <blockquote class=\"code-in\">\n        <code-in-title>Bash</code-in-title>\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>journalctl -f\n</code></pre></div>        </div>\n      </blockquote>\n\n      <blockquote class=\"code-out code-max-300\">\n        <code-out-title></code-out-title>\n        <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>gunicorn[1190010]: galaxy.tool_util.deps.containers INFO 2021-01-08 13:37:30,342 [p:1190010,w:0,m:2] [LocalRunner.work_thread-1] Checking with container resolver [MulledSingularityContainerResolver[namespace=biocontainers]] found description [ContainerDescription[identifier=docker://quay.io/biocontainers/mulled-v2-66534bcbb7031a148b13e2ad42583020b9cd25c4:e1ea28074233d7265a5dc2111d6e55130dff5653-0,type=singularity]]\ngunicorn[1190010]: galaxy.jobs.command_factory INFO 2021-01-08 13:37:30,418 [p:1190010,w:0,m:2] [LocalRunner.work_thread-1] Built script [/srv/galaxy/jobs/000/23/tool_script.sh] for tool command [minimap2 --version &gt; /srv/galaxy/jobs/000/23/outputs/COMMAND_VERSION 2&gt;&amp;1; ln -f -s '/data/000/dataset_22.dat' reference.fa &amp;&amp; minimap2           -t ${GALAXY_SLOTS:-4} reference.fa '/data/000/dataset_22.dat' -a | samtools sort -@${GALAXY_SLOTS:-2} -T \"${TMPDIR:-.}\" -O BAM -o '/data/000/dataset_23.dat' &gt; '/data/000/dataset_23.dat']\ngunicorn[1190010]: galaxy.jobs.runners DEBUG 2021-01-08 13:37:30,441 [p:1190010,w:0,m:2] [LocalRunner.work_thread-1] (23) command is: mkdir -p working outputs configs\ngunicorn[1190010]: if [ -d _working ]; then\ngunicorn[1190010]:     rm -rf working/ outputs/ configs/; cp -R _working working; cp -R _outputs outputs; cp -R _configs configs\ngunicorn[1190010]: else\ngunicorn[1190010]:     cp -R working _working; cp -R outputs _outputs; cp -R configs _configs\ngunicorn[1190010]: fi\ngunicorn[1190010]: cd working; SINGULARITYENV_GALAXY_SLOTS=$GALAXY_SLOTS SINGULARITYENV_HOME=$HOME SINGULARITYENV__GALAXY_JOB_HOME_DIR=$_GALAXY_JOB_HOME_DIR SINGULARITYENV__GALAXY_JOB_TMP_DIR=$_GALAXY_JOB_TMP_DIR SINGULARITYENV_TMPDIR=$TMPDIR SINGULARITYENV_TMP=$TMP SINGULARITYENV_TEMP=$TEMP singularity -s exec -B /srv/galaxy/server:/srv/galaxy/server:ro -B /srv/galaxy/var/shed_tools/toolshed.g2.bx.psu.edu/repos/iuc/minimap2/8c6cd2650d1f/minimap2:/srv/galaxy/var/shed_tools/toolshed.g2.bx.psu.edu/repos/iuc/minimap2/8c6cd2650d1f/minimap2:ro -B /srv/galaxy/jobs/000/23:/srv/galaxy/jobs/000/23 -B /srv/galaxy/jobs/000/23/outputs:/srv/galaxy/jobs/000/23/outputs -B /srv/galaxy/jobs/000/23/configs:/srv/galaxy/jobs/000/23/configs -B /srv/galaxy/jobs/000/23/working:/srv/galaxy/jobs/000/23/working -B /data:/data -B /srv/galaxy/var/tool-data:/srv/galaxy/var/tool-data:ro -B /srv/galaxy/var/tool-data:/srv/galaxy/var/tool-data:ro --home $HOME:$HOME docker://quay.io/biocontainers/mulled-v2-66534bcbb7031a148b13e2ad42583020b9cd25c4:e1ea28074233d7265a5dc2111d6e55130dff5653-0 /bin/bash /srv/galaxy/jobs/000/23/tool_script.sh &gt; ../outputs/tool_stdout 2&gt; ../outputs/tool_stderr; return_code=$?; cd '/srv/galaxy/jobs/000/23';\n</code></pre></div>        </div>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"hidden\">\n  <div data-test=\"true\" class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>1-run-minimap2.sh\n</code></pre></div>  </div>\n</blockquote>\n\n<blockquote class=\"comment\">\n  <comment-title>Manage dependencies menu</comment-title>\n  <p>You can manually pull one or many containers for tools in the admin menu. Go to the admin menu, click Manage Dependencies and select the Containers tab. This will list all tools, their dependencies and whether containers are already pulled or can be pulled on demand.</p>\n\n  <p>When a container has been resolved through Apptainer, you‚Äôll see something like this:\n<a href=\"../../images/singularity-resolved.png\" rel=\"noopener noreferrer\"><img src=\"../../images/singularity-resolved.png\" alt=\"Image of a table entry with minimap2 having requirements minimap2+singularity, a resolved column with a green checkmark next to via singularity, the resolver is mulled_singularity, and a container column with a path to /srv/galaxy/var/cache/singularity/mulled and some long hash.\" width=\"4416\" height=\"192\" loading=\"lazy\" /></a></p>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Apptainer, Conda, something else?</tip-title>\n  <p>We often hear</p>\n\n  <blockquote class=\"quote\">\n    <p>What would be the best practice, use Conda or Apptainer?</p>\n  </blockquote>\n\n  <p>Many of us are moving towards Apptainer. Conda environments can resolve differently if they were installed at different times, which isn‚Äôt great for reproducibility. Apptainer images are never updated after generation which makes them fantastic. Also the isolation that‚Äôs there by default is an incredible improvement for less-trustworthy binaries.</p>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Does Apptainer fix issues with Conda dependencies resolution?</tip-title>\n  <p>Yes and no. Apptainer images are built from Conda environments. Only now you are no longer responsible for solving the conda environment, or ensuring that all of the dependencies are installed. The Galaxy project uses a system called ‚Äúmulling‚Äù to bring together multiple Conda dependencies together in a single environment, and Apptainer images are produced for these dependencies as well. That said, complex or unresolvable Conda environments are not solved by Apptainer, because Apptainer is really just packaging Conda‚Äôs environment into a single binary file.</p>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Gateway Time-out (504) in Dependencies view</tip-title>\n  <p>When you open ‚ÄúAdmin -&gt; Tool Management -&gt; Manage Dependencies -&gt; Containers‚Äù, it sometimes shows ‚ÄúGateway Time-out (504)‚Äù</p>\n\n  <p>Resolving all dependencies for all tools can take a bit, you can increase your timeout with the <code class=\"language-plaintext highlighter-rouge\">proxy_read_timeout</code> setting in <code class=\"language-plaintext highlighter-rouge\">templates/nginx/galaxy.j2</code></p>\n</blockquote>\n\n<blockquote class=\"tip\">\n  <tip-title>Resolution is \"unresolved\"</tip-title>\n  <p>In ‚ÄúAdmin -&gt; Tool Management -&gt; Manage Dependencies -&gt; Dependencies‚Äù, the Resolution for minimap2 @ 2.24 (as well as samtools @1.14) is ‚Äúunresolved‚Äù. How can I resolve this issue?</p>\n\n  <p>Because our training uses containers for resolution it is expected that the non-container dependencies show as ‚Äúunresolved‚Äù. There is not currently a view which indicates if the containers have been resolved.</p>\n</blockquote>\n\n<!--\n## Use Apptainer containers from CVMFS\n\nGalaxy can be configured to use pre-made Apptainer containers available from /cvmfs/singularity.galaxyproject.org/.\nIn order to do so, you will first need to set up CVMFS by doing the [CVMFS](/training-material/topics/admin/tutorials/cvmfs/tutorial.html) tutorial.\nAfter finishing the CVMFS tutorial, come back, and do this hands-on.\n\n> <hands-on-title>Optional: Configure Galaxy to use Apptainer containers from CVMFS</hands-on-title>\n>\n> 1. Edit the `group_vars/galaxyservers.yml` file and add `container_resolvers_config_file` and `galaxy_singularity_images_cvmfs_path`:\n>    \n>    ```yaml\n>    galaxy_singularity_images_cvmfs_path: \"/cvmfs/singularity.galaxyproject.org/all/\"\n>    galaxy_config:\n>      galaxy:\n>        ...\n>        container_resolvers_config_file: \"{{ galaxy_config_dir }}/container_resolvers_conf.yml\"\n>    ```\n>    \n>\n> 2. Also in `group_vars/galaxyservers.yml`, add a `galaxy_config_templates` entry:\n>    \n>    ```yaml\n>    galaxy_config_templates:\n>      - src: templates/galaxy/config/container_resolvers_conf.yml.j2\n>        dest: \"{{ galaxy_config_dir }}/container_resolvers_conf.yml\"\n>    ```\n>    \n>\n> 3. Create the new file `templates/galaxy/config/container_resolvers_conf.yml.j2`:\n>    \n>    ```xml\n>    <containers_resolvers>\n>        <explicit_singularity />\n>        <cached_mulled_singularity cache_directory=\"{{ galaxy_singularity_images_cvmfs_path }}\"/>\n>    </containers_resolvers>\n>    ```\n>    \n>\n> 4. Re-run the playbook (`ansible-playbook galaxy.yml`)\n>\n> 5. Rerun your minimap2 job from the previous section. This time it should use a container served by CVMFS.\n>\n{: .hands_on}\n\n> ```bash\n> 1-run-minimap2.sh\n> ```\n> {: data-test=\"true\"}\n{: .hidden}\n\n-->\n\n<!--SNIPPET-->\n<blockquote class=\"hands_on\">   <div class=\"box-title hands_on-title\" id=\"hands-on-time-to-git-commit\"><i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i> Hands-on: Time to git commit</div>   <p>It‚Äôs time to commit your work! Check the status with</p>   <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git status<br /></code></pre></div></div>   <p>Add your changed files with</p>   <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git add ... # any files you see that are changed<br /></code></pre></div></div>   <p>And then commit it!</p>   <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git commit -m 'Finished Use Apptainer containers for running Galaxy jobs'<br /></code></pre></div></div> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-got-lost-along-the-way\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Got lost along the way?</div>   <p>If you missed any steps, you can compare against the <a href=\"https://github.com/hexylena/git-gat/tree/step-6\">reference files</a>, or see what changed since <a href=\"https://github.com/hexylena/git-gat/compare/step-5...step-6#files_bucket\">the previous tutorial</a>.</p>   <p>If you‚Äôre using <code class=\"language-plaintext highlighter-rouge\">git</code> to track your progress, remember to add your changes and commit with a good commit message!</p> </blockquote>\n<p><!--END_SNIPPET--></p>\n\n<!--SNIPPET-->\n<blockquote class=\"comment\">   <div class=\"box-title comment-title\" id=\"comment-galaxy-admin-training-path-1\"><i class=\"far fa-comment-dots\" aria-hidden=\"true\"></i> Comment: Galaxy Admin Training Path</div>   <p>The yearly Galaxy Admin Training follows a specific ordering of tutorials. Use this timeline to help keep track of where you are in Galaxy Admin Training.</p>   <ol id=\"git-gat-timeline\">                    <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html\">             <div>Step 1</div>             <div>ansible-galaxy</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/backup-cleanup/tutorial.html\">             <div>Step 2</div>             <div>backup-cleanup</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/customization/tutorial.html\">             <div>Step 3</div>             <div>customization</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/tus/tutorial.html\">             <div>Step 4</div>             <div>tus</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"disabled\">         <a href=\"/training-material/topics/admin/tutorials/cvmfs/tutorial.html\">             <div>Step 5</div>             <div>cvmfs</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"active\">         <a href=\"/training-material/topics/admin/tutorials/apptainer/tutorial.html\">             <div>Step 6</div>             <div>apptainer</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/tool-management/tutorial.html\">             <div>Step 7</div>             <div>tool-management</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/reference-genomes/tutorial.html\">             <div>Step 8</div>             <div>reference-genomes</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/data-library/tutorial.html\">             <div>Step 9</div>             <div>data-library</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/dev/tutorials/bioblend-api/tutorial.html\">             <div>Step 10</div>             <div>dev/bioblend-api</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/connect-to-compute-cluster/tutorial.html\">             <div>Step 11</div>             <div>connect-to-compute-cluster</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/job-destinations/tutorial.html\">             <div>Step 12</div>             <div>job-destinations</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/pulsar/tutorial.html\">             <div>Step 13</div>             <div>pulsar</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/celery/tutorial.html\">             <div>Step 14</div>             <div>celery</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/gxadmin/tutorial.html\">             <div>Step 15</div>             <div>gxadmin</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/reports/tutorial.html\">             <div>Step 16</div>             <div>reports</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/monitoring/tutorial.html\">             <div>Step 17</div>             <div>monitoring</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/tiaas/tutorial.html\">             <div>Step 18</div>             <div>tiaas</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/sentry/tutorial.html\">             <div>Step 19</div>             <div>sentry</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/ftp/tutorial.html\">             <div>Step 20</div>             <div>ftp</div>         </a>     </li>               <span aria-hidden=\"true\">         <i class=\"fas fa-arrow-right\" aria-hidden=\"true\"></i>     </span>                         <li class=\"\">         <a href=\"/training-material/topics/admin/tutorials/beacon/tutorial.html\">             <div>Step 21</div>             <div>beacon</div>         </a>     </li>           </ol> </blockquote>\n<p><!--END_SNIPPET--></p>\n"],"ref_slides":[],"video_library":{"tutorial":{"description":"Running jobs in Apptainer","materials":[{"link":"topics/admin/tutorials/apptainer/tutorial.html","type":"Tutorial"}],"tags":["admin"],"type":"Tutorial","versions":[{"captions":["gallardoalba","slugger70"],"date":"2021-06-28","galaxy_version":"21.05","length":"43M","link":"q6Dt7j713tI","speakers":["slugger70"]},{"captions":["hexylena","cat-bro"],"date":"2021-02-15","galaxy_version":"21.01","length":"16M","link":"airzg4-ETEs","speakers":["hexylena"]}],"gtn_id":"admin/apptainer","title":"Use Apptainer containers for running Galaxy jobs","captioned":true},"slides":null,"demo":null,"both":null,"session":null},"hands_on":true,"slides":false,"mod_date":"2024-01-31 16:33:56 +0000","pub_date":"2021-01-08 14:43:22 +0000","version":33,"api":"https://training.galaxyproject.org/training-material/api/topics/admin/tutorials/apptainer/tutorial.json","tools":[],"supported_servers":[],"topic_name_human":"Galaxy Server administration","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools: []\n","tours":false,"video":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}