{"layout":"tutorial_hands_on","title":"ERGA post-assembly QC","questions":["what combination of tools can assess the quality of an post-assembly?","what metrics can help to analyse the quality?","how to evaluate the outputs?"],"objectives":["apply the post-assembly-QC-workflow using the necessary tools","analyse and evaluate the results of the workflow"],"time_estimation":"3H","key_points":["The ERGA post-assembly pipeline allows to assess and improve the quality of genome assemblies","The ERGA post-assembly pipeline contains of three main steps: Genome assembly decontamination and overview with BlobToolKit, providing analysis information and statistics and Hi-C scaffolding."],"contributors":[{"name":"Fabian Recktenwald","joined":"2023-03","id":"GitFab93","url":"https://training.galaxyproject.org/training-material/api/contributors/GitFab93.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/GitFab93/"},{"name":"Cristóbal Gallardo","joined":"2020-11","elixir_node":"de","orcid":"0000-0002-5752-2155","former_affiliations":["uni-freiburg","elixir-europe"],"id":"gallardoalba","url":"https://training.galaxyproject.org/training-material/api/contributors/gallardoalba.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/gallardoalba/"}],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00355","url":"/topics/assembly/tutorials/ERGA-post-assembly-QC/tutorial.html","topic_name":"assembly","tutorial_name":"ERGA-post-assembly-QC","dir":"topics/assembly/tutorials/ERGA-post-assembly-QC","symlink":null,"id":"assembly/ERGA-post-assembly-QC","ref_tutorials":["<p>The European Reference Genome Atlas (ERGA) is a large-scale project aimed at generating and integrating high-quality reference genomes for a wide range of European organisms. The project will use state-of-the-art sequencing technologies and advanced bioinformatics tools to produce high-quality genome assemblies.</p>\n\n<p>Reference genomes provide a baseline for understanding genetic diversity within and among populations, and can be used to identify populations at risk of genetic erosion. This information is crucial for developing effective conservation strategies and management plans for threatened and endangered species (<span class=\"citation\"><a href=\"#Shafer2015\">Shafer <i>et al.</i> 2015</a></span>). Additionally, by better understanding the genetic basis of important traits, such as disease resistance and adaptation to changing environments, researchers can develop targeted interventions to mitigate the effects of environmental change and prevent the loss of genetic diversity (<span class=\"citation\"><a href=\"#Frankham2011\">FRANKHAM <i>et al.</i> 2011</a></span>). The ERGA project has the potential to greatly benefit biodiversity conservation efforts and advance our understanding of the genetic basis of biodiversity.</p>\n\n<p>Genome post-assembly quality control (GPAQC) is a crucial step for evaluating the accuracy and completeness of newly assembled genomes. This involves assessing the contiguity, completeness, accuracy, and consistency of the genome assembly using various bioinformatic tools and methods (<span class=\"citation\"><a href=\"#Koren2017\">Koren <i>et al.</i> 2017</a></span>, <span class=\"citation\"><a href=\"#Hunt2015\">Hunt <i>et al.</i> 2015</a></span>, <span class=\"citation\"><a href=\"#Mikheenko2015\">Mikheenko <i>et al.</i> 2015</a></span>, <span class=\"citation\"><a href=\"#Vaser2017\">Vaser <i>et al.</i> 2017</a></span>, <span class=\"citation\"><a href=\"#Zimin2017\">Zimin <i>et al.</i> 2017</a></span>). GPAQC aims to ensure that genomic data is reliable and useful for downstream analyses such as annotation, comparative genomics, and functional studies.</p>\n\n<p>In this tutorial you will learn how to implement the ERGA GPAQC pipeline, and how to interpretate the potential outcomes.</p>\n\n<blockquote class=\"agenda\">\n  <agenda-title></agenda-title>\n\n  <p>In this tutorial, we will cover:</p>\n\n<ol id=\"markdown-toc\">\n  <li><a href=\"#study-cases\" id=\"markdown-toc-study-cases\">Study cases</a></li>\n  <li><a href=\"#get-data\" id=\"markdown-toc-get-data\">Get data</a></li>\n  <li><a href=\"#genome-assembly-overview-with-blobtoolkit\" id=\"markdown-toc-genome-assembly-overview-with-blobtoolkit\">Genome assembly overview with BlobToolKit</a>    <ol>\n      <li><a href=\"#generate-read-coverage-data-with-hisat2\" id=\"markdown-toc-generate-read-coverage-data-with-hisat2\">Generate read coverage data with <strong>HISAT2</strong></a></li>\n      <li><a href=\"#generate-sequence-similarity-data-with-diamond\" id=\"markdown-toc-generate-sequence-similarity-data-with-diamond\">Generate sequence similarity data with DIAMOND</a></li>\n      <li><a href=\"#generate-busco-report\" id=\"markdown-toc-generate-busco-report\">Generate <strong>BUSCO</strong> report</a></li>\n      <li><a href=\"#generate-interactive-plots-with-blobtoolkit\" id=\"markdown-toc-generate-interactive-plots-with-blobtoolkit\">Generate interactive plots with <strong>BlobToolKit</strong></a></li>\n    </ol>\n  </li>\n  <li><a href=\"#k-mer-based-genome-profiling-and-evaluation\" id=\"markdown-toc-k-mer-based-genome-profiling-and-evaluation\">K-mer based genome profiling and evaluation</a>    <ol>\n      <li><a href=\"#generating-k-mer-profile-with-meryl\" id=\"markdown-toc-generating-k-mer-profile-with-meryl\">Generating k-mer profile with <strong>Meryl</strong></a></li>\n      <li><a href=\"#k-mer-profile-analysis-with-genomescope\" id=\"markdown-toc-k-mer-profile-analysis-with-genomescope\">K-mer profile analysis with <strong>GenomeScope</strong></a></li>\n      <li><a href=\"#k-mer-based-assembly-evaluation-with-merqury\" id=\"markdown-toc-k-mer-based-assembly-evaluation-with-merqury\">K-mer based assembly evaluation with <strong>Merqury</strong></a></li>\n      <li><a href=\"#providing-assembly-statistics-with-gfastats\" id=\"markdown-toc-providing-assembly-statistics-with-gfastats\">Providing assembly statistics with <strong>gfastats</strong></a></li>\n    </ol>\n  </li>\n  <li><a href=\"#hi-c-scaffolding\" id=\"markdown-toc-hi-c-scaffolding\">Hi-C scaffolding</a>    <ol>\n      <li><a href=\"#pre-processing-hi-c-data\" id=\"markdown-toc-pre-processing-hi-c-data\">Pre-processing Hi-C data</a></li>\n      <li><a href=\"#generate-hi-c-contact-map\" id=\"markdown-toc-generate-hi-c-contact-map\">Generate Hi-C contact map</a></li>\n    </ol>\n  </li>\n  <li><a href=\"#assembly-graph\" id=\"markdown-toc-assembly-graph\">Assembly graph</a></li>\n  <li><a href=\"#conclusion\" id=\"markdown-toc-conclusion\">Conclusion</a></li>\n</ol>\n\n</blockquote>\n\n<h1 id=\"study-cases\">Study cases</h1>\n\n<p>In this tutorial we will evaluate three genome assemblies, belonging to three different taxonomic groups, in order to illustrate the different scenarios that can be identified. The characteristics of each of them are described briefly below.</p>\n\n<p><strong>Case 1: <em>Chondrosia reniformis</em></strong></p>\n\n<p><em>Chondrosia reniformis</em> is a slow-growing marine sponge cosmopolitan species which can be found in the Mediterranean Sea and the eastern Atlantic Ocean in shallow waters; it is considered to playing an important ecological role in the marine ecosystem by filtering large volumes of water and providing habitat for other species (<span class=\"citation\"><a href=\"#Voultsiadou2005\">Voultsiadou 2005</a></span>). The members of this species are gonochoristic and oviparous, whose physiology and behavious seems to be highly influence for the presence of endosymbiosis heterotrophic bacteria (<span class=\"citation\"><a href=\"#sara1997\">Sara Michele and Carlo 1998</a></span>).</p>\n\n<figure id=\"figure-1\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/chondrosia.jpg\" alt=\"Figure 1: Distribution of data. \" width=\"1024\" height=\"360\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/chondrosia.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 1</strong>:</span> Histories corresponding to the three cases of study.</figcaption></figure>\n\n<p>The assembly is based on 70x PacBio HiFi and Arima2 Hi-C data generated by the Aquatic <a href=\"https://www.aquaticsymbiosisgenomics.org/\">Symbiosis Genomics Project</a>. The assembly process included the following sequence of steps: initial PacBio assembly generation with Hifiasm, retained haplotig separation with purge_dups, and Hi-C based scaffolding with YaHS. The mitochondrial genome was assembled using MitoHiFi. Finally, the primary assembly was analysed and manually improved using gEVAL.</p>\n\n<p><strong>Case 2: <em>Erythrolamprus reginae</em></strong></p>\n\n<p><em>Erythrolamprus reginae</em> is a species of colubrid snake found in South America. This species has been reported to include triploid individuals with parthenogenic reproduction; this type of seems to be associated with higher mutation rate tandem dupliation (<span class=\"citation\"><a href=\"#Bogart1980\">Bogart 1980</a></span>).</p>\n\n<figure id=\"figure-2\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/erytrocampus.jpg\" alt=\"Figure 2: Distribution of data. \" width=\"1023\" height=\"369\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/erytrocampus.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 2</strong>:</span> Histories corresponding to the three cases of study.</figcaption></figure>\n\n<p>The assembly used in this tutorial correspond to the curated primary assembly generated by the <a href=\"https://vertebrategenomesproject.org/\">VGP project</a>, based on 34x Pacbio HiFi and Arima2 Hi-C data, by using the <a href=\"/training-material/topics/assembly/tutorials/vgp_genome_assembly/tutorial.html\">VGP assembly pipeline</a>.</p>\n\n<p><strong>Case 3: <em>Eschrichtius robustus</em></strong></p>\n\n<p><em>Eschrichtius robustus</em>, commonly known as the gray whale, is a species of whale found primarily in the North Pacific Ocean. Adult gray whales can reach lengths of up to 14.9 meters and weights of up to 36,000 kilograms. It is a diploid specie, genetically characterized by high homozygosity as a result of inbreeding (<span class=\"citation\"><a href=\"#BrnicheOlsen2018\">Brüniche-Olsen <i>et al.</i> 2018</a></span>).</p>\n\n<figure id=\"figure-3\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/eschrichtius.jpg\" alt=\"Figure 3: Distribution of data. \" width=\"1200\" height=\"420\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/eschrichtius.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 3</strong>:</span> Histories corresponding to the three cases of study.</figcaption></figure>\n\n<p>The assembly used in this tutorial correspond to the curated primary assembly generated by the <a href=\"https://vertebrategenomesproject.org/\">VGP project</a>, based on 29x Pacbio HiFi data, by using the <a href=\"/training-material/topics/assembly/tutorials/vgp_genome_assembly/tutorial.html\">VGP assembly pipeline</a>.</p>\n\n<h1 id=\"get-data\">Get data</h1>\n\n<p>As a first step we will get the data from Zenodo.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload data</hands-on-title>\n\n  <ol>\n    <li>\n      <p>Create a new history for allocating temporally all the datasets. This history can be named as <code class=\"language-plaintext highlighter-rouge\">Datasets history</code></p>\n    </li>\n    <li>\n      <p>Import the Pacbio HiFi files from Zenodo:</p>\n\n      <ul>\n        <li>Open the file <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>upload</strong> menu</li>\n        <li>Click on <strong>Rule-based</strong> tab</li>\n        <li><em>“Upload data as”</em>: <code class=\"language-plaintext highlighter-rouge\">Collections</code></li>\n        <li>\n          <p>Copy the tabular data, paste it into the textbox and press <kbd>Build</kbd></p>\n\n          <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>dataset_01   https://zenodo.org/record/7786773/files/hifi.fastq.gz   fastq.gz    HiFi    CReniformis_Pacbio\ndataset_01   https://zenodo.org/record/7784764/files/m64055_210602_211608.hifi_reads.fastq.gz   fastq.gz    HiFi    EReginae_PacBio\ndataset_02   https://zenodo.org/record/7784764/files/m54306Ue_211020_191957.hifi_reads.fastq.gz   fastq.gz    HiFi    EReginae_PacBio\ndataset_03   https://zenodo.org/record/7784764/files/m54306Ue_211016_070813.hifi_reads.fastq.gz   fastq.gz    HiFi    EReginae_PacBio\ndataset_04   https://zenodo.org/record/7786773/files/m54306U_210529_225553.hifi_reads.fastq.gz   fastq.gz    HiFi    EReginae_PacBio\ndataset_01   https://zenodo.org/record/7781236/files/m54306Ue_220411_220734.demultiplex.bc1010--bc1010.hifi_reads.fastq.gz   fastq.gz    HiFi    ERobustus_PacBio\ndataset_02   https://zenodo.org/record/7781236/files/m54306Ue_220520_051743.demultiplex.bc1010--bc1010.hifi_reads.fastq.gz   fastq.gz    HiFi    ERobustus_PacBio\ndataset_03   https://zenodo.org/record/7781236/files/m64055e_220615_033108.demultiplex.bc1010--bc1010.hifi_reads.fastq.gz   fastq.gz    HiFi    ERobustus_PacBio\ndataset_04   https://zenodo.org/record/7786773/files/m64055e_220603_182128.demultiplex.bc1010--bc1010.hifi_reads.fastq.gz   fastq.gz    HiFi    ERobustus_PacBio\n</code></pre></div>          </div>\n        </li>\n        <li>From <strong>Rules</strong> menu select <code class=\"language-plaintext highlighter-rouge\">Add / Modify Column Definitions</code>\n          <ul>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">List Identifier(s)</code>: column <code class=\"language-plaintext highlighter-rouge\">A</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">URL</code>: column <code class=\"language-plaintext highlighter-rouge\">B</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">Type</code>: column <code class=\"language-plaintext highlighter-rouge\">C</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">Group Tag</code>: column <code class=\"language-plaintext highlighter-rouge\">D</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">Collection Name</code>: column <code class=\"language-plaintext highlighter-rouge\">E</code></li>\n          </ul>\n        </li>\n        <li>Click <code class=\"language-plaintext highlighter-rouge\">Apply</code> and press <kbd>Upload</kbd></li>\n      </ul>\n    </li>\n    <li>\n      <p>Import the remainig datasets from Zenodo:</p>\n\n      <ul>\n        <li>Open the file <i class=\"fas fa-upload\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-upload</span> <strong>upload</strong> menu</li>\n        <li>Click on <strong>Rule-based</strong> tab</li>\n        <li><em>“Upload data as”</em>: <code class=\"language-plaintext highlighter-rouge\">Datasets</code></li>\n        <li>\n          <p>Copy the tabular data, paste it into the textbox and press <kbd>Build</kbd></p>\n\n          <div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>CReformitis_assembly    https://zenodo.org/record/7831298/files/assembly_sponge.fasta.gz    fasta.gz    assembly\nCReformitis_metadata    https://zenodo.org/record/7781236/files/metadata_chon.yaml  yaml    metadata\nCReniformis_Hi-C_F   https://zenodo.org/record/7786773/files/hiC_1.fastq.gz   fastq.gz    Hi-C\nCReniformis_Hi-C_R   https://zenodo.org/record/7786773/files/hiC_2.fastq.gz   fastq.gz    Hi-C\nEReginae_Hi-C_F_01   https://zenodo.org/record/7831762/files/rEryReg1_Royal_Ground_Snake_R1.fastq.gz.gz.001   fastq.gz    Hi-C\nEReginae_Hi-C_F_02   https://zenodo.org/record/7831762/files/rEryReg1_Royal_Ground_Snake_R1.fastq.gz.gz.002   fastq.gz    Hi-C\nEReginae_Hi-C_F_03   https://zenodo.org/record/7831763/files/rEryReg1_Royal_Ground_Snake_R1.fastq.gz.gz.003   fastq.gz    Hi-C\nEReginae_Hi-C_R_01   https://zenodo.org/record/7833514/files/rEryReg1_Royal_Ground_Snake_R2.fastq.gz.gz.001   fastq.gz    Hi-C\nEReginae_Hi-C_R_02   https://zenodo.org/record/7833514/files/rEryReg1_Royal_Ground_Snake_R2.fastq.gz.gz.002   fastq.gz    Hi-C\nEReginae_Hi-C_R_03   https://zenodo.org/record/7831763/files/rEryReg1_Royal_Ground_Snake_R2.fastq.gz.gz.003   fastq.gz    Hi-C\nEReginata_assembly    https://zenodo.org/record/7788734/files/rEryReg1.pri.cur.20230105.fasta.gz    fasta.gz    assembly\nERegina_metadata    https://zenodo.org/record/7781236/files/metadata_eryth.yaml  fasta.gz    metadata\nERobustus_assembly  https://zenodo.org/record/7781236/files/mEscRob2.pri.cur.20221201.fasta.gz  fasta.gz    assembly\nERobustus_metadata  https://zenodo.org/record/7781236/files/metadata_esch.yaml  yaml    metadata\nTaxonomy_data   https://zenodo.org/record/7781236/files/new_taxdump.tar.gz  gz  taxonomy\nDiamond_db   https://zenodo.org/record/7788734/files/Diamond_makedb.dmnd  dmnd  database\n</code></pre></div>          </div>\n        </li>\n        <li>From <strong>Rules</strong> menu select <code class=\"language-plaintext highlighter-rouge\">Add / Modify Column Definitions</code>\n          <ul>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">Name</code>: column <code class=\"language-plaintext highlighter-rouge\">A</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">URL</code>: column <code class=\"language-plaintext highlighter-rouge\">B</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">Type</code>: column <code class=\"language-plaintext highlighter-rouge\">C</code></li>\n            <li>Click <code class=\"language-plaintext highlighter-rouge\">Add Definition</code> button and select <code class=\"language-plaintext highlighter-rouge\">Name Tag</code>: column <code class=\"language-plaintext highlighter-rouge\">D</code></li>\n          </ul>\n        </li>\n        <li>Click <code class=\"language-plaintext highlighter-rouge\">Apply</code> and press <kbd>Upload</kbd></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Once we have imported all the datasets, we will move each one to its correspondent history.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Upload data</hands-on-title>\n\n  <ol>\n    <li>Create three new empty histories, one for each specie.</li>\n    <li>Rename the histories as  <code class=\"language-plaintext highlighter-rouge\">Case 1: *Chondrosia reniformis*</code>, <code class=\"language-plaintext highlighter-rouge\">Case 2: *Erythrolamprus reginae*</code> and  <code class=\"language-plaintext highlighter-rouge\">Case 3: *Eschrichtius robustus*</code>.</li>\n    <li>Click in <strong>History options</strong> and select <code class=\"language-plaintext highlighter-rouge\">Show Histories Side-by-Side</code></li>\n    <li>Click in <code class=\"language-plaintext highlighter-rouge\">Select histories</code>, and include the histories corresponding to the three species.</li>\n    <li>\n      <p>Move the datasets to its correspondent history.</p>\n\n      <blockquote class=\"comment\">\n        <comment-title>Non-unique datasets</comment-title>\n        <p>Both the <strong>Taxonomic_data</strong> and the <strong>Diamond_database</strong> should be included in all of them.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n  <!--SNIPPET-->\n  <blockquote class=\"tip\">   <div class=\"box-title tip-title\" id=\"tip-renaming-a-history\"><button class=\"gtn-boxify-button tip\" type=\"button\" aria-controls=\"tip-renaming-a-history\" aria-expanded=\"true\"><i class=\"far fa-lightbulb\" aria-hidden=\"true\"></i> <span>Tip: Renaming a history</span><span class=\"fold-unfold fa fa-minus-square\"></span></button></div>   <ol>   <li>Click on <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class=\"fas fa-pencil-alt\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>\n  <p><!--END_SNIPPET--></p>\n\n</blockquote>\n\n<p>Once all the datasets have been copied to their correspondent history, we should obtain something similar to this:</p>\n\n<figure id=\"figure-4\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/histories_side_by_side.png\" alt=\"Figure 4: Distribution of data. \" width=\"1445\" height=\"1164\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/histories_side_by_side.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 4</strong>:</span> Histories corresponding to the three cases of study.</figcaption></figure>\n\n<h1 id=\"genome-assembly-overview-with-blobtoolkit\">Genome assembly overview with BlobToolKit</h1>\n\n<p><strong>BlobToolKit</strong> is a tool designed to assist researchers in analyzing and visualizing genome assembly data. The tool uses information from multiple data sources such as read coverage, gene expression, and taxonomic annotations to generate a comprehensive overview of genome assembly data (<span class=\"citation\"><a href=\"#Challis2020\">Challis <i>et al.</i> 2020</a></span>). One of the key characteristics of BlobToolKit is its ability to provide with a user-friendly interactive interface for analyzing complex genome assembly data.</p>\n\n<p>In this tutorial, we will use BlobToolKit in order to integrate the following data:</p>\n\n<ul>\n  <li><strong>Read coverage data</strong>: BlobToolKit can use read coverage information to identify potential errors or gaps in the genome assembly. By comparing the depth of coverage across the genome, it can highlight regions that may be overrepresented or underrepresented, which can indicate potential issues with the assembly.</li>\n  <li><strong>Taxonomic annotations</strong>: BlobToolKit can use taxonomic information to identify potential contaminants or foreign DNA in the genome assembly. It does this by comparing the taxonomic profile of the genome assembly to a reference database of known organisms.</li>\n  <li><strong>Sequence similarity data</strong>: Sequence similarity data can be used to identify potential misassemblies or contaminants in the genome assembly. BlobToolKit can use BLAST/DIAMOND searches to compare the genome assembly to reference databases and identify regions that may be problematic.</li>\n  <li><strong>BUSCO reports</strong>: BlobToolKit can use BUSCO data to provide additional information about the quality of a genome assembly. It can generate plots of the number of complete and partial BUSCO genes in the genome assembly, as well as the number of missing and fragmented genes.</li>\n</ul>\n\n<blockquote class=\"comment\">\n  <comment-title>Why should we evaluate contaminants?</comment-title>\n\n  <p>A significant proportion of the genome sequences in both GenBank and RefSeq (0.54% and 0.34% of entries, respectively) include sequences from contaminants; the contamination primarily exists in the form of short contigs, flanking regions on longer contigs, or areas of larger scaffolds that are flanked by Ns, although a few longer sequences with contamination were also detected (<span class=\"citation\"><a href=\"#Steinegger2020\">Steinegger and Salzberg 2020</a></span>).</p>\n\n</blockquote>\n\n<p>In the next steps, we will generate the data required for generating the visualization plots with BlobToolKit.</p>\n\n<h2 id=\"generate-read-coverage-data-with-hisat2\">Generate read coverage data with <strong>HISAT2</strong></h2>\n\n<p>Read coverage is an essential metric for evaluating the quality of genome assemblies, and it provides valuable information for identifying regions of high and low quality, detecting misassemblies, and identifying potential contaminants. Thus, for example, unexpected regions of low coverage suggests potential errors, such as misassemblies, gaps, or low complexity regions (<span class=\"citation\"><a href=\"#Koren2017\">Koren <i>et al.</i> 2017</a></span>).</p>\n\n<p>In this tutorial we will use <strong>HISAT2</strong> for generation the coverage data. This tool uses a indexing scheme based on the Burrows-Wheeler transform (BWT) and the Ferragina-Manzini (FM) index, which enables efficient and accurate alignment (<span class=\"citation\"><a href=\"#Zhang2021\">Zhang <i>et al.</i> 2021</a></span>). It then provides the alignment output in BAM file format which we will then use as an input for BlobToolKit.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>How is coverage information encoded in the BAM file?</comment-title>\n\n  <p>Coverage information is encoded in the BAM file format through the number of reads that align to each position in the reference genome. Specifically, the BAM file stores each read’s start and end position in the genome, as well as the length and orientation of the read, among other information. To calculate coverage, the number of reads that overlap each position in the reference genome is counted.</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title>Generate BAM file with HISAT2</hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0\" title=\"Collapse Collection tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Collapse Collection</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.1.0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Collection of files to collapse into single dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">CReniformis_Pacbio</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/hisat2/hisat2/2.2.1+galaxy1\" title=\"HISAT2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>HISAT2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.1+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><em>“Source for the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select the reference genome”</em>: <code class=\"language-plaintext highlighter-rouge\">CReformitis_assembly</code></li>\n          </ul>\n        </li>\n        <li><em>“Is this a single or paired library”</em>: <code class=\"language-plaintext highlighter-rouge\">Single-end</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“FASTA/Q file”</em>: output of <strong>Collapse Collection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Repeat the prevous steps with the datasets from the two remanining species.</li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"generate-sequence-similarity-data-with-diamond\">Generate sequence similarity data with DIAMOND</h2>\n\n<p><strong>DIAMOND</strong> is a sequence alignment tool that utilizes a more efficient algorithm compared to BLAST, allowing for much faster searches of large sequence databases. Specifically, DIAMOND uses a sensitive seed-extension approach that compares a set of small segments (seeds) from the query sequence to a database, and then extends the alignments based on the highest-scoring hits. This approach allows DIAMOND to perform up to 20,000 times faster than BLAST, with comparable or improved sensitivity and accuracy (<span class=\"citation\"><a href=\"#Buchfink2014\">Buchfink <i>et al.</i> 2014</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Task description </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/2.0.15+galaxy0\" title=\"Diamond tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Diamond</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0.15+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Alignment mode”</em>: <code class=\"language-plaintext highlighter-rouge\">DNA query sequences (blastx)</code>\n          <ul>\n            <li><em>“Allow for frameshifts?”</em>: <code class=\"language-plaintext highlighter-rouge\">yes</code>\n              <ul>\n                <li><em>“restrict hit culling to overlapping query ranges”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n                <li><em>“frame shift penalty”</em>: <code class=\"language-plaintext highlighter-rouge\">15</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input query file in FASTA or FASTQ format”</em>: <code class=\"language-plaintext highlighter-rouge\">CReformitis_assembly</code></li>\n        <li><em>“Will you select a reference database from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use one from the history</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select the reference database”</em>: <code class=\"language-plaintext highlighter-rouge\">Diamond_db</code></li>\n          </ul>\n        </li>\n        <li><em>“Restrict search taxonomically?”</em>: <code class=\"language-plaintext highlighter-rouge\">No</code></li>\n        <li><em>“Sensitivity Mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Fast (--fast)</code>\n          <ul>\n            <li><em>“Block size in billions of sequence letters to be processed at a time”</em>: <code class=\"language-plaintext highlighter-rouge\">10.0</code></li>\n          </ul>\n        </li>\n        <li><em>“Method to filter?”</em>: <code class=\"language-plaintext highlighter-rouge\">Maximum e-value to report alignments</code></li>\n        <li><em>“Method to restrict the number of hits?”</em>: <code class=\"language-plaintext highlighter-rouge\">Maximum number of target sequences</code></li>\n        <li>In <em>“Output options”</em>:\n          <ul>\n            <li><em>“Format of output file”</em>: <code class=\"language-plaintext highlighter-rouge\">BLAST tabular</code>\n              <ul>\n                <li><em>“Tabular fields”</em>: <code class=\"language-plaintext highlighter-rouge\">Query Seq-id</code>,<code class=\"language-plaintext highlighter-rouge\">Subject Seq -id</code>, <code class=\"language-plaintext highlighter-rouge\">Start of alignment in query</code>, <code class=\"language-plaintext highlighter-rouge\">End of alignment in query</code>, <code class=\"language-plaintext highlighter-rouge\">Expected value</code>, <code class=\"language-plaintext highlighter-rouge\">Bit score</code> and <code class=\"language-plaintext highlighter-rouge\">Unique Subject Taxonomy ID(s), separated by a ',' (in numerical order)</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Repeat the prevous steps with the datasets from the two remanining species.</li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"generate-busco-report\">Generate <strong>BUSCO</strong> report</h2>\n\n<p><strong>BUSCO</strong> (Benchmarking Universal Single-Copy Orthologs) is a tool used for quantitative assessment of genome assembly, gene set, and transcriptome completeness. It is based on evolutionarily informed expectations of gene content derived from near-universal single-copy orthologs (<span class=\"citation\"><a href=\"#Simo2015\">Simão <i>et al.</i> 2015</a></span>)</p>\n\n<blockquote class=\"comment\">\n  <comment-title> Orthologs </comment-title>\n\n  <p>Orthologs are genes in different species which have usually the same function and have evolved from a common ancestral gene. They are important for new genome assemblies in order to predict gene functions and help with gene annotation (<span class=\"citation\"><a href=\"#Gennarelli2010\">Gennarelli and Cattaneo 2010</a></span>).</p>\n\n</blockquote>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Estimate single copy gene representation completeness </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/5.4.4+galaxy0\" title=\"Busco tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Busco</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 5.4.4+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Sequences to analyse”</em>: <code class=\"language-plaintext highlighter-rouge\">outfile</code> (output of <strong>Replace</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Genome assemblies (DNA)</code>\n          <ul>\n            <li><em>“Use Augustus instead of Metaeuk”</em>: <code class=\"language-plaintext highlighter-rouge\">Use Metaeuk</code></li>\n          </ul>\n        </li>\n        <li><em>“Auto-detect or select lineage?”</em>: <code class=\"language-plaintext highlighter-rouge\">Auto-detect</code></li>\n        <li><em>“Which outputs should be generated”</em>: <code class=\"language-plaintext highlighter-rouge\">Short summary text</code></li>\n      </ul>\n\n      <blockquote class=\"details\">\n        <details-title> Additional information </details-title>\n\n        <p>BUSCO sets represent 3023 genes for vertebrates, 2675 for arthropods, 843 for metazoans, 1438 for fungi and 429 for eukaryotes. An intuitive metric is provided \tin BUSCO notation - C:complete[D:dublicated], F:fragmented, M:missing, n:number of genes used.</p>\n      </blockquote>\n    </li>\n    <li>Repeat the prevous steps with the datasets from the two remanining species.</li>\n  </ol>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title></question-title>\n\n  <p>What are the values of complete BUSCO genes for each species?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <ol>\n      <li>Eschrichtius robustus: 96.0%</li>\n      <li>Erythrolamprus reginae: 91.3%</li>\n      <li>Chondrosia reniformis: 82.8%</li>\n    </ol>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"generate-interactive-plots-with-blobtoolkit\">Generate interactive plots with <strong>BlobToolKit</strong></h2>\n\n<p><strong>BlobToolKit</strong> is a tool designed to assist researchers in analyzing and visualizing genome assembly data. The tool uses information from multiple data sources such as read coverage, gene expression, and taxonomic annotations to generate a comprehensive overview of genome assembly data (<span class=\"citation\"><a href=\"#Challis2020\">Challis <i>et al.</i> 2020</a></span>). One of the key characteristics of BlobToolKit is its ability to provide with a user-friendly interactive interface for analyzing complex genome assembly data.</p>\n\n<p>To work with BlobToolKit we need to create a new dataset structure called <strong>BlobDir</strong>. Therefore the minimum requirement is a fasta file which contains the sequence of our assembly. A list of sequence identifiers and some statistics like length, GC proportion and undefined bases will then be generated.</p>\n\n<p>To get a more meaningful analysis and therefore more useful information about our assembly, it is better to provide as much data as we can get. In our case we will also provide a metadata file if possible, NCBI taxonomy ID and the NCBI taxdump directory (<span class=\"citation\"><a href=\"#Challis2020\">Challis <i>et al.</i> 2020</a></span>).</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Creating the BlobDir dataset </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/blobtoolkit/blobtoolkit/3.4.0+galaxy0\" title=\"BlobToolKit tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>BlobToolKit</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.4.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Select mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Create a BlobToolKit dataset</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Genome assembly file”</em>: <code class=\"language-plaintext highlighter-rouge\">CReformitis_assembly</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Metadata file”</em>: <code class=\"language-plaintext highlighter-rouge\">CReformitis_metadata</code></li>\n            <li><em>“NCBI taxonomy ID”</em>: <code class=\"language-plaintext highlighter-rouge\">121349</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“NCBI taxdump directory”</em>: <code class=\"language-plaintext highlighter-rouge\">Taxonomy_Data</code></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/blobtoolkit/blobtoolkit/3.4.0+galaxy0\" title=\"BlobToolKit tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>BlobToolKit</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 3.4.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Select mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Add data to a BlobToolKit dataset</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Blobdir.tgz file”</em>: output of <strong>BlobToolKit</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BUSCO full table file”</em>: <code class=\"language-plaintext highlighter-rouge\">Full table</code> (output of <strong>Busco</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><em>“BLAST/Diamond hits”</em>: <code class=\"language-plaintext highlighter-rouge\">Enabled</code>\n              <ul>\n                <li><em>“BLAST/Diamond hits dataset”</em>: output of <strong>Diamond</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n              </ul>\n            </li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“BAM/SAM/CRAM read alignment file”</em>: output of <strong>HISAT2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"interactive_tool_blobtoolkit\" title=\"Interactive BlobToolKit tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Interactive BlobToolKit</strong></span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Blobdir file”</em>: output of <strong>BlobToolKit</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n      </ul>\n    </li>\n    <li>\n      <p>Click on the <i class=\"far fa-eye\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">galaxy-eye</span> (eye) icon and inspect the output of <strong>Interactive BlobToolKit</strong>.</p>\n    </li>\n    <li>Repeat the prevous steps with the datasets from the two remanining species.</li>\n  </ol>\n\n</blockquote>\n\n<p>Now, we will evaluate three of plots that we can find in the Blobtoolkit interactve interface. First, we will start with the <strong>snailplot</strong>, which provides a holistic view of the assembly.</p>\n\n<figure id=\"figure-5\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.snail.c.png\" alt=\"Figure 5: BlobToolKit snail plot. \" width=\"2000\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.snail.c.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 5</strong>:</span> Chondrosia reniformis snail plot summary. The grey line represents the assembly scaffolds, where the distance to the center of the circle indicates the length of the scaffolds. A scale line in the center of the circle helps to gauge the length. Longest contig: The red line in the plot indicates the longest contig in the assembly. N50 and N90: The dark orange and light orange lines represent the scaffolds contained in the N50 and N90 metrics, respectively. GC/AT content: The outer light and dark blue lines represent the GC and AT content, respectively. In an ideal assembly, the line between the two colors should be consistent, without much fluctuation. Gaps: Gaps in the assembly, if present, are denoted by the percent N in the bottom right of the image.</figcaption></figure>\n\n<p>The main plot is divided into 1,000 size-ordered bins around the circumference with each bin representing 0.1% of the 117,390,217 bp assembly. The <strong>distribution of sequence lengths is shown in dark grey</strong> with the plot radius scaled to the longest sequence present in the assembly (10,413,042 bp, shown in red).</p>\n\n<p><strong>Orange and pale-orange arcs show the N50 and N90 sequence lengths</strong> (8,459,200 and 6,903,244 bp), respectively. The <strong>pale grey spiral shows the cumulative sequence count on a log scale</strong> with white scale lines showing successive orders of magnitude. The <strong>blue and pale-blue area around the outside of the plot shows the distribution of GC, AT and N percentages</strong> in the same bins as the inner plot. A summary of complete, fragmented, duplicated and missing BUSCO genes in the eukaryota_odb10 set is shown in the top right.</p>\n\n<blockquote class=\"question\">\n  <question-title>Snailplot question</question-title>\n\n  <p>Which differences do you appreciate between the snailplots corresponding to <em>Erythrolamprus reginae</em> and <em>Eschrichtius robustus</em>?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-6\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.snail.png\" alt=\"Figure 6: BlobToolKit snailplots comparison. \" width=\"4394\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.snail.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 6</strong>:</span> Comparison between snailplots from E. reginae (A) and E. robustus (B).</figcaption></figure>\n\n    <ul>\n      <li>(A) The snake (<em>Erythrolamprus reginae</em>) does have a relatively large proportion of the genome assembled into some few and long scaffolds (reflected in the high “longest scaffold” value and the high “Log10 scaffold count” value).</li>\n      <li>(B) The whale (<em>Eschrichtius robustus</em>) does have a relatively large proportion of the genome assembled into fragmented scaffolds (reflected in the low N90 value compared to the N50 value and the high “Log10 scaffold count” value)</li>\n    </ul>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Now, we are going to analyze the blob plot corresponding to <em>Erythrolamprus reginae</em>, which is specially useful for gaining insights into the composition of your genomic data and identify potential contaminants or endosymbionts.</p>\n\n<figure id=\"figure-7\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.blob.circle.png\" alt=\"Figure 7: BlobToolKit circle plot. \" width=\"2000\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.blob.circle.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 7</strong>:</span> Blob plot of base coverage in input against GC proportion for sequences in *E. reginate assembly*. Sequences are coloured by phylum. Circles are sized in proportion to sequence length . Histograms show the distribution of sequence length sum along each axis</figcaption></figure>\n\n<p>The blob plot is a two-dimensional scatter plot that helps in visualizing and analyzing genomic data for quality control, contaminant detection, and filtering. In the circle plot, <strong>each sequence is represented by a circle</strong>, with its diameter proportional to the sequence length. Circles are colored based on their taxonomic affiliation, and their positions on the X and Y axes are determined by their GC content and coverage, respectively. GC content is the proportion of G and C bases in the sequence, which can differ substantially between genomes. Coverage, on the other hand, is a measure of the number of times a particular sequence has been read during the sequencing process. The plot also includes coverage and GC histograms for each taxonomic group, weighted by the total span (cumulative length) of sequences occupying each bin.</p>\n\n<blockquote class=\"comment\">\n  <comment-title>Pre-curated assembly evaluation</comment-title>\n\n  <p>Usually, the evaluation of the pre-curated assembly yield quite different results when compared with the post-curation evaluation. A frequent difference is the abudance of contigs that belong to different organisms, as a result of contamination in the reads. It can be clearly appreciated in the next figure, which correspond to the <em>E. reginae</em> pre-curated assembly. A striking element is the presence of 38 contigs corresponding to the phylum Artverviricota (dark green), a group of viruses that encode a reverse transcriptase.</p>\n\n  <figure id=\"figure-8\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.blob.circle_precuration.png\" alt=\"Figure 8: BlobToolKit circle plot. \" width=\"2000\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.blob.circle_precuration.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 8</strong>:</span> Blob plot of base coverage in input against GC proportion for sequences in pre-curated E. reginate assembly. Sequences are coloured by phylum. Circles are sized in proportion to sequence length . Histograms show the distribution of sequence length sum along each axis</figcaption></figure>\n\n  <p>In addition, as we can appreciate, the samples included contamination from fungi, arthropoda and bacteria.</p>\n\n</blockquote>\n\n<blockquote class=\"question\">\n  <question-title>Blob plot question</question-title>\n\n  <p>Does exist significant contamination in the <em>Eschrichtius robustus</em> and <em>Chondrosia reniformis</em> assemblies?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-9\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.blob.circle_comparison.png\" alt=\"Figure 9: BlobToolKit snailplots comparison. \" width=\"4428\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.blob.circle_comparison.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 9</strong>:</span> Comparison between blob plots from E. robustus (A) and C. reniformis (B).</figcaption></figure>\n\n    <ul>\n      <li>(A) The whale (<em>Eschrichtius robustus</em>) does have significant contamination. Approximately half of the assembly of the whale does contain contaminants or cosymbionts (total count: 703, Chordata count: 316).</li>\n      <li>(B) The sponge (<em>Condrosia reniformis</em>) doesn’t contain any contamination (total count: 15, Chordata count: 15).</li>\n    </ul>\n\n  </blockquote>\n\n</blockquote>\n\n<p>Finally, let’s have a look at the accumulative plot, which shows the curves for subsets of scaffolds assigned to each phylum relative to the overall assembly. It is useful for evaluating the <strong>contribution of the contigs from contaminated reads to the final assembly</strong>. In that case, first we will evaluate all sequences together, and then we will remove those correspoding to chordata or not classified (not-hit) in order to be able to evaluate in detail each of the contaminants. So, let’s start with the accumulative plot corresponding to all sequences (fig. 10).</p>\n\n<p>In this kind of plot, <strong>the x-axis represent the number of contigs</strong> (sorted by species and length), and <strong>the y-axis correspond to the cumulative length in nucleotides</strong>. The gray line shows the cumulative length of all sequences. As we can appreciate, most sequences corespond to the taxa chordata (1.9Gb, distributed along 151 contigs). In addition, we can see that the final assembly includes 174 contigs corresponding to different taxa, or not classified at all. In order to be able to analyze the contribution of those sequences, we will filter the contigs corresponding to the chordata.</p>\n\n<figure id=\"figure-10\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.cumulative.png\" alt=\"Figure 10: BlobToolKit cumulativ plot. \" width=\"2000\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.cumulative.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 10</strong>:</span> Cumulative sequence length for assembly Blobdir. The grey line shows cumulative length for all sequences. Coloured lines show cumulative lengths of sequences assigned to each phylum using the bestsum taxrule. Plot axes are scaled to the filtered assembly.</figcaption></figure>\n\n<blockquote class=\"comment\">\n  <comment-title> How do I apply filters to a dataset? </comment-title>\n\n  <p>Datasets can be filtered based on any category or variable using the “Filters” menu. To filter based on a category, click the tab above any bar of the preview histogram to hide/show records assigned to this category. To filter variables, use the sliders at either end of the preview histogram to change the maximum and minimum values or enter the numbers directly into the text boxes above the histogram.</p>\n\n</blockquote>\n\n<p>By hidding the contings corresponding to chordata, we can have a detailed view of the contributions of each contaminant (fig. 11).</p>\n\n<figure id=\"figure-11\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Blobdir.cumulative_filtered.png\" alt=\"Figure 11: BlobToolKit cumulativ plot. \" width=\"2000\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Blobdir.cumulative_filtered.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 11</strong>:</span>  The grey line shows cumulative length for all sequences. Coloured lines show cumulative lengths of sequences assigned to each phylum using the bestsum taxrule and are stacked by cumulative value on the x-axis to show the proportion of each phylum in the overall assembly. The assembly has been filtered to exclude sequences with phylum matches Chordata. Plot axes are scaled to the filtered assembly.</figcaption></figure>\n\n<p>In figure 11 we can appreciate clearly the relative contribution of each contaminant with respect to the total contamination.</p>\n\n<h1 id=\"k-mer-based-genome-profiling-and-evaluation\">K-mer based genome profiling and evaluation</h1>\n\n<p>k-mers can be utilized to infer genome characteristics such as length and heterozygosity by analyzing their frequency distribution in raw sequencing reads (<span class=\"citation\"><a href=\"#Manekar2018\">Manekar and Sathe 2018</a></span>). In this tutorial we will make use of three different tools in order to perform the k-mer based genome profiling and assembly evaluation.</p>\n\n<blockquote class=\"comment\">\n  <comment-title> Genome profiling details </comment-title>\n\n  <p>You can find more details about genome profiling in the <a href=\"/training-material/topics/assembly/tutorials/vgp_genome_assembly/tutorial.html#genome-profile-analysis\">VGP training</a>.</p>\n\n</blockquote>\n\n<h2 id=\"generating-k-mer-profile-with-meryl\">Generating k-mer profile with <strong>Meryl</strong></h2>\n\n<p>DNA is double stranded and normally only one strand is sequenced. For our assembly we want to consider the other strand as well. Therefore canonical k-mers are used in most counting tools, exactly like in <strong>Meryl</strong>. A full k-mer pair is a sequence and the reverse complement of the sequence (e.g. ATG/CAT). The canonical sequence of a k-mer pair is the lexicographically smaller of the two reverse complementary sequences. So if CAT appears it will be counted as ATG. (<span class=\"citation\"><a href=\"#Clavijo\">Clavijo</a></span>)</p>\n\n<p>Meryl is a powerful tool for counting k-mers in large-scale genomic datasets. It uses a sorting-based approach that sorts the k-mers in lexicographical order.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generating k-mer profile </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/meryl/meryl/1.3+galaxy6\" title=\"Meryl tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Meryl</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3+galaxy6)</span> with the following parameters:\n      <ul>\n        <li><em>“Operation type selector”</em>: <code class=\"language-plaintext highlighter-rouge\">Count operations</code>\n          <ul>\n            <li><i class=\"far fa-folder\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-collection</span> <em>“Input sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset collection)</li>\n            <li><em>“K-mer size selector”</em>: <code class=\"language-plaintext highlighter-rouge\">Set a k-mer size</code>\n              <ul>\n                <li><em>“K-mer size”</em>: <code class=\"language-plaintext highlighter-rouge\">21</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title> compute k </comment-title>\n\n        <p>In general k can be computed as k=log4 (G(1-p)/p), with G as genome size and p as tolerable collision rate.\nIn our case we set the k-mer size to 21.</p>\n      </blockquote>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/meryl/meryl/1.3+galaxy6\" title=\"Meryl tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Meryl</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3+galaxy6)</span> again with the following parameters:\n      <ul>\n        <li><em>“Operation type selector”</em>: <code class=\"language-plaintext highlighter-rouge\">Operations on sets of k-mers</code>\n          <ul>\n            <li><em>“Operations on sets of k-mers”</em>: <code class=\"language-plaintext highlighter-rouge\">Union-sum: return k-mers that occur in any input, set the count to the sum of the counts</code></li>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input meryldb”</em>: previous output of <strong>Meryl</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/meryl/meryl/1.3+galaxy6\" title=\"Meryl tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Meryl</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3+galaxy6)</span> a third time with the following parameters:\n      <ul>\n        <li><em>“Operation type selector”</em>: <code class=\"language-plaintext highlighter-rouge\">Generate histogram dataset</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input meryldb”</em>: previous output of <strong>Meryl</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span></li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li>Rename the output as <code class=\"language-plaintext highlighter-rouge\">Histogram dataset</code></li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"k-mer-profile-analysis-with-genomescope\">K-mer profile analysis with <strong>GenomeScope</strong></h2>\n\n<p><strong>Genomescope</strong> is used for analysing genomes with the help of k-mer profile analysis. It estimates the overall genome characteristics and the overall read characteristics. The tool will use a given k-mer profile which is calculated only from raw reads sequencing data. It then generates a plot with the calculated data giving us information about the completeness and quality of the to be assembled data. (<span class=\"citation\"><a href=\"#Vurture2017\">Vurture <i>et al.</i> 2017</a></span>)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generate plots for analysis </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/genomescope/genomescope/2.0+galaxy2\" title=\"GenomeScope tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>GenomeScope</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.0+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input histogram file”</em>: <code class=\"language-plaintext highlighter-rouge\">Histogram dataset</code></li>\n        <li><em>“Ploidy for model to use”</em>: <code class=\"language-plaintext highlighter-rouge\">2</code> for <em>C. reniformis</em> and <em>E. robustus</em>, <code class=\"language-plaintext highlighter-rouge\">3</code> for <em>E. reginae</em>.</li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title> Plots </comment-title>\n\n        <p>The generated plots will have the coverage on the x-axis and the frequency on the y-axis. It shows the fitted model in the observed k-mer data as well as the k-mer peaks and other information like some estimated parameters of the assembly.</p>\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-12\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Chondrosia-reniformis-Linear_plot.png\" alt=\"Figure 12: Genomescope plot. \" width=\"2000\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Chondrosia-reniformis-Linear_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 12</strong>:</span> Genomescope 21-mer profile (k:21) of Chondrosia reniformis, diploid (p:2). The plot includes estimations about the genome length (len:124,167,659bp), unique sequences (uniq:61.5%), homozygous portion (aa: 98.7%), heterozygous portions (ab:1.32%), mean k-mer coverage for heterozygous bases (kcov:35.4), read error rate (err:0.752%) and average rate of read duplications (dup:0.378).</figcaption></figure>\n\n<p>Figure 12 corresponds to the k-mer profile of the sponge (<em>Chondrosia reniformis</em>). Presumably, the large gene number in the sponge genome is due to regional gene duplication; so far evidence for a transposition in sponges has been presented. Data indicate that only 0.25 % of the total sponge genome comprises CA/TG microsatellites, and until now also no SINEs/transposable elements have been identified. The estimated genome size around 124,Mbp is relatively close to <em>Chondrosia reniformis</em> genome size (117,39Mbp).</p>\n\n<blockquote class=\"question\">\n  <question-title>Genome profile question</question-title>\n\n  <p>Which differences can you appreciate between the genome profile of <em>Erythrolamprus reginae</em> and <em>Eschrichtius robustus</em>?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-13\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/genome_profiling_comparison.png\" alt=\"Figure 13: Genomescope plot . \" width=\"4010\" height=\"2000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/genome_profiling_comparison.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 13</strong>:</span> Genomescope genome profile. Erythrolamprus reginae (A). Eschrichtius robustus (B).</figcaption></figure>\n\n    <ul>\n      <li>(A) The genome profile of the snake (<em>Erythrolamprus reginae</em>) suggests a high level of heterozygosity (reflected by the first peak at 11.1x coverage). 51.6% unique sequences have been estimated. In this case the low value is attributed to the parthenogenesis and the polyploidy of this snake which causes tandem duplications and higher DNA replication as a result of the triploid-diploid cycles.</li>\n      <li>(B) The genome profile of the whale (<em>Eschrichtius robustus</em>) suggests a high level of homozygosity (reflected by the second peak at 29x coverage). The homozygous k-mer distribution can be expected from the high grade of inbreeding.</li>\n    </ul>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"k-mer-based-assembly-evaluation-with-merqury\">K-mer based assembly evaluation with <strong>Merqury</strong></h2>\n\n<p>Merqury is designed for evaluating the completeness and accuracy of long-read genome assemblies using short-read sequencing data. Thus the quality of assemblies which are generated by using third-generation sequencing technologies can be reviewed and assessed by the tool.\nMerqury works by comparing k-mers of an assembly to those from unassembled high-accuracy reads of the raw sequencing data. K-mer-based methods are also used to identify errors and missing sequences. (<span class=\"citation\"><a href=\"#Rhie2020\">Rhie <i>et al.</i> 2020</a></span>)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generating stats and plots </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/merqury/merqury/1.3+galaxy2\" title=\"Merqury tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Merqury</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3+galaxy2)</span> with the following parameters:\n      <ul>\n        <li><em>“Evaluation mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Default mode</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“K-mer counts database”</em>: <code class=\"language-plaintext highlighter-rouge\">read_db</code> (output of <strong>Meryl</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n            <li><em>“Number of assemblies”</em>: <code class=\"language-plaintext highlighter-rouge\">One assembly (pseudo-haplotype or mixed-haplotype)</code>\n              <ul>\n                <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Genome assembly”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title> Output </comment-title>\n\n        <p>Merqury will now generate following outputs:</p>\n\n        <ol>\n          <li>stats with completeness statistics</li>\n          <li>QV stats with quality value statistics</li>\n          <li>plots</li>\n        </ol>\n\n      </blockquote>\n    </li>\n  </ol>\n\n</blockquote>\n\n<p>Let’s have a closer look at the copy number plots for each of the three species. Merqury will generate k-mers from the raw sequencing data (in the following called the ‘read set’) and will compare them to the assembly, in contrast to genomescope. Despite being diploid or triploid the species only got plotted with the primary assembly. This is why only one-copy k-mers get evaluated.</p>\n\n<figure id=\"figure-14\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/Eschrichtius-robustus.spectra-cn.fl.png\" alt=\"Figure 14: Merqury plot. \" width=\"1800\" height=\"1500\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/Eschrichtius-robustus.spectra-cn.fl.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 14</strong>:</span> Merqury copy numbers (CN) plot of the whale (*Eschrichtius robustus*). The red area displays the k-mers of the assembly. The black area displays the k-mers only found in the read set. The black area can be indicative for sequencing error in the read set or missing sequences in the assembly.</figcaption></figure>\n\n<p>The small black area indicates that most of the k-mers found in the read set are also found in the assembly (but not all since only the primary assembly got plotted). It reflects a highly homozygous assembly. This plot indicates a sequencing coverage at ~30x as seen before with genomescope.</p>\n\n<blockquote class=\"question\">\n  <question-title>Genome profile question</question-title>\n\n  <p>Which differences can you appreciate between the genome profile of <em>Chondrosia reniformis</em> and <em>Erythrolamprus reginae</em>?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-15\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/merqury_comparison_plot.png\" alt=\"Figure 15: Merqury plot. \" width=\"3549\" height=\"1500\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/merqury_comparison_plot.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 15</strong>:</span> Merqury copy numbers (CN) plot of Chondrosia reniformis (A) and Erythrolamprus reginae (B). The red area displays the k-mers of the assembly. The black area displays the k-mers only found in the read set. The black area can be indicative for sequencing error in the read set or missing sequences in the assembly.</figcaption></figure>\n\n    <ul>\n      <li>(A) The sponge (<em>Chondrosia reniformis</em>) does have two peaks as seen before with genomescope which is typical for a diploid species. The large black area indicates that there is a high amount of k-mers in the read set which is not used in the assembly since only the primary assembly got plotted. The secondary assembly is missing.</li>\n      <li>(B) The snake (<em>Erythrolamprus reginae</em>) does have three peaks as seen before with genomescope which is typical for a triploid species. The black area is even larger compared to the sponge since only the primary assembly got plotted. The secondary and third assembly are missing.</li>\n    </ul>\n\n  </blockquote>\n\n</blockquote>\n\n<h2 id=\"providing-assembly-statistics-with-gfastats\">Providing assembly statistics with <strong>gfastats</strong></h2>\n\n<p>gfastats is a tool for providing summary statistics and genome file manipulation. In our case it will generate genome assembly statistics in a tabular-format output. Metrics like N50/L50, GC-content and lengths of contigs, scaffolds and gaps as well as other statistical information are provided for assessing the contiguity of the assembly.</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generate summary statistics </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/gfastats/gfastats/1.2.0+galaxy0\" title=\"gfastats tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>gfastats</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.2.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n        <li><em>“Specify target sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">Disabled</code></li>\n        <li><em>“Tool mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Summary statistics generation</code>\n          <ul>\n            <li><em>“Report mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Genome assembly statistics (--nstar-report)</code></li>\n          </ul>\n        </li>\n      </ul>\n\n      <blockquote class=\"comment\">\n        <comment-title> N50/NG50 </comment-title>\n\n        <p>Consider taking all contigs and sorting them by size. Starting with the largest and ending with the smallest. Now add up the length of each contig beginning with the largest, then the second largest and so on. When reaching 50% of the total length of all contigs it’s done. The length of the contig you stopped is the N50 value. (<span class=\"citation\"><a href=\"#Videvall201703\">Videvall</a></span>)</p>\n\n        <p>NG50 or more general NG(X) is based on the same idea as N50. The difference is that in this case the whole genome size or estimated genome size is taken into account. Through this comparisons can be made over different assemblies and genome sizes.</p>\n\n      </blockquote>\n\n      <blockquote class=\"comment\">\n        <comment-title> L50 </comment-title>\n\n        <p>Remember adding up the length of each contig until reaching the 50%. The L50 value is the number of the contig you have stopped.</p>\n\n        <p>Example: The sum of all contigs together is 2000 kbp. The contig at 50% has length 300 kbp and is the third one and thus the third largest.\nThen N50 = 300 kbp and L50 = 3.</p>\n\n      </blockquote>\n    </li>\n  </ol>\n\n  <p>In the best case a high quality assembly should consist of just a few and large contigs to represent the genome as a whole. Therefore a good assembly should lead to a high N50 value and in contrast a low quality assembly with tiny, fragmented contigs would lead to a low N50 value. (<span class=\"citation\"><a href=\"#Videvall201704\">Videvall</a></span>)</p>\n\n  <p>The metric doesn’t only rely on measuring the 50% mark. The general case is N(X) where X ranges from 0 - 100 mostly in ten steps. However the NX metric is not suitable for comparing different species with different genome lengths.</p>\n\n  <blockquote class=\"details\">\n    <details-title> GC-content </details-title>\n\n    <p>The GC-content or guanine-cytosine ratio tells one about the occurrence of guanine and cytosine in a genome. It is stated in percent. The two nucleobases are held together by three hydrogen bonds. A high GC-content makes DNA more stable than a low GC-content. Because the ratio of most species and organisms has been found out by now, it is also a good metric to gauge completeness.(<span class=\"citation\"><a href=\"#Wikipedia\">Wikipedia</a></span>)</p>\n  </blockquote>\n\n  <blockquote class=\"details\">\n    <details-title> CC(contig/chromosome) ratio </details-title>\n\n    <p>Another good metric for gauging contiguity is the CC ratio. The value is calculated by dividing contig counts by the chromosome pair number. A perfect score would be 1. Therefore the lower the value the better the contiguity of the assembly.</p>\n  </blockquote>\n</blockquote>\n\n<h1 id=\"hi-c-scaffolding\">Hi-C scaffolding</h1>\n\n<p>To understand how chromosomes are arranged in their three-dimensional structure in the nucleus, high resolution and high throughput imaging techniques have been developed. Hi-C is a high throughput method to measure pairwise contacts between pairs of genomic loci. \nIt is based on cross-linking the DNA in the nucleus and its histones(proteins). However the DNA gets cut and marked and afterwards the cutted parts get ligated together. Then the DNA gets fragmented and sequenced forwards and backwards generating paired reads. The resulting information can be used to assemble the reads to the corresponding chromosome.\n(<span class=\"citation\"><a href=\"#Pal2018\">Pal <i>et al.</i> 2018</a></span>)</p>\n\n<h2 id=\"pre-processing-hi-c-data\">Pre-processing Hi-C data</h2>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Mapping Hi-C reads against a reference genome </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bwa_mem2/bwa_mem2/2.2.1+galaxy0\" title=\"BWA-MEM2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>BWA-MEM2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.1+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Use the following dataset as the reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n          </ul>\n        </li>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select fastq dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Collapse Collection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not set</code></li>\n        <li><em>“Select analysis mode”</em>: <code class=\"language-plaintext highlighter-rouge\">1.Simple Illumina mode</code></li>\n        <li><em>“BAM sorting mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Sort by read names  (i.e., the QNAME field) </code></li>\n      </ul>\n    </li>\n    <li>Run <span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bwa_mem2/bwa_mem2/2.2.1+galaxy0\" title=\"BWA-MEM2 tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>BWA-MEM2</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2.2.1+galaxy0)</span> again with the following parameters:\n      <ul>\n        <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class=\"language-plaintext highlighter-rouge\">Use a genome from history and build index</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Use the following dataset as the reference sequence”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n          </ul>\n        </li>\n        <li><em>“Single or Paired-end reads”</em>: <code class=\"language-plaintext highlighter-rouge\">Single</code>\n          <ul>\n            <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Select fastq dataset”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>Collapse Collection</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n          </ul>\n        </li>\n        <li><em>“Set read groups information?”</em>: <code class=\"language-plaintext highlighter-rouge\">Do not set</code></li>\n        <li><em>“Select analysis mode”</em>: <code class=\"language-plaintext highlighter-rouge\">1.Simple Illumina mode</code></li>\n        <li><em>“BAM sorting mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Sort by read names  (i.e., the QNAME field) </code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bellerophon/bellerophon/1.0+galaxy0\" title=\"Filter and merge tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Filter and merge</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.0+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“First set of reads”</em>: <code class=\"language-plaintext highlighter-rouge\">bam_output</code> (output of <strong>BWA-MEM2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Second set of reads”</em>: <code class=\"language-plaintext highlighter-rouge\">bam_output</code> (output of <strong>BWA-MEM2</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<h2 id=\"generate-hi-c-contact-map\">Generate Hi-C contact map</h2>\n\n<p>PretextMap converts BAM/SAM files into genome contact maps. With those contact maps it is possible to analyse the 3D organisation of chromosomes. The resulting map will be used for visualisation and editing contigs/scaffolds. (<span class=\"citation\"><a href=\"#Kumar2017\">Kumar <i>et al.</i> 2017</a></span>)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generate a contact map with PretextMap and PretextSnapshot </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/pretext_map/pretext_map/0.1.9+galaxy0\" title=\"PretextMap tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>PretextMap</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.1.9+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input dataset in SAM or BAM format”</em>: <code class=\"language-plaintext highlighter-rouge\">outfile</code> (output of <strong>Filter and merge</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Sort by”</em>: <code class=\"language-plaintext highlighter-rouge\">Don't sort</code></li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/pretext_snapshot/pretext_snapshot/0.0.3+galaxy1\" title=\"Pretext Snapshot tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Pretext Snapshot</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 0.0.3+galaxy1)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input Pretext map file”</em>: <code class=\"language-plaintext highlighter-rouge\">pretext_map_out</code> (output of <strong>PretextMap</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n        <li><em>“Output image format”</em>: <code class=\"language-plaintext highlighter-rouge\">PNG</code></li>\n        <li><em>“Show grid?”</em>: <code class=\"language-plaintext highlighter-rouge\">Yes</code></li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-16\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/pretext_snake.png\" alt=\"Figure 16: Contact Map Snake. \" width=\"1000\" height=\"1000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/pretext_snake.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 16</strong>:</span> Hi-C contact map of Erythrolamprus reginae generated by Pretext.</figcaption></figure>\n\n<p>The contact map of the snake (<em>Erythrolamprus reginae</em>) does have a clear diagonal pattern. These interactions are commonly called “cis” interactions and occur between genomic loci that are spatially close to each other. Interactions beyond the diagonal pattern are called “trans” and indicate long-range interactions.</p>\n\n<blockquote class=\"question\">\n  <question-title>Hi-C contact map question</question-title>\n\n  <p>What can you say about the Hi-C map corresponding to <em>Chondrosia reniformis</em>?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-17\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/pretext_sponge.png\" alt=\"Figure 17: Contact Map Sponge. \" width=\"1000\" height=\"1000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/pretext_sponge.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 17</strong>:</span> Hi-C contact map of Chondrosia reniformis generated by Pretext.</figcaption></figure>\n\n    <p>The contact map of the sponge (<em>Chondrosia reniformis</em>) does contain widespread interactions all over the genome. Additionally a diagonal pattern can be observed. The widespread interactions all over the genome can be the result of experimental and technical issues or it can have a biological and funcitonal significance.</p>\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"assembly-graph\">Assembly graph</h1>\n\n<p>Bandage is a tool to visualise de novo assembly graphs with connections. (<span class=\"citation\"><a href=\"#Wick2015\">Wick <i>et al.</i> 2015</a></span>)</p>\n\n<blockquote class=\"hands_on\">\n  <hands-on-title> Generate assembly graph </hands-on-title>\n\n  <ol>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/bgruening/gfastats/gfastats/1.3.6+galaxy0\" title=\"gfastats tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>gfastats</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 1.3.6+galaxy0)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Input file”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (Input dataset)</li>\n        <li><em>“Specify target sequences”</em>: <code class=\"language-plaintext highlighter-rouge\">Disabled</code></li>\n        <li><em>“Tool mode”</em>: <code class=\"language-plaintext highlighter-rouge\">Genome assembly manipulation</code>\n          <ul>\n            <li><em>“Output format”</em>: <code class=\"language-plaintext highlighter-rouge\">GFA</code>\n              <ul>\n                <li><em>“Terminal overlaps selection”</em>: <code class=\"language-plaintext highlighter-rouge\">No (default)</code></li>\n              </ul>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n    <li><span class=\"tool\" data-tool=\"toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/2022.09+galaxy4\" title=\"Bandage Image tool\" aria-role=\"button\"><i class=\"fas fa-wrench\" aria-hidden=\"true\"></i> <strong>Bandage Image</strong> (<i class=\"fas fa-cubes\" aria-hidden=\"true\"></i> Galaxy version 2022.09+galaxy4)</span> with the following parameters:\n      <ul>\n        <li><i class=\"far fa-file\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">param-file</span> <em>“Graphical Fragment Assembly”</em>: <code class=\"language-plaintext highlighter-rouge\">output</code> (output of <strong>gfastats</strong> <i class=\"fas fa-wrench\" aria-hidden=\"true\"></i><span class=\"visually-hidden\">tool</span>)</li>\n      </ul>\n    </li>\n  </ol>\n\n</blockquote>\n\n<figure id=\"figure-18\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/bandage_sponge.jpg\" alt=\"Figure 18: Assembly Graph Sponge. \" width=\"1392\" height=\"1000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/bandage_sponge.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 18</strong>:</span> Assembly graph of the sponge (*Chrondrosia reniformis*). Contigs (nodes) are displayed in different colors and their connections (edges) are displayed as red dotted lines.</figcaption></figure>\n\n<p>The Assembly graph of <em>Chondrosia reniformis</em> is relatively simple and doesn’t have a complex structure. The connectivity of the nodes is clear but uncomplete and lacking some indicative regions of overlapping contigs. Repetitive regions can be investigated by searching for multiple paths or connections in the graph.</p>\n\n<blockquote class=\"question\">\n  <question-title>Assembly graph question</question-title>\n\n  <p>Which differences can you appreciate between the assembly graph corresponding to <em>Erythrolamprus reginae</em> and <em>Eschrichtius robustus</em>?</p>\n\n  <blockquote class=\"solution\">\n    <solution-title></solution-title>\n\n    <figure id=\"figure-19\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/bandage.jpg\" alt=\"Figure 19: Assembly Graph Snake and Whale. \" width=\"2618\" height=\"1000\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/bandage.jpg\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 19</strong>:</span> Assembly graph of Erythrolamprus reginae (A) and Eschrichtius robustus (B). Contigs (nodes) are displayed in different colors and their connections (edges) are displayed as red dotted lines.</figcaption></figure>\n\n    <ul>\n      <li>(A) The assembly graph of the snake (<em>Erythrolamprus reginae</em>) does have a confusing and complex structure. This can be an indicator for errors or misassemblies. The nodes are well-connected but relatively unclear in their path which is reflected by many small contigs and only a few large contigs. This assembly graph does contain a lot of repetitive sequences that result in multiple paths and connections between the nodes.</li>\n      <li>(B) The assembly graph of the whale (<em>Eschrichtius robustus</em>) is overall relatively simple and doesn’t have a too complex structure. The nodes are well-connected and most of the paths are clear which is reflected by many large contigs and only some small contigs. This assembly does also contain repetitive regions but clearly less than in the assembly of the snake.</li>\n    </ul>\n\n  </blockquote>\n\n</blockquote>\n\n<h1 id=\"conclusion\">Conclusion</h1>\n\n<p>In conclusion, it’s worth to run the the post-assembly workflow to assess the quality of genome assemblies. The following table contains metrics to sum up the quality control.</p>\n\n<figure id=\"figure-20\" style=\"max-width: 90%;\"><img src=\"../../images/post-assembly-QC/table_of_metrics.png\" alt=\"Figure 20:  Final stats. \" width=\"892\" height=\"463\" loading=\"lazy\" /><a target=\"_blank\" href=\"../../images/post-assembly-QC/table_of_metrics.png\" rel=\"noopener noreferrer\"><small>Open image in new tab</small></a><br /><br /><figcaption><span class=\"figcaption-prefix\"><strong>Figure 20</strong>:</span> This table contains 9 indicators for quality evaluation of three different organisms: Chondrosia reniformis, Eschrichtius robustus and Erythrolamprus reginae.</figcaption></figure>\n"],"ref_slides":[],"hands_on":true,"slides":false,"mod_date":"2023-11-03 14:30:27 +0000","pub_date":"2023-06-23 16:06:20 +0000","version":12,"workflows":[{"workflow":"main_workflow.ga","tests":true,"url":"https://training.galaxyproject.org/training-material/topics/assembly/tutorials/ERGA-post-assembly-QC/workflows/main_workflow.ga","path":"topics/assembly/tutorials/ERGA-post-assembly-QC/workflows/main_workflow.ga","wfid":"assembly-ERGA-post-assembly-QC","wfname":"main_workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/assembly-ERGA-post-assembly-QC/versions/main_workflow","license":"AGPL-3.0-or-later","creators":[{"class":"Person","identifier":"0000-0002-5752-2155","name":"Cristóbal Gallardo Alba"}],"name":"Post-assembly workflow","title":"Post-assembly workflow","test_results":null,"modified":"2024-06-23 00:06:06 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nMetadata file\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Parameter\\nNCBI taxonomic ID\"];\n  style 1 fill:#ded,stroke:#393,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nNCBI taxdump directory\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Collection\\nFASTQ files\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"ℹ️ Input Parameter\\nPloidy for model to use\"];\n  style 4 fill:#ded,stroke:#393,stroke-width:4px;\n  5[\"ℹ️ Input Dataset\\nPrimary genome assembly file fasta\"];\n  style 5 stroke:#2c3143,stroke-width:4px;\n  6[\"ℹ️ Input Dataset\\nDIAMOND database\"];\n  style 6 stroke:#2c3143,stroke-width:4px;\n  7[\"ℹ️ Input Collection\\nHi-C reverse\"];\n  style 7 stroke:#2c3143,stroke-width:4px;\n  8[\"ℹ️ Input Collection\\nHi-C forward\"];\n  style 8 stroke:#2c3143,stroke-width:4px;\n  9[\"Meryl\"];\n  3 -->|output| 9;\n  10[\"Collapse Collection\"];\n  3 -->|output| 10;\n  11[\"Create BlobtoolKit\"];\n  5 -->|output| 11;\n  0 -->|output| 11;\n  2 -->|output| 11;\n  1 -->|output| 11;\n  12[\"gfastats\"];\n  5 -->|output| 12;\n  13[\"Convert compressed file to uncompressed.\"];\n  5 -->|output| 13;\n  14[\"gfastats\"];\n  5 -->|output| 14;\n  15[\"Diamond\"];\n  5 -->|output| 15;\n  6 -->|output| 15;\n  16[\"Collapse Collection\"];\n  7 -->|output| 16;\n  17[\"Collapse Collection\"];\n  8 -->|output| 17;\n  18[\"Meryl\"];\n  9 -->|read_db| 18;\n  19[\"HISAT2\"];\n  10 -->|output| 19;\n  5 -->|output| 19;\n  20[\"Smudgeplot\"];\n  10 -->|output| 20;\n  21[\"Replace\"];\n  13 -->|output1| 21;\n  22[\"Bandage Image\"];\n  14 -->|output| 22;\n  23[\"BWA-MEM2\"];\n  16 -->|output| 23;\n  5 -->|output| 23;\n  24[\"BWA-MEM2\"];\n  17 -->|output| 24;\n  5 -->|output| 24;\n  25[\"Merqury\"];\n  5 -->|output| 25;\n  18 -->|read_db| 25;\n  c2fe83a3-754a-4544-bb87-df16f3537ab4[\"Output\\nMerqury on input dataset(s): stats\"];\n  25 --> c2fe83a3-754a-4544-bb87-df16f3537ab4;\n  style c2fe83a3-754a-4544-bb87-df16f3537ab4 stroke:#2c3143,stroke-width:4px;\n  8f08d8f6-7615-420c-8a15-201a61b5d3bb[\"Output\\nMerqury on input dataset(s): plots\"];\n  25 --> 8f08d8f6-7615-420c-8a15-201a61b5d3bb;\n  style 8f08d8f6-7615-420c-8a15-201a61b5d3bb stroke:#2c3143,stroke-width:4px;\n  7a8d951a-6a31-4b02-aeba-0eb3061f85ce[\"Output\\nMerqury on input dataset(s): QV stats\"];\n  25 --> 7a8d951a-6a31-4b02-aeba-0eb3061f85ce;\n  style 7a8d951a-6a31-4b02-aeba-0eb3061f85ce stroke:#2c3143,stroke-width:4px;\n  26[\"Meryl\"];\n  18 -->|read_db| 26;\n  27[\"Samtools stats\"];\n  19 -->|output_alignments| 27;\n  28[\"Busco\"];\n  21 -->|outfile| 28;\n  1d4e4542-8bf1-4e32-890b-2e18df95a0de[\"Output\\nBusco on input dataset(s): full table\"];\n  28 --> 1d4e4542-8bf1-4e32-890b-2e18df95a0de;\n  style 1d4e4542-8bf1-4e32-890b-2e18df95a0de stroke:#2c3143,stroke-width:4px;\n  680b8177-3653-4630-ab99-c1d2304dc485[\"Output\\nBusco on input dataset(s): short summary\"];\n  28 --> 680b8177-3653-4630-ab99-c1d2304dc485;\n  style 680b8177-3653-4630-ab99-c1d2304dc485 stroke:#2c3143,stroke-width:4px;\n  29[\"Filter and merge\"];\n  24 -->|bam_output| 29;\n  23 -->|bam_output| 29;\n  30[\"Merqury plot 2\"];\n  25 -->|png_files| 30;\n  31[\"Merqury plot 1\"];\n  25 -->|png_files| 31;\n  32[\"Merqury plot 3\"];\n  25 -->|png_files| 32;\n  33[\"Merqury plot 5\"];\n  25 -->|png_files| 33;\n  34[\"Merqury plot 4\"];\n  25 -->|png_files| 34;\n  35[\"GenomeScope\"];\n  26 -->|read_db_hist| 35;\n  4 -->|output| 35;\n  36[\"BlobToolKit\"];\n  15 -->|blast_tabular| 36;\n  11 -->|blobdir| 36;\n  28 -->|busco_table| 36;\n  19 -->|output_alignments| 36;\n  37[\"PretextMap\"];\n  29 -->|outfile| 37;\n  38[\"Interactive BlobToolKit\"];\n  36 -->|blobdir| 38;\n  39[\"Pretext Snapshot\"];\n  37 -->|pretext_map_out| 39;"}],"api":"https://training.galaxyproject.org/training-material/api/topics/assembly/tutorials/ERGA-post-assembly-QC/tutorial.json","tools":["CONVERTER_gz_to_uncompressed","__EXTRACT_DATASET__","interactive_tool_blobtoolkit","toolshed.g2.bx.psu.edu/repos/bgruening/blobtoolkit/blobtoolkit/3.4.0+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/blobtoolkit/blobtoolkit/4.0.7+galaxy1","toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/gfastats/gfastats/1.2.0+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/gfastats/gfastats/1.3.6+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_find_and_replace/1.1.4","toolshed.g2.bx.psu.edu/repos/devteam/samtools_stats/samtools_stats/2.0.4","toolshed.g2.bx.psu.edu/repos/galaxy-australia/smudgeplot/smudgeplot/0.2.5+galaxy+2","toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/2022.09+galaxy4","toolshed.g2.bx.psu.edu/repos/iuc/bellerophon/bellerophon/1.0+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/busco/busco/5.4.4+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/bwa_mem2/bwa_mem2/2.2.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/genomescope/genomescope/2.0+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/hisat2/hisat2/2.2.1+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/merqury/merqury/1.3+galaxy2","toolshed.g2.bx.psu.edu/repos/iuc/meryl/meryl/1.3+galaxy6","toolshed.g2.bx.psu.edu/repos/iuc/pretext_map/pretext_map/0.1.9+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/pretext_snapshot/pretext_snapshot/0.0.3+galaxy1","toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[]},"topic_name_human":"Assembly","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"blobtoolkit","owner":"bgruening","revisions":"7d9ee8cd14b8","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"blobtoolkit","owner":"bgruening","revisions":"53dd00a4ab68","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"diamond","owner":"bgruening","revisions":"e8ac2b53f262","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gfastats","owner":"bgruening","revisions":"5799092ffdff","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"gfastats","owner":"bgruening","revisions":"3ef480892a9f","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"samtools_stats","owner":"devteam","revisions":"3a0efe14891f","tool_panel_section_label":"SAM/BAM","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"smudgeplot","owner":"galaxy-australia","revisions":"5e0825476fb7","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bandage","owner":"iuc","revisions":"ddddce450736","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bellerophon","owner":"iuc","revisions":"25ca5d73aedf","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"busco","owner":"iuc","revisions":"bb935709506a","tool_panel_section_label":"Annotation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"bwa_mem2","owner":"iuc","revisions":"b4a22d90cce9","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"genomescope","owner":"iuc","revisions":"01210c4e9144","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"hisat2","owner":"iuc","revisions":"f4af63aaf57a","tool_panel_section_label":"Mapping","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"merqury","owner":"iuc","revisions":"f8113c25bc6b","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"meryl","owner":"iuc","revisions":"29dabd8db6f2","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pretext_map","owner":"iuc","revisions":"dfb8a4497339","tool_panel_section_label":"Assembly","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"pretext_snapshot","owner":"iuc","revisions":"44c66e8d21e6","tool_panel_section_label":"Graph/Display Data","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collapse_collections","owner":"nml","revisions":"90981f86000f","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: blobtoolkit\n  owner: bgruening\n  revisions: 7d9ee8cd14b8\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: blobtoolkit\n  owner: bgruening\n  revisions: 53dd00a4ab68\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: diamond\n  owner: bgruening\n  revisions: e8ac2b53f262\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gfastats\n  owner: bgruening\n  revisions: 5799092ffdff\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: gfastats\n  owner: bgruening\n  revisions: 3ef480892a9f\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: samtools_stats\n  owner: devteam\n  revisions: 3a0efe14891f\n  tool_panel_section_label: SAM/BAM\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: smudgeplot\n  owner: galaxy-australia\n  revisions: 5e0825476fb7\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bandage\n  owner: iuc\n  revisions: ddddce450736\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bellerophon\n  owner: iuc\n  revisions: 25ca5d73aedf\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: busco\n  owner: iuc\n  revisions: bb935709506a\n  tool_panel_section_label: Annotation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: bwa_mem2\n  owner: iuc\n  revisions: b4a22d90cce9\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: genomescope\n  owner: iuc\n  revisions: 01210c4e9144\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: hisat2\n  owner: iuc\n  revisions: f4af63aaf57a\n  tool_panel_section_label: Mapping\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: merqury\n  owner: iuc\n  revisions: f8113c25bc6b\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: meryl\n  owner: iuc\n  revisions: 29dabd8db6f2\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pretext_map\n  owner: iuc\n  revisions: dfb8a4497339\n  tool_panel_section_label: Assembly\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: pretext_snapshot\n  owner: iuc\n  revisions: 44c66e8d21e6\n  tool_panel_section_label: Graph/Display Data\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collapse_collections\n  owner: nml\n  revisions: 90981f86000f\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}