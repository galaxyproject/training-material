{"layout":"tutorial_hands_on","title":"Removing the effects of the cell cycle","zenodo_link":"https://zenodo.org/record/7311628/","subtopic":"tricks","priority":2,"questions":["How can I reduce the effects of the cell cycle on my scRNA-seq data?"],"objectives":["Identify the cell cycle genes","Use the cell cycle genes to regress out the effects of the cell cycle","Create PCA plots to understand the impact of the regression"],"requirements":[{"type":"internal","topic_name":"single-cell","tutorials":["scrna-case_alevin","scrna-case_alevin-combine-datasets","scrna-case_basic-pipeline"]}],"time_estimation":"1H","key_points":["Cell cycle genes can conceal what is happening in your data if cells are grouping together according to their stage in the cycle","Identifying the cell cycle genes and using them to regress out the effects of the cell cycle can reveal underlying patterns in the data"],"tags":["10x"],"contributions":{"authorship":["MarisaJL"],"editing":["nomadscientist"],"testing":["hrukkudyr"]},"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00248","url":"/topics/single-cell/tutorials/scrna-case_cell-cycle/tutorial.html","topic_name":"single-cell","tutorial_name":"scrna-case_cell-cycle","dir":"topics/single-cell/tutorials/scrna-case_cell-cycle","symlink":null,"id":"single-cell/scrna-case_cell-cycle","hands_on":true,"slides":false,"mod_date":"2024-06-12 18:23:54 +0000","pub_date":"2023-01-25 09:43:32 +0000","version":35,"workflows":[{"workflow":"main_workflow.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_cell-cycle/workflows/main_workflow.ga","url_html":"https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_cell-cycle/workflows/main_workflow.html","path":"topics/single-cell/tutorials/scrna-case_cell-cycle/workflows/main_workflow.ga","wfid":"single-cell-scrna-case_cell-cycle","wfname":"main-workflow","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_cell-cycle/versions/main-workflow","license":null,"parent_id":"single-cell/scrna-case_cell-cycle","topic_id":"single-cell","tutorial_id":"scrna-case_cell-cycle","creators":[],"name":"Cell Cycle Regression Workflow","title":"Cell Cycle Regression Workflow","version":1,"description":"","tags":["single-cell","10x","transcriptomics"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1246","history":[{"hash":"f70e87e49ec1315f959cb4532d667ab976ae61f4","unix":"1669054986","message":"Moving to single cell","short_hash":"f70e87e49","num":1}],"test_results":null,"modified":"2024-07-05 12:44:54 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nAnnData After QC, normalisation, scaling\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Dataset\\nS Phase Genes\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Dataset\\nG2M Phase Genes\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"ℹ️ Input Dataset\\nPasted Entry\"];\n  style 3 stroke:#2c3143,stroke-width:4px;\n  4[\"Inspect AnnData\"];\n  0 -->|output| 4;\n  5[\"All Cell Cycle Genes Concatenate S and G2M Genes\"];\n  1 -->|output| 5;\n  2 -->|output| 5;\n  6[\"Inspect and manipulate\"];\n  0 -->|output| 6;\n  2 -->|output| 6;\n  1 -->|output| 6;\n  7[\"Table Compute\"];\n  4 -->|var| 7;\n  8[\"Add column\"];\n  5 -->|out_file1| 8;\n  9[\"Scanpy RegressOut\"];\n  6 -->|anndata_out| 9;\n  026b02d3-97ee-4847-9347-40773ab76356[\"Output\\nScanpy RegressOut on input dataset(s): Regressed out  AnnData\"];\n  9 --> 026b02d3-97ee-4847-9347-40773ab76356;\n  style 026b02d3-97ee-4847-9347-40773ab76356 stroke:#2c3143,stroke-width:4px;\n  10[\"Add column\"];\n  7 -->|table| 10;\n  11[\"Join\"];\n  10 -->|out_file1| 11;\n  8 -->|out_file1| 11;\n  12[\"Sort\"];\n  11 -->|output| 12;\n  13[\"Table Compute\"];\n  12 -->|out_file1| 13;\n  14[\"Concatenate datasets\"];\n  3 -->|output| 14;\n  13 -->|table| 14;\n  15[\"Manipulate AnnData\"];\n  6 -->|anndata_out| 15;\n  14 -->|out_file1| 15;\n  16[\"Manipulate AnnData\"];\n  9 -->|output_h5ad| 16;\n  14 -->|out_file1| 16;\n  17[\"Manipulate AnnData\"];\n  15 -->|anndata| 17;\n  18[\"Manipulate AnnData\"];\n  16 -->|anndata| 18;\n  19[\"Cluster, infer trajectories and embed\"];\n  17 -->|anndata| 19;\n  20[\"Cluster, infer trajectories and embed\"];\n  18 -->|anndata| 20;\n  09d97ef7-ed92-4d90-a597-2032581c2d4a[\"Output\\nCluster, infer trajectories and embed (tl.louvain) on input dataset(s): Annotated data matrix\"];\n  20 --> 09d97ef7-ed92-4d90-a597-2032581c2d4a;\n  style 09d97ef7-ed92-4d90-a597-2032581c2d4a stroke:#2c3143,stroke-width:4px;\n  21[\"Plot\"];\n  19 -->|anndata_out| 21;\n  22[\"Plot\"];\n  20 -->|anndata_out| 22;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nAnnData After QC, normalisation, scaling\"]\n  1[color=lightblue,label=\"ℹ️ Input Dataset\\nS Phase Genes\"]\n  2[color=lightblue,label=\"ℹ️ Input Dataset\\nG2M Phase Genes\"]\n  3[color=lightblue,label=\"ℹ️ Input Dataset\\nPasted Entry\"]\n  4[label=\"Inspect AnnData\"]\n  0 -> 4 [label=\"output\"]\n  5[label=\"All Cell Cycle Genes Concatenate S and G2M Genes\"]\n  1 -> 5 [label=\"output\"]\n  2 -> 5 [label=\"output\"]\n  6[label=\"Inspect and manipulate\"]\n  0 -> 6 [label=\"output\"]\n  2 -> 6 [label=\"output\"]\n  1 -> 6 [label=\"output\"]\n  7[label=\"Table Compute\"]\n  4 -> 7 [label=\"var\"]\n  8[label=\"Add column\"]\n  5 -> 8 [label=\"out_file1\"]\n  9[label=\"Scanpy RegressOut\"]\n  6 -> 9 [label=\"anndata_out\"]\n  k026b02d397ee4847934740773ab76356[color=lightseagreen,label=\"Output\\nScanpy RegressOut on input dataset(s): Regressed out  AnnData\"]\n  9 -> k026b02d397ee4847934740773ab76356\n  10[label=\"Add column\"]\n  7 -> 10 [label=\"table\"]\n  11[label=\"Join\"]\n  10 -> 11 [label=\"out_file1\"]\n  8 -> 11 [label=\"out_file1\"]\n  12[label=\"Sort\"]\n  11 -> 12 [label=\"output\"]\n  13[label=\"Table Compute\"]\n  12 -> 13 [label=\"out_file1\"]\n  14[label=\"Concatenate datasets\"]\n  3 -> 14 [label=\"output\"]\n  13 -> 14 [label=\"table\"]\n  15[label=\"Manipulate AnnData\"]\n  6 -> 15 [label=\"anndata_out\"]\n  14 -> 15 [label=\"out_file1\"]\n  16[label=\"Manipulate AnnData\"]\n  9 -> 16 [label=\"output_h5ad\"]\n  14 -> 16 [label=\"out_file1\"]\n  17[label=\"Manipulate AnnData\"]\n  15 -> 17 [label=\"anndata\"]\n  18[label=\"Manipulate AnnData\"]\n  16 -> 18 [label=\"anndata\"]\n  19[label=\"Cluster, infer trajectories and embed\"]\n  17 -> 19 [label=\"anndata\"]\n  20[label=\"Cluster, infer trajectories and embed\"]\n  18 -> 20 [label=\"anndata\"]\n  k09d97ef7ed924d90a5972032581c2d4a[color=lightseagreen,label=\"Output\\nCluster, infer trajectories and embed (tl.louvain) on input dataset(s): Annotated data matrix\"]\n  20 -> k09d97ef7ed924d90a5972032581c2d4a\n  21[label=\"Plot\"]\n  19 -> 21 [label=\"anndata_out\"]\n  22[label=\"Plot\"]\n  20 -> 22 [label=\"anndata_out\"]\n}","workflow_tools":["toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1","cat1","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/table_compute/table_compute/1.2.4+galaxy0","toolshed.g2.bx.psu.edu/repos/devteam/add_value/addValue/1.0.0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_regress_variable/scanpy_regress_variable/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2","sort1","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_cluster_reduce_dimension/scanpy_cluster_reduce_dimension/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1"]}],"api":"https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-case_cell-cycle/tutorial.json","tools":["cat1","sort1","toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2","toolshed.g2.bx.psu.edu/repos/devteam/add_value/addValue/1.0.0","toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_regress_variable/scanpy_regress_variable/1.8.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_cluster_reduce_dimension/scanpy_cluster_reduce_dimension/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.7.1+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1","toolshed.g2.bx.psu.edu/repos/iuc/table_compute/table_compute/1.2.4+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.org.au","name":"UseGalaxy.org.au","usegalaxy":true}]},"topic_name_human":"Single Cell","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"text_processing","owner":"bgruening","revisions":"d698c222f354","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"add_value","owner":"devteam","revisions":"745871c0b055","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_regress_variable","owner":"ebi-gxa","revisions":"36daab33aecf","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_inspect","owner":"iuc","revisions":"ee98d611afc6","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"anndata_manipulate","owner":"iuc","revisions":"3d748954434b","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_cluster_reduce_dimension","owner":"iuc","revisions":"aaa5da8e73a9","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_inspect","owner":"iuc","revisions":"c5d3684f7c4c","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"scanpy_plot","owner":"iuc","revisions":"aa0c474463c2","tool_panel_section_label":"Single-cell","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"table_compute","owner":"iuc","revisions":"3bf5661c0280","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: add_value\n  owner: devteam\n  revisions: 745871c0b055\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_regress_variable\n  owner: ebi-gxa\n  revisions: 36daab33aecf\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: 3d748954434b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_cluster_reduce_dimension\n  owner: iuc\n  revisions: aaa5da8e73a9\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_inspect\n  owner: iuc\n  revisions: c5d3684f7c4c\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot\n  owner: iuc\n  revisions: aa0c474463c2\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: table_compute\n  owner: iuc\n  revisions: 3bf5661c0280\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial","contributors":[{"name":"Marisa Loach","orcid":"0000-0001-6979-6930","twitter":"Marisa_Loach","email":"marisa.loach@open.ac.uk","joined":"2022-10","id":"MarisaJL","url":"https://training.galaxyproject.org/training-material/api/contributors/MarisaJL.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/MarisaJL/"},{"name":"Wendi Bacon","email":"wendi.bacon@open.ac.uk","twitter":"WendiBacon1","matrix":"nomadscientist:matrix.org","joined":"2020-03","elixir_node":"uk","orcid":"0000-0002-8170-8806","bio":"Lecturer at The Open University","fediverse":"https://mstdn.science/@wendibacon1","fediverse_flavor":"mastodon","affiliations":["elixir-europe"],"id":"nomadscientist","url":"https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"},{"name":"Graeme Tyson","email":"grt67@open.ac.uk","orcid":"0000-0002-1748-2806","joined":"2022-09","id":"hrukkudyr","url":"https://training.galaxyproject.org/training-material/api/contributors/hrukkudyr.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/hrukkudyr/"}]}