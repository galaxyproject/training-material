{
  "layout": "tutorial_hands_on",
  "title": "Removing the effects of the cell cycle",
  "zenodo_link": "https://zenodo.org/record/7311628/",
  "subtopic": "tricks",
  "priority": 2,
  "questions": [
    "How can I reduce the effects of the cell cycle on my scRNA-seq data?"
  ],
  "objectives": [
    "Identify the cell cycle genes",
    "Use the cell cycle genes to regress out the effects of the cell cycle",
    "Create PCA plots to understand the impact of the regression"
  ],
  "requirements": [
    {
      "type": "internal",
      "topic_name": "single-cell",
      "tutorials": [
        "scrna-case_alevin",
        "scrna-case_alevin-combine-datasets",
        "scrna-case_basic-pipeline"
      ]
    }
  ],
  "time_estimation": "1H",
  "key_points": [
    "Cell cycle genes can conceal what is happening in your data if cells are grouping together according to their stage in the cycle",
    "Identifying the cell cycle genes and using them to regress out the effects of the cell cycle can reveal underlying patterns in the data"
  ],
  "tags": [
    "10x"
  ],
  "contributions": {
    "authorship": [
      "MarisaJL"
    ],
    "editing": [
      "nomadscientist"
    ],
    "testing": [
      "hrukkudyr"
    ]
  },
  "mathjax": null,
  "short_id": "T00248",
  "url": "/topics/single-cell/tutorials/scrna-case_cell-cycle/tutorial.html",
  "topic_name": "single-cell",
  "tutorial_name": "scrna-case_cell-cycle",
  "dir": "topics/single-cell/tutorials/scrna-case_cell-cycle",
  "id": "single-cell/scrna-case_cell-cycle",
  "video_library": {
    "tutorial": {
      "description": "Single-cell RNA sequencing can be sensitive to both biological and technical variation,   i\nwhich is why preparing your data carefully is an important part of the analysis. You want\nthe results to reflect the interesting differences in expression between cells that relate\nto their type or state. Other sources of variation can conceal or confound this, making it\nharder for you to see what is going on.\n\nOne common biological confounder is the cell cycle. Cells express\ndifferent genes during different parts of the cell cycle, depending on whether they are in\ntheir growing phase (G1), duplicating their DNA (the S or Synthesis phase), or dividing in\ntwo (G2/M or Mitosis phase). If these cell cycle genes are having a big impact on your\ndata, then you could end up with separate clusters that actually represent cells of the\nsame type that are just at different stages of the cycle.\n\nIn this tutorial, we will identify the genes whose expression is known to vary during the\ncell cycle so that we can use them to regress out (or remove) the effects of the cell cycle\non the clustering.\n",
      "materials": [
        {
          "link": "topics/single-cell/tutorials/scrna-case_cell-cycle/tutorial.html",
          "type": "Tutorial"
        }
      ],
      "tags": [
        "single-cell",
        "transcriptomics"
      ],
      "versions": [

      ],
      "gtn_id": "single-cell/scrna-case_cell-cycle",
      "title": "Removing the effects of the cell cycle"
    },
    "slides": null,
    "demo": null,
    "both": null,
    "session": null
  },
  "hands_on": true,
  "slides": false,
  "workflows": [
    {
      "workflow": "main_workflow.ga",
      "tests": false,
      "url": "https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_cell-cycle/workflows/main_workflow.ga",
      "path": "topics/single-cell/tutorials/scrna-case_cell-cycle/workflows/main_workflow.ga",
      "wfid": "single-cell-scrna-case_cell-cycle",
      "wfname": "main_workflow",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_cell-cycle/versions/main_workflow",
      "license": null,
      "creators": [

      ],
      "name": "Cell Cycle Regression Workflow",
      "title": "Cell Cycle Regression Workflow",
      "test_results": null,
      "modified": "2024-01-22 20:42:06 +0000",
      "mermaid": "flowchart TD\n  0[\"Input dataset\"];\n  1[\"Input dataset\"];\n  2[\"Input dataset\"];\n  3[\"Input dataset\"];\n  4[\"Inspect AnnData\"];\n  0 -->|output| 4;\n  5[\"Concatenate datasets\"];\n  1 -->|output| 5;\n  2 -->|output| 5;\n  6[\"Inspect and manipulate\"];\n  0 -->|output| 6;\n  2 -->|output| 6;\n  1 -->|output| 6;\n  7[\"Table Compute\"];\n  4 -->|var| 7;\n  8[\"Add column\"];\n  5 -->|out_file1| 8;\n  9[\"Scanpy RegressOut\"];\n  6 -->|anndata_out| 9;\n  10[\"Add column\"];\n  7 -->|table| 10;\n  11[\"Join\"];\n  10 -->|out_file1| 11;\n  8 -->|out_file1| 11;\n  12[\"Sort\"];\n  11 -->|output| 12;\n  13[\"Table Compute\"];\n  12 -->|out_file1| 13;\n  14[\"Concatenate datasets\"];\n  3 -->|output| 14;\n  13 -->|table| 14;\n  15[\"Manipulate AnnData\"];\n  6 -->|anndata_out| 15;\n  14 -->|out_file1| 15;\n  16[\"Manipulate AnnData\"];\n  9 -->|output_h5ad| 16;\n  14 -->|out_file1| 16;\n  17[\"Manipulate AnnData\"];\n  15 -->|anndata| 17;\n  18[\"Manipulate AnnData\"];\n  16 -->|anndata| 18;\n  19[\"Cluster, infer trajectories and embed\"];\n  17 -->|anndata| 19;\n  20[\"Cluster, infer trajectories and embed\"];\n  18 -->|anndata| 20;\n  21[\"Plot\"];\n  19 -->|anndata_out| 21;\n  22[\"Plot\"];\n  20 -->|anndata_out| 22;\n"
    }
  ],
  "api": "https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-case_cell-cycle/tutorial.json",
  "tools": [
    "cat1",
    "sort1",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_easyjoin_tool/1.1.2",
    "toolshed.g2.bx.psu.edu/repos/devteam/add_value/addValue/1.0.0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_regress_variable/scanpy_regress_variable/1.8.1+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/scanpy_cluster_reduce_dimension/scanpy_cluster_reduce_dimension/1.7.1+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/scanpy_inspect/scanpy_inspect/1.7.1+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/iuc/scanpy_plot/scanpy_plot/1.7.1+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/table_compute/table_compute/1.2.4+galaxy0"
  ],
  "supported_servers": {
    "exact": [
      {
        "url": "https://usegalaxy.eu",
        "name": "UseGalaxy.eu",
        "usegalaxy": true
      }
    ],
    "inexact": [
      {
        "url": "https://usegalaxy.org.au",
        "name": "UseGalaxy.org.au",
        "usegalaxy": true
      }
    ]
  },
  "topic_name_human": "Single Cell",
  "admin_install": {
    "install_tool_dependencies": true,
    "install_repository_dependencies": true,
    "install_resolver_dependencies": true,
    "tools": [
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "add_value",
        "owner": "devteam",
        "revisions": "745871c0b055",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "scanpy_regress_variable",
        "owner": "ebi-gxa",
        "revisions": "36daab33aecf",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "anndata_inspect",
        "owner": "iuc",
        "revisions": "ee98d611afc6",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "anndata_manipulate",
        "owner": "iuc",
        "revisions": "3d748954434b",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "scanpy_cluster_reduce_dimension",
        "owner": "iuc",
        "revisions": "aaa5da8e73a9",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "scanpy_inspect",
        "owner": "iuc",
        "revisions": "c5d3684f7c4c",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "scanpy_plot",
        "owner": "iuc",
        "revisions": "aa0c474463c2",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "table_compute",
        "owner": "iuc",
        "revisions": "3bf5661c0280",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      }
    ]
  },
  "admin_install_yaml": "---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: add_value\n  owner: devteam\n  revisions: 745871c0b055\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_regress_variable\n  owner: ebi-gxa\n  revisions: 36daab33aecf\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_manipulate\n  owner: iuc\n  revisions: 3d748954434b\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_cluster_reduce_dimension\n  owner: iuc\n  revisions: aaa5da8e73a9\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_inspect\n  owner: iuc\n  revisions: c5d3684f7c4c\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: scanpy_plot\n  owner: iuc\n  revisions: aa0c474463c2\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: table_compute\n  owner: iuc\n  revisions: 3bf5661c0280\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n",
  "tours": false,
  "video": false,
  "translations": {
    "tutorial": [

    ],
    "slides": [

    ],
    "video": false
  },
  "type": "tutorial",
  "contributors": [
    {
      "name": "Marisa Loach",
      "orcid": "0000-0001-6979-6930",
      "twitter": "Marisa_Loach",
      "email": "marisa.loach@open.ac.uk",
      "joined": "2022-10",
      "id": "MarisaJL",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/MarisaJL.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/MarisaJL/"
    },
    {
      "name": "Wendi Bacon",
      "email": "wendi.bacon@open.ac.uk",
      "twitter": "WendiBacon1",
      "matrix": "nomadscientist:matrix.org",
      "joined": "2020-03",
      "elixir_node": "uk",
      "orcid": "0000-0002-8170-8806",
      "bio": "Lecturer at The Open University",
      "fediverse": "https://mstdn.science/@wendibacon1",
      "fediverse_flavor": "mastodon",
      "id": "nomadscientist",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"
    },
    {
      "name": "Graeme Tyson",
      "email": "grt67@open.ac.uk",
      "orcid": "0000-0002-1748-2806",
      "joined": "2022-09",
      "id": "hrukkudyr",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/hrukkudyr.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/hrukkudyr/"
    }
  ]
}