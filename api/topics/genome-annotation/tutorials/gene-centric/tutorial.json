{"layout":"tutorial_hands_on","title":"Comparative gene analysis in unannotated genomes","zenodo_link":"https://zenodo.org/record/7034885","questions":["I have several genomes assemblies that are not annotated (or I do not trust annotations)","I am interested to compare structure of a particular gene across these genome assemblies","How do I do that?"],"objectives":["Provide a quick method for identifying genes of interest in unannotated or newly assembled genomes"],"time_estimation":"30M","key_points":["You can locate gene of interest in unannotated genomes and compare its structure across multiple species"],"contributors":[{"name":"Anton Nekrutenko","email":"anton@nekrut.org","joined":"2017-09","id":"nekrut","url":"https://training.galaxyproject.org/training-material/api/contributors/nekrut.json","page":"https://training.galaxyproject.org/training-material/hall-of-fame/nekrut/"}],"tags":["evolution","annotation","vgp","cookbook","eukaryote","prokaryote","microgalaxy"],"requirements":[{"type":"internal","topic_name":"introduction","tutorials":["galaxy-intro-101"]},{"type":"internal","topic_name":"galaxy-interface","tutorials":["collections"]}],"abbreviations":{"ORF":"Open Reading Frame"},"priority":2,"edam_ontology":["topic_0622","topic_0623","topic_0080","topic_0084"],"js_requirements":{"mathjax":null,"mermaid":false},"short_id":"T00174","url":"/topics/genome-annotation/tutorials/gene-centric/tutorial.html","topic_name":"genome-annotation","tutorial_name":"gene-centric","dir":"topics/genome-annotation/tutorials/gene-centric","symlink":null,"id":"genome-annotation/gene-centric","hands_on":true,"slides":false,"mod_date":"2024-03-18 08:58:14 +0000","pub_date":"2022-09-08 13:09:47 +0000","version":8,"workflows":[{"workflow":"Comparative-gene-analysis.ga","tests":false,"url":"https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/gene-centric/workflows/Comparative-gene-analysis.ga","url_html":"https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/gene-centric/workflows/Comparative-gene-analysis.html","path":"topics/genome-annotation/tutorials/gene-centric/workflows/Comparative-gene-analysis.ga","wfid":"genome-annotation-gene-centric","wfname":"comparative-gene-analysis","trs_endpoint":"https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/genome-annotation-gene-centric/versions/comparative-gene-analysis","license":null,"parent_id":"genome-annotation/gene-centric","topic_id":"genome-annotation","tutorial_id":"gene-centric","creators":[{"class":"Person","identifier":"0000-0002-5987-8032","name":"Anton Nekrutenko"}],"name":"Comparative gene analysis","title":"Comparative gene analysis","version":1,"description":"Workflows for comparison of genes in annotated genomes","tags":["vgp","genome-annotation"],"features":{"report":null,"subworkflows":false,"comments":false,"parameters":false},"workflowhub_id":"1173","history":[{"hash":"476d3d57ff2b0ce249879b60aa03500ab62685d6","unix":"1662055154","message":"workflow update","short_hash":"476d3d57f","num":1}],"test_results":null,"modified":"2024-09-10 16:41:20 +0000","mermaid":"flowchart TD\n  0[\"ℹ️ Input Dataset\\nExons\"];\n  style 0 stroke:#2c3143,stroke-width:4px;\n  1[\"ℹ️ Input Collection\\nDiamond makedb\"];\n  style 1 stroke:#2c3143,stroke-width:4px;\n  2[\"ℹ️ Input Collection\\nORFipy BED\"];\n  style 2 stroke:#2c3143,stroke-width:4px;\n  3[\"Diamond: Find hits in ORFs\"];\n  0 -->|output| 3;\n  1 -->|output| 3;\n  4[\"Column Regex Find And Replace\"];\n  2 -->|output| 4;\n  5[\"Alignments\"];\n  3 -->|daa_output| 5;\n  6[\"Cut\"];\n  4 -->|out_file1| 6;\n  7[\"Alignments + BED\"];\n  6 -->|out_file1| 7;\n  5 -->|blast_tabular| 7;\n  8[\"Cut\"];\n  7 -->|out_file1| 8;\n  9[\"Collapse Collection\"];\n  7 -->|out_file1| 9;\n  10[\"Intersect\"];\n  6 -->|out_file1| 10;\n  8 -->|out_file1| 10;\n  11[\"Filter\"];\n  9 -->|output| 11;\n  12[\"Overlapping ORFs\"];\n  10 -->|output| 12;\n  13[\"Cut\"];\n  11 -->|out_file1| 13;\n  14[\"Compute\"];\n  12 -->|output| 14;\n  15[\"Compute\"];\n  13 -->|out_file1| 15;\n  16[\"Split file\"];\n  15 -->|out_file1| 16;\n  17[\"Report\"];\n  15 -->|out_file1| 17;\n  18[\"Tabular-to-FASTA\"];\n  16 -->|split_output| 18;\n  19[\"Cut\"];\n  17 -->|out_file1| 19;\n  20[\"MAFFT\"];\n  18 -->|output| 20;\n  21[\"Filter: Plus strand matches\"];\n  19 -->|out_file1| 21;\n  22[\"Filter: Minus strand matches\"];\n  19 -->|out_file1| 22;\n  23[\"Join neighbors\"];\n  20 -->|outputAlignment| 23;\n  54ea37cc-63d1-422a-9f5e-124b8d39e6bd[\"Output\\nJoin neighbors on input dataset(s): Calculated distances\"];\n  23 --> 54ea37cc-63d1-422a-9f5e-124b8d39e6bd;\n  style 54ea37cc-63d1-422a-9f5e-124b8d39e6bd stroke:#2c3143,stroke-width:4px;\n  24[\"Compute\"];\n  21 -->|out_file1| 24;\n  25[\"Compute\"];\n  22 -->|out_file1| 25;\n  26[\"Concatenate datasets\"];\n  24 -->|out_file1| 26;\n  25 -->|out_file1| 26;\n  27[\"Compute\"];\n  26 -->|out_file1| 27;\n  28[\"Cut\"];\n  27 -->|out_file1| 28;\n  29[\"Compute\"];\n  28 -->|out_file1| 29;\n  30[\"Join two Datasets\"];\n  14 -->|out_file1| 30;\n  29 -->|out_file1| 30;\n  31[\"Mapping report\"];\n  30 -->|out_file1| 31;","graph_dot":"digraph main {\n  node [fontname=\"Atkinson Hyperlegible\", shape=box, color=white,style=filled,color=peachpuff,margin=\"0.2,0.2\"];\n  edge [fontname=\"Atkinson Hyperlegible\"];\n  0[color=lightblue,label=\"ℹ️ Input Dataset\\nExons\"]\n  1[color=lightblue,label=\"ℹ️ Input Collection\\nDiamond makedb\"]\n  2[color=lightblue,label=\"ℹ️ Input Collection\\nORFipy BED\"]\n  3[label=\"Diamond: Find hits in ORFs\"]\n  0 -> 3 [label=\"output\"]\n  1 -> 3 [label=\"output\"]\n  4[label=\"Column Regex Find And Replace\"]\n  2 -> 4 [label=\"output\"]\n  5[label=\"Alignments\"]\n  3 -> 5 [label=\"daa_output\"]\n  6[label=\"Cut\"]\n  4 -> 6 [label=\"out_file1\"]\n  7[label=\"Alignments + BED\"]\n  6 -> 7 [label=\"out_file1\"]\n  5 -> 7 [label=\"blast_tabular\"]\n  8[label=\"Cut\"]\n  7 -> 8 [label=\"out_file1\"]\n  9[label=\"Collapse Collection\"]\n  7 -> 9 [label=\"out_file1\"]\n  10[label=\"Intersect\"]\n  6 -> 10 [label=\"out_file1\"]\n  8 -> 10 [label=\"out_file1\"]\n  11[label=\"Filter\"]\n  9 -> 11 [label=\"output\"]\n  12[label=\"Overlapping ORFs\"]\n  10 -> 12 [label=\"output\"]\n  13[label=\"Cut\"]\n  11 -> 13 [label=\"out_file1\"]\n  14[label=\"Compute\"]\n  12 -> 14 [label=\"output\"]\n  15[label=\"Compute\"]\n  13 -> 15 [label=\"out_file1\"]\n  16[label=\"Split file\"]\n  15 -> 16 [label=\"out_file1\"]\n  17[label=\"Report\"]\n  15 -> 17 [label=\"out_file1\"]\n  18[label=\"Tabular-to-FASTA\"]\n  16 -> 18 [label=\"split_output\"]\n  19[label=\"Cut\"]\n  17 -> 19 [label=\"out_file1\"]\n  20[label=\"MAFFT\"]\n  18 -> 20 [label=\"output\"]\n  21[label=\"Filter: Plus strand matches\"]\n  19 -> 21 [label=\"out_file1\"]\n  22[label=\"Filter: Minus strand matches\"]\n  19 -> 22 [label=\"out_file1\"]\n  23[label=\"Join neighbors\"]\n  20 -> 23 [label=\"outputAlignment\"]\n  k54ea37cc63d1422a9f5e124b8d39e6bd[color=lightseagreen,label=\"Output\\nJoin neighbors on input dataset(s): Calculated distances\"]\n  23 -> k54ea37cc63d1422a9f5e124b8d39e6bd\n  24[label=\"Compute\"]\n  21 -> 24 [label=\"out_file1\"]\n  25[label=\"Compute\"]\n  22 -> 25 [label=\"out_file1\"]\n  26[label=\"Concatenate datasets\"]\n  24 -> 26 [label=\"out_file1\"]\n  25 -> 26 [label=\"out_file1\"]\n  27[label=\"Compute\"]\n  26 -> 27 [label=\"out_file1\"]\n  28[label=\"Cut\"]\n  27 -> 28 [label=\"out_file1\"]\n  29[label=\"Compute\"]\n  28 -> 29 [label=\"out_file1\"]\n  30[label=\"Join two Datasets\"]\n  14 -> 30 [label=\"out_file1\"]\n  29 -> 30 [label=\"out_file1\"]\n  31[label=\"Mapping report\"]\n  30 -> 31 [label=\"out_file1\"]\n}","workflow_tools":["Cut1","Filter1","cat1","join1","toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond_view/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.4","toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/1.6","toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0","toolshed.g2.bx.psu.edu/repos/devteam/intersect/gops_intersect_1/1.0.0","toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/rapidnj/rapidnj/2.3.2","toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0","toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.489+galaxy0"],"inputs":[{"annotation":"Amino acid sequences of CDS exons from the gene of interest","content_id":null,"errors":null,"id":0,"input_connections":{},"inputs":[{"description":"Amino acid sequences of CDS exons from the gene of interest","name":"Exons"}],"label":"Exons","name":"Input dataset","outputs":[],"position":{"left":1.90625,"top":74.21875},"tool_id":null,"tool_state":"{\"optional\": false, \"format\": [\"fasta\"], \"tag\": \"\"}","tool_version":null,"type":"data_input","uuid":"107c06e7-51a6-41a1-a026-45a9dddf29a9","workflow_outputs":[]},{"annotation":"Diamond DB created from ORF predicted from genomes used in the analysis","content_id":null,"errors":null,"id":1,"input_connections":{},"inputs":[{"description":"Diamond DB created from ORF predicted from genomes used in the analysis","name":"Diamond makedb"}],"label":"Diamond makedb","name":"Input dataset collection","outputs":[],"position":{"left":0.0,"top":185.71875},"tool_id":null,"tool_state":"{\"optional\": false, \"tag\": \"\", \"collection_type\": \"list\"}","tool_version":null,"type":"data_collection_input","uuid":"0acc2c20-91fb-4470-80ac-2eeb7e2f32ae","workflow_outputs":[]},{"annotation":"BED dataset containing information about ORFs predicted in genomes of interest","content_id":null,"errors":null,"id":2,"input_connections":{},"inputs":[{"description":"BED dataset containing information about ORFs predicted in genomes of interest","name":"ORFipy BED"}],"label":"ORFipy BED","name":"Input dataset collection","outputs":[],"position":{"left":1.90625,"top":313.203125},"tool_id":null,"tool_state":"{\"optional\": false, \"format\": [\"bed\"], \"tag\": \"\", \"collection_type\": \"list\"}","tool_version":null,"type":"data_collection_input","uuid":"329b3c07-f0ee-4882-abf7-1215062a0fec","workflow_outputs":[]}],"outputs":[{"annotation":"Compute NJ phylogenetic trees","content_id":"toolshed.g2.bx.psu.edu/repos/iuc/rapidnj/rapidnj/2.3.2","errors":null,"id":23,"input_connections":{"alignments":{"id":20,"output_name":"outputAlignment"}},"inputs":[],"label":null,"name":"Join neighbors","outputs":[{"name":"distances","type":"nhx"}],"position":{"left":2200.03125,"top":0},"post_job_actions":{"TagDatasetActiondistances":{"action_arguments":{"tags":"Trees"},"action_type":"TagDatasetAction","output_name":"distances"}},"tool_id":"toolshed.g2.bx.psu.edu/repos/iuc/rapidnj/rapidnj/2.3.2","tool_shed_repository":{"changeset_revision":"9f4a66e22580","name":"rapidnj","owner":"iuc","tool_shed":"toolshed.g2.bx.psu.edu"},"tool_state":"{\"__job_resource\": {\"__job_resource__select\": \"no\", \"__current_case__\": 0}, \"alignment_type\": \"p\", \"alignments\": {\"__class__\": \"ConnectedValue\"}, \"bootstrap\": null, \"evolution_model\": \"kim\", \"no_negative_length\": \"false\", \"output_format\": \"t\", \"__page__\": null, \"__rerun_remap_job_id__\": null}","tool_version":"2.3.2","type":"tool","uuid":"a9f1ebbf-4a88-4ddb-aec7-6a1c3a3921db","workflow_outputs":[{"label":"Join neighbors on input dataset(s): Calculated distances","output_name":"distances","uuid":"54ea37cc-63d1-422a-9f5e-124b8d39e6bd"}]},{"annotation":"","content_id":"Cut1","errors":null,"id":31,"input_connections":{"input":{"id":30,"output_name":"out_file1"}},"inputs":[],"label":"Mapping report","name":"Cut","outputs":[{"name":"out_file1","type":"tabular"}],"position":{"left":3450.75,"top":1309.90625},"post_job_actions":{"RenameDatasetActionout_file1":{"action_arguments":{"newname":"Mapping report"},"action_type":"RenameDatasetAction","output_name":"out_file1"},"TagDatasetActionout_file1":{"action_arguments":{"tags":"PlottingData"},"action_type":"TagDatasetAction","output_name":"out_file1"}},"tool_id":"Cut1","tool_state":"{\"columnList\": \"c1,c2,c3,c4,c5,c6,c7,c11,c12,c13,c14,c15\", \"delimiter\": \"T\", \"input\": {\"__class__\": \"ConnectedValue\"}, \"__page__\": null, \"__rerun_remap_job_id__\": null}","tool_version":"1.0.2","type":"tool","uuid":"341c7257-c027-421b-afc1-a8dc11d2f6cd","workflow_outputs":[{"label":null,"output_name":"out_file1","uuid":"bb199f1a-1402-4f00-9a02-e5743a8662b6"}]}]}],"api":"https://training.galaxyproject.org/training-material/api/topics/genome-annotation/tutorials/gene-centric/tutorial.json","tools":["Cut1","Filter1","cat1","join1","toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond_makedb/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/diamond/bg_diamond_view/2.0.15+galaxy0","toolshed.g2.bx.psu.edu/repos/bgruening/split_file_on_column/tp_split_on_column/0.4","toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/1.6","toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0","toolshed.g2.bx.psu.edu/repos/devteam/intersect/gops_intersect_1/1.0.0","toolshed.g2.bx.psu.edu/repos/devteam/tabular_to_fasta/tab2fasta/1.1.1","toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.1","toolshed.g2.bx.psu.edu/repos/iuc/orfipy/orfipy/0.0.4+galaxy0","toolshed.g2.bx.psu.edu/repos/iuc/rapidnj/rapidnj/2.3.2","toolshed.g2.bx.psu.edu/repos/nml/collapse_collections/collapse_dataset/5.1.0","toolshed.g2.bx.psu.edu/repos/rnateam/mafft/rbc_mafft/7.489+galaxy0"],"supported_servers":{"exact":[{"url":"https://usegalaxy.eu","name":"UseGalaxy.eu","usegalaxy":true},{"url":"https://usegalaxy.org","name":"UseGalaxy.org (Main)","usegalaxy":true}],"inexact":[{"url":"https://usegalaxy.cz/","name":"UseGalaxy.cz","usegalaxy":false}]},"topic_name_human":"Genome Annotation","admin_install":{"install_tool_dependencies":true,"install_repository_dependencies":true,"install_resolver_dependencies":true,"tools":[{"name":"diamond","owner":"bgruening","revisions":"e8ac2b53f262","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"diamond","owner":"bgruening","revisions":"e8ac2b53f262","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"diamond","owner":"bgruening","revisions":"e8ac2b53f262","tool_panel_section_label":"NCBI Blast","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"split_file_on_column","owner":"bgruening","revisions":"37a53100b67e","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"column_maker","owner":"devteam","revisions":"02026300aa45","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"column_maker","owner":"devteam","revisions":"6595517c2dd8","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"intersect","owner":"devteam","revisions":"69c10b56f46d","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"tabular_to_fasta","owner":"devteam","revisions":"0a7799698fe5","tool_panel_section_label":"FASTA/FASTQ","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"regex_find_replace","owner":"galaxyp","revisions":"ae8c4b2488e7","tool_panel_section_label":"Text Manipulation","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"orfipy","owner":"iuc","revisions":"c147914c9f02","tool_panel_section_label":"Extract Features","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"rapidnj","owner":"iuc","revisions":"9f4a66e22580","tool_panel_section_label":"Evolution","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"collapse_collections","owner":"nml","revisions":"90981f86000f","tool_panel_section_label":"Collection Operations","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"},{"name":"mafft","owner":"rnateam","revisions":"f1a5908ea2cb","tool_panel_section_label":"Multiple Alignments","tool_shed_url":"https://toolshed.g2.bx.psu.edu/"}]},"admin_install_yaml":"---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: diamond\n  owner: bgruening\n  revisions: e8ac2b53f262\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: diamond\n  owner: bgruening\n  revisions: e8ac2b53f262\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: diamond\n  owner: bgruening\n  revisions: e8ac2b53f262\n  tool_panel_section_label: NCBI Blast\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: split_file_on_column\n  owner: bgruening\n  revisions: 37a53100b67e\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: column_maker\n  owner: devteam\n  revisions: 02026300aa45\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: column_maker\n  owner: devteam\n  revisions: 6595517c2dd8\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: intersect\n  owner: devteam\n  revisions: 69c10b56f46d\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: tabular_to_fasta\n  owner: devteam\n  revisions: 0a7799698fe5\n  tool_panel_section_label: FASTA/FASTQ\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: ae8c4b2488e7\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: orfipy\n  owner: iuc\n  revisions: c147914c9f02\n  tool_panel_section_label: Extract Features\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: rapidnj\n  owner: iuc\n  revisions: 9f4a66e22580\n  tool_panel_section_label: Evolution\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: collapse_collections\n  owner: nml\n  revisions: 90981f86000f\n  tool_panel_section_label: Collection Operations\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: mafft\n  owner: rnateam\n  revisions: f1a5908ea2cb\n  tool_panel_section_label: Multiple Alignments\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n","tours":false,"video":false,"slides_recordings":false,"translations":{"tutorial":[],"slides":[],"video":false},"license":"CC-BY-4.0","type":"tutorial"}