<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Slides: High Performance Computing for Pairwise Genome Comparison / From small to large-scale genome comparison / Genome Annotation</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@9340b92c8a6cf9ab116086dafb2c6891537ef9ed",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/genome-annotation/tutorials/hpc-for-lsgc/slides-plain.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" as="script" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.40d4e218.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="High Performance Computing for Pairwise Genome Comparison">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2021-07-27 12:20:31 +0000">
<meta name="DC.creator" content="Esteban Perez-Wohlfeil"><meta name="description" content="### What is sequence comparison?  - Finding string matches between text paragraphs - Comparing biological sequences can be seen as an instance of common string matching problem but with some particularities      - Restricted alphabets: *e.g.* DNA = \{A, C, G, T\}     - It adds an additional dimension          - instead of looking for only one pattern, we have to look for all possible patterns!  ---  ### Why is it importantg?  - Sequence comparison is a core problem of bioinformatics that allows us to study:  - Evolution (Where do we come from? And other species?)  - Structure (What are we made of? How does our body work?)  - Functionality (How do changes in our DNA affect us?)  - Widely used in several fields!  - Whole genome alignment, gene prediction, phylogenomics, pharmacogenetics, metagenomics, etc.  ---  ### What are the challenges?  - A lot of progress has taken place since the beginning (around 1960s) - So what is the problem?   - New technology produces huge amounts of data...">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Genome Annotation / From small to large-scale genome comparison / Slides: High Performance Computing for Pairwise Genome Comparison">
        <meta property="og:description" content="### What is sequence comparison?  - Finding string matches between text paragraphs - Comparing biological sequences can be seen as an instance of common string matching problem but with some particularities      - Restricted alphabets: *e.g.* DNA = \{A, C, G, T\}     - It adds an additional dimension          - instead of looking for only one pattern, we have to look for all possible patterns!  ---  ### Why is it importantg?  - Sequence comparison is a core problem of bioinformatics that allows us to study:  - Evolution (Where do we come from? And other species?)  - Structure (What are we made of? How does our body work?)  - Functionality (How do changes in our DNA affect us?)  - Widely used in several fields!  - Whole genome alignment, gene prediction, phylogenomics, pharmacogenetics, metagenomics, etc.  ---  ### What are the challenges?  - A lot of progress has taken place since the beginning (around 1960s) - So what is the problem?   - New technology produces huge amounts of data...">
        
	<meta property="og:image" content="https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png"></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
			

                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/./topics/genome-annotation/tutorials/hpc-for-lsgc/slides.html">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/genome-annotation/tutorials/hpc-for-lsgc/slides-plain.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            <a class="dropdown-item" href="/training-material/feedback.html">
                <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        <section class="tutorial">
	<a href="https://github.com/galaxyproject/training-material/blob/main//topics/genome-annotation/tutorials/hpc-for-lsgc/slides.html">View markdown source on GitHub</a>
	<h1>High Performance Computing for Pairwise Genome Comparison</h1>
		<h2>Contributors</h2>
<div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/estebanpw/" class="contributor-badge contributor-estebanpw"><img src="https://avatars.githubusercontent.com/estebanpw?s=36" alt="Esteban Perez-Wohlfeil avatar" width="36" class="avatar" />
    Esteban Perez-Wohlfeil</a>
	</div>

</div>


		
		<h2>Questions</h2>
		<ul>
		
		<li><p>What is sequence comparison and why does it matter?</p>
</li>
		
		<li><p>What are the challenges and how can we use High Performance Computing to overcome them?</p>
</li>
		
		<li><p>How can we use Galaxy for large scale sequence comparison?</p>
</li>
		
		</ul>
		

		
		<h2>Objectives</h2>
		<ul>
		
		<li><p>Learn the basics of genome comparison</p>
</li>
		
		<li><p>Run sequence comparisons in Galaxy</p>
</li>
		
		<li><p>Using GECKO for sequence comparison</p>
</li>
		
		<li><p>Using CHROMEISTER for comparing large sequences such as plants and chromosomes</p>
</li>
		
		</ul>
		

		

		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Published:</strong> Feb 8, 2021 </div>
		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last Updated:</strong> Jul 27, 2021 </div>

	<hr />


	<h3 id="what-is-sequence-comparison">What is sequence comparison?</h3>

<ul>
  <li>Finding string matches between text paragraphs</li>
  <li>
    <p>Comparing biological sequences can be seen as an instance of common string matching problem but with some particularities</p>

    <ul>
      <li>Restricted alphabets: <em>e.g.</em> DNA = {A, C, G, T}</li>
      <li>It adds an additional dimension
        <ul>
          <li>instead of looking for only one pattern, we have to look for all possible patterns!</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="why-is-it-importantg">Why is it importantg?</h3>

<ul>
  <li>Sequence comparison is a core problem of bioinformatics that allows us to study:</li>
  <li>Evolution (Where do we come from? And other species?)</li>
  <li>Structure (What are we made of? How does our body work?)</li>
  <li>
    <p>Functionality (How do changes in our DNA affect us?)</p>
  </li>
  <li>Widely used in several fields!</li>
  <li>Whole genome alignment, gene prediction, phylogenomics, pharmacogenetics, metagenomics, etc.</li>
</ul>

<hr />

<h3 id="what-are-the-challenges">What are the challenges?</h3>

<ul>
  <li>A lot of progress has taken place since the beginning (around 1960s)</li>
  <li>
    <p>So what is the problem?</p>
  </li>
  <li>New technology produces huge amounts of data</li>
  <li>Optimal sequence comparison has complexity O(n<sup>2</sup>), which is a lot when sequences are long</li>
  <li>Several ways to compare sequences, each having its advantages: DP-based, gapped and ungapped, alignment-free</li>
  <li>DNA contains lots of repeats and low complexity regions, which make it difficult to find the conserved signal</li>
  <li>And also makes it very hard for computational algorithms</li>
</ul>

<hr />

<h3 id="why-is-sequence-comparison-hard">Why is sequence comparison hard?</h3>

<ul>
  <li>The complexity of the problem grows as the length of the sequences becomes larger</li>
  <li>That means that for small sequences it is OK; but for large sequences the problem can take a lot of time</li>
  <li>Computing power doubles every two years according to Moore’s law but sequence databases grow purely exponential every year</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Sequence type</th>
      <th>Approx. length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Gene</td>
      <td>~1,000 to 10,000 bp</td>
    </tr>
    <tr>
      <td>Bacteria genome</td>
      <td>~10<sup>6</sup> bp</td>
    </tr>
    <tr>
      <td>Mammalian chr.</td>
      <td>~10<sup>8</sup> bp</td>
    </tr>
    <tr>
      <td>Mammalian genome</td>
      <td>~2 * 10<sup>9</sup> bp</td>
    </tr>
    <tr>
      <td>Plant genome</td>
      <td>~3 * 10<sup>9</sup> bp</td>
    </tr>
    <tr>
      <td>Large plant genomes</td>
      <td>~2 * 10<sup>10</sup> bp</td>
    </tr>
    <tr>
      <td>Amoeba genome</td>
      <td>~6 * 10<sup>11</sup> bp</td>
    </tr>
  </tbody>
</table>

<hr />
<h3 id="exponential-growth-of-the-sequence-read-archive">Exponential growth of the Sequence Read Archive</h3>

<p><img src="../../images/hpc-for-lsgc/SRA.png" alt="line chart going from 2009 to 2013 with number of bases growing from 10e11 to 10e15, and all bases slowly growing larger than open access, but open access still being the vast majority. A pie chart is overlaid showing the majority is Illumina GA, with SOLiD making up 10% and others a tiny slice." /></p>

<ul>
  <li>Other databases have experienced similar growth too</li>
</ul>

<hr />

<h3 id="methods-for-sequence-comparison">Methods for sequence comparison</h3>

<ul>
  <li>Dot-matrix comparison (no alignments)</li>
  <li>
    <p>Comparing all letters with each other (extremely slow/noisy)</p>
  </li>
  <li>Alignment-free methods</li>
  <li>
    <p>Similar to the previous but typically based on k-mers (words)</p>
  </li>
  <li>Aligning methods
    <ul>
      <li>Exhaustive dynamic programming algorithms (Slow but optimal)
        <ul>
          <li>Local alignment</li>
          <li>Global alignment</li>
        </ul>
      </li>
      <li>Seed-based heuristics
        <ul>
          <li>Words of fixed size are used to start alignments (Fast but less sensitivity). Can also include gaps.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="dot-matrix-methods">Dot-matrix methods</h3>

<ul>
  <li>Takes each letter in both sequences and compare it to all the rest</li>
  <li>Takes quadratic time and space!</li>
  <li>Does not produce alignments, but rather just represents a comparison</li>
  <li>The <strong>x</strong> and <strong>y</strong> axis represent the sequences being compared</li>
</ul>

<p><img src="../../images/hpc-for-lsgc/Dot01.png" alt="Montage of three dot plots" /></p>

<hr />

<h3 id="comparing-genomes-with-dotplots">Comparing genomes with dotplots</h3>

<p><img src="../../images/hpc-for-lsgc/Dot02.png" alt="A dotplot is shown, with lines going from bottom left to the top right. Part way through it is fractured and a line is seen in the opposite direction showing an inversion. There is noise scattered around the plot from accidental overlaps. An inset shows some repeats which appear as regular small diagonal lines, repeated in x and y axes." /></p>

<hr />

<h3 id="how-useful-are-raw-dotplots">How useful are raw dotplots?</h3>

<p>.pull-left[</p>

<ul>
  <li>
    <p>Dot matrix methods do not take into account the global information or context</p>
  </li>
  <li>
    <p>Noise</p>
  </li>
  <li>
    <p>Where is the signal?
]</p>
  </li>
</ul>

<p>.pull-right[.image-70[<img src="../../images/hpc-for-lsgc/Dot03.png" alt="A tiny dot plot is shown, with two sequences and dots scattered across the plot. No pattern emerges due to repeating letters in some sequences." />]]</p>

<hr />

<h3 id="how-do-we-include-alignments">How do we include alignments?</h3>

<p>.pull-left[</p>

<ul>
  <li>
    <p>Alignments have to take into account their surroundings!</p>
  </li>
  <li>
    <p>Use dynamic programming to compute an accumulated score</p>
  </li>
  <li>Match =  4</li>
  <li>Miss  = -4</li>
</ul>

<p>]</p>

<p>.pull-right[
.image-70[
<img src="../../images/hpc-for-lsgc/Dot04.png" alt="A table with sequence across top left and right are shown, some boxes are filled with 4 and -4 according to match or mismatches." />
]
]</p>

<hr />

<h3 id="how-do-we-include-alignments-cont-i">How do we include alignments? Cont. I</h3>

<p>.pull-left[</p>

<ul>
  <li>
    <p>Alignments have to take into account their surroundings!</p>
  </li>
  <li>
    <p>Use dynamic programming to compute an accumulated score</p>
  </li>
  <li>
    <p>The score of each cell comes from either the diagonal (no penalty but match/mismatch score) or from a row or column, which is a gap in either the query or reference sequence (“jumping” gap penalty is included then)</p>
  </li>
  <li>Match =  4</li>
  <li>Miss  = -4</li>
  <li><strong>Gap   = -iG - eG*L</strong></li>
</ul>

<p>]</p>

<p>.pull-right[
<img src="../../images/hpc-for-lsgc/Dot05.png" alt="The same chart as before, but more cells are filled in, the numbers get mostly increasingly negative." />
]</p>

<hr />

<h3 id="how-do-we-include-alignments-cont-ii">How do we include alignments? Cont. II</h3>

<p><img src="../../images/hpc-for-lsgc/Dot06.png" alt="A filled out chart and then several boxes are highlighted showing a best scoring set of matches using a typical algorithm for sequence alignment. The alignment is shown at the left." /></p>

<hr />

<h3 id="how-do-we-include-alignments-cont-iii">How do we include alignments? Cont. III</h3>

<ul>
  <li>
    <p>But what if the two sequences are not toy examples?</p>
  </li>
  <li>
    <p>Typically, a mammalian chromosome is around the 100 Mbp mark</p>
  </li>
  <li>
    <p>Worst case scenario this algorithm takes quadratic time and space</p>
  </li>
  <li>Imagine comparing two amoeba genomes (Not your usual case, though)</li>
  <li>Total number of cells: 10<sup>22</sup> ~the number of sand grains in the earth</li>
</ul>

<hr />
<h3 id="how-do-we-include-alignments-cont-iv">How do we include alignments? Cont. IV</h3>

<p><img src="../../images/hpc-for-lsgc/Dot07.png" alt="A larger subset of a table is shown from rows 0 to 100 billion. The text grows quadratically is shown over the table." /></p>

<hr />

<h3 id="how-to-speed-up-finding-alignments">How to speed up finding alignments?</h3>

<ul>
  <li>
    <p>DP algorithms are not feasible for long sequences</p>
  </li>
  <li>
    <p>Use seeds of fixed size (k-mers) to find anchor points and then perform the alignment</p>
  </li>
  <li>
    <p>Can be done in linear time</p>
  </li>
  <li>
    <p>But careful, the number of common seeds can be huge and optimization is still needed</p>
  </li>
</ul>

<hr />

<h3 id="how-to-speed-up-finding-alignments-cont-i">How to speed up finding alignments? Cont. I</h3>

<p><img src="../../images/hpc-for-lsgc/Dot08.png" alt="The same matrix is shown again, but now black diagonal lines appear, circled as k-mers of fixed size." /></p>

<hr />
<h3 id="how-to-speed-up-finding-alignments-cont-ii">How to speed up finding alignments? Cont. II</h3>

<ul>
  <li>
    <p>Extend the common seeds identified previously to form larger fragments</p>
  </li>
  <li>
    <p>These are called High-scoring Segment Pairs and do not typically include gaps</p>
  </li>
  <li>
    <p>Some programs (such as BLAST) include small gaps</p>
  </li>
  <li>This approach also enables to compare distant sequences with many evolutionary rearrangments since fragments do not require to be close to each other</li>
  <li>Similar result to the local dynamic programming algorithm (as opposed to the global approach where everything is connected)</li>
</ul>

<hr />

<h3 id="how-to-speed-up-finding-alignments-cont-iii">How to speed up finding alignments? Cont. III</h3>

<p><img src="../../images/hpc-for-lsgc/Dot09.png" alt="Multiple aligned k-mers are grouped into larger runs of sequence and labelled high-scoring pairs." /></p>

<hr />

<h3 id="recap-on-sequence-comparison">Recap on Sequence comparison</h3>

<ul>
  <li>
    <p>Sequence comparison is inherently hard because it requires quadratic time and space to produce optimal alignments</p>
  </li>
  <li>
    <p>Especially when there are more (and longer) genome sequences available everyday (<a href="http://www.ensembl.info/category/01-release/">Ensembl blog</a>)</p>
  </li>
  <li>
    <p>Heuristic approaches based on seeds are required to cope with the complexity of dynamic programming methods</p>
  </li>
  <li>
    <p>Tools are needed to quickly compare sequences while providing insightful information</p>
  </li>
</ul>

<hr />

<h3 id="methods">Methods</h3>

<ul>
  <li>
    <p>Now that we have a general background on sequence alignment, lets jump to the software that we will use in this tutorial</p>
  </li>
  <li>GECKO: fine-grained sequence comparison that uses secondary memory to enable virtually comparisons of any size</li>
  <li>GECKO Multi-Genome-Viewer: A tool for the interactive inspection of sequence comparisons</li>
  <li>CHROMEISTER: Ultra-fast approach for the previsualization of sequence comparisons while dealing with noise and repeats, including full mammalian genomes and plants</li>
</ul>

<hr />

<h3 id="gecko">GECKO</h3>

<ul>
  <li>
    <p>Pairwise genome comparison software which reduces execution time in pairwise and multiple genome comparison studies</p>
  </li>
  <li>It uses an ‘out of core’ strategy, <em>i.e.</em> it runs on secondary memory (disk) as opposed to RAM</li>
  <li>
    <p>Can run anywhere, about ~4 GB of RAM and  ~1 TB of disk required for the longest sequences</p>
  </li>
  <li>Faster than state-of-the-art software especially for longer sequences such as chromosomes</li>
</ul>

<hr />

<h3 id="the-gecko-algorithm">The GECKO algorithm</h3>

<p><img src="../../images/hpc-for-lsgc/Gecko01.png" alt="Sequence X and Y enter the pipeline and produce two dictionary and dictionary hashes. These are combined into a hits file which shows a dotplot with several circles in diagonals. These are then sorted, filtered, and produce a set of HSPs which show the same dots connected up into diagonal lines." /></p>

<hr />

<h3 id="the-gecko-algorithm-cont-i">The GECKO algorithm (Cont. I)</h3>

<ul>
  <li>
    <p>A dictionary is computed for each sequence containing the positional information of each word (possible seed)</p>
  </li>
  <li>
    <p>Once each dictionary is sorted, perfect matches between words produce a set of seeds (alignment candidates)</p>
  </li>
  <li>
    <p>Seeds are then sorted (by their diagonal position <strong>x</strong><sub>start</sub> - <strong>y</strong><sub>start</sub>) and filtered</p>
  </li>
  <li>
    <p>Finally, the seeds are extended (up and downstream) to generate a set of High-scoring Segment Pairs (HSPs)</p>
  </li>
</ul>

<hr />

<h3 id="parallelising-gecko">Parallelising GECKO</h3>

<p>.pull-left[</p>

<ul>
  <li>
    <p>In a static distribution cores can become idle if they finish before other cores → resources are wasted</p>
  </li>
  <li>
    <p>GECKO uses MPI to distribute the workload dynamically based on the length</p>
  </li>
  <li>
    <p>When a core (worker) has finished executing a task (comparison) the master node broadcasts more work</p>
  </li>
  <li>
    <p>This reduces overall makespan time because of workload balance</p>
  </li>
</ul>

<p>]</p>

<p>.pull-right[
<img src="../../images/hpc-for-lsgc/Gecko02.png" alt="A genomes list enters the workflow and is mapped into a workload file which gives all combinations of G1 to GN. This is sent to a job runner and the individual pairwise comparisons are distributed across worker nodes." />
]
—</p>

<h3 id="parallelising-gecko-cont-i">Parallelising GECKO (Cont. I)</h3>

<p>.pull-left[</p>

<ul>
  <li>
    <p>GECKO also employs a second level of parallelism besides using MPI to distribute data dynamically</p>
  </li>
  <li>
    <p>It consists on sorting the initial seeds found (which is the most time-consuming step) using shared memory threads (pthreads and openMP)</p>
  </li>
  <li>
    <p>Each core uses up to <code class="language-plaintext highlighter-rouge">t</code> threads to sort the dictionaries containing the seeds
]</p>
  </li>
</ul>

<p>.pull-right[
<img src="../../images/hpc-for-lsgc/Gecko03.png" alt="Two sequences, G1 and G2 enter, produce dictionaries, and hits which are then combined into sorted Hits and fragmented hits." />
]
—</p>

<h3 id="gecko-mgv-interactive-sequence-comparison">GECKO-MGV: interactive sequence comparison</h3>

<ul>
  <li>
    <p>GeckoMGV is a Web-based application aimed to visualize results from multiple genome comparison allowing deep data analysis. It features:</p>
  </li>
  <li>
    <p>User friendly interface</p>
  </li>
  <li>
    <p>Multilayer for displaying and overlaying comparisons</p>
  </li>
  <li>
    <p>Interactive zooming and filtering</p>
  </li>
  <li>
    <p>External and proprietary post-processing services</p>
  </li>
  <li>
    <p>Adaptable from equivalent software (<em>e.g.</em> MAUVE)</p>
  </li>
  <li>
    <p>Dendrograms and Multiple Sequence Alignment visualization</p>
  </li>
</ul>

<hr />

<h3 id="gecko-mgv-interactive-sequence-comparison-cont-i">GECKO-MGV: interactive sequence comparison (Cont. I)</h3>

<p><img src="../../images/hpc-for-lsgc/Gecko04.png" alt="Multiple pairwise alignments are shown on the left, in the center is a large dot-plot, and below is a distribution matrix with a large scatter plot. On the right a minimap and various filtering options are shown." /></p>

<hr />

<h3 id="gecko-mgv-interactive-sequence-comparison-cont-ii">GECKO-MGV: interactive sequence comparison (Cont. II)</h3>

<ul>
  <li>
    <p>A typical exercise would include running a sequence comparison with GECKO</p>
  </li>
  <li>
    <p>Visualizing the alignments with GECKO-MGV</p>
  </li>
  <li>
    <p>Interactively selecting regions of interest and performing post-processing</p>
  </li>
  <li>
    <p>Such as selecting repeats, extracting them and performing multiple sequence alignment to find out single point mutations</p>
  </li>
</ul>

<hr />

<h3 id="gecko-mgv-interactive-sequence-comparison-cont-iii">GECKO-MGV: interactive sequence comparison (Cont. III)</h3>

<p><img src="../../images/hpc-for-lsgc/Gecko05.png" alt="The same application is shown with a set of repeats highlighted, and pulled out into a table and at the bottom a sequence logo is shown with the multiple sequence alignment." /></p>

<hr />

<h3 id="chromeister-motivation">CHROMEISTER: Motivation</h3>

<p>.pull-left[</p>

<ul>
  <li>
    <p>GECKO is suitable for chromosome comparisons</p>
  </li>
  <li>
    <p>But all vs all chromosomes between any two species generate usually over 400 comparisons</p>
  </li>
  <li>This results in extremely large computation times</li>
  <li>Do all of these even have any similarity signals?</li>
  <li>Instead of runnning everything from scratch with GECKO, first use CHROMEISTER to detect significant comparisons
]</li>
</ul>

<p>.pull-right[
<img src="../../images/hpc-for-lsgc/Chrom01.png" alt="A large multi-genome dot-plot is shown." />
]</p>

<hr />

<h3 id="chromeister-motivation-cont-i">CHROMEISTER: Motivation (Cont. I)</h3>

<p>.pull-left[</p>
<ul>
  <li>
    <p>Comparisons tend to be full of repetitions in large mammalians, let alone plants!</p>
  </li>
  <li>
    <p>State-of-the-art methods get stuck handling large number of repetitions or resulting dotplots are too noisy</p>
  </li>
  <li>
    <p>Can we extract any information from raw seeds (hits) without having to generate fragments (slower)?
]</p>
  </li>
</ul>

<p>.pull-right[
<img src="../../images/hpc-for-lsgc/Chrom02.png" alt="An even larger, denser dot plot is shown with a very low signal to noise ratio." />
]</p>

<hr />

<h3 id="chromeister-motivation-cont-ii">CHROMEISTER: Motivation (Cont. II)</h3>

<p><img src="../../images/hpc-for-lsgc/Chrom03.png" alt="Two 3d plots are shown, the first resembles the previous dot plot with high noise, and lots of tiny peaks. An arrow points to the second set of &quot;filtered seeds&quot; with several diagonal sets of peaks highlighted." /></p>

<hr />
<h3 id="chromeister-methods">CHROMEISTER: Methods</h3>

<ul>
  <li>
    <p>CHROMEISTER (CHROmosome MEISTER) is an ultra fast heuristic approach to computing extremely large pairwise genome comparison in desktop PCs</p>
  </li>
  <li>
    <p>Hybrid indexing approach</p>
  </li>
  <li>
    <p>Heuristically select long, unique and inexact hits!</p>
  </li>
  <li>
    <p>Probabilistic filtering</p>
  </li>
  <li>
    <p>Higher concentration of unique hits within HSPs</p>
  </li>
  <li>
    <p>Apply a kernel to improve visualization</p>
  </li>
</ul>

<hr />

<h3 id="chromeister-methods-cont-i">CHROMEISTER: Methods (Cont. I)</h3>

<ul>
  <li>
    <p>Heuristically select unique and inexact seeds:</p>
  </li>
  <li>Hits with frequency above one are repetitions by definition (in a computational sense) so we remove them</li>
  <li>Short k-mers produce repetitions and noise, so we have to use long k-mers</li>
  <li>
    <p>But long k-mers produce less seeds due to biological evolution, therefore a certain inexactitude is allowed</p>
  </li>
  <li>Are these two words equal? Under what considerations?</li>
</ul>

<p><img src="../../images/hpc-for-lsgc/Chrom04.png" alt="Two sequences 1 and 2 are shown. Each has a single nucleotide change at the start and end." /></p>

<hr />

<h3 id="chromeister-methods-cont-ii">CHROMEISTER: Methods (Cont. II)</h3>

<ul>
  <li>Probabilistic filtering</li>
  <li>The probability of a sequence region containing more hits will be higher if there was an existing HSP!</li>
  <li>
    <p>The discrete dotplot is downsampled to a smaller representation to group hits into blocks (similar to HSPs)</p>
  </li>
  <li>Kernel and score calculation</li>
  <li>A kernel is convoluted with the dotplot to improve visualization and remove single repetitions</li>
  <li>The scoring distance is calculated between the peak hit points using taxicab distance:</li>
</ul>

\[d\_{raw} = \sum\_{i}^{l-1}taxicab(max(H\_m(i), H\_m(i+1)))\]

\[d = \frac{d\_{raw}}{l^2}\]

<hr />

<h3 id="chromeister-examples">CHROMEISTER: Examples</h3>

<p><img src="../../images/hpc-for-lsgc/Chrom06.png" alt="A low signal to noise ratio dot plot plot labelled Macaca Mulatta Chr X vs Homo Sapiens Chr X is reduced to a diagonal line via CHROMEISTER under 2 minutes. Below an Aegilops tauschii Chr.1 vs Triticum aestivum Chr 1 produced with NUCMER is reduced to a very clear dot plot with CHROMEISTER." /></p>

<hr />

<h3 id="chromeister-conclusions">CHROMEISTER: Conclusions</h3>

<p>.pull-left[</p>
<ul>
  <li>Produces a dotplot visualization in minutes using 1 core and 1 GB of RAM</li>
  <li>It is used in the plants community</li>
  <li>This is due mostly to its ability to filter repeats and to handle large sizes</li>
  <li>
    <p>Also used for analysis of contig/scaffold reordering</p>
  </li>
  <li>(Right) Pairwise genome comparison between Aegilops tauschii (3.2 Gbps) and Triticum aestivum (4.2 Gbps) in under 16 minutes using 1 core and 1 GB of RAM
]</li>
</ul>

<p>.pull-right[
<img src="../../images/hpc-for-lsgc/Chrom07.png" alt="A multi-genome dot plot is shown comparing two genomes. It is very clean and low-noise." />
]</p>



	<hr />


<h2>Key Points</h2>

<ul>

<li>Sequence comparison is difficult due to its computational complexity and the growth of databases</li>

<li>There are several approaches to sequencen comparison, and we need to know which one to use (DP-based, alignment-free, seeds, etc.)</li>

<li>We have learnt the internals regarding GECKO, GECKO-MGV and CHROMEISTER to work with single chromosome comparisons and/or exhaustive searchs, the post-processing and for larger/noisy experiments, respectively</li>

</ul>







<h2>Thank you!</h2>

This material is the result of a collaborative work. Thanks to the <a href="https://training.galaxyproject.org" aria-label="Visit the GTN">Galaxy Training Network</a> and all the contributors!


<img src="/training-material/assets/images/GTNLogo1000.png" alt="Galaxy Training Network" style="height: 100px;"/>


Tutorial Content is licensed under

  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

</section>






        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/./topics/genome-annotation/tutorials/hpc-for-lsgc/slides.html">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/./topics/genome-annotation/tutorials/hpc-for-lsgc/slides.html">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/9340b92c8a6cf9ab116086dafb2c6891537ef9ed">9340b92</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.40d4e218.js'></script>

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
	

    </body>
</html>
