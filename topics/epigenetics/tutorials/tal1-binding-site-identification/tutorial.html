<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1)</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="DNA methylation is an epigenetic mechanism used by higher..." />
        <meta property="og:title" content="Galaxy Training: Identification of the binding sites of the T-cell acute l..." />
        <meta property="og:description" content="DNA methylation is an epigenetic mechanism used by higher..." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        











<!-- Gitter -->


<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/epigenetics" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">topic</span> Epigenetics
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Language Selector">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Language
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fepigenetics%2Ftutorials%2Ftal1-binding-site-identification%2Ftutorial.html&edit-text=&act=url" title="">
                                Fran√ßais
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fepigenetics%2Ftutorials%2Ftal1-binding-site-identification%2Ftutorial.html&edit-text=&act=url" title="">
                                Êó•Êú¨Ë™û
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fepigenetics%2Ftutorials%2Ftal1-binding-site-identification%2Ftutorial.html&edit-text=&act=url" title="">
                                Espa√±ol
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fepigenetics%2Ftutorials%2Ftal1-binding-site-identification%2Ftutorial.html&edit-text=&act=url" title="">
                                Portugu√™s
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fepigenetics%2Ftutorials%2Ftal1-binding-site-identification%2Ftutorial.html&edit-text=&act=url" title="">
                                ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fepigenetics%2Ftutorials%2Ftal1-binding-site-identification%2Ftutorial.html&edit-text=&act=url" title="">
                                And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>

        <div class="dropdown-item">
            <div>
                Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> üéÉ
                </label>
            </div>

        </div>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/epigenetics/tutorials/tal1-binding-site-identification/tutorial.md">
                            <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1)",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "https://github.com/galaxyproject/training-material/blob/master/LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Epigenetics",
    "description": "DNA methylation is an epigenetic mechanism used by higher eukaryotes and involved in e.g. gene expression, X-Chromosome inactivating, imprinting, and gene silencing of germline specific gene and repetitive elements.",
    "url": "https://training.galaxyproject.org//training-material/topics/epigenetics/"
  },
  "courseCode": "epigenetics / tal1-binding-site-identification / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1)' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/epigenetics/tutorials/tal1-binding-site-identification/tutorial.html",
  "timeRequired": "PT3H",
  "keywords": "ChIP-seq",
  "description": "The questions this  addresses are:\n - How is raw ChIP-seq data processed and analyzed?\n - What are the binding sites of TAL1?\n - Which genes are regulated by TAL1?\n\n\\nThe objectives are:\n - Inspect read quality with FastQC\n - Perform read trimming with Trimmomatic\n - Align trimmed reads with BWA\n - Assess quality and reproducibility of experiments\n - Identify TAL1 binding sites with MACS2\n - Determine unique/common TAL1 binding sites from G1E and Megakaryocytes\n - Identify unique/common TAL1 peaks occupying gene promoters\n - Visually inspect TAL1 peaks with Trackster\n\n",
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/quality-control/slides.html",
      "name": "Quality Control",
      "description": "Slides for 'Quality Control' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html",
      "name": "Quality Control",
      "description": "Hands-on for 'Quality Control' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/mapping/slides.html",
      "name": "Mapping",
      "description": "Slides for 'Mapping' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html",
      "name": "Mapping",
      "description": "Hands-on for 'Mapping' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "CreativeWork",
      "url": "https://wiki.galaxyproject.org/Learn/Visualization",
      "name": "Trackster"
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Mallory Freeberg"
    },
    {
      "@type": "Person",
      "name": "Mo Heydarian"
    },
    {
      "@type": "Person",
      "name": "Vivek Bhardwaj"
    },
    {
      "@type": "Person",
      "name": "Joachim Wolff"
    },
    {
      "@type": "Person",
      "name": "Anika Erxleben"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Mallory Freeberg"
    },
    {
      "@type": "Person",
      "name": "Mo Heydarian"
    },
    {
      "@type": "Person",
      "name": "Vivek Bhardwaj"
    },
    {
      "@type": "Person",
      "name": "Joachim Wolff"
    },
    {
      "@type": "Person",
      "name": "Anika Erxleben"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Epigenetics",
      "description": "DNA methylation is an epigenetic mechanism used by higher eukaryotes and involved in e.g. gene expression, X-Chromosome inactivating, imprinting, and gene silencing of germline specific gene and repetitive elements.",
      "url": "https://training.galaxyproject.org//training-material/topics/epigenetics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3173",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3173",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3173"
    }
  ]
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1)</h1>
        

        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame/malloryfreeberg/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/malloryfreeberg" alt="Mallory Freeberg">Mallory Freeberg</a>, <a href="/training-material/hall-of-fame/moheydarian/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/moheydarian" alt="Mo Heydarian">Mo Heydarian</a>, <a href="/training-material/hall-of-fame/vivekbhr/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/vivekbhr" alt="Vivek Bhardwaj">Vivek Bhardwaj</a>, <a href="/training-material/hall-of-fame/joachimwolff/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/joachimwolff" alt="Joachim Wolff">Joachim Wolff</a>, <a href="/training-material/hall-of-fame/erxleben/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/erxleben" alt="Anika Erxleben">Anika Erxleben</a>

</div>

        <blockquote class="overview">
            <h3>Overview</h3>
            <strong><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li><p>How is raw ChIP-seq data processed and analyzed?</p>
</li>
            
            <li><p>What are the binding sites of TAL1?</p>
</li>
            
            <li><p>Which genes are regulated by TAL1?</p>
</li>
            
            </ul>

            <strong><i class="fas fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li><p>Inspect read quality with FastQC</p>
</li>
            
            <li><p>Perform read trimming with Trimmomatic</p>
</li>
            
            <li><p>Align trimmed reads with BWA</p>
</li>
            
            <li><p>Assess quality and reproducibility of experiments</p>
</li>
            
            <li><p>Identify TAL1 binding sites with MACS2</p>
</li>
            
            <li><p>Determine unique/common TAL1 binding sites from G1E and Megakaryocytes</p>
</li>
            
            <li><p>Identify unique/common TAL1 peaks occupying gene promoters</p>
</li>
            
            <li><p>Visually inspect TAL1 peaks with Trackster</p>
</li>
            
            </ul>

            
            <strong><i class="fas fa-check-circle" aria-hidden="true"></i><span class="visually-hidden">requirements</span> Requirements</strong>
            <ul>
            
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

    <li>
    
        
        
        <a href="/training-material/topics/sequence-analysis">Sequence analysis</a>
        
            <ul>
                
                    
                        
                    
                        
                            
                            <li> Quality Control:
                            
                                <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                
                    
                        
                            
                            <li> Mapping:
                            
                                <a href="/training-material/topics/sequence-analysis/tutorials/mapping/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

            
    <li>
    
        <a href="https://wiki.galaxyproject.org/Learn/Visualization">Trackster</a>
    
    </li>

            </ul>
            

            
            <p><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 3 hours</p>
            

            

            
            

            
            <p id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials</strong></p>
            <ul>
                <div class="supporting_material">
                
                    <li class="btn btn-default supporting_material"><a href="/training-material/topics/epigenetics/slides/introduction-dna-methylation.html" title="Topic Overview slides">
                        <i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> Topic Overview slides
                    </a></li>
                

                
                    <li class="btn btn-default supporting_material">
<a class="topic-icon" href="https://doi.org/10.5281/zenodo.197100">
    <i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">zenodo_link</span> Datasets
</a>

</li>
                

                
                    <li class="btn btn-default supporting_material">
    <a class="topic-icon" href="/training-material/topics/epigenetics/tutorials/tal1-binding-site-identification/workflows/" title="Workflows" alt="Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1) workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden">workflow</span> Workflows
    </a>

</li>
                

                
                    <li class="btn btn-default supporting_material">
<a class="topic-icon" href="https://github.com/galaxyproject/training-material/tree/master/topics/epigenetics/tutorials/tal1-binding-site-identification/tours/">
    <i class="fas fa-magic" aria-hidden="true"></i><span class="visually-hidden">interactive_tour</span> Tours
</a>

</li>
                

                
                    <li class="btn btn-default supporting_material">

    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span> Available on these Galaxies
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/master/topics/epigenetics/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://africa.usegalaxy.eu/" title="Galaxy Africa">
            Galaxy Africa
        </a>
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://galaxy.genouest.org" title="Galaxy@GenOuest">
            Galaxy@GenOuest
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.be/" title="UseGalaxy.be">
            UseGalaxy.be
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.eu" title="UseGalaxy.eu">
            UseGalaxy.eu
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.fr/" title="UseGalaxy.fr">
            UseGalaxy.fr
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.no/" title="UseGalaxy.no">
            UseGalaxy.no
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.org" title="UseGalaxy.org (Main)">
            UseGalaxy.org (Main)
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.org.au" title="UseGalaxy.org.au">
            UseGalaxy.org.au
        </a>
        
    
        
    
    </ul>


</li>
                
                </div>
            </ul>
            

            <p><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last modification:</strong> Jan 6, 2021 </p>
        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <h1 class="no_toc" id="introduction">Introduction</h1>

<p>This tutorial uses ChIP-seq datasets from a study published by <a class="citation" href="#Wu_2014">Wu <i>et al.</i> 2014</a>. The goal of this study was to investigate ‚Äúthe dynamics of occupancy and the role in gene regulation of the transcription factor TAL1, a critical regulator of hematopoiesis, at multiple stages of hematopoietic differentiation.‚Äù</p>

<p>To this end, ChIP-seq experiments were performed in multiple mouse cell types including G1E - a GATA-null immortalized cell line derived from targeted disruption of GATA-1 in mouse embryonic stem cells - and megakaryocytes.</p>

<p>This dataset (GEO Accession: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE51338">GSE51338</a>) consists of biological replicate TAL1 ChIP-seq and input control experiments.
Input control experiments are used to identify and remove sampling bias, for example open/accessible chromatin or GC bias.</p>

<p>Because of the long processing time for the large original files, we have downsampled the original raw data files to include only <span class="notranslate">reads</span> that align to chromosome 19 and a subset of interesting genomic loci identified by <a class="citation" href="#Wu_2014">Wu <i>et al.</i> 2014</a>.</p>

<p><strong>Table 1</strong>: Metadata for ChIP-seq experiments in this tutorial. SE: single-end.</p>

<table>
  <thead>
    <tr>
      <th>Cellular state</th>
      <th>Datatype</th>
      <th style="text-align: center">ChIP Ab</th>
      <th style="text-align: center">Replicate</th>
      <th>SRA Accession</th>
      <th style="text-align: center">Library type</th>
      <th style="text-align: center">Read length</th>
      <th style="text-align: center">Stranded?</th>
      <th>Data size (MB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>G1E</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">input</td>
      <td style="text-align: center">1</td>
      <td>SRR507859</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">36</td>
      <td style="text-align: center">No</td>
      <td>35.8</td>
    </tr>
    <tr>
      <td>G1E</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">input</td>
      <td style="text-align: center">2</td>
      <td>SRR507860</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">55</td>
      <td style="text-align: center">No</td>
      <td>427.1</td>
    </tr>
    <tr>
      <td>G1E</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">TAL1</td>
      <td style="text-align: center">1</td>
      <td>SRR492444</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">36</td>
      <td style="text-align: center">No</td>
      <td>32.3</td>
    </tr>
    <tr>
      <td>G1E</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">TAL1</td>
      <td style="text-align: center">2</td>
      <td>SRR492445</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">41</td>
      <td style="text-align: center">No</td>
      <td>62.7</td>
    </tr>
    <tr>
      <td>Megakaryocyte</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">input</td>
      <td style="text-align: center">1</td>
      <td>SRR492453</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">41</td>
      <td style="text-align: center">No</td>
      <td>57.2</td>
    </tr>
    <tr>
      <td>Megakaryocyte</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">input</td>
      <td style="text-align: center">2</td>
      <td>SRR492454</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">55</td>
      <td style="text-align: center">No</td>
      <td>403.8</td>
    </tr>
    <tr>
      <td>Megakaryocyte</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">TAL1</td>
      <td style="text-align: center">1</td>
      <td>SRR549006</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">55</td>
      <td style="text-align: center">No</td>
      <td>340.3</td>
    </tr>
    <tr>
      <td>Megakaryocyte</td>
      <td>ChIP-seq</td>
      <td style="text-align: center">TAL1</td>
      <td style="text-align: center">2</td>
      <td>SRR549007</td>
      <td style="text-align: center">SE</td>
      <td style="text-align: center">48</td>
      <td style="text-align: center">No</td>
      <td>356.9</td>
    </tr>
  </tbody>
</table>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#quality-control" id="markdown-toc-quality-control">Quality control</a></li>
  <li><a href="#trimming-and-clipping-reads" id="markdown-toc-trimming-and-clipping-reads">Trimming and clipping <span class="notranslate">reads</span></a></li>
  <li><a href="#aligning-reads-to-a-reference-genome" id="markdown-toc-aligning-reads-to-a-reference-genome">Aligning <span class="notranslate">reads</span> to a reference genome</a></li>
  <li><a href="#assessing-correlation-between-samples" id="markdown-toc-assessing-correlation-between-samples">Assessing correlation between samples</a></li>
  <li><a href="#assessing-ip-strength" id="markdown-toc-assessing-ip-strength">Assessing IP strength</a></li>
  <li><a href="#determining-tal1-binding-sites" id="markdown-toc-determining-tal1-binding-sites">Determining TAL1 binding sites</a></li>
  <li><a href="#inspection-of-peaks-and-aligned-data" id="markdown-toc-inspection-of-peaks-and-aligned-data">Inspection of peaks and aligned data</a>    <ol>
      <li><a href="#inspection-of-peaks-and-aligned-data-with-trackster" id="markdown-toc-inspection-of-peaks-and-aligned-data-with-trackster">Inspection of peaks and aligned data with Trackster</a></li>
      <li><a href="#inspection-of-peaks-and-aligned-data-with-igv" id="markdown-toc-inspection-of-peaks-and-aligned-data-with-igv">Inspection of peaks and aligned data with IGV</a></li>
    </ol>
  </li>
  <li><a href="#identifying-unique-and-common-tal1-peaks-between-stages" id="markdown-toc-identifying-unique-and-common-tal1-peaks-between-stages">Identifying unique and common TAL1 peaks between stages</a></li>
  <li><a href="#generating-input-normalized-coverage-files" id="markdown-toc-generating-input-normalized-coverage-files">Generating Input normalized coverage files</a></li>
  <li><a href="#plot-the-signal-on-the-peaks-between-samples" id="markdown-toc-plot-the-signal-on-the-peaks-between-samples">Plot the signal on the peaks between samples</a></li>
  <li><a href="#additional-optional-analyses" id="markdown-toc-additional-optional-analyses">Additional optional analyses</a>    <ol>
      <li><a href="#assessing-gc-bias" id="markdown-toc-assessing-gc-bias">Assessing GC bias</a></li>
    </ol>
  </li>
</ol>

</blockquote>

<h1 id="quality-control">Quality control</h1>

<p>As for any NGS data analysis, ChIP-seq data must be quality controlled before being aligned to a reference genome. For more detailed information on NGS quality control, check out the tutorial <a href="/training-material/topics/sequence-analysis">here</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-performing-quality-control"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Performing quality control</h3>

  <ol>
    <li>
      <p>Create and name a new history for this tutorial.</p>

      <blockquote class="tip">

        <h3 id="tip-tip-creating-a-new-history"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Creating a new history</h3>

        <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel</p>

        <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>
        <ol>
          <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>
          <li>Select the option <strong>Create New</strong> from the menu</li>
        </ol>
      </blockquote>
    </li>
    <li>
      <p>Import the ChIP-seq raw data (*.fastqsanger) from <a href="https://doi.org/10.5281/zenodo.197100">Zenodo</a>.</p>

      <blockquote class="tip">

        <h3 id="tip-tip-importing-data-via-links"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Importing data via links</h3>

        <ul>
          <li>Copy the link location</li>
          <li>
            <p>Open the <span class="notranslate">Galaxy</span> Upload Manager (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> on the top-right of the tool panel)</p>
          </li>
          <li>Select <strong>Paste/Fetch Data</strong></li>
          <li>
            <p>Paste the link into the text field</p>
          </li>
          <li>
            <p>Press <strong>Start</strong></p>
          </li>
          <li><strong>Close</strong> the window</li>
        </ul>

        <p>By default, <span class="notranslate">Galaxy</span> uses the URL as the name, so rename the files with a more useful name.</p>

      </blockquote>
    </li>
    <li>
      <p>Examine the data in a FASTQ file by clicking on the <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> (eye) icon.</p>

      <blockquote class="question">
        <h3 id="question-questions"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What are four key features of a FASTQ file?</li>
          <li>What is the main difference between a FASTQ and a FASTA file?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>A FASTQ file contains a sequence identifier and additional information, the raw sequence, information about the sequence again with optional information, and quality information about the sequence.</li>
            <li>A FASTA file contains only the description of the sequence and the sequence itself. A FASTA file does not contain any quality information.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
    <li>
      <p><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1"><strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+<span class="notranslate">galaxy</span>1</span></span> : Run FastQC on each FASTQ file to assess the quality of the raw data. An explanation of the results can be found on the <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC web page</a>.</p>
      <ul>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúShort read data from your current history‚Äù</em>: The uploaded fastqsanger files.</li>
      </ul>

      <figure id="figure-1"><img src="../../images/tal1/fastqc_before.png" alt="fastqbefore" /><figcaption><span class="figcaption-prefix">Figure 1:</span> Sequence quality per base generated by FastQC before end trimming.</figcaption></figure>

      <blockquote class="question">
        <h3 id="question-questions-1"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What does the y-axis represent in Figure 3?</li>
          <li>Why is the quality score decreasing across the length of the <span class="notranslate">reads</span>?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-1"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>The phred-score. This score gives the probability of an incorrect base <em>e.g.</em> a score of 20 means that it is likely by 1% that one base is incorrect. See <a href="https://en.wikipedia.org/wiki/Phred_quality_score">here</a> for more information.</li>
            <li>This is an unsolved technical issue of the sequencing machines. The longer the sequences are the more likely are errors. See <a href="https://www.ecseq.com/support/ngs/why-does-the-sequence-quality-decrease-over-the-read-in-illumina">here</a> for more information.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<h1 id="trimming-and-clipping-reads">Trimming and clipping <span class="notranslate">reads</span></h1>

<p>It is often necessary to trim a sequenced read to remove bases sequenced with high uncertainty (<em>i.e.</em> low-quality bases). In addition, artificial adaptor sequences used in library preparation protocols need to be removed before attempting to align the <span class="notranslate">reads</span> to a reference genome.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-trimming-and-clipping-reads"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Trimming and clipping <span class="notranslate">reads</span></h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.0" title="Tested with toolshed.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.0"><strong>Trimmomatic</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/pjbriggs/trimmomatic/trimmomatic/0.38.0</span></span> : Run Trimmomatic to trim low-quality <span class="notranslate">reads</span>.
      <ul>
        <li><em>‚ÄúSingle-end or paired-end <span class="notranslate">reads</span>?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Single-end</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúInput FASTQ file‚Äù</em>: Select all of the FASTQ files</li>
        <li><em>‚ÄúPerform initial ILLUMINACLIP?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><em>‚ÄúSelect Trimmomatic operation to perform‚Äù</em>: <code class="language-plaintext highlighter-rouge">Sliding window trimming (SLIDINGWINDOW)</code></li>
        <li><em>‚ÄúNumber of bases to average across‚Äù</em>: <code class="language-plaintext highlighter-rouge">4</code></li>
        <li><em>‚ÄúAverage quality required‚Äù</em>: <code class="language-plaintext highlighter-rouge">20</code></li>
      </ul>

      <blockquote class="tip">
        <h3 id="tip-tip-changing-datatypes"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing datatypes</h3>

        <p>If the FASTQ files cannot be selected, check whether their format is FASTQ with Sanger-scaled quality values (<em>fastqsanger</em>). If not, you can edit the data type by clicking on the pencil symbol next to a file in the history, clicking the ‚ÄúDatatype‚Äù tab, and choosing <em>fastqsanger</em> as the ‚ÄúNew Type‚Äù.</p>
      </blockquote>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+galaxy1"><strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/fastqc/fastqc/0.72+<span class="notranslate">galaxy</span>1</span></span> : Rerun FastQC on each trimmed/clipped FASTQ file to determine whether low-quality and adaptor sequences were correctly removed.
      <ul>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúShort read data from your current history‚Äù</em>: The output of Trimmomatic.</li>
      </ul>

      <blockquote class="question">
        <h3 id="question-questions-2"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>How did the range of read lengths change after trimming/clipping?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-2"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>Before trimming, all the <span class="notranslate">reads</span> were the same length, which reflected the number of rounds of nucleotide incorporation in the sequencing experiment. After trimming, read lengths span a range of values reflecting different lengths of the actual <span class="notranslate">DNA</span> fragments captured during the ChIP experiement.</li>
          </ol>
        </blockquote>
      </blockquote>

      <figure id="figure-2"><img src="../../images/tal1/fastqc_after.png" alt="fastqafter" /><figcaption><span class="figcaption-prefix">Figure 2:</span> Sequence quality per base generated by FastQC after end trimming.</figcaption></figure>
    </li>
  </ol>
</blockquote>

<h1 id="aligning-reads-to-a-reference-genome">Aligning <span class="notranslate">reads</span> to a reference genome</h1>

<p>To determine where <span class="notranslate">DNA</span> fragments originated from in the genome, the sequenced <span class="notranslate">reads</span> must be aligned to a reference genome. This is equivalent to solving a jigsaw puzzle, but unfortunately, not all pieces are unique. In principle, you could do a BLAST analysis to figure out where the sequenced pieces fit best in the known genome. Aligning millions of short sequences this way, however, can take a couple of weeks.
Nowadays, there are many read alignment programs for sequenced <span class="notranslate">DNA</span>, BWA being one of them. You can read more about the BWA algorithm and tool <a href="https://academic.oup.com/bioinformatics/article-lookup/doi/10.1093/bioinformatics/btp324">here</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-aligning-reads-to-a-reference-genome"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Aligning <span class="notranslate">reads</span> to a reference genome</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa/0.7.17.4" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/bwa/bwa/0.7.17.4"><strong>BWA</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/bwa/bwa/0.7.17.4</span></span> : Run BWA to map the trimmed/clipped <span class="notranslate">reads</span> to the mouse genome.
      <ul>
        <li><em>‚ÄúWill you select a reference genome‚Ä¶‚Äú</em>: <code class="language-plaintext highlighter-rouge">Use a built-in genome index</code></li>
        <li><em>‚ÄúUsing reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">Mouse (mus musculus) mm10</code></li>
        <li><em>‚ÄúSelect input type‚Äù</em>: <code class="language-plaintext highlighter-rouge">Single fastq</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúSelect fastq dataset‚Äù</em>: Select all of the trimmed FASTQ files</li>
      </ul>
    </li>
    <li>
      <p>Rename files to reflect the origin and contents.</p>

      <blockquote class="tip">

        <h3 id="tip-tip-renaming-a-dataset"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Renaming a dataset</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, change the <strong>Name</strong> field</li>
          <li>Click the <strong>Save</strong> button</li>
        </ul>
      </blockquote>
    </li>
    <li>
      <p>Inspect a file produced by BWA.</p>

      <blockquote class="question">
        <h3 id="question-questions-3"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What datatype is the BWA output file?</li>
          <li>How many <span class="notranslate">reads</span> were mapped from each file?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-3"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>The output is a BAM file.</li>
            <li>Check the number of lines for each file in your history. This gives you a rough estimate.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.3" title="Tested with toolshed.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.3"><strong>Samtools idxstats</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/devteam/samtools_idxstats/samtools_idxstats/2.0.3</span></span> : Run idxstats to get statistics of the BWA alignments.
      <ul>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúBAM file‚Äù</em>: Select all of the mapped BAM files</li>
      </ul>
    </li>
    <li>
      <p>Examine the output (<i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span>)</p>

      <blockquote class="question">
        <h3 id="question-questions-4"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What does each column in the output represent (<strong>Tip</strong>: look at the Tool Form)?</li>
          <li>How many <span class="notranslate">reads</span> were mapped to chromosome 19 in each experiment?</li>
          <li>If the mouse genome has 21 pairs of chromosomes, what are the other reference chromosomes (<em>e.g.</em> chr1_GL456210_random)?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-4"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>Column 1: Reference sequence identifier
Column 2: Reference sequence length
Column 3: Number of mapped <span class="notranslate">reads</span>
Column 4: Number of placed but unmapped <span class="notranslate">reads</span> (typically unmapped partners of mapped <span class="notranslate">reads</span>)</li>
            <li>This information can be seen in column 3, <em>e.g.</em> for Megakaryocyte_Tal1_R1 2143352 <span class="notranslate">reads</span> are mapped. Your answer might be slightly different if different references or tool versions are used.</li>
            <li>Some of these other reference sequences are parts of chromosomes but it is unclear where exactly, <em>e.g.</em> chr1_GL456210_random is a part of chromosome 1. There are entries like <code class="language-plaintext highlighter-rouge">chrUn</code> that are not associated with a chromosome but it is believed that they are part of the genome.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<h1 id="assessing-correlation-between-samples">Assessing correlation between samples</h1>

<p>To assess the similarity between the replicates sequencing datasets, it is a common technique to calculate the correlation of read counts for the different samples.</p>

<p>We expect that the replicate samples will cluster more closely to each other than to other samples. We will be use tools from the package deepTools for the next few steps. More information on deepTools can be found <a href="https://deeptools.readthedocs.io/en/latest/content/list_of_tools.html">here</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-assessing-correlation-between-samples"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Assessing correlation between samples</h3>

  <p>multiBamSummary splits the reference genome into bins of equal size and counts the number of <span class="notranslate">reads</span> in each bin from each sample. We set a small bin size here because we are working with a subset of <span class="notranslate">reads</span> that align to only a fraction of the genome.</p>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_multi_bam_summary/deeptools_multi_bam_summary/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_multi_bam_summary/deeptools_multi_bam_summary/3.3.2.0.0"><strong>multiBamSummary</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_multi_bam_summary/deeptools_multi_bam_summary/3.3.2.0.0</span></span> : Run multiBamSummary to get read coverage of the alignments.
      <ul>
        <li><em>‚ÄúSample order matters‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúBam files‚Äù</em>: Select all of the aligned BAM files</li>
        <li><em>‚ÄúBin size in bp‚Äù</em>: 1000</li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_correlation/deeptools_plot_correlation/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_correlation/deeptools_plot_correlation/3.3.2.0.0"><strong>plotCorrelation</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_plot_correlation/deeptools_plot_correlation/3.3.2.0.0</span></span> : Run plotCorrelation to visualize the results.
      <ul>
        <li><em>‚ÄúMatrix file from the multiBamSummary tool‚Äù</em>: Select the multiBamSummary output file</li>
        <li><em>‚ÄúCorrelation method‚Äù</em>: <code class="language-plaintext highlighter-rouge">Pearson</code></li>
        <li><em>‚ÄúPlotting type‚Äù</em>: <code class="language-plaintext highlighter-rouge">Heatmap</code></li>
        <li><em>‚ÄúPlot the correlation value‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúSkip zeros‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúRemove regions with very large counts‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>

      <p>Feel free to play around with these parameter settings!</p>

      <blockquote class="question">
        <h3 id="question-questions-5"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>Why do we want to skip zeros in <strong>plotCorrelation</strong>?</li>
          <li>What happens if the Spearman‚Äôs correlation method is used instead of the Pearson method?</li>
          <li>What does the output of making a Scatterplot instead of a Heatmap look like?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-5"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>Large areas of zeros would lead to a correlation of these areas. The information we would get out of this computation would be meaningless.</li>
            <li>The clusters are different, <em>e.g.</em> Megakaryocyte_input_R2 and G1E_input_R2 are clustered together. <a href="http://support.minitab.com/en-us/minitab-express/1/help-and-how-to/modeling-statistics/regression/supporting-topics/basics/a-comparison-of-the-pearson-and-spearman-correlation-methods/"> More information about Pearson and Spearman‚Äôs correlation. </a></li>
            <li>Try making a Scatterplot to see for yourself!</li>
          </ol>
        </blockquote>
      </blockquote>

      <figure id="figure-3"><img src="../../images/tal1/plotCorrelation_heatmap_pearson_1kb.png" alt="heatmap" /><figcaption><span class="figcaption-prefix">Figure 3:</span> Heatmap of correlation matrix generated by plotCorrelation.</figcaption></figure>
    </li>
  </ol>
</blockquote>

<p>Additional information on how to interpret plotCorrelation plots can be found <a href="https://deeptools.readthedocs.io/en/latest/content/tools/plotCorrelation.html#background">here</a>.</p>

<h1 id="assessing-ip-strength">Assessing IP strength</h1>

<p>We will now evaluate the quality of the immunoprecipitation step in the ChIP-seq protocol.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-assessing-ip-strength"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Assessing IP strength</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_fingerprint/deeptools_plot_fingerprint/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_fingerprint/deeptools_plot_fingerprint/3.3.2.0.0"><strong>plotFingerprint</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_plot_fingerprint/deeptools_plot_fingerprint/3.3.2.0.0</span></span> : Run plotFingerprint to assess ChIP signal strength.
      <ul>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúBam files‚Äù</em>: Select all of the aligned BAM files for the G1E cell type</li>
        <li><em>‚ÄúShow advanced options‚Äù</em>: <code class="language-plaintext highlighter-rouge">yes</code></li>
        <li><em>‚ÄúBin size in bases‚Äù</em>: <code class="language-plaintext highlighter-rouge">100</code></li>
        <li><em>‚ÄúSkip zeros‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li>
      <p>Rerun plotFingerprint for the Megakaryocyte cell type.</p>
    </li>
    <li>
      <p>View the output images.</p>

      <figure id="figure-4"><img src="../../images/tal1/plotFingerprint_graph_v2.png" alt="fingerprintimage" /><figcaption><span class="figcaption-prefix">Figure 4:</span> Strength of immunoprecipitation of TAL1.</figcaption></figure>

      <blockquote class="question">
        <h3 id="question-questions-6"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What does this graph in Figure 10 represent?</li>
          <li>How do (or should) input datasets differ from IP datasets?</li>
          <li>What do you think about the quality of the IP for this experiment?</li>
          <li>How does the quality of the IP for megakaryocytes compare to G1E cells?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-6"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>It shows us how good the ChIP Signal compared to the control signal is. An ideal control (input) with perfect uniform distribution of <span class="notranslate">reads</span> along the genome (<em>i.e.</em> without enrichment in open chromatin etc.) and infinite sequencing coverage should generate a straight diagonal line. A very specific and strong ChIP enrichment will be indicated by a prominent and steep rise of the cumulative sum towards the highest rank.</li>
            <li>We expect that the control (input) signal is more or less uniform distributed over the genome (<em>e.g.</em> like the green line in the image above). The IP dataset should look more like the red line but it would be better if the values for IP start to increase at around 0.8 on the x-axis.</li>
            <li>The enrichment did not work as it should. Compare the blue line with the red one! For your future experiments: You can never have enough replicates!</li>
            <li>The quality of megakaryocytes is better then G1E.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<p>Additional information on how to interpret plotFingerprint plots can be found <a href="https://deeptools.readthedocs.io/en/latest/content/tools/plotFingerprint.html#background">here</a>.</p>

<h1 id="determining-tal1-binding-sites">Determining TAL1 binding sites</h1>

<p>Now that BWA has aligned the <span class="notranslate">reads</span> to the genome, we will use the tool MACS2 to identify regions of TAL1 occupancy, which are called ‚Äúpeaks‚Äù. Peaks are determined from pileups of sequenced <span class="notranslate">reads</span> across the genome that correspond to where TAL1 binds.</p>

<p>MACS2 will perform two tasks:</p>
<ol>
  <li>Identify regions of TAL1 occupancy (peaks).</li>
  <li>Generate <span class="notranslate">bed</span>Graph files for visual inspection of the data on a genome browser.</li>
</ol>

<p>More information about MACS2 can be found in <a class="citation" href="#Zhang_2008">Zhang <i>et al.</i> 2008</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-determining-tal1-binding-sites"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Determining TAL1 binding sites</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6"><strong>MACS2 callpeak</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/macs2/macs2_callpeak/2.1.1.20160309.6</span></span> : Run MACS2 callpeak with the aligned read files from the previous step as Treatment (TAL1) and Control (input).
      <ul>
        <li><em>‚ÄúAre you pooling Treatment Files?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúChIP-Seq Treatment File‚Äù</em>: Select all of the replicate ChIP-Seq treatment aligned BAM files for one cell type</li>
        <li><em>‚ÄúDo you have a Control File?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúAre you pooling Control Files?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúChIP-Seq Control File‚Äù</em>: Select replicate ChIP-Seq control aligned BAM files for the same cell type</li>
        <li><em>‚ÄúFormat of Input Files‚Äù</em>: <code class="language-plaintext highlighter-rouge">Single-end BAM</code></li>
        <li><em>‚ÄúEffective genome size‚Äù</em>: <code class="language-plaintext highlighter-rouge">M. musculus</code></li>
        <li><em>‚ÄúAdditional Outputs‚Äù</em>: Select <code class="language-plaintext highlighter-rouge">Peaks as tabular file (compatible wih MultiQC)</code>, <code class="language-plaintext highlighter-rouge">Peak summits</code>, <code class="language-plaintext highlighter-rouge">Scores in <span class="notranslate">bed</span>Graph files (--bdg)</code></li>
      </ul>
    </li>
    <li>
      <p>Rename files to reflect the origin and contents.</p>
    </li>
    <li>Repeat for the other cell type.</li>
  </ol>
</blockquote>

<h1 id="inspection-of-peaks-and-aligned-data">Inspection of peaks and aligned data</h1>

<p>It is critical to visualize NGS data on a genome browser after alignment to evaluate the ‚Äúgoodness‚Äù of the analysis. Evaluation criteria will differ for various NGS experiment types, but for ChIP-seq data we want to ensure <span class="notranslate">reads</span> from a Treatment/IP sample are enriched at peaks and do not localize non-specifically (like the control/input condition).</p>

<p>MACS2 generates <span class="notranslate">bed</span>Graph and <span class="notranslate">BED</span> files that we will use to visualize read abundance and peaks, respectively, at regions MACS2 determines to be TAL1 peaks using <span class="notranslate">Galaxy</span>‚Äôs in-house genome browser, Trackster.</p>

<h2 id="inspection-of-peaks-and-aligned-data-with-trackster">Inspection of peaks and aligned data with Trackster</h2>

<p>We will import a gene annotation file so we can visualize aligned <span class="notranslate">reads</span> and TAL1 peaks relative to gene features and positions.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-inspecting-peaks-and-aligned-data-with-trackster"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Inspecting peaks and aligned data with Trackster</h3>

  <ol>
    <li>
      <p>Import gene annotations file from Zenodo <a href="https://doi.org/10.5281/zenodo.197100"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.197100.svg" alt="DOI" /></a></p>
    </li>
    <li>
      <p>Click ‚ÄúVisualize‚Äù on the page header and select ‚ÄúCreate Visualization‚Äù</p>

      <figure id="figure-5"><img src="../../images/tal1/create-visualization.png" alt="vizbutton" /><figcaption><span class="figcaption-prefix">Figure 5:</span> Trackster can be accessed from the Visualize button at the top of the screen.</figcaption></figure>
    </li>
    <li>Set up Trackster
      <ul>
        <li>Select Trackster</li>
        <li><em>‚ÄúSelect a dataset to visualize‚Äù</em>: Select the imported gene annotation file (<strong>Tip</strong>: if this file doesn‚Äôt appear as an option, go back to the history and edit the attribute Database/Build to be <code class="language-plaintext highlighter-rouge">mm10</code>)</li>
        <li>Click ‚ÄúCreate Visualization‚Äù</li>
      </ul>
    </li>
    <li>Configure the visualization
      <ul>
        <li>Select ‚ÄúView in new visualization‚Äù</li>
        <li><em>‚ÄúBrowser name‚Äù</em>: Enter a name for your visualization</li>
        <li><em>‚ÄúReference genome build (dbkey):‚Äù</em>: <code class="language-plaintext highlighter-rouge">mm10</code></li>
        <li>Click ‚ÄúCreate‚Äù</li>
      </ul>

      <figure id="figure-6"><img src="../../images/tal1/configure-visualization.png" alt="tracksterdb" /><figcaption><span class="figcaption-prefix">Figure 6:</span> Assign session name and reference genome.</figcaption></figure>
    </li>
    <li>Add tracks to Trackster
      <ul>
        <li>Click the ‚ÄúAdd tracks‚Äù (plus sign) button at the top right</li>
        <li>Using the search bar, search for and add the following tracks from MACS2 callpeak output to your view
          <ul>
            <li>G1E Treatment <span class="notranslate">bed</span>Graph</li>
            <li>G1E Control <span class="notranslate">bed</span>Graph</li>
            <li>G1E narrow peaks</li>
            <li>Megakaryocytes Treatment <span class="notranslate">bed</span>Graph</li>
            <li>Megakaryocytes Control <span class="notranslate">bed</span>Graph</li>
            <li>Megakaryocytes narrow peaks</li>
          </ul>
        </li>
        <li>Rename the tracks, if desired</li>
        <li>Play around with the track configurations, for example the color or the display mode</li>
      </ul>

      <figure id="figure-7"><img src="../../images/tal1/add-tracks.png" alt="tracksterselect" /><figcaption><span class="figcaption-prefix">Figure 7:</span> Select data from the history to view in Trackster.</figcaption></figure>
    </li>
    <li>
      <p>Navigate to the <em>Runx1</em> locus (<code class="language-plaintext highlighter-rouge">chr16:92501466-92926074</code>) to inspect the aligned <span class="notranslate">reads</span> and TAL1 peaks.</p>

      <blockquote class="question">
        <h3 id="question-questions-7"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What do you see at the <em>Runx1</em> locus in Trackster?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-7"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>Directly <span class="notranslate">upstream</span> of the shorter <em>Runx1</em> gene models is a cluster of 3 TAL1 peaks that only appear in the G1E cell type, but not in Megakaryocytes. Further <span class="notranslate">upstream</span>, there are some shared TAL1 peaks in both cell types.</li>
          </ol>
        </blockquote>
      </blockquote>

      <figure id="figure-8"><img src="../../images/tal1/Trackster_Runx1_locus.png" alt="runx1" /><figcaption><span class="figcaption-prefix">Figure 8:</span> The Runx1 locus with TAL1 peaks identified.</figcaption></figure>
    </li>
  </ol>
</blockquote>

<h2 id="inspection-of-peaks-and-aligned-data-with-igv">Inspection of peaks and aligned data with IGV</h2>
<p>We show here an alte<span class="notranslate">rna</span>tive to Trackster, <a href="http://software.broadinstitute.org/software/igv/">IGV</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-inspecting-peaks-with-igv"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Inspecting peaks with IGV</h3>

  <ol>
    <li>Open IGV on your local computer.</li>
    <li>Click on each narrow peaks result file from the MACS2 computations on ‚Äúdisplay with IGV‚Äù ‚Äì&gt; ‚Äúlocal Mouse mm10‚Äù</li>
    <li>For more information about IGV see <a href="/training-material/topics/introduction/tutorials/igv-introduction/tutorial.html">here</a></li>
  </ol>
</blockquote>

<h1 id="identifying-unique-and-common-tal1-peaks-between-stages">Identifying unique and common TAL1 peaks between stages</h1>

<p>We have processed ChIP-seq data from two stages of hematopoiesis and have lists of TAL1-occupied sites (peaks) in both cellular states. The next analysis step is to identify TAL1 peaks that are <em>shared</em> between the two cellular states and peaks that are <em>specific</em> to either cellular state.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-identifying-unique-and-common-tal1-peaks-between-states"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Identifying unique and common TAL1 peaks between states</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.29.0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.29.0"><strong><span class="notranslate">bed</span>tools Intersect intervals</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/<span class="notranslate">bed</span>tools/<span class="notranslate">bed</span>tools_intersectbed/2.29.0</span></span> : Run <span class="notranslate">bed</span>tools Intersect intervals to find peaks that exist both in G1E and megakaryocytes.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile A to intersect with B‚Äù</em>: Select the TAL1 G1E narrow peaks <span class="notranslate">BED</span> file</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile B to intersect with A‚Äù</em>: Select the TAL1 Megakaryocytes narrow peaks <span class="notranslate">BED</span> file</li>
        <li>Running this tool with the default settings will return overlapping peaks of both files.</li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.29.0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.29.0"><strong><span class="notranslate">bed</span>tools Intersect intervals</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/<span class="notranslate">bed</span>tools/<span class="notranslate">bed</span>tools_intersectbed/2.29.0</span></span> : Run <span class="notranslate">bed</span>tools Intersect intervals to find peaks that exist only in G1E.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile A to intersect with B‚Äù</em>: Select the TAL1 G1E narrow peaks <span class="notranslate">BED</span> file</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile B to intersect with A‚Äù</em>: Select the TAL1 Megakaryocytes narrow peaks <span class="notranslate">BED</span> file</li>
        <li><em>‚ÄúReport only those alignments that **do not** overlap the <span class="notranslate">BED</span> file‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.29.0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/bedtools/bedtools_intersectbed/2.29.0"><strong><span class="notranslate">bed</span>tools Intersect intervals</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/<span class="notranslate">bed</span>tools/<span class="notranslate">bed</span>tools_intersectbed/2.29.0</span></span> : Run <span class="notranslate">bed</span>tools Intersect intervals to find peaks that exist only in megakaryocytes.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile A to intersect with B‚Äù</em>: Select the TAL1 Megakaryocytes narrow peaks <span class="notranslate">BED</span> file</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile B to intersect with A‚Äù</em>: Select the TAL1 G1E narrow peaks <span class="notranslate">BED</span> file</li>
        <li><em>‚ÄúReport only those alignments that **do not** overlap the <span class="notranslate">BED</span> file‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li>
      <p>Rename files to reflect the origin and contents.</p>

      <blockquote class="question">
        <h3 id="question-questions-8"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>How many TAL1 peaks are common to both G1E cells and megakaryocytes?</li>
          <li>How many are unique to G1E cells?</li>
          <li>How many are unique to megakaryocytes?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-8"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>1 peak (answer may vary depending on references and tool versions used)</li>
            <li>407 peaks (answer may vary depending on references and tool versions used)</li>
            <li>139 peaks (answer may vary depending on references and tool versions used)</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<h1 id="generating-input-normalized-coverage-files">Generating Input normalized coverage files</h1>

<p>We will generate Input normalized coverage (bigWig) files for the ChIP samples, using the bamCompare tool from deepTools2. bamCompare provides multiple options to compare the two files (<em>e.g.</em> log2ratio, subtraction). We will use log2 ratio of the ChIP samples over Input.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generating-input-normalized-bigwigs"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generating input-normalized bigwigs</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.3.2.0.0"><strong>bamCompare</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_bam_compare/deeptools_bam_compare/3.3.2.0.0</span></span> : Run bamCompare to get the log2 read ratios between treatment and control samples.
      <ul>
        <li><em>‚ÄúFirst BAM/CRAM file (</em>e.g.* treated sample)‚Äù*: Select the Megakaryocyte TAL1 aligned BAM file for replicate 1 (R1)</li>
        <li><em>‚ÄúSecond BAM/CRAM file (</em>e.g.* control sample)‚Äù*: Select the Megakaryocyte input aligned BAM file for replicate 1 (R1)</li>
        <li><em>‚ÄúHow to compare the two files‚Äù</em>: <code class="language-plaintext highlighter-rouge">Compute log2 of the number of <span class="notranslate">reads</span></code></li>
      </ul>
    </li>
    <li>Repeat this step for all treatment and control samples:
      <ul>
        <li>Megakaryocyte TAL1 aligned BAM R2 and Megakaryocyte input aligned BAM R2</li>
        <li>G1E TAL1 aligned BAM R1 and G1E input aligned BAM R1</li>
        <li>G1E TAL1 aligned BAM R2 and G1E input aligned BAM R2</li>
      </ul>
    </li>
    <li>Rename files to reflect the origin and contents.</li>
  </ol>
</blockquote>

<h1 id="plot-the-signal-on-the-peaks-between-samples">Plot the signal on the peaks between samples</h1>

<p>Plotting your region of interest will involve using two tools from the deepTools suite:</p>
<ul>
  <li>computeMatrix: Computes the signal on given regions, using the bigwig coverage files from different samples.</li>
  <li>plotHeatmap: Plots heatMap of the signals using the computeMatrix output.</li>
</ul>

<p>Optionally, you can use plotProfile to create a profile plot using to computeMatrix output.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-calculating-signal-matrix-on-macs2-output"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Calculating signal matrix on MACS2 output</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0"><strong>computeMatrix</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_compute_matrix/deeptools_compute_matrix/3.3.2.0.0</span></span> : Run computeMatrix to prepare data for plotting a heatmap of TAL1 peaks.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>Select Regions</em> &gt; <em>‚ÄúRegions to plot‚Äù</em>: Select the MACS2 narrow peaks files for G1E cells (TAL1 over Input)</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúScore file‚Äù</em>: Select the bigWig files for the G1E cells (log2 ratios from bamCompare)</li>
        <li><em>‚ÄúcomputeMatrix has two main output options‚Äù</em>: <code class="language-plaintext highlighter-rouge">reference-point</code></li>
        <li><em>‚ÄúThe Reference point for plotting‚Äù</em>: <code class="language-plaintext highlighter-rouge">center of region</code></li>
        <li><em>‚ÄúDistance <span class="notranslate">upstream</span> of the start site of the regions defined in the region file‚Äù</em>: <code class="language-plaintext highlighter-rouge">5000</code></li>
        <li><em>‚ÄúDistance <span class="notranslate">downstream</span> of the end site of the given regions‚Äù</em>: <code class="language-plaintext highlighter-rouge">5000</code></li>
        <li><em>‚ÄúShow advanced options‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúConvert missing values ot zero‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúSkip zeros‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li>Repeat for Megakaryoctes.</li>
  </ol>
</blockquote>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-plotting-a-heatmap-of-tal1-peaks"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Plotting a heatmap of TAL1 peaks</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1"><strong>plotHeatmap</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_plot_heatmap/deeptools_plot_heatmap/3.3.2.0.1</span></span> : Run plotHeatmap to create a heatmap for score distributions across TAL1 peak genomic regions in each cell type.
      <ul>
        <li><em>‚ÄúMatrix file from the computeMatrix tool‚Äù</em>: Select the computeMatrix output for G1E cells</li>
        <li><em>‚ÄúShow advanced options‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúLabels for the samples (each bigwig) plotted‚Äù</em>: Enter sample labels in the order you added them in computeMatrix, separated by spaces.</li>
      </ul>
    </li>
    <li>Repeat for Megakaryocytes.</li>
  </ol>

  <p>The outputs should look similar to this:</p>

  <p><img src="../../images/tal1/TAL1-plotheatmap.png" alt="hm" /></p>
</blockquote>

<h1 id="additional-optional-analyses">Additional optional analyses</h1>

<h2 id="assessing-gc-bias">Assessing GC bias</h2>

<p>A common problem of PCR-based protocols is the observation that GC-rich regions tend to be amplified more readily than GC-poor regions.</p>

<p>We will now check whether the samples have more <span class="notranslate">reads</span> from regions of the genome with high GC.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-assessing-gc-bias"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Assessing GC bias</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_gc_bias/deeptools_compute_gc_bias/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_compute_gc_bias/deeptools_compute_gc_bias/3.3.2.0.0"><strong>computeGCbias</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_compute_gc_bias/deeptools_compute_gc_bias/3.3.2.0.0</span></span> : Run computeGCbias to determine the GC bias of the sequenced <span class="notranslate">reads</span>.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúBam file‚Äù</em>: Select an aligned BAM file</li>
        <li><em>‚ÄúReference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">locally cached</code></li>
        <li><em>‚ÄúUsing reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">mm10</code></li>
        <li><em>‚ÄúEffective genome size‚Äù</em>: <code class="language-plaintext highlighter-rouge">user specified</code></li>
        <li><em>‚ÄúEffective genome size‚Äù</em>: <code class="language-plaintext highlighter-rouge">10000000</code></li>
        <li><em>‚ÄúFragment length used for the sequencing‚Äù</em>: <code class="language-plaintext highlighter-rouge">50</code></li>
      </ul>

      <blockquote class="question">
        <h3 id="question-questions-9"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>Why would we worry more about checking for GC bias in an input file?</li>
          <li>Does this dataset have a GC bias?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-9"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>In an input ChIP-seq file, the expectation is that <span class="notranslate">DNA</span> fragments are uniformly sampled from the genome. This is in contrast to an IP ChIP-seq file where it is expected that certain genomic regions contain more <span class="notranslate">reads</span> (<em>i.e.</em> regions that are bound by the protein that is immunopurified). Therefore, non-uniformity of <span class="notranslate">reads</span> in the input sample could be a result of GC-bias, whereby more GC-rich fragments are preferentially amplified during PCR.</li>
            <li>To answer this question, run the computeGCbias tool as described above and check out the results. What do YOU think? For more examples and information on how to interpret the results, check out the tool usage documentation <a href="https://deeptools.readthedocs.io/en/latest/content/tools/computeGCBias.html#background">here</a>.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
    <li>
      <p><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_correct_gc_bias/deeptools_correct_gc_bias/3.3.2.0.0" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/deeptools_correct_gc_bias/deeptools_correct_gc_bias/3.3.2.0.0"><strong>correctGCbias</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/deeptools_correct_gc_bias/deeptools_correct_gc_bias/3.3.2.0.0</span></span> : Run correctGCbias to generate GC-corrected BAM/CRAM files.</p>

      <blockquote class="question">
        <h3 id="question-questions-10"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</h3>

        <ol>
          <li>What does the tool correctGCbias do?</li>
          <li>What is the output of this tool?</li>
          <li>What are some caveats to be aware of if using the output of this tool in <span class="notranslate">downstream</span> analyses?</li>
        </ol>

        <blockquote class="solution">
          <h3 id="solution-solution-10"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <ol>
            <li>The correctGCbias tool removes <span class="notranslate">reads</span> from regions with higher coverage than expected (typically corresponding to GC-rich regions) and adds <span class="notranslate">reads</span> to regions with lower coverage than expected (typically corresponding to AT-rich regions).</li>
            <li>The output of this tool is a GC-corrected file in BAM, bigWig, or <span class="notranslate">bed</span>Graph format.</li>
            <li>The GC-corrected output file likely contains duplicated <span class="notranslate">reads</span> in low-coverage regions where <span class="notranslate">reads</span> were added to match the expected read density. Therefore, it is necessary to avoid filtering or removing duplicate <span class="notranslate">reads</span> in any <span class="notranslate">downstream</span> analyses.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<p>Additional information on how to interpret computeGCbias plots can be found <a href="https://deeptools.readthedocs.io/en/latest/content/tools/computeGCBias.html">here</a>.</p>

<h1 class="no_toc" id="conclusion">Conclusion</h1>

<p>In this exercise you imported raw Illumina sequencing data, evaluated the quality before and after you trimmed <span class="notranslate">reads</span> with low confidence scores, aligned the trimmed <span class="notranslate">reads</span>, identified TAL1 peaks relative to the negative control (background), and visualized the aligned <span class="notranslate">reads</span> and TAL1 peaks relative to gene structures and positions. Additional, you assessed the ‚Äúgoodness‚Äù of the experiments by looking at metrics such as GC bias and IP enrichment.</p>


                    
                    <blockquote class="key_points">
                        <h3><i class="fas fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>
                        <ul>
                            
                            <li><p>Sophisticated analysis of ChIP-seq data is possible using tools hosted by Galaxy.</p>
</li>
                            
                            <li><p>Genomic dataset analyses require multiple methods of quality assessment to ensure that the data are appropriate for answering the biology question of interest.</p>
</li>
                            
                            <li><p>By using the sharable and transparent Galaxy platform, data analyses can easily be shared and reproduced.</p>
</li>
                            
                        </ul>
                    </blockquote>
                    

                    

                    
                    <h1 id="bibliography">References</h1>
                    <ol class="bibliography"><li><span id="Zhang_2008">Zhang, Y., T. Liu, C. A. Meyer, J. Eeckhoute, D. S. Johnson <i>et al.</i>, 2008 <b>Model-based Analysis of ChIP-Seq (MACS)</b>. Genome Biology 9: R137.</span>
    
    
    <a href="https://doi.org/10.1186/gb-2008-9-9-r137">10.1186/gb-2008-9-9-r137</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li>
<li><span id="Wu_2014">Wu, W., C. S. Morrissey, C. A. Keller, T. Mishra, M. Pimkin <i>et al.</i>, 2014 <b>Dynamic shifts in occupancy by TAL1 are guided by GATA factors and drive large-scale reprogramming of gene expression during hematopoiesis</b>. Genome Research 24: 1945‚Äì1962.</span>
    
    
    <a href="https://doi.org/10.1101/gr.164830.113">10.1101/gr.164830.113</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li></ol>
                    

                    <h1>Feedback</h1>
                    <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">how it went</a>.</p>

                    <div id="feedback-button">
                        <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                    </div>
                    <div id="feedback-form">
                    </div>
                    <script type="text/javascript">
                        (function (window, document) {
                            function onDocumentReady(fn) {
                                if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                    fn();
                                } else {
                                    document.addEventListener('DOMContentLoaded', fn);
                                }
                            }

                            onDocumentReady(function () {
                                $("#feedback-button").click(function(evt){
                                    var e = $(evt.target)
                                    e.hide();

                                    $("#feedback-form").html(`
                                        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1) (Epigenetics)">Loading...</iframe>
                                    `)
                                })
                            });
                        })(window, document);
                    </script>



                    <h1>Citing this Tutorial</h1>
                    <p>
                        <ol>
                            <li id="citation-text">Mallory Freeberg, Mo Heydarian, Vivek Bhardwaj, Joachim Wolff, Anika Erxleben, 2021 <b>Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1) (Galaxy Training Materials)</b>. <a href="/training-material/topics/epigenetics/tutorials/tal1-binding-site-identification/tutorial.html">/training-material/topics/epigenetics/tutorials/tal1-binding-site-identification/tutorial.html</a> Online; accessed TODAY
                            </li>
                            <li>
                            Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                            </li>
                        </ol>
                    </p>


                    <blockquote class="details">
                      <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                      <p style="display: none;">

                    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{epigenetics-tal1-binding-site-identification,
    author = "Mallory Freeberg and Mo Heydarian and Vivek Bhardwaj and Joachim Wolff and Anika Erxleben",
    title = "Identification of the binding sites of the T-cell acute lymphocytic leukemia protein 1 (TAL1) (Galaxy Training Materials)",
    year = "2021",
    month = "01",
    day = "06"
    url = "\url{/training-material/topics/epigenetics/tutorials/tal1-binding-site-identification/tutorial.html}",
    note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
        doi = {10.1016/j.cels.2018.05.012},
        url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
        year = 2018,
        month = {jun},
        publisher = {Elsevier {BV}},
        volume = {6},
        number = {6},
        pages = {752--758.e1},
        author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and Bj√∂rn Gr√ºning},
        title = {Community-Driven Data Analysis Training for Biology},
        journal = {Cell Systems}
}</code>
                    </pre></div></div>
                    </p>
                    </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                </div>
            </div>
        </div>

        <h3><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Mallory Freeberg, Mo Heydarian, Vivek Bhardwaj, Joachim Wolff, Anika Erxleben)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/epigenetics/tutorials/tal1-binding-site-identification/tutorial.md">GitHub</a>.
        </p>
        <p>
    The content of the tutorials and website is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
