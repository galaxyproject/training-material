<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hands-on: Assembly of metagenomic sequencing data / Assembly of metagenomic sequencing data / Assembly</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@ee30569ed5e31b78b05a188eddba620db755a99d",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/assembly/tutorials/metagenomics-assembly/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" as="script" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.40d4e218.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Assembly of metagenomic sequencing data">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-11-20 00:06:40 +0000">
<meta name="DC.creator" content="Polina Polunina">
<meta name="DC.creator" content="Bérénice Batut"><meta name="description" content="DNA sequence data has become an indispensable tool for Molecular Biology & Evolutionary Biology. Study in these fields now require a genome sequence to work from. We call this a 'Reference Sequence.' We need to build a reference for each species. We do this by Genome Assembly. De novo Genome Assembly is the process of reconstructing the original DNA sequence from the fragment reads alone.">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Assembly / Assembly of metagenomic sequencing data / Hands-on: Assembly of metagenomic sequencing data">
        <meta property="og:description" content="DNA sequence data has become an indispensable tool for Molecular Biology & Evolutionary Biology. Study in these fields now require a genome sequence to work from. We call this a 'Reference Sequence.' We need to build a reference for each species. We do this by Genome Assembly. De novo Genome Assembly is the process of reconstructing the original DNA sequence from the fragment reads alone.">
        <meta property="og:image" content="https://galaxy-training.s3.amazonaws.com/social/topics/assembly/tutorials/metagenomics-assembly/tutorial.png">
	<script type="application/ld+json">


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": [
    {
      "@type": "CreativeWork",
      "name": "Galaxy Training: A Powerful Framework for Teaching!",
      "url": "https://doi.org/10.1371/journal.pcbi.1010752"
    },
    {
      "@type": "CreativeWork",
      "name": "Community-Driven Data Analysis Training for Biology",
      "url": "https://doi.org/10.1016/j.cels.2018.05.012"
    }
  ],
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Assembly of metagenomic sequencing data",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "provider": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "dateModified": "2024-11-20 00:06:40 +0000",
  "datePublished": "2024-11-20 00:06:40 +0000",
  "copyrightHolder": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "funder": [

  ],
  "funding": [
    {
      "@context": "https://schema.org",
      "@type": "Grant",
      "identifier": "2020-1-NL01-KA203-064717",
      "url": "https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717",
      "funder": {
        "@context": "https://schema.org",
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
          "@type": "CreativeWork"
        },
        "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
        "description": "This project ([`2020-1-NL01-KA203-064717`](https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717)) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n![eu flag with the text: with the support of the erasmus programme of the european union](https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg)\n![erasmus plus logo](https://www.erasmusplus.nl/assets/images/logo.png)\n",
        "url": "https://www.erasmusplus.nl",
        "logo": "https://gallantries.github.io/assets/images/gallantries-logo.png"
      },
      "startDate": "2020-09-01",
      "endDate": "2023-09-30"
    }
  ],
  "identifier": "https://gxy.io/GTN:T00035",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Assembly",
    "description": "DNA sequence data has become an indispensable tool for Molecular Biology & Evolutionary Biology. Study in these fields now require a genome sequence to work from. We call this a 'Reference Sequence.' We need to build a reference for each species. We do this by Genome Assembly. De novo Genome Assembly is the process of reconstructing the original DNA sequence from the fragment reads alone.",
    "url": "https://training.galaxyproject.org/training-material/topics/assembly/"
  },
  "abstract": "Metagenomics involves the extraction, sequencing and analysis of combined genomic DNA from **entire microbiome** samples. It includes then DNA from **many different organisms**, with different taxonomic background.",
  "learningResourceType": "e-learning",
  "name": "Assembly of metagenomic sequencing data",
  "url": "https://training.galaxyproject.org/training-material/topics/assembly/tutorials/metagenomics-assembly/tutorial.html",
  "version": 0,
  "timeRequired": "PT2H",
  "teaches": "- Describe what an assembly is\n- Describe what de-replication is\n- Explain the difference between co-assembly and individual assembly\n- Explain the difference between reads, contigs and scaffolds\n- Explain how tools based on De Bruijn graph work\n- Apply appropriate tools for analyzing the quality of metagenomic data\n- Construct and apply simple assembly pipelines on short read data\n- Apply appropriate tools for analyzing the quality of metagenomic assembly\n- Evaluate the Quality of the Assembly with Quast, Bowtie2, and CoverM-Genome",
  "keywords": [
    "Assembly",
    "assembly",
    "metagenomics",
    "microgalaxy"
  ],
  "description": "## Abstract\n\nMetagenomics involves the extraction, sequencing and analysis of combined genomic DNA from **entire microbiome** samples. It includes then DNA from **many different organisms**, with different taxonomic background.\n\n\n## About This Material\n\nThis is a Hands-on Tutorial from the GTN which is usable either for individual self-study, or as a teaching material in a classroom.\n\n\n## Questions this  will address\n\n - Why metagenomic data should be assembled?\n - What is the difference between co-assembly and individual assembly?\n - What is the difference between reads, contigs and scaffolds?\n - How tools based on De Bruijn graph work?\n - How to assess the quality of metagenomic data assembly?\n\n\n## Learning Objectives\n\n- Describe what an assembly is\n- Describe what de-replication is\n- Explain the difference between co-assembly and individual assembly\n- Explain the difference between reads, contigs and scaffolds\n- Explain how tools based on De Bruijn graph work\n- Apply appropriate tools for analyzing the quality of metagenomic data\n- Construct and apply simple assembly pipelines on short read data\n- Apply appropriate tools for analyzing the quality of metagenomic assembly\n- Evaluate the Quality of the Assembly with Quast, Bowtie2, and CoverM-Genome\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html",
      "name": "Quality Control",
      "description": "Slides for 'Quality Control' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html",
      "name": "Quality Control",
      "description": "Hands-on for 'Quality Control' tutorial",
      "learningResourceType": "e-learning",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    }
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/plushz/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/plushz/",
      "name": "Polina Polunina",
      "image": "https://avatars.githubusercontent.com/plushz",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/uni-freiburg/",
          "name": "University of Freiburg",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.uni-freiburg.de/"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-0507-4602",
      "orcid": "https://orcid.org/0000-0002-0507-4602"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "name": "Bérénice Batut",
      "image": "https://avatars.githubusercontent.com/bebatut",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/ifb/",
          "name": "Institut Français de Bioinformatique",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.france-bioinformatique.fr/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9852-1987",
      "orcid": "https://orcid.org/0000-0001-9852-1987"
    }
  ],
  "contributor": [

  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Assembly",
      "description": "DNA sequence data has become an indispensable tool for Molecular Biology & Evolutionary Biology. Study in these fields now require a genome sequence to work from. We call this a 'Reference Sequence.' We need to build a reference for each species. We do this by Genome Assembly. De novo Genome Assembly is the process of reconstructing the original DNA sequence from the fragment reads alone.",
      "url": "https://training.galaxyproject.org/training-material/topics/assembly/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0196",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0196",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0196"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3174",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3174",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3174"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [
    {
      "@type": "Thing",
      "url": "https://training.galaxyproject.org/training-material/topics/assembly/tutorials/metagenomics-assembly/workflows/",
      "name": "Associated Workflows"
    },
    {
      "@type": "Thing",
      "url": "https://zenodo.org/record/7818827",
      "name": "Associated Training Datasets"
    }
  ]
}</script></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/assembly" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Assembly
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/assembly/faqs/" title="Check our FAQs for the Assembly topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/assembly/tutorials/metagenomics-assembly/tutorial.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/assembly/tutorials/metagenomics-assembly/tutorial.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html">
                    <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-assembly">
    <h1 data-toc-skip>Assembly of metagenomic sequencing data</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/plushz/" class="contributor-badge contributor-plushz"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/plushz?s=36" alt="Polina Polunina avatar" width="36" class="avatar" />
    Polina Polunina</a><a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bebatut?s=36" alt="Bérénice Batut avatar" width="36" class="avatar" />
    Bérénice Batut</a>
		</td>
	</tr>
	

	

	

	

	

	

	

	

	

</table>


	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png" width="88" height="31"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>Why metagenomic data should be assembled?</p>
</li>
        
        <li><p>What is the difference between co-assembly and individual assembly?</p>
</li>
        
        <li><p>What is the difference between reads, contigs and scaffolds?</p>
</li>
        
        <li><p>How tools based on De Bruijn graph work?</p>
</li>
        
        <li><p>How to assess the quality of metagenomic data assembly?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Describe what an assembly is</p>
</li>
        
        <li><p>Describe what de-replication is</p>
</li>
        
        <li><p>Explain the difference between co-assembly and individual assembly</p>
</li>
        
        <li><p>Explain the difference between reads, contigs and scaffolds</p>
</li>
        
        <li><p>Explain how tools based on De Bruijn graph work</p>
</li>
        
        <li><p>Apply appropriate tools for analyzing the quality of metagenomic data</p>
</li>
        
        <li><p>Construct and apply simple assembly pipelines on short read data</p>
</li>
        
        <li><p>Apply appropriate tools for analyzing the quality of metagenomic assembly</p>
</li>
        
        <li><p>Evaluate the Quality of the Assembly with Quast, Bowtie2, and CoverM-Genome</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    
        
        
        
        <li>
          <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        </li>
        
    

    
        
        
        
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                            <li>
                              <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> Slides: Quality Control</a>
                            </li>
                        
                        
                            
                                <li>
                                  <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> Hands-on: Quality Control</a>
                                </li>
                            
                        
                    
                
                    
                
                    
                
            
        
    


        

        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 2 hours</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Level: </strong>
        


 Introductory <span class="visually-hidden">Introductory</span>
<span class="level introductory" title="Introductory Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/7818827">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/assembly/tutorials/metagenomics-assembly/workflows/" title="Assembly of metagenomic sequencing data workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            

            

            
            
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            











<li class="btn btn-default supporting_material">


  <!-- dropdown with all recordings -->
  <a href="/training-material/topics/assembly/tutorials/metagenomics-assembly/recordings/" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Latest recordings of this material in the GTN Video Library">
        <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span>&nbsp;Recordings
  </a>


  <ul class="dropdown-menu">
    

    
      
      
      
    <li><a class="dropdown-item" href="/training-material/topics/assembly/tutorials/metagenomics-assembly/recordings/index.html#tutorial-recording-2-may-2023" title="View the recording for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Tutorial (May 2023) - 1h</a>
    </li>
      
    
    <li><a class="dropdown-item" href="/training-material/topics/assembly/tutorials/metagenomics-assembly/recordings/" title="View all recordings for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> View All</a>
    </li>

  </ul>

  
</li>
  





            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
    
	<li class="dropdown-header">
		<b>Possibly Working</b>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.cz/" title="">
			UseGalaxy.cz
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.eu" title="">
			UseGalaxy.eu
		</a>
	</li>
    
    

    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Published:</strong> Nov 20, 2024 </div>
        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Nov 20, 2024 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            Tutorial Content is licensed under
            
              <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
            The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span> <abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00035">https://gxy.io/GTN:T00035</a> </div>
        

	
	

	
	
	<div><strong><i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">rating</span> Rating:</strong> <a href="#feedback-responses">5.0</a> (0 recent ratings, 1 all time)</div>
	
	<div><strong><i class="fas fa-code-commit" aria-hidden="true"></i><span class="visually-hidden">version</span> Revision:</strong> 0 </div>

    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <p>Metagenomics involves the extraction, sequencing and analysis of combined genomic DNA from <strong>entire microbiome</strong> samples. It includes then DNA from <strong>many different organisms</strong>, with different taxonomic background.</p>

<p>Reconstructing the genomes of microorganisms in the sampled communities is critical step in analyzing metagenomic data. To do that, we can use <strong>assembly</strong> and assemblers, <em>i.e.</em> computational programs that stich together the small fragments of sequenced DNA produced by sequencing instruments.</p>

<p>Assembling seems intuitively similar to putting together a jigsaw puzzle. Essentially, it looks for reads “that work together” or more precisely, reads that overlap. Tasks like this are <strong>not straightforward</strong>, but rather complex because of the complexity of the genomics (specially the repeats), the missing pieces and the errors introduced during sequencing.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>

  <p>Do you want to learn more about the principles behind single genome assembly? Follow our <a href="/training-material/topics/assembly/index.html">tutorials</a>.</p>
</blockquote>

<p><strong>Metagenomic assembly</strong> is further complicated by</p>
<ul>
  <li>the large volume of data produced</li>
  <li>the quality of the sequence</li>
  <li>the unequal representation of members of the microbial community</li>
  <li>the presence of closely related microorganisms with similar genomes</li>
  <li>the presence of several strains of the same microorganism</li>
  <li>an insufficient amount of data for minor community members</li>
</ul>

<blockquote class="details">
  <div class="box-title details-title" id="details-strategies-for-assembly"><button class="gtn-boxify-button details" type="button" aria-controls="details-strategies-for-assembly" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Strategies for assembly</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p>For assembly, there are 3 main strategies:</p>
  <ol>
    <li>Greedy extension</li>
    <li>Overlap Layout Consensus</li>
    <li>De Bruijn graphs. The following figure illustrates these strategies in brief.</li>
  </ol>

  <figure id="figure-1" style="max-width: 90%;"><img src="./images/assembly-algorithms.png" alt="Image shows greedy extention, overlap layout consensus, and de Brujin graphs assembly algorithms. " width="868" height="777" loading="lazy" /><a target="_blank" href="./images/assembly-algorithms.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 1</strong>:</span> Assembly algorithms. Image from <span class="citation"><a href="#carpentries">“<b>Metagenome Assembly – Data Processing and Visualization for Metagenomics</b>”</a></span></figcaption></figure>

  <p>The nice paper <span class="citation"><a href="#miller2010">Miller <i>et al.</i> 2010</a></span> on assemblers based on these algorithms will help you to better understand how they work.</p>
</blockquote>

<p>For metagenomic assembly, several tools exist: metaSPAdes (<span class="citation"><a href="#nurk2017">Nurk <i>et al.</i> 2017</a></span>), MEGAHIT (<span class="citation"><a href="#li2015">Li <i>et al.</i> 2015</a></span>), etc. The different assemblers have different computational characteristics and their performance varies according to the microbiome as shown in by both rounds of  Critical Assessment of Metagenome Interpretation initiative (<span class="citation"><a href="#sczyrba2017">Sczyrba <i>et al.</i> 2017</a></span>, <span class="citation"><a href="#meyer2022">Meyer <i>et al.</i> 2022</a></span>, <span class="citation"><a href="#meyer2021">Meyer <i>et al.</i> 2021</a></span>). The preference of one assembler over another depends on the purpose at hand.</p>

<p>In this tutorial, we will learn how to run metagenomic assembly tool and evaluate the quality of the generated assemblies. To do that, we will use data from the study: <a href="https://www.ebi.ac.uk/metagenomics/studies/MGYS00005630#overview">Temporal shotgun metagenomic dissection of the coffee fermentation ecosystem</a>. For an in-depth analysis of the structure and functions of the coffee microbiome, a temporal shotgun metagenomic study (six time points) was performed. The six samples have been sequenced with Illumina MiSeq utilizing whole genome sequencing.</p>

<p>Based on the 6 original dataset of the coffee fermentation system, we generated mock datasets for this tutorial.</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#prepare-analysis-history-and-data" id="markdown-toc-prepare-analysis-history-and-data">Prepare analysis history and data</a></li>
  <li><a href="#assembly" id="markdown-toc-assembly">Assembly</a></li>
  <li><a href="#quality-control-of-assembly" id="markdown-toc-quality-control-of-assembly">Quality control of assembly</a>    <ol>
      <li><a href="#assembly-statistics" id="markdown-toc-assembly-statistics">Assembly statistics</a></li>
      <li><a href="#icarus-contig-browser" id="markdown-toc-icarus-contig-browser">Icarus contig browser</a></li>
    </ol>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ol>

</blockquote>

<h1 id="prepare-analysis-history-and-data">Prepare analysis history and data</h1>

<p>To run assembly, we first need to get the data into Galaxy. Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-prepare-the-galaxy-history"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Prepare the Galaxy history</div>

  <ol>
    <li>
      <p>Create a new history for this analysis</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a new history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>To create a new history simply click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel:</p>   <p><img src="/training-material/shared/images/history_create_new.svg" alt="UI for creating new history" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Rename the history</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Renaming a history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li>   <li>To cancel renaming, click the <i class="fas fa-undo" aria-hidden="true"></i><span class="visually-hidden">galaxy-undo</span> “Cancel” button</li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which can be the case if you are using an older version of Galaxy) do the following:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>We need to get the data into our history.</p>

<p>In case of a not very large dataset it’s more convenient to upload data directly from your computer to Galaxy.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-upload-data-into-galaxy"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Upload data into Galaxy</div>

  <ol>
    <li>
      <p>Import the sequence read raw data (*.fastqsanger.gz) from <a href="https://zenodo.org/record/7818827">Zenodo</a> or a data library:</p>

      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7818827/files/ERR2231567_1.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231567_2.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231568_1.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231568_2.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231569_1.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231569_2.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231570_1.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231570_2.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231571_1.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231571_2.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231572_1.fastqsanger.gz
https://zenodo.org/record/7818827/files/ERR2231572_2.fastqsanger.gz
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing via links</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-data-from-a-data-library"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-data-from-a-data-library" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing data from a data library</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class="fas fa-caret-down" aria-hidden="true"></i><span class="visually-hidden">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-1"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
        <p>In case of large dataset, we can use FTP server or the <a href="/training-material/topics/galaxy-interface/tutorials/upload-rules/tutorial.html">Galaxy Rule-based Uploader</a>.</p>
      </blockquote>
    </li>
    <li>
      <p>Create a paired collection named <code class="language-plaintext highlighter-rouge">Raw reads</code>, rename your pairs with the sample name</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-paired-collection"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-paired-collection" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a paired collection</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src="/training-material/topics/galaxy-interface/images/historyItemControls.png" alt="Select Items button" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<h1 id="assembly">Assembly</h1>

<p>As explained before, there are many challenges to metagenomics assembly, including:</p>

<ol>
  <li>differences in coverage between samples, resulting from differences in abundance,</li>
  <li>the fact that different species often share conserved regions (<span class="citation"><a href="#kececioglu2001">Kececioglu and Ju 2001</a></span>), and</li>
  <li>the presence of multiple strains of a single species (<span class="citation"><a href="#miller2010">Miller <i>et al.</i> 2010</a></span>).</li>
</ol>

<p>To reduce the differences in coverage between samples, we can use a <strong>co-assembly</strong> approach, where reads from all samples are aligned together.:</p>

<figure id="figure-2" style="max-width: 90%;"><img src="./images/co-assembly.png" alt="Image show one pile of sample1 reads and another pile of sample2 reads, then, green arrow leads to assembled reads from both piles. " width="482" height="348" loading="lazy" /><a target="_blank" href="./images/co-assembly.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 2</strong>:</span> Co-assembly</figcaption></figure>

<table>
  <thead>
    <tr>
      <th>Pros of co-assembly</th>
      <th>Cons of co-assembly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>More data</td>
      <td>Higher computational overhead</td>
    </tr>
    <tr>
      <td>Better/longer assemblies</td>
      <td>Risk of shattering your assembly</td>
    </tr>
    <tr>
      <td>Access to lower abundant organisms</td>
      <td>Risk of increased contamination</td>
    </tr>
  </tbody>
</table>

<p>Co-assembly is then not always beneficial:</p>
<ul>
  <li>Changes in strain can cause the assembly graph to collapse</li>
  <li>Binned contigs are likely to be misclassified: MAGs must be treated as a population genome.</li>
</ul>

<figure id="figure-3" style="max-width: 90%;"><img src="./images/co-assembly-process.png" alt="Image shows the process of assembled reads from 2 samples followed by binning and there is detailed information about broken contigs, dominant coverage, chimeric contigs found during assembly process. " width="512" height="200" loading="lazy" /><a target="_blank" href="./images/co-assembly-process.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 3</strong>:</span> Co-assembly process</figcaption></figure>

<p>In these cases, co-assembly is reasonable if:</p>
<ul>
  <li>Same samples</li>
  <li>Same sampling event</li>
  <li>Longitudinal sampling of the same site</li>
  <li>Related samples</li>
</ul>

<p>If it is not the case, <strong>individual assembly</strong> should be prefered. In this case, an extra step of <strong>de-replication</strong> should be used:</p>

<figure id="figure-4" style="max-width: 90%;"><img src="./images/individual-assembly.png" alt="Image shows the process of individual assembly on two strains and five samples, after individual assembly of samples two samples are chosen for de-replication process. In parallel, co-assembly on all five samples is performed. " width="512" height="316" loading="lazy" /><a target="_blank" href="./images/individual-assembly.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 4</strong>:</span> Individual assembly followed by de-replication vs co-assembly. Source: dRep documentation</figcaption></figure>

<p>Co-assembly is more commonly used than individual assembly and then de-replication after binning. But in this tutorial, to show all steps, we will run an <strong>individual assembly</strong>.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-2"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
  <p>Sometimes it is important to run assembly tools both on individual samples and on all pooled samples, and use both outputs to get the better outputs for the certain dataset.</p>
</blockquote>

<p>As mentioned in the introduction, several tools are available for metagenomic assembly. But 2 are the most used ones:</p>

<ul>
  <li>
    <p><strong>MetaSPAdes</strong> (<span class="citation"><a href="#nurk2017">Nurk <i>et al.</i> 2017</a></span>): an short-read assembler designed specifically for large and complex metagenomics datasets</p>

    <p>MetaSPAdes is part of the SPAdes toolkit, which has several assembly pipelines. Since SPAdes handles non-uniform coverage, it is useful for assembling simple communities, but metaSPAdes also handles other problems, allowing it to assemble complex communities’ metagenomes.</p>

    <p>As input for metaSPAdes it can accept short reads. However, there is an option to use additionally long reads besides short reads to produce hybrid input.</p>
  </li>
  <li>
    <p><strong>MEGAHIT</strong> (<span class="citation"><a href="#li2015">Li <i>et al.</i> 2015</a></span>): a single node assembler for large and complex metagenomics NGS reads, such as soil</p>

    <p>It makes use of succinct de Bruijn graph (SdBG) to achieve low memory assembly.</p>
  </li>
</ul>

<p>Both tools are available in Galaxy. But currently, only MEGAHIT can be used in individual mode for several samples.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-individual-assembly-of-short-reads-with-megahit"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Individual assembly of short-reads with MEGAHIT</div>
  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/megahit/megahit/1.2.9+galaxy0" title="MEGAHIT tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>MEGAHIT</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.2.9+galaxy0)</span> with parameters:
      <ul>
        <li><em>“Select your input option”</em>: <code class="language-plaintext highlighter-rouge">Paired-end collection</code>
          <ul>
            <li>
              <p><em>“Run in batch mode?”</em>: <code class="language-plaintext highlighter-rouge">Run individually</code></p>

              <blockquote class="comment">
                <div class="box-title comment-title" id="comment-3"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
                <p>To run as co-assembly, select <code class="language-plaintext highlighter-rouge">Merge all fastq pair-end</code>, instead of <code class="language-plaintext highlighter-rouge">Run individually</code></p>
              </blockquote>
            </li>
            <li>
              <p><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Select a paired collection”</em>: <code class="language-plaintext highlighter-rouge">Raw reads</code></p>
            </li>
          </ul>
        </li>
        <li>In <em>Basic assembly options</em>
          <ul>
            <li><em>“K-mer specification method”</em>: <code class="language-plaintext highlighter-rouge">Specify min, max, and step values</code>
              <ul>
                <li><em>“Minimum kmer size”</em>: 21</li>
                <li><em>“Maximum kmer size”</em>: 91</li>
                <li><em>“Increment of kmer size of each iteration”</em>: 12</li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>

</blockquote>

<p><strong>MEGAHIT</strong> produced a collection of output assemblies - one per sample - that can be proceeded further in binning step and then de-replication. The output contains <strong>contigs</strong>, contiguous lengths of genomic sequences in which bases are known to a high degree of certainty.</p>

<p>Contrary to <strong>MetaSPAdes</strong>, <strong>MEGAHIT</strong> does not output <strong>scaffolds</strong>, i.e. segments of genome sequence reconstructed fron contigs and gaps. The gaps occur when reads from the two sequenced ends of at least one fragment overlap with other reads from two different contigs (as long as the arrangement is otherwise consistent with the contigs being adjacent). It is possible to estimate the number of bases between contigs based on fragment lengths.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-4"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>

  <p>Since the assembly process would take ~1h we are just going to import the results of the assembly previously run.</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-import-generated-assembly-files"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Import generated assembly files</div>

    <ol>
      <li>
        <p>Import the six contig files from <a href="https://zenodo.org/record/7818827">Zenodo</a> or the Shared Data library:</p>

        <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7818827/files/contigs_ERR2231567.fasta
https://zenodo.org/record/7818827/files/contigs_ERR2231568.fasta
https://zenodo.org/record/7818827/files/contigs_ERR2231569.fasta
https://zenodo.org/record/7818827/files/contigs_ERR2231570.fasta
https://zenodo.org/record/7818827/files/contigs_ERR2231571.fasta
https://zenodo.org/record/7818827/files/contigs_ERR2231572.fasta
</code></pre></div>        </div>
      </li>
      <li>
        <p>Create a collection named <code class="language-plaintext highlighter-rouge">MEGAHIT Contig</code>, rename your pairs with the sample name</p>
      </li>
    </ol>

  </blockquote>
</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>How many contigs has been for ERR2231568 sample?</li>
    <li>And for ERR2231572?</li>
    <li>What is the minimum length of the contigs?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>There are 228,719 sequences in the file so 228,719 contigs</li>
      <li>122,526 contigs</li>
      <li>Sequences seems bigger than 200 bp (<code class="language-plaintext highlighter-rouge">len</code> attribute of the sequence information in Fasta files). It is the default value set up in MEGAHIT.</li>
    </ol>

  </blockquote>

</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-co-assembly-with-metaspades"><button class="gtn-boxify-button details" type="button" aria-controls="details-co-assembly-with-metaspades" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Co-assembly with MetaSPAdes</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-assembly-with-metaspades"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Assembly with MetaSPAdes</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/nml/metaspades/metaspades/3.15.4+galaxy2" title="MetaSPAdes tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>MetaSPAdes</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 3.15.4+galaxy2)</span> with following parameters
        <ul>
          <li><em>“Pair-end reads input format”</em>: <code class="language-plaintext highlighter-rouge">Paired-end: list of dataset pairs</code>
            <ul>
              <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“FASTQ file(s): collection”</em>: <code class="language-plaintext highlighter-rouge">Raw reads</code></li>
            </ul>
          </li>
          <li><em>“Select k-mer detection option”</em>: <code class="language-plaintext highlighter-rouge">User specific</code>
            <ul>
              <li><em>“K-mer size values”</em>: <code class="language-plaintext highlighter-rouge">21,33,55,77</code></li>
            </ul>
          </li>
        </ul>
      </li>
    </ol>
  </blockquote>
</blockquote>

<h1 id="quality-control-of-assembly">Quality control of assembly</h1>

<p>Once assembly is done, it is important to check its quality.</p>

<p>Assemblies can be evaluated with <strong>metaQUAST</strong> (<span class="citation"><a href="#mikheenko2016">Mikheenko <i>et al.</i> 2016</a></span>), the metagenomics mode of <strong>QUAST</strong> (<span class="citation"><a href="#gurevich2013">Gurevich <i>et al.</i> 2013</a></span>).</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-evaluation-assembly-quality-with-metaquast"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Evaluation assembly quality with metaQUAST</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/quast/quast/5.2.0+galaxy1" title="Quast tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Quast</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 5.2.0+galaxy1)</span> with parameters:
      <ul>
        <li><em>“Assembly mode?</em>”: <code class="language-plaintext highlighter-rouge">Individual assembly (1 contig file per samples)</code>
          <ul>
            <li><em>“Use customized names for the input files?”</em>: <code class="language-plaintext highlighter-rouge">No, use dataset names</code>
              <ul>
                <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Contigs/scaffolds file”</em>: output <strong>MEGAHIT</strong></li>
              </ul>
            </li>
            <li>
              <p><em>“Reads options”</em>: <code class="language-plaintext highlighter-rouge">Illumina paired-end reads in paired collection</code></p>

              <blockquote class="comment">
                <div class="box-title comment-title" id="comment-5"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
                <p>To make the job quicker, you can select <code class="language-plaintext highlighter-rouge">Disabled</code> here. The raw reads will then not been mapped to the assembly to compute metrics, like the coverage.</p>
              </blockquote>
            </li>
            <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“FASTQ/FASTA files”</em>: <code class="language-plaintext highlighter-rouge">Raw reads</code></li>
          </ul>
        </li>
        <li><em>“Type of assembly”</em>: <code class="language-plaintext highlighter-rouge">Metagenome</code></li>
        <li><em>“Output files”</em>: <code class="language-plaintext highlighter-rouge">HTML report</code>, <code class="language-plaintext highlighter-rouge">PDF report</code>, <code class="language-plaintext highlighter-rouge">Tabular reports</code>, <code class="language-plaintext highlighter-rouge">Log file</code>, <code class="language-plaintext highlighter-rouge">Key metric summary (metagenome mode)</code>, <code class="language-plaintext highlighter-rouge">Krona charts (metagenome mode without reference genomes)</code></li>
      </ul>
    </li>
    <li>Inspect the HTML reports</li>
  </ol>
</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-6"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>

  <p>Since the Quast process would take times we are just going to import the results:</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-import-generated-metaquast-results"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Import generated metaQuast results</div>

    <ol>
      <li>
        <p>Import the metaQuast report file from <a href="https://zenodo.org/record/7818827">Zenodo</a> or the Shared Data library:</p>

        <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7818827/files/quast_ERR2231567.html
https://zenodo.org/record/7818827/files/quast_ERR2231568.html
https://zenodo.org/record/7818827/files/quast_ERR2231569.html
https://zenodo.org/record/7818827/files/quast_ERR2231570.html
https://zenodo.org/record/7818827/files/quast_ERR2231571.html
https://zenodo.org/record/7818827/files/quast_ERR2231572.html
</code></pre></div>        </div>
      </li>
    </ol>

  </blockquote>
</blockquote>

<p>Quast main output are HTML reports which aggregate different metrics.</p>

<h2 id="assembly-statistics">Assembly statistics</h2>

<p>On the top of each report is a table with in rows statistics for contigs larger than 500 bp for the different sample assemblies (columns). Let’s now look at the table and go from top to bottom:</p>

<ol>
  <li>
    <p><strong>Genome statistics</strong></p>

    <ul>
      <li>
        <p><strong>Genome fraction (%)</strong>: percentage of aligned bases in the reference genome</p>

        <p>A base in the reference genome is counted as aligned if at least one contig has at least one alignment to this base.</p>

        <p>We did not provide any reference there, but metaQuast try to identify genome content of the metagenome by aligning contigs to <a href="https://www.arb-silva.de/">SILVA</a> 16S rRNA database. For each assembly, 50 reference genomes with top scores are chosen. The full reference genomes of the identified organisms are afterwards downloaded from NCBI to map the assemblies on them and compute the genome fractions.</p>

        <p>For each identified genomes, the genome fraction is given when clicking on <strong>Genome fraction (%)</strong></p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>What is the genome fraction for ERR2231568? And for ERR2231572?</li>
            <li>Which reference genome has the highest genome fraction for ERR2231568? And for ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>The genome fraction is 30.22% for ERR2231568 and 58.73% for ERR2231572</li>
              <li>The highest genome fraction was found for <em>Leuconostoc pseudomesenteroides</em> for ERR2231568 (844%) and for <em>Lactobacillus</em> for ERR2231572 (91%). The genomes of <em>Leuconostoc pseudomesenteroides</em> and <em>Lactobacillus</em> could be then almost completely recovered from the assemblies of ERR2231568 and ERR2231572 respectively.</li>
            </ol>

          </blockquote>

        </blockquote>
      </li>
      <li>
        <p><strong>Duplication ratio</strong>: total number of aligned bases / genome fraction * reference length</p>

        <p>If an assembly contains many contigs that cover the same regions of the reference, the duplication ratio may be much larger than 1.</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-2"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>What is the duplication ratio for ERR2231568? And for ERR2231572?</li>
            <li>Which reference genome has the highest duplication ratio for ERR2231568? And for ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>The duplication ratio is 1.068 for ERR2231568 and 1.1 for ERR2231572 (column ERR2231572 in ERR2231572 report)</li>
              <li>The highest duplication ratio was found for <em>Gluconobacter kondonii</em> for ERR2231568 (1.156) and for <em>Lactobacillus brevis KB290</em> for ERR2231572 (1.178).</li>
            </ol>

          </blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Read mapping</strong>: results of the mapping of the raw reads on the different assemblies (only if the <em>“Reads options”</em> is not disabled)</p>

    <blockquote class="question">
      <div class="box-title question-title" id="question-3"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <ol>
        <li>What is the % of read mapped for ERR2231568 assembly to ERR2231568 raw reads? And for ERR2231572 assembly to ERR2231572 raw reads?</li>
        <li>What is the percentage of reads used to build the assemblies for ERR2231568? and ERR2231572?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ol>
          <li>79.47% of ERR2231568 raw reads were mapped to ERR2231568 assembly and 86.98% of ERR2231572 raw reads to ERR2231572 assembly.</li>
          <li>79.47% of reads were used to the assemblies for ERR2231568 and  86.97% for ERR2231572.</li>
        </ol>
      </blockquote>

    </blockquote>

    <blockquote class="details">
      <div class="box-title details-title" id="details-alternative-ways-to-compute-coverage"><button class="gtn-boxify-button details" type="button" aria-controls="details-alternative-ways-to-compute-coverage" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Alternative ways to compute coverage</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

      <p>2 alternative ways to compute coverage are to</p>
      <ol>
        <li>
          <p>Use <a href="https://github.com/wwood/CoverM">CoverM</a>, which is available in Galaxy</p>

          <blockquote class="notranslate hands_on">
            <div class="box-title hands-on-title" id="hands-on-calculate-coverage-using-coverm"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Calculate coverage using CoverM</div>

            <ol>
              <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/coverm_contig/coverm_contig/0.2.1" title="CoverM-CONTIG tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>CoverM-CONTIG</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 0.2.1)</span> with parameters:
                <ul>
                  <li><em>“Read type”</em>: <code class="language-plaintext highlighter-rouge">Paired collection</code>
                    <ul>
                      <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“One or more pairs of forward and reverse possibly gzipped FASTA/Q files for mapping in order”</em>: <code class="language-plaintext highlighter-rouge">Raw reads</code></li>
                    </ul>
                  </li>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span>  <em>“FASTA file(s) of contigs”</em>: output of MEGAGIT</li>
                </ul>
              </li>
              <li>Inspect the HTML report for ERR2231568</li>
            </ol>
          </blockquote>
        </li>
        <li>
          <p>Map the original reads onto contigs and extract the percentage of mapped reads:</p>

          <blockquote class="notranslate hands_on">
            <div class="box-title hands-on-title" id="hands-on-computation-of-the-reads-used-in-assemblies"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Computation of the % reads used in assemblies</div>

            <ol>
              <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/bowtie2/bowtie2/2.5.0+galaxy0" title="Bowtie2 tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Bowtie2</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 2.5.0+galaxy0)</span> with the following parameters:
                <ul>
                  <li><em>“Is this single or paired library”</em>: <code class="language-plaintext highlighter-rouge">Paired-end Dataset Collection</code>
                    <ul>
                      <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“FASTQ Paired Dataset”</em>: <code class="language-plaintext highlighter-rouge">Raw reads</code></li>
                    </ul>
                  </li>
                  <li><em>“Will you select a reference genome from your history or use a built-in index?”</em>: <code class="language-plaintext highlighter-rouge">Use a genome from the history and build index</code>
                    <ul>
                      <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Select reference genome”</em>: MEGAHIT output</li>
                    </ul>
                  </li>
                  <li><em>“Save the Bowtie2 mapping statistics to the history”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                </ul>
              </li>
              <li>Inspect the mapping statistics output</li>
            </ol>
          </blockquote>

          <blockquote class="question">
            <div class="box-title question-title" id="question-4"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

            <ol>
              <li>What is the overall alignment rate for ERR2231567? and ERR2231571?</li>
              <li>What is the percentage of reads used in assemblies for ERR2231567? and ERR2231571?</li>
            </ol>

            <blockquote class="solution">
              <div class="box-title solution-title" id="solution-4"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-4" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

              <ol>
                <li>The overall alignment rate for ERR2231567 is 65.97% and 73.67% for ERR2231571</li>
                <li>65.97% of the reads were used in assemblies for ERR2231567 and 73.67% for ERR2231571.</li>
              </ol>

            </blockquote>

          </blockquote>
        </li>
      </ol>
    </blockquote>
  </li>
  <li>
    <p><strong>Misassemblies</strong>: joining sequences that should not be adjacent.</p>

    <p>Quast identifies missassemblies by mapping the contigs to the reference genomes of the identified organisms. 3 types of misassemblies can be identified:</p>

    <figure id="figure-5" style="max-width: 90%;"><img src="./images/quast_misassemblies.png" alt="Image shows on the top a contig with a blue and a gren parts with white arrows (pointing on the right) on them and below a reference with 2 chromosomes. The 3 types of misassemblies are after schematized. Relocation: the blue and gren parts of the contig are on chr 1 but separated. Inversion: the blue and gren parts of the contig are on chr 1 but separated and with the arrows facing each other. Translocation: the blue part is on chr 1 and gren part on chr 2." width="592" height="180" loading="lazy" /><a target="_blank" href="./images/quast_misassemblies.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 5</strong>:</span> Source: <a href="https://quast.sourceforge.net/docs/manual.html#sec3.1.2">QUAST manual</a></figcaption></figure>

    <ol>
      <li><strong>Relocation</strong> occur based on signal from two mappings of the same contig against the same chromosome, with 2 cases:
        <ol>
          <li>the 2 mappings are separated by an unmapped region of at least 1 kbp</li>
          <li>they map on the same chromosome with a shared mapping area of at least 1 kbp</li>
        </ol>

        <figure id="figure-6" style="max-width: 90%;"><div style="overflow-x: auto"><object data="./images/relocation.svg" width="80%" type="image/svg+xml" alt="Image shows on the top a contig with a blue and a gren parts with white arrows (pointing on the right) on them and below a reference with 2 chromosomes. The 3 types of misassemblies are after schematized. Relocation: the blue and gren parts of the contig are on chr 1 but separated. Inversion: the blue and gren parts of the contig are on chr 1 but separated and with the arrows facing each other. Translocation: the blue part is on chr 1 and gren part on chr 2.">Image shows on the top a contig with a blue and a gren parts with white arrows (pointing on the right) on them and below a reference with 2 chromosomes. The 3 types of misassemblies are after schematized. Relocation: the blue and gren parts of the contig are on chr 1 but separated. Inversion: the blue and gren parts of the contig are on chr 1 but separated and with the arrows facing each other. Translocation: the blue part is on chr 1 and gren part on chr 2.</object></div><a target="_blank" href="./images/relocation.svg" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 6</strong>:</span> Source: <a href="https://blog.pierre.marijon.fr/misassemblies-in-noisy-assemblies/">Yet Another Bioinformatic blog by Pierre Marijon</a></figcaption></figure>

        <blockquote class="question">
          <div class="box-title question-title" id="question-5"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>How many relocations has been found for ERR2231568? And for ERR2231572?</li>
            <li>For which reference genomes are there the most relocation found for ERR2231568? And for ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-5"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-5" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>78 for ERR2231568 and 151 for ERR2231572</li>
              <li><em>Leuconostoc pseudomesenteroides</em> and <em>Tatumella morbirosei</em> for ERR2231568 and <em>Lactobacillus plantarum argentoratensis</em> for ERR2231572</li>
            </ol>
          </blockquote>

        </blockquote>
      </li>
      <li>
        <p><strong>Translocation</strong> occur when a contig has mapped on more than one reference chromosomes</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-6"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>How many translocations has been found for ERR2231568? And for ERR2231572?</li>
            <li>For which reference genomes are there the most translocations found for ERR2231568? And for ERR2231572?</li>
            <li>What are the interspecies translocations?</li>
            <li>How many interspecies translocations has been found for ERR2231568? And for ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-6"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-6" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>25 for ERR2231568 and 55 for ERR2231572.</li>
              <li><em>Leuconostoc pseudomesenteroides</em> for ERR2231568 and <em>Lactobacillus vaccinostercus</em> for ERR2231572.</li>
              <li>Interspecies translocations are translocations where a contig has mapped on different reference genomes.</li>
              <li>80 for ERR2231568 and 144 for ERR2231572.</li>
            </ol>
          </blockquote>

        </blockquote>
      </li>
      <li>
        <p><strong>Inversion</strong> occurs when a contig has two consecutive mappings on the same chromosome but in different strands</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-7"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>How many inversion has been found for ERR2231568? And for ERR2231572?</li>
            <li>For which reference genomes are there the most inversions found for ERR2231568? And for ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-7"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-7" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>4 for ERR2231568 and 6 for ERR2231572.</li>
              <li><em>Tatumella morbirosei</em> for ERR2231568 and <em>Lactobacillus sp</em> for ERR2231572.</li>
            </ol>
          </blockquote>

        </blockquote>
      </li>
    </ol>
  </li>
  <li>
    <p><strong>Mismatches</strong> or mismatched bases in the contig-reference alignment</p>

    <blockquote class="question">
      <div class="box-title question-title" id="question-8"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <ol>
        <li>How many mismatches have been identified for ERR2231568? And for ERR2231572?</li>
        <li>For which reference genomes are there the most mismatches for ERR2231568? And for ERR2231572?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-8"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-8" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ol>
          <li>503,352 for ERR2231568 and 287,270 for ERR2231572.</li>
          <li><em>Pantoea rwandensis</em> for ERR2231568 and <em>Leuconostoc brevis KB290</em> for ERR2231572.</li>
        </ol>
      </blockquote>

    </blockquote>
  </li>
  <li>
    <p><strong>Statistics without reference</strong></p>

    <ul>
      <li>
        <p><strong># contigs</strong>: total number of contigs</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-9"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>How many contigs are for ERR2231568? And for ERR2231572?</li>
            <li>How many sequences are in the output of MEGAHIT for ERR2231568? And for ERR2231572?</li>
            <li>Why are these numbers different from the number of sequences in the output of MEGAHIT?</li>
            <li>Which statistics in the metaQUAST report corresponds to number of sequences in the output of MEGAHIT?</li>
            <li>Which reference genomes have the most contigs (\(\geq\) 500 bp) in ERR2231568? And in ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-9"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-9" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>66,434 contigs for ERR2231568 and 36,112 for ERR2231572.</li>
              <li>In the outputs of MEGAHIT, there are 228,719 contigs for ERR2231568 and 122,526 contigs.</li>
              <li>The numbers are lower in the metaQUAST results because metaQUAST reports there only the contigs longer than 500bp.</li>
              <li>The <strong># contigs (&gt;= 0 bp)</strong></li>
              <li>Except the non aligned contigs, <em>Tatumella morbirosei</em> for ERR2231568 and <em>Leuconostoc brevis KB290</em> for ERR2231572.</li>
            </ol>
          </blockquote>

        </blockquote>
      </li>
      <li>
        <p><strong>Largest contig</strong>: length of the longest contig in the assembly</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-10"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>What is the length of the longest contig in ERR2231568? And in ERR2231572?</li>
            <li>Is the longest contig assigned to a reference genome in ERR2231568? And in ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-10"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-10" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>63,871 bp in ERR2231568 and 65,608 for ERR2231572.</li>
              <li>It is assigned to <em>Leuconostoc pseudomesenteroides KCTC 3652</em> in ERR2231568 and not assigned in ERR2231572.</li>
            </ol>
          </blockquote>

        </blockquote>
      </li>
      <li>
        <p><strong>N50</strong>: length for which the collection of all contigs of that length or longer covers at least half an assembly</p>

        <p>N50 statistic defines assembly quality in terms of contiguity. If all contigs in an assembly are ordered by length, the N50 is the minimum length of contigs that contains 50% of the assembled bases. For example, an N50 of 10,000 bp means that 50% of the assembled bases are contained in contigs of at least 10,000 bp.</p>

        <p>Another example. Let’s consider 9 contigs with the lengths 2, 3, 4, 5, 6, 7, 8, 9, and 10:</p>
        <ul>
          <li>The sum of the length is 54</li>
          <li>Half of the sum is 27</li>
          <li>10 + 9 + 8 = 27 (half the length of the sequence)</li>
          <li>N50 = 8, i.e. the size of the contig which, along with the larger contigs, contain half of sequence of a particular genome</li>
        </ul>

        <blockquote class="question">
          <div class="box-title question-title" id="question-11"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>What is N50 for ERR2231568? And for ERR2231572?</li>
            <li>What is N90?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-11"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-11" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>921 for ERR2231568 and 1,233 for ERR2231572.</li>
              <li>N90 is similar to the N50 metric but with 90% of of the sum of the lengths of all contigs</li>
            </ol>
          </blockquote>

        </blockquote>

        <p>When comparing N50 values from different assemblies, the assembly sizes must be the same size in order for N50 to be meaningful.</p>

        <p>Also the N50 alone is not a useful measure to assess the quality of an assembly. For example, the assemblies with the following contig lengths:</p>
        <ul>
          <li>3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 25, 25, 150, 1500</li>
          <li>50, 500, 530, 650</li>
        </ul>

        <p>Both assemblies have the same N50 although one is more contiguous than the other.</p>
      </li>
      <li>
        <p><strong>L50</strong>: number of contigs equal to or longer than N50</p>

        <p>In other words, L50, for example, is the minimal number of contigs that cover half the assembly.</p>

        <p>If we take the previous example in N50, L50 = 3.</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-12"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>What is the L50 for ERR2231568? And for ERR2231572?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-12"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-12" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>17,280 for ERR2231568 and 7,496 for ERR2231572.</li>
            </ol>
          </blockquote>

        </blockquote>
      </li>
    </ul>
  </li>
</ol>

<h2 id="icarus-contig-browser">Icarus contig browser</h2>

<p>Icarus generates contig size viewer and one or more contig alignment viewers (if reference genome/genomes are provided) that are accessible from the HTML report, by clicking on <code class="language-plaintext highlighter-rouge">View on Icarus contig browser</code>.</p>

<h3 id="contig-size-viewer">Contig size viewer</h3>

<p>This viewer draws contigs ordered from longest to shortest. Let’s inspect this viewer for ERR2231568.</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-13"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>Open the Contig size viewer for ERR2231568 and define start as <code class="language-plaintext highlighter-rouge">0</code> and end as <code class="language-plaintext highlighter-rouge">500000</code></p>

  <p><a href="./images/ERR2231568-contig-size-viewer.png" rel="noopener noreferrer"><img src="./images/ERR2231568-contig-size-viewer.png" alt="Image shows on the Icarus Contig size viewer for ERR2231568, with a zoom between 0 500000. Below the menu, the contigs are drawn from the longest on the left to the shortest on the right. Each contig is filled with a different color: green for correct, red for misassembled, etc. Below the contigs is dispayed a bar to navigate through the contigs. " width="1499" height="658" loading="lazy" /></a></p>

  <ol>
    <li>What is the color of the first contig? Why?</li>
    <li>What is the red contig?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-13"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-13" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>The first contig is white because &gt;50% of the contigs is unaligned. By clicking on the contig, we see that only a small block is aligned: 223.41 – 223.65 kbp to Leuconostoc_pseudomesenteroides_KCTC_3652_NZ_BMBP01000002.1.</li>
      <li>The red contig is a missamblied contig: it contains 2 blocks, with a translocation between them.</li>
    </ol>
  </blockquote>

</blockquote>

<p>Click <code class="language-plaintext highlighter-rouge">Main menu</code> on the top left to go back to the main Icarus page.</p>

<h3 id="contig-alignment-viewer">Contig alignment viewer</h3>

<p>If a reference genome is provided, there should be a table on the main Icarus page that looks like:</p>

<table>
  <thead>
    <tr>
      <th>Genome</th>
      <th># fragments</th>
      <th>Length, bp</th>
      <th>Mean genome fraction, %</th>
      <th># misassembled blocks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Gluconobacter oxydans H24</td>
      <td>2</td>
      <td>3 816 232</td>
      <td>10.989</td>
      <td>38</td>
    </tr>
    <tr>
      <td>Kosakonia cowanii</td>
      <td>5</td>
      <td>4 806 998</td>
      <td>28.224</td>
      <td>60</td>
    </tr>
    <tr>
      <td>Lactococcus lactis subsp. lactis CV56</td>
      <td>6</td>
      <td>2 518 737</td>
      <td>18.940 	23</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>When clicking on the genome name, the contigs are displayed according to their mapping to the reference genome. The viewer can additionally visualize genes, operons, and read coverage distribution along the genome, if any of those were fed to QUAST.</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-14"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>Open the Contig alignment viewer for ERR2231568 and <em>Leuconostoc pseudomesenteroides</em> KCTC 3652, the most covered by contigs</p>

  <p><a href="./images/ERR2231568-contig-alignment-viewer-leuconostoc.png" rel="noopener noreferrer"><img src="./images/ERR2231568-contig-alignment-viewer-leuconostoc.png" alt="Image shows on the Icarus alignment size viewer of ERR2231568 contigs for Leuconostoc pseudomesenteroides KCTC 3652. On the top are displayed the contigs aligend on the reference genome, with a zoom. Each contig is filled with a different color: green for correct, red for misassembled, etc. Below the contigs is dispayed a bar to navigate through the contigs. Below is a graph representing the GC percentage and coverage along the reference genome. " width="1508" height="741" loading="lazy" /></a></p>

  <ol>
    <li>How are the organized the contigs on the top?</li>
    <li>What the different colors for the contigs?</li>
    <li>Why is there a big red block on the right?</li>
    <li>What is the graph on the bottom?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-14"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-14" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>The contigs are displayed based on their mapping on the reference genome of <em>Leuconostoc pseudomesenteroides</em> KCTC 3652</li>
      <li>The different colors represent the different status for the contig: correct contigs, correct contigs but with &gt;50% of the contig unaligned, misassembled blocks. unchecked misassembled blocks, ambiguously mapped contigs, alternative blocks of misassembled contigs, etc.</li>
      <li>The big red block on the right is contig k91_88833 with a misassembly on the left side, and overlap with 2 other contigs</li>
      <li>The graph on the bottom represents the GC percentage and coverage by contigs along the reference genome</li>
    </ol>
  </blockquote>

</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-visualization-of-the-de-novo-assembly-graph"><button class="gtn-boxify-button details" type="button" aria-controls="details-visualization-of-the-de-novo-assembly-graph" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Visualization of the *de novo* assembly graph</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>Current metagenome assemblers like MEGAHIT and MetaSPAdes use <strong>graphs</strong>, most typically a de Bruijn graph to stich reads together. In an ideal case, the graph would contain one distinct path for each genome of each micro-organisms, but complexities such as repeated sequences usually prevent this.</p>

  <p>Assembly graphs contain then <strong>branching structures</strong>: one node may lead into multiple others. <strong>Contigs</strong> correspond to the longest sequences in the graph that can be determined unambiguously. They are the final results of most assembler. But the assembly graph contains more information. It can be useful for finding sections of the graph, such as rRNA, or to try to find parts of a genome.</p>

  <p><strong>Bandage</strong> (<span class="citation"><a href="#wick2015bandage">Wick <i>et al.</i> 2015</a></span>) is a tool creating interactive visualisations of assembly graphs.</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-visualization-the-assembly-graph"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Visualization the assembly graph</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/megahit_contig2fastg/megahit_contig2fastg/1.1.3+galaxy10" title="megahit contig2fastg tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>megahit contig2fastg</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.1.3+galaxy10)</span> with parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Contig file”</em>: Output of <strong>MEGAHIT</strong></li>
          <li>
            <p><em>“K-mer length”</em>: <code class="language-plaintext highlighter-rouge">91</code></p>

            <blockquote class="comment">
              <div class="box-title comment-title" id="comment-7"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>
              <p>To get the value, you need to</p>
              <ol>
                <li>Go into the <strong>MEGAHIT</strong> output collection</li>
                <li>Expand one of the contig file by clicking on it in the history</li>
                <li>Check in the dataset peek the name of the contig</li>
                <li>Extract the value after the first <code class="language-plaintext highlighter-rouge">k</code> in the contig names</li>
              </ol>
            </blockquote>
          </li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_image/0.8.1+galaxy4" title="Bandage Image tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Bandage Image</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 0.8.1+galaxy4)</span> with parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Graphical Fragment Assembly”</em>: Output of <strong>megahit contig2fastg</strong></li>
        </ul>
      </li>
      <li>Inspect the generated image for ERR2231571</li>
    </ol>
  </blockquote>

  <figure id="figure-7" style="max-width: 90%;"><img src="./images/ERR2231571_graph.jpg" alt="Image shows the assembly graphs, with longer stretch on the top and many small contigs on the bottom. " width="1292" height="1000" loading="lazy" /><a target="_blank" href="./images/ERR2231571_graph.jpg" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 7</strong>:</span> Assembly graph for ERR2231571 sample</figcaption></figure>

  <p>The graph is quite disconnected. On the top, we can see the longer stretches, that includes multiples contigs (each contig having a different color). On the bottom are the shortest stretches or single contigs.</p>

  <p>But it is really hard to read or extract any information from the graph. Let’s inspect the information about the assembly graph</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-visualization-the-de-novo-assembly-graph"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Visualization the *de novo* assembly graph</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bandage/bandage_info/0.8.1+galaxy2" title="Bandage Info tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Bandage Info</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 0.8.1+galaxy2)</span> with parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Graphical Fragment Assembly”</em>: Output of <strong>megahit contig2fastg</strong></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/collection_column_join/collection_column_join/0.0.3" title="Column join tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Column join</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 0.0.3)</span> with parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Tabular files”</em>: Output of <strong>Bandage Info</strong></li>
        </ul>
      </li>
      <li>Inspect the generated output</li>
    </ol>
  </blockquote>

  <blockquote class="question">
    <div class="box-title question-title" id="question-15"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <ol>
      <li>How many nodes are in the graph for ERR2231568? And for ERR2231572? What does they correspond to?</li>
      <li>How many edges are in the graph for ERR2231568? And for ERR2231572? What is the impact of these numbers in relation to the number of nodes on the graph?</li>
      <li>How many connected components are there for ERR2231568? And for ERR2231572? What does they correspond to?</li>
      <li>What is the percentage of dead ends are there for ERR2231568? And for ERR2231572?</li>
      <li>What are the smallest and larges edge overlaps?</li>
      <li>What is the largest component? For which sample?</li>
      <li>What is the shortest node? What does they correspond to?</li>
    </ol>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-15"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-15" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

      <ol>
        <li>There are 228,719 nodes for ERR2231568 and 122,526 for ERR2231572. They correspond to the number of contigs</li>
        <li>There are 16,580 edges for ERR2231568 and 13,993 for ERR2231572. There are less edges than nodes in the graph. It means that many nodes/contigs are disconnected</li>
        <li>There are 212,598 connected components, i.e. number of regions of the graph which are disconnected from each other, for ERR2231568 and 109,044 for ERR2231572</li>
        <li>There are 94.0702% dead ends, i.e. the end of a node not connected to any other nodes, for ERR2231568 and 90.7032% for ERR2231572. It confirms the previous observation</li>
        <li>The smallest and larges edge overlaps are 91bp, i.e. the k-mer length</li>
        <li>The largest component is 340,003 bp for ERR2231567</li>
        <li>The shortest node is 200 bp, i.e. the minimal size for a contig</li>
      </ol>

    </blockquote>

  </blockquote>
</blockquote>
<!--# De-replication

De-replication is the process of identifying sets of genomes that are the "same" in a list of genomes, and removing all but the “best” genome from each redundant set. How similar genomes need to be to be considered “same”, how to determine which genome is “best”, and other important decisions are discussed in [Important Concepts](https://drep.readthedocs.io/en/latest/choosing_parameters.html).

A common use for genome de-replication is the case of individual assembly of metagenomic data. If metagenomic samples are collected in a series, a common way to assemble the short reads is with a “co-assembly”. That is, combining the reads from all samples and assembling them together. The problem with this is assembling similar strains together can severely fragment assemblies, precluding recovery of a good genome bin. An alternative option is to assemble each sample separately, and then “de-replicate” the bins from each assembly to make a final genome set.

<figure id="figure-8" style="max-width: 90%;"><img src="./images/individual-assembly.png"  alt="Image shows the process of individual assembly on two strains and five samples, after individual assembly of samples two samples are chosen for de-replication process. In parallel, co-assembly on all five samples is performed. " width="80%" width="512" height=316 loading="lazy"><a target="_blank" href="./images/individual-assembly.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br/><br/><figcaption><span class="figcaption-prefix"><strong>Figure 8</strong>:</span> Individual assembly followed by de-replication vs co-assembly</figcaption></figure>

If we have different samples, then we do an individual assembly for each sample. In the figure above we see that after individual assembly we have results for every individual assembly represented with pie charts. Different colours on these charts show different strains (organisms). Every chart has a different percentage of every strain which means that the assemblies contain different strains in different proportions in each sample.

Afterwards, we do the process of de-replication. We try to combine all the assemblies and try to identify which genomes are the most proper.

Individual assembly is a good practice as well as co-assembly. They both have pros and cons and that are just different techniques.

Co-assembly is a more common practice. But in case of co-assembly the genome might be more fragmented afterwards (like it is shown in the figure)  and sometimes it can be less proper. However, it should be decided in every single case which approach to use (co- or individual). More comprehensive information about de-replication you can learn from paper <span class="citation"><a href="#evans2020">Evans and Denef 2020</a></span> to get more intuition about how de-replication works.

> <div class="box-title hands-on-title" id="hands-on-general-list-of-actions-for-de-replication"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: General list of actions for de-replication</div>
> 1. Create new history
> 2. Assemble each sample separately using your favorite assembler
> 3. Perform a co-assembly to catch low-abundance microbes
> 4. Bin each assembly separately using your favorite binner
> 5. Bin co-assembly using your favorite binner
> 6. Pull the bins from all assemblies together
> 7. rRun **dRep** on them
> 8. Perform downstream analysis on the de-replicated genome list
>
{: .hands_on}

We will perform steps from 1 to 3 in this tutorial a bit later while steps 4 - 8 will be considered in the following tutorial - Binning tutorial.-->

<h1 id="conclusion">Conclusion</h1>

<p>Metagenomic data can be assembled to, ideally, obtain the genomes of the species that are represented within the input data. But metagenomic assembly is <strong>complex</strong> and there are</p>
<ul>
  <li><strong>different approaches</strong> like de Bruijn graphs methods</li>
  <li><strong>different strategies</strong>, such as co-assembly, when we assembly all samples together, and individual assembly, when we assembly samples one by one</li>
  <li><strong>different tools</strong> like MetaSPAdes and MEGAHIT</li>
</ul>

<p>Once the choices made, metagenomic assembly can start:</p>
<ol>
  <li>Input data are assembled to obtain contigs and sometimes scaffolds</li>
  <li>Assembly quality is evaluated with various metrics</li>
  <li>The assembly graph can be visualized.</li>
</ol>

<p>Once all these steps done, we can move to the next phase to build Metagenomics Assembled Genomes (MAGs): binning</p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                        <h3>You've Finished the Tutorial</h3>
                        <button id="tutorial-finish-button" class="btn btn-primary" onclick="tutorial_finish()">I finished this tutorial 👍</button>
                        <p style="display: none" id="tutorial-finish-text">Please also consider filling out the <a href="#gtn-feedback">Feedback Form</a> as well!</p>
                        <script>
                        function tutorial_finish() {
                          if(typeof plausible !== 'undefined'){
                            // Plausible may be undefined (script blocked)
                            // or it may be defined, but opted-out (select box/DNT),
                            // which means `plausible()` will work but not send data, *nor* execute the callback.
                            plausible('TutorialComplete', {props: {path: document.location.pathname}})
                          }
                          // since the callback is completely cosmetic, we'll just issue it optimistically.
                          tutorial_finish_finish();
                        }
                        function tutorial_finish_finish() {
                          document.getElementById("tutorial-finish-button").innerText = 'Congrats! Thanks for letting us know! 🎉'
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-text").style.display = 'block'
                        }
                        </script>

                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>Assembly groups reads into contigs and scafolds.</p>
</li>
                        
                        <li><p>De Brujin Graphs use k-mers to assembly reads</p>
</li>
                        
                        <li><p>MetaSPAdes and MEGAHIT are assemblers</p>
</li>
                        
                        <li><p>Quast is the tool to assess the assembly quality</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the  <a href="/training-material/topics/assembly/faqs/">FAQ page for the Assembly topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                


                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="carpentries"><b>Metagenome Assembly – Data Processing and Visualization for Metagenomics</b>. <a href="https://carpentries-incubator.github.io/metagenomics/04-assembly/index.html">https://carpentries-incubator.github.io/metagenomics/04-assembly/index.html</a></li>
<li id="kececioglu2001">Kececioglu, J., and J. Ju, 2001 <b>Separating repeats in DNA sequence assembly</b>, pp. 176–183 <span style="font-style: normal">in</span> <i>Proceedings of the fifth annual international conference on Computational biology</i>, RECOMB ’01, <i>Association for Computing Machinery</i>, New York, NY, USA. <a href="https://doi.org/10.1145/369133.369192">10.1145/369133.369192</a></li>
<li id="miller2010">Miller, J. R., S. Koren, and G. Sutton, 2010 <b>Assembly Algorithms for Next-Generation Sequencing Data</b>. Genomics 95: 315–327. <a href="https://doi.org/10.1016/j.ygeno.2010.03.001">10.1016/j.ygeno.2010.03.001</a></li>
<li id="gurevich2013">Gurevich, A., V. Saveliev, N. Vyahhi, and G. Tesler, 2013 <b>QUAST: quality assessment tool for genome assemblies</b>. Bioinformatics (Oxford, England) 29: 1072–1075. <a href="https://doi.org/10.1093/bioinformatics/btt086">10.1093/bioinformatics/btt086</a></li>
<li id="li2015">Li, D., C.-M. Liu, R. Luo, K. Sadakane, and T.-W. Lam, 2015 <b>MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph</b>. Bioinformatics 31: 1674–1676. <a href="https://doi.org/10.1093/bioinformatics/btv033">10.1093/bioinformatics/btv033</a></li>
<li id="wick2015bandage">Wick, R. R., M. B. Schultz, J. Zobel, and K. E. Holt, 2015 <b>Bandage: interactive visualization of de novo genome assemblies</b>. Bioinformatics 31: 3350–3352. <a href="https://doi.org/10.1093/bioinformatics/btv383">10.1093/bioinformatics/btv383</a></li>
<li id="mikheenko2016">Mikheenko, A., V. Saveliev, and A. Gurevich, 2016 <b>MetaQUAST: evaluation of metagenome assemblies</b>. Bioinformatics (Oxford, England) 32: 1088–1090. <a href="https://doi.org/10.1093/bioinformatics/btv697">10.1093/bioinformatics/btv697</a></li>
<li id="nurk2017">Nurk, S., D. Meleshko, A. Korobeynikov, and P. A. Pevzner, 2017 <b>metaSPAdes: a new versatile metagenomic assembler</b>. Genome Research 27: 824–834. Company: Cold Spring Harbor Laboratory Press Distributor: Cold Spring Harbor Laboratory Press Institution: Cold Spring Harbor Laboratory Press Label: Cold Spring Harbor Laboratory Press Publisher: Cold Spring Harbor Lab. <a href="https://doi.org/10.1101/gr.213959.116">10.1101/gr.213959.116</a></li>
<li id="sczyrba2017">Sczyrba, A., P. Hofmann, P. Belmann, D. Koslicki, S. Janssen <i>et al.</i>, 2017 <b>Critical Assessment of Metagenome Interpretation—a benchmark of metagenomics software</b>. Nature Methods 14: 1063–1071. Number: 11 Publisher: Nature Publishing Group. <a href="https://doi.org/10.1038/nmeth.4458">10.1038/nmeth.4458</a></li>
<li id="evans2020">Evans, J. T., and V. J. Denef, 2020 <b>To Dereplicate or Not To Dereplicate?</b> mSphere 5: e00971–19. Publisher: American Society for Microbiology. <a href="https://doi.org/10.1128/mSphere.00971-19">10.1128/mSphere.00971-19</a></li>
<li id="meyer2021">Meyer, F., T.-R. Lesker, D. Koslicki, A. Fritz, A. Gurevich <i>et al.</i>, 2021 <b>Tutorial: assessing metagenomics software with the CAMI benchmarking toolkit</b>. Nature Protocols 16: 1785–1801. Number: 4 Publisher: Nature Publishing Group. <a href="https://doi.org/10.1038/s41596-020-00480-3">10.1038/s41596-020-00480-3</a></li>
<li id="meyer2022">Meyer, F., A. Fritz, Z.-L. Deng, D. Koslicki, T. R. Lesker <i>et al.</i>, 2022 <b>Critical Assessment of Metagenome Interpretation: the second round of challenges</b>. Nature Methods 19: 429–440. Number: 4 Publisher: Nature Publishing Group. <a href="https://doi.org/10.1038/s41592-022-01431-4">10.1038/s41592-022-01431-4</a></li></ol>
                

                

                <h1 id="gtn-feedback">Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=assembly/metagenomics-assembly"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=assembly/metagenomics-assembly">Feedback Form</a></iframe>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Polina Polunina, Bérénice Batut,  <b>Assembly of metagenomic sequencing data (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/assembly/tutorials/metagenomics-assembly/tutorial.html">https://training.galaxyproject.org/training-material/topics/assembly/tutorials/metagenomics-assembly/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{assembly-metagenomics-assembly,
author = "Polina Polunina and Bérénice Batut",
	title = "Assembly of metagenomic sequencing data (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/assembly/tutorials/metagenomics-assembly/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

        
		<h2 id="funding">Funding</h2>
		<p>These individuals or organisations provided funding support for the development of this resource</p>

                
<div class="d-flex flex-wrap">

	<a href="/training-material/hall-of-fame/gallantries/" class="funder-badge">
		
		<div class="avatar">
			
			<img class="funder-avatar" src="https://gallantries.github.io/assets/images/gallantries-logo.png" alt="Logo">
			
		</div>

		<div class="info">
			<div class="name">Gallantries</div>
			<div class="description">
			This project (2020-1-NL01-KA203-064717) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.



            
			</div>
		</div>
	</a>

</div>


        


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="details follow-up" id="admins-install-missing-tools">
                  <div id="admin-missing-tools" class="box-title">
                    <button type="button" aria-controls="admin-missing-tools" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Galaxy Administrators: Install the missing tools<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>


			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/assembly/tutorials/metagenomics-assembly/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools:
- name: text_processing
  owner: bgruening
  revisions: d698c222f354
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: unique
  owner: bgruening
  revisions: 7ce75adb93be
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: bamtools
  owner: devteam
  revisions: befc9dad4ca8
  tool_panel_section_label: SAM/BAM
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: bowtie2
  owner: devteam
  revisions: f6877ad76b00
  tool_panel_section_label: Mapping
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: bowtie2
  owner: devteam
  revisions: 03e9b2fbc005
  tool_panel_section_label: Mapping
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: fastqc
  owner: devteam
  revisions: 3d0c7bdf12f5
  tool_panel_section_label: FASTA/FASTQ
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: bandage
  owner: iuc
  revisions: 21e491ad532a
  tool_panel_section_label: Graph/Display Data
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: bandage
  owner: iuc
  revisions: 21e491ad532a
  tool_panel_section_label: Graph/Display Data
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: collection_column_join
  owner: iuc
  revisions: 3ddd99c7efee
  tool_panel_section_label: Join, Subtract and Group
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: coverm_contig
  owner: iuc
  revisions: 6941d0d453ba
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: filter_tabular
  owner: iuc
  revisions: 34d29339abab
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: megahit
  owner: iuc
  revisions: 14ddfc8ffb93
  tool_panel_section_label: Assembly
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: megahit_contig2fastg
  owner: iuc
  revisions: 4ec5b3777508
  tool_panel_section_label: Proteomics
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: ngsutils_bam_filter
  owner: iuc
  revisions: 2e957d4c4b95
  tool_panel_section_label: SAM/BAM
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: quast
  owner: iuc
  revisions: 3061c8b029e5
  tool_panel_section_label: Assembly
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: quast
  owner: iuc
  revisions: 72472698a2df
  tool_panel_section_label: Assembly
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: seqtk
  owner: iuc
  revisions: 3da72230c066
  tool_panel_section_label: FASTA/FASTQ
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: cutadapt
  owner: lparsons
  revisions: 5915ea1ec9b1
  tool_panel_section_label: FASTA/FASTQ
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: metaspades
  owner: nml
  revisions: fd128c111ab0
  tool_panel_section_label: Assembly
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
</code></pre></div>
                </blockquote>
		

		<blockquote class="details hide-when-printing" id="feedback-responses">
                  <div id="feedback-response-c" class="box-title">
                    <button type="button" aria-controls="feedback-response-c" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Feedback<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>

		   <p>
		   
		   <table class="charts-css bar show-labels" style="--labels-size: 8rem; overflow-y: hidden">
		   
			<tr>
				<th scope="row"><span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 1.0">1</td>
			</tr>
		   
		   </table>
		   </p>
		
        
        
            <p>No feedback has been recieved yet for this training. Be the first one by filling in the feedback form from <a href="#gtn-feedback">above</a>. </p>
        
		</blockquote>




		
		
		

                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					
					<li><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00035">gxy.io/GTN:T00035</a></li>
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/assembly/tutorials/metagenomics-assembly/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/assembly/tutorials/metagenomics-assembly/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/ee30569ed5e31b78b05a188eddba620db755a99d">ee30569</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.40d4e218.js'></script>

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
	

    </body>
</html>