<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Protein-ligand docking</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="Modelling, simulation and analysis of biomolecular systems" />
        <meta property="og:title" content="Galaxy Training: Protein-ligand docking" />
        <meta property="og:description" content="Modelling, simulation and analysis of biomolecular systems" />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        











<!-- Gitter -->


<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'galaxycomputationalchemistry/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/computational-chemistry" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">topic</span> Computational chemistry
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Language Selector">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Language
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fcheminformatics%2Ftutorial.html&edit-text=&act=url" title="">
                                Fran√ßais
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fcheminformatics%2Ftutorial.html&edit-text=&act=url" title="">
                                Êó•Êú¨Ë™û
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fcheminformatics%2Ftutorial.html&edit-text=&act=url" title="">
                                Espa√±ol
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fcheminformatics%2Ftutorial.html&edit-text=&act=url" title="">
                                Portugu√™s
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fcheminformatics%2Ftutorial.html&edit-text=&act=url" title="">
                                ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fcomputational-chemistry%2Ftutorials%2Fcheminformatics%2Ftutorial.html&edit-text=&act=url" title="">
                                And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>

        <div class="dropdown-item">
            <div>
                Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> üéÉ
                </label>
            </div>

        </div>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/computational-chemistry/tutorials/cheminformatics/tutorial.md">
                            <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Protein-ligand docking",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "https://github.com/galaxyproject/training-material/blob/master/LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Computational chemistry",
    "description": "Modelling, simulation and analysis of biomolecular systems",
    "url": "https://training.galaxyproject.org//training-material/topics/computational-chemistry/"
  },
  "courseCode": "computational-chemistry / cheminformatics / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Protein-ligand docking' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/computational-chemistry/tutorials/cheminformatics/tutorial.html",
  "timeRequired": "PT3H",
  "description": "The questions this  addresses are:\n - What is cheminformatics?\n - What is protein-ligand docking?\n - How can I perform a simple docking workflow in Galaxy?\n\n\\nThe objectives are:\n - Create a small compound library using the ChEMBL database\n - Dock a variety of ligands to the active site of the Hsp90 protein\n\n",
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Simon Bray"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Simon Bray"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Computational chemistry",
      "description": "Modelling, simulation and analysis of biomolecular systems",
      "url": "https://training.galaxyproject.org//training-material/topics/computational-chemistry/"
    }
  ],
  "skillLevel": "Intermediate"
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>Protein-ligand docking</h1>
        

        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame/simonbray/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/simonbray" alt="Simon Bray">Simon Bray</a>

</div>

        <blockquote class="overview">
            <h3>Overview</h3>
            <strong><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li><p>What is cheminformatics?</p>
</li>
            
            <li><p>What is protein-ligand docking?</p>
</li>
            
            <li><p>How can I perform a simple docking workflow in Galaxy?</p>
</li>
            
            </ul>

            <strong><i class="fas fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li><p>Create a small compound library using the ChEMBL database</p>
</li>
            
            <li><p>Dock a variety of ligands to the active site of the Hsp90 protein</p>
</li>
            
            </ul>

            
            <strong><i class="fas fa-check-circle" aria-hidden="true"></i><span class="visually-hidden">requirements</span> Requirements</strong>
            <ul>
            
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

            
            </ul>
            

            
            <p><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 3 hours</p>
            

            
            <p><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> Level: </strong>
             Intermediate 
<span class="level intermediate" title="Intermediate Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span>
</span>

</p>
            

            
            

            
            <p id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials</strong></p>
            <ul>
                <div class="supporting_material">
                

                

                
                    <li class="btn btn-default supporting_material">
    <a class="topic-icon" href="/training-material/topics/computational-chemistry/tutorials/cheminformatics/workflows/" title="Workflows" alt="Protein-ligand docking workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden">workflow</span> Workflows
    </a>

</li>
                

                

                
                    <li class="btn btn-default supporting_material">

    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span> Available on these Galaxies
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/master/topics/computational-chemistry/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://cheminformatics.usegalaxy.eu/" title="ChemicalToolbox">
            ChemicalToolbox
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://africa.usegalaxy.eu/" title="Galaxy Africa">
            Galaxy Africa
        </a>
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://galaxy.genouest.org" title="Galaxy@GenOuest">
            Galaxy@GenOuest
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.eu" title="UseGalaxy.eu">
            UseGalaxy.eu
        </a>
        
    
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.no/" title="UseGalaxy.no">
            UseGalaxy.no
        </a>
        
    
        
    
        
    
        
    
    </ul>


</li>
                
                </div>
            </ul>
            

            <p><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last modification:</strong> Jan 6, 2021 </p>
        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <h1 class="no_toc" id="introduction">Introduction</h1>

<p>Cheminformatics is the use of computational techniques and information about molecules to solve problems in chemistry. This involves a number of steps: retrieving data on chemical compounds, sorting data for properties which are of interest, and extracting new information. This tutorial will provide a brief overview of all of these, centered around protein-ligand docking, a molecular modelling technique. The purpose of protein-ligand docking is to find the optimal binding between a small molecule (ligand) and a protein. It is generally applied to the drug discovery and development process with the aim of finding a potential drug candidate. First, a target protein is identified. This protein is usually linked to a disease and is known to bind small molecules. Second, a ‚Äòlibrary‚Äô of possible ligands is assembled. Ligands are small molecules that bind to a protein and may interfere with protein function. Each of the compounds in the library is then ‚Äòdocked‚Äô into the protein to find the optimal binding position and energy.</p>

<p>Docking is a form of molecular modelling, but several simplifications are made in comparison to methods such as molecular dynamics. Most significantly, the receptor is generally considered to be rigid, with covalent bond lengths and angles held constant. Charges and protonation states are also not permitted to change. While these approximations reduce accuracy to some extent, they increase computational speed, which is necessary to screen a large compound library in a realistic amount of time.</p>

<p>In this tutorial, you will perform docking of ligands into the N-terminus of Hsp90 (heat shock protein 90). The tools used for docking are based on the open-source software <a href="http://vina.scripps.edu/">AutoDock Vina</a> (<a class="citation" href="#Trott2009">Trott and Olson 2009</a>).</p>

<blockquote class="details">
  <h3 id="details-biological-background"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> Biological background</h3>

  <p>The 90 kDa heat shock protein (Hsp90) is a chaperone protein responsible for catalyzing the conversion of a wide variety of proteins to a functional form; examples of the Hsp90 clientele, which totals several hundred proteins, include nuclear steroid hormone receptors and protein kinases. The mechanism by which Hsp90 acts varies between clients, as does the client binding site; the process is dependent on post-translational modifications of Hsp90 and the identity of co-chaperones which bind and regulate the conformational cycle.</p>

  <p>Due to its vital biochemical role as a chaperone protein involved in facilitating the folding of many client proteins, Hsp90 is an attractive pharmaceutical target. In particular, as protein folding is a potential bottleneck to slow cellular reproduction and growth, blocking Hsp90 function using inhibitors which bind tightly to the ATP binding site could assist in treating cancer; for example, the antibiotic geldanamycin and its analogs are under investigation as possible anti-tumor agents.</p>

  <p>See <a class="citation" href="#Pearl2006">Pearl and Prodromou 2006</a> for a review on the structure and mechanism of the Hsp90 protein. Alte<span class="notranslate">rna</span>tively, read more at <a href="https://pdb101.rcsb.org/motm/108">PDB-101</a> and <a href="https://en.wikipedia.org/wiki/Hsp90">Wikipedia</a>.</p>
</blockquote>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#download-data" id="markdown-toc-download-data">Download data</a>    <ol>
      <li><a href="#get-data" id="markdown-toc-get-data">Get data</a></li>
    </ol>
  </li>
  <li><a href="#separating-protein-and-ligand-structures" id="markdown-toc-separating-protein-and-ligand-structures">Separating protein and ligand structures</a>    <ol>
      <li><a href="#creating-and-processing-the-compound-library" id="markdown-toc-creating-and-processing-the-compound-library">Creating and processing the compound library</a></li>
    </ol>
  </li>
  <li><a href="#prepare-files-for-docking" id="markdown-toc-prepare-files-for-docking">Prepare files for docking</a></li>
  <li><a href="#docking" id="markdown-toc-docking">Docking</a></li>
  <li><a href="#optional-cheminformatics-tools-applied-to-the-compound-library" id="markdown-toc-optional-cheminformatics-tools-applied-to-the-compound-library">Optional: cheminformatics tools applied to the compound library</a></li>
  <li><a href="#post-processing-and-plotting" id="markdown-toc-post-processing-and-plotting">Post-processing and plotting</a></li>
</ol>

</blockquote>

<h1 id="download-data">Download data</h1>

<p>For this exercise, we need two datasets: a protein structure and a library of compounds. We will download the former directly from the Protein Data Bank; the latter will be created by searching the ChEMBL database (<a class="citation" href="#Gaulton2016">Gaulton <i>et al.</i> 2016</a>).</p>

<h2 id="get-data">Get data</h2>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Data upload</h3>

  <ol>
    <li>Create a new history for this tutorial</li>
    <li>Search <span class="notranslate">Galaxy</span> for the ‚ÄòGet PDB‚Äô tool. Request the accession code <code class="language-plaintext highlighter-rouge">2brc</code>.</li>
    <li>Rename the dataset to ‚ÄòHsp90 structure‚Äô</li>
    <li>
      <p>Check that the datatype is correct (PDB file).</p>

      <blockquote class="tip">

        <h3 id="tip-tip-changing-the-datatype"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing the datatype</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, click on the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>
          <li>Select <code class="language-plaintext highlighter-rouge">datatypes</code></li>
          <li>Click the <strong>Change datatype</strong> button</li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<figure id="figure-1"><img src="/training-material/topics/computational-chemistry/images/2brc.png" alt="Hsp90 N-terminus structure" /><figcaption><span class="figcaption-prefix">Figure 1:</span> Structure of Hsp90 N-terminus, as recorded on the PDB. Visualization produced using VMD  (<a class="citation" href="#Humphrey1996">Humphrey <i>et al.</i> 1996</a>).</figcaption></figure>

<h1 id="separating-protein-and-ligand-structures">Separating protein and ligand structures</h1>

<p>You can view the contents of the downloaded PDB file by pressing the ‚ÄòView data‚Äô icon in the history pane. After the header section (about 500 lines), the atoms of the protein and their coordinates are listed. The lines begin with <code class="language-plaintext highlighter-rouge">ATOM</code>. At the end of the file, the atomic coordinates of the ligand and the solvent water molecules are also listed, labelled <code class="language-plaintext highlighter-rouge">HETATM</code>. We will use the grep tool to separate these molecules into separate files, and then convert the ligand file into SDF/MOL format using the ‚ÄòCompound conversion‚Äô tool, which is based on OpenBabel, an open-source library for analyzing chemical data (<a class="citation" href="#OBoyle2011">O‚ÄôBoyle <i>et al.</i> 2011</a>).</p>

<blockquote class="details">
  <h3 id="details-what-is-grep"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> What is grep?</h3>

  <p>Grep is a command-line tool for searching text files for lines which match a search query.</p>

  <p>There is a <span class="notranslate">Galaxy</span> tool available based on grep, which we will apply to the downloaded PDB tool.</p>

</blockquote>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-separate-protein-and-ligand"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Separate protein and ligand</h3>

  <ol>
    <li><strong>Search in textfiles (grep)</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSelect lines from‚Äù</em>: Downloaded PDB file ‚ÄòHsp90 structure‚Äô</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúthat‚Äù</em>: <code class="language-plaintext highlighter-rouge">Don't match</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">HETATM</code></li>
        <li>All other parameters can be left as their defaults.</li>
        <li>Rename the dataset <strong>‚ÄòProtein (PDB)‚Äô</strong>.</li>
      </ul>

      <p>The result is a file with all non-protein (<code class="language-plaintext highlighter-rouge">HETATM</code>) atoms removed.</p>
    </li>
    <li><strong>Search in textfiles (grep)</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters. Here, we use grep again to produce a file with only non-protein atoms.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSelect lines from‚Äù</em>: Downloaded PDB file ‚ÄòHsp90 structure‚Äô</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúthat‚Äù</em>: <code class="language-plaintext highlighter-rouge">Match</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">CT5</code> (the name of the ligand in the PDB file)</li>
        <li>All other parameters can be left as their defaults.</li>
        <li>Rename the dataset <strong>‚ÄòLigand (PDB)‚Äô</strong>.</li>
      </ul>

      <p>This produces a file which only contains ligand atoms.</p>
    </li>
    <li><strong>Compound conversion</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúMolecular input file‚Äù</em>: Ligand PDB file created in step 2.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúOutput format‚Äù</em>: <code class="language-plaintext highlighter-rouge">MDL MOL format (sdf, mol)</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAdd hydrogens appropriate for pH‚Äù</em>: <code class="language-plaintext highlighter-rouge">7.4</code></li>
        <li>All other parameters can be left as their defaults.</li>
        <li>Change the datatype to ‚Äòmol‚Äô and rename the dataset <strong>‚ÄòLigand (MOL)‚Äô</strong>.</li>
      </ul>

      <p>Applying this tool will generate a representation of the structure of the ligand in MOL format.</p>
    </li>
  </ol>

</blockquote>

<p>At this stage, separate protein and ligand files have been created. Next, we want to generate a compound library we can use for docking.</p>

<h2 id="creating-and-processing-the-compound-library">Creating and processing the compound library</h2>

<p>In this step we will create a compound library, using data from the ChEMBL database.</p>

<blockquote class="details">
  <h3 id="details-what-chemical-databases-are-available"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> What chemical databases are available?</h3>

  <p>Multiple databases are available online which provide access to chemical information, e.g. chemical structures, reactions, or literature. In this tutorial, we use a tool which searches the <a href="https://www.ebi.ac.uk/chembl/">ChEMBL</a> database. There are also <span class="notranslate">Galaxy</span> tools available for downloading data from <a href="https://pubchem.ncbi.nlm.nih.gov/">PubChem</a>.</p>

  <p>Other notable databases include <a href="https://www.drugbank.ca/">Drugbank</a> and <a href="http://www.chemspider.com/">ChemSpider</a>.</p>

</blockquote>

<p>We will generate our compound library by searching ChEMBL for compounds which have a similar structure to the ligand in the PDB file we downloaded in the first step. There is a <span class="notranslate">Galaxy</span> tool for accessing ChEMBL which requires data input in SMILES format; thus, the first step is to convert the ‚ÄòLigand‚Äô PDB file to a SMILES file. Then the search is performed, returning a SMILES file. For docking, we would like to convert to SDF format, which we can do once again using the ‚ÄòCompound conversion‚Äô tool.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generate-compound-library"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generate compound library</h3>

  <ol>
    <li><strong>Compound conversion</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúMolecular input file‚Äù</em>: ‚ÄòLigand‚Äô PDB file</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúOutput format‚Äù</em>: <code class="language-plaintext highlighter-rouge">SMILES format (SMI)</code></li>
        <li>Leave all other options as default.</li>
      </ul>
    </li>
    <li>Rename the output of the ‚Äòcompound conversion‚Äô step to <strong>‚ÄòLigand SMILES‚Äô</strong>.</li>
    <li><strong>Search ChEMBL database</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSMILES input type‚Äù</em>: File</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput file‚Äù</em>: ‚ÄòLigand SMILES‚Äô file</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSearch type‚Äù</em>: <code class="language-plaintext highlighter-rouge">Similarity</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTanimoto cutoff score‚Äù</em>: <code class="language-plaintext highlighter-rouge">80</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFilter for Lipinski‚Äôs Rule of Five‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li>All other parameters can be left as their defaults.</li>
      </ul>

      <blockquote class="question">
        <h3 id="question-question"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Question</h3>

        <p>Why are compounds filtered for Lipinski‚Äôs Rule of Five?</p>

        <blockquote class="solution">
          <h3 id="solution-solution"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
          <p>Lipinski‚Äôs rule of five is an empirical rule which can be used to determine the ‚Äòdruglikeness‚Äô of a molecule. The rule consists of four criteria which relate to the pharmacokinetics of the molecule. The rule is discussed in (<a class="citation" href="#Lipinski2004">Lipinski 2004</a>), or you can also read more on <a href="https://en.wikipedia.org/wiki/Lipinski%27s_rule_of_five">Wikipedia</a>.</p>
        </blockquote>
      </blockquote>

      <p>Optional: experiment with different combinations of options - adding different filters, adjusting the Tanimoto coefficient.</p>
    </li>
    <li>
      <p>Check that the datatype is correct (smi). This step is essential, as <span class="notranslate">Galaxy</span> does not automatically detect the datatype for SMILES files.</p>

      <blockquote class="tip">

        <h3 id="tip-tip-changing-the-datatype-1"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing the datatype</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, click on the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>
          <li>Select <code class="language-plaintext highlighter-rouge">datatypes</code></li>
          <li>Click the <strong>Change datatype</strong> button</li>
        </ul>
      </blockquote>
    </li>
    <li>Rename dataset <strong>‚ÄòCompound library‚Äô</strong>.</li>
  </ol>

</blockquote>

<p>There are some other tools available, which will not be used in this tutorial, which help to develop a more focused compound library. For example, the ‚ÄòNatural product likeness calculator‚Äô and ‚ÄòDrug-likeness‚Äô tools assign a score to compounds based on how similar they are to typical natural products and drugs respectively, which could then be used to filter the library. If you are interested, you can try testing them out on the library just generated.</p>

<blockquote class="tip">
  <h3 id="tip-tip-generating-a-compound-library"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Generating a compound library</h3>
  <p>If you try using this tutorial using your own data, you might encounter some issues. Important things to remember:</p>
  <ul>
    <li>If you encounter an error, check the SMILES file only has a single column. Additional columns can be removed using the ‚ÄòCut‚Äô tool.</li>
    <li>If the output file is empty, it may be that the ChEMBL database doesn‚Äôt have any compounds similar to the input. Consider lowering the Tanimoto coefficient to 70 if this is the case and removing filters (including the Lipinski RO5 filter). If this doesn‚Äôt help, you will have to use another source of chemical data (e.g. PubChem).</li>
    <li>Finally, please remember this step is totally optional if you already have a list of compounds for docking (in SMILES or another format). In this case you can upload them to <span class="notranslate">Galaxy</span> and continue with the next step.</li>
  </ul>
</blockquote>

<blockquote class="details">
  <h3 id="details-what-are-smiles-and-sdf-formats"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> What are SMILES and SDF formats?</h3>

  <p>SMILES and SD-files both represent chemical structures. A SMILES file represents the 2D structure of a molecule as a chemical graph. In other words, it states only the atoms and the connectivity between them. An example of a SMILES string (taken from the ligand in the PDB file) is <code class="language-plaintext highlighter-rouge">c1c2OCCOc2ccc1c1c(C)[nH]nc1c1cc(CC)c(O)cc1O</code>. For more information on how the notation works, please consult the <a href="http://opensmiles.org/opensmiles.html">OpenSMILES specification</a> or the description provided by <a href="https://en.wikipedia.org/wiki/Simplified_molecular-input_line-entry_system">Wikipedia</a>. A more comprehensive alte<span class="notranslate">rna</span>tive to the SMILES system is the Inte<span class="notranslate">rna</span>tional Chemical Identifier (InChI).</p>

  <p>Neither SMILES nor InChI format contain the three-dimensional structure of a molecule. By contrast, the SDF (structure data file) format encodes three-dimensional atomic coordinates of a structure, similar to a PDB file.</p>

  <p>In a previous step, we also generated a MOL file - this format is closely related to the SDF format. The difference is that MOL files can store only a single molecule, whereas SD-files can encode single or multiple molecules. Multiple molecules are separated by lines containing four dollar signs (<code class="language-plaintext highlighter-rouge">$$$$</code>).</p>

  <p>For docking, we need the three-dimensional coordinates of the ligand; thus, we want to convert from SMILES to SDF format.</p>
</blockquote>

<h1 id="prepare-files-for-docking">Prepare files for docking</h1>

<p>A processing step now needs to be applied to the protein structure and the docking candidates - each of the structures needs to be converted to PDBQT format before using the AutoDock Vina docking tool.</p>

<p>Further, docking requires the coordinates of a binding site to be defined. Effectively, this defines a ‚Äòbox‚Äô in which the docking software attempts to define an optimal binding site. In this case, we already know the location of the binding site, since the downloaded PDB structure contained a bound ligand. There is a tool in <span class="notranslate">Galaxy</span> which can be used to automatically create a configuration file for docking when ligand coordinates are already known.</p>

<blockquote class="details">
  <h3 id="details-how-to-find-the-binding-site-of-an-apoprotein"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> How to find the binding site of an apoprotein?</h3>

  <p>If the structure contains no ligand in complex with the protein (i.e. apoprotein), identifying the binding site is not trivial. There are software available for automatic detection of pockets which may be promising candidates for ligand binding sites. For example, try out the fpocket tool  (<a class="citation" href="#LeGuilloux2009">Le Guilloux <i>et al.</i> 2009</a>) on the Hsp90 structure.</p>

</blockquote>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generate-pdbqt-and-config-files-for-docking"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generate PDBQT and config files for docking</h3>

  <ol>
    <li><strong>Prepare receptor</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSelect a PDB file‚Äù</em>: ‚ÄòProtein‚Äô PDB file.</li>
      </ul>
    </li>
    <li><strong>Compound conversion</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúMolecular input file‚Äù</em>: ‚ÄòCompound library‚Äô file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúOutput format‚Äù</em>: <code class="language-plaintext highlighter-rouge">SDF</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGenerate 3D coordinates‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li>Leave all other options unchanged.</li>
        <li>Rename to ‚ÄòPrepared ligands‚Äô</li>
      </ul>
    </li>
    <li><strong>Calculate the box parameters for an AutoDock Vina job</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput ligand‚Äù</em>: ‚ÄòLigand (MOL) file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúx-axis buffer‚Äù</em>: <code class="language-plaintext highlighter-rouge">5</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúy-axis buffer‚Äù</em>: <code class="language-plaintext highlighter-rouge">5</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúz-axis buffer‚Äù</em>: <code class="language-plaintext highlighter-rouge">5</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúExhaustiveness‚Äù</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
        <li>The ‚ÄòRandom seed‚Äô parameter should be left empty.</li>
        <li>Rename to ‚ÄòDocking config file‚Äô</li>
      </ul>
    </li>
  </ol>
</blockquote>

<h1 id="docking">Docking</h1>

<p>Now that the protein and the ligand library have been correctly prepared and formatted, docking can be performed.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-perform-docking"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Perform docking</h3>

  <ol>
    <li><strong>Docking</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúReceptor‚Äù</em>: ‚ÄòProtein PDBQT‚Äô file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúLigands‚Äù</em>: ‚ÄòPrepared ligands‚Äô file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSpecify pH value for ligand protonation‚Äù</em>: <code class="language-plaintext highlighter-rouge">7.4</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSpecify parameters‚Äù</em>: ‚ÄòUpload a config file to specify parameters‚Äô</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúBox configuration‚Äù</em>: ‚ÄòDocking config file‚Äô</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúExhaustiveness‚Äù</em>: leave blank (it was specified in the previous step)</li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>The output consists of a collection, which contains an SDF output file for each ligand, containing multiple docking poses and scoring files for each of the ligands. We will now perform some processing on these files which extracts scores from the SD-files and selects the best score for each.</p>

<h1 id="optional-cheminformatics-tools-applied-to-the-compound-library">Optional: cheminformatics tools applied to the compound library</h1>

<p>The ChemicalToolBox contains a large number of cheminformatics tools. This section will demonstrate some of the useful functionalities available. If you are just interested in docking, feel free to skip this section - or, just try out the tools which look particularly interesting.</p>

<p>(This section can also be completed while waiting for the docking, which can take some time to complete.)</p>

<h3 id="visualization">Visualization</h3>

<p>It can be useful to visualize the compounds generated. There is a tool available for this in <span class="notranslate">Galaxy</span> based on OpenBabel.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-visualization-of-chemical-structures"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Visualization of chemical structures</h3>

  <ol>
    <li><strong>Visualisation</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúMolecular input file‚Äù</em>: Compound library</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúEmbed molecule as CML‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúDraw all carbon atoms‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúUse thicker lines‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúProperty to display under the molecule‚Äù</em>: <code class="language-plaintext highlighter-rouge">Molecule weight</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSort the displayed molecules by‚Äù</em>: <code class="language-plaintext highlighter-rouge">Molecular weight</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> Format of the resultant picture‚Äù*: <code class="language-plaintext highlighter-rouge">SVG</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<p>This produces an SVG image of all the structures generated ordered by molecular weight.</p>

<figure id="figure-2"><img src="/training-material/topics/computational-chemistry/images/compound_library.png" alt="Hsp90 N-terminus structure" /><figcaption><span class="figcaption-prefix">Figure 2:</span> Structures of the compounds from ChEMBL.</figcaption></figure>

<h3 id="calculation-of-fingerprints-and-clustering">Calculation of fingerprints and clustering</h3>

<p>In this step, we will group similar molecules together. A key tool in cheminformatics for measuring molecular similarity is fingerprinting, which entails extracting chemical properties of molecules and storing them as a bitstring. These bitstrings can be easily compared computationally, for example with a clustering method. The fingerprinting tools in <span class="notranslate">Galaxy</span> are based on the Chemfp tools (<a class="citation" href="#Dalke2013">Dalke 2013</a>).</p>

<p>Before clustering, let‚Äôs label each compound. To do so add a second column to the SMILES compound library containing a label for each molecule. The <code class="language-plaintext highlighter-rouge">Ligand SMILES</code> file is also labelled something like <code class="language-plaintext highlighter-rouge">/data/dnb02/<span class="notranslate">galaxy</span>_db/files/010/406/dataset_10406067.dat</code> (the exact name will vary) and we would like to give it a more useful name. When labelling is complete, we can concatenate (join together) the library file with the original SMILES file for the ligand from the PDB file.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-calculate-molecular-fingerprints"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Calculate molecular fingerprints</h3>
  <ol>
    <li><strong>Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile to process‚Äù</em>: <code class="language-plaintext highlighter-rouge">Ligand SMILES</code>.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFind pattern‚Äù</em>: add the current label of the SMILES here. You can find it by clicking the ‚Äòview‚Äô button next to the <code class="language-plaintext highlighter-rouge">Ligand SMILES</code> dataset - it will look something like <code class="language-plaintext highlighter-rouge">/data/dnb02/<span class="notranslate">galaxy</span>_db/files/010/406/dataset_10406067.dat</code>.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">ligand</code></li>
      </ul>
    </li>
    <li><strong>Concatenate datasets</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúDatasets to concatenate‚Äù</em>: Output of the previous step.</li>
        <li>Click on <strong>Insert Dataset</strong> and in the new selection box which appears, select ‚ÄòCompound library‚Äô.</li>
        <li>Run the step and rename the output dataset ‚ÄòLabelled compound library‚Äô.</li>
      </ul>
    </li>
    <li><strong>Molecules to Fingerprints</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúmolecule file‚Äù</em>: ‚ÄòLabelled compound library‚Äô file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúType of fingerprint‚Äù</em>: <code class="language-plaintext highlighter-rouge">Open Babel FP2 fingerprints</code></li>
        <li>Rename to ‚ÄòFingerprints‚Äô.</li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>Taylor-Butina clustering  (<a class="citation" href="#Butina1999">Butina 1999</a>) provides a classification of the compounds into different groups or clusters, based on their structural similarity. This methods shows us how similar the compounds are to the original ligand, and after docking, we can compare the results to the proposed clusters to observe if there is any correlation.</p>

<figure id="figure-3"><img src="/training-material/topics/computational-chemistry/images/fingerprints.png" alt="Fingerprinting" /><figcaption><span class="figcaption-prefix">Figure 3:</span> A simple fingerprinting system. Each 1 or 0 in the bitstring corresponds to the presence or absence of a particular feature in the molecule. In this case, the presence of phenyl, amine and carboxylic acid groups are encoded.</figcaption></figure>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-cluster-molecules-using-molecular-fingerprints"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Cluster molecules using molecular fingerprints</h3>
  <ol>
    <li><strong>Taylor-Butina clustering</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFingerprint dataset‚Äù</em>: ‚ÄòFingerprints‚Äô file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúthreshold‚Äù</em>: <code class="language-plaintext highlighter-rouge">0.8</code></li>
      </ul>
    </li>
    <li><strong>NxN Clustering</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFingerprint dataset‚Äù</em>: ‚ÄòFingerprints‚Äô file.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúthreshold‚Äù</em>: <code class="language-plaintext highlighter-rouge">0.0</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFormat of the resulting picture‚Äù</em>: <code class="language-plaintext highlighter-rouge">SVG</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúOutput options‚Äù</em>: <code class="language-plaintext highlighter-rouge">Image</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>The image produced by the NxN clustering shows the clustering in the form of a dendrogram, where individual molecules are represented as vertical lines and merged into clusters. Merges are represented by horizontal lines. The y-axis represents the similarity of data points to each other; thus, the lower a cluster is merged, the more similar the data points are which it contains. Clusters in the dendogram are colored differently. For example, all molecules connected in red are similar enough to be grouped into the same cluster.</p>

<figure id="figure-4"><img src="/training-material/topics/computational-chemistry/images/nxn.png" alt="NxN clustering" /><figcaption><span class="figcaption-prefix">Figure 4:</span> Dendrogram produced by NxN clustering. The library used to produce this image is generated with a Tanimoto cutoff of 80; here 15 search results are shown, plus the original ligand contained in the PDB file.</figcaption></figure>

<blockquote class="details">
  <h3 id="details-further-investigation-optional"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> Further investigation (optional)</h3>

  <ul>
    <li>
      <p>Try generating fingerprints using some of the other nine different protocols available and monitor how this affects the clustering.</p>
    </li>
    <li>
      <p>For both the Taylor-Butina and NxN clustering, a threshold has to be set. Try varying this value and observe how the clustering results are affected.</p>
    </li>
  </ul>

</blockquote>

<h1 id="post-processing-and-plotting">Post-processing and plotting</h1>

<p>From our collection of SD-files, we first extract all stored values into tabular format and then combine the files together to create a single tabular file.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-process-sd-files"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Process SD-files</h3>

  <ol>
    <li><strong>Extract values from an SD-file</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput SD-file‚Äù</em>: Collection of SD-files generated by the docking step. (Remember to select the ‚Äòcollection‚Äô icon!)</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInclude the property name as header‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSpecify pH value for ligand protonation‚Äù</em>: <code class="language-plaintext highlighter-rouge">7.4</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInclude molecule name as column in output‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li>Leave all other paramters unchanged.</li>
      </ul>
    </li>
    <li><strong>Collapse Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúCollection of files to collapse into single dataset‚Äù</em>: Collection of tabular files generated by the previous step.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúKeep one header line‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAppend File name‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
      </ul>

      <blockquote class="tip">

        <h3 id="tip-tip-selecting-a-dataset-collection-as-input"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Selecting a dataset collection as input</h3>

        <ol>
          <li>Click on <i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <strong>Dataset collection</strong> in
front of the input parameter you want to supply the collection to.</li>
          <li>Select the collection you want to use from the list</li>
        </ol>
      </blockquote>
    </li>
    <li><strong>Compound conversion</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúMolecular input file‚Äù</em>: choose one of the SD-files from the collection generated by the docking step.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúOutput format‚Äù</em>: <code class="language-plaintext highlighter-rouge">Protein Data Bank format (pdb)</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSplit multi-molecule files into a collection‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li>Leave all other parameters unchanged.</li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>We now have a tabular file available which contains all poses calculated for all ligands docked, together with scores and RMSD values for the deviation of each pose from the optimum. We also have PDB files for some of the docking poses which can be inspected using the NGLViewer visualization embedded in <span class="notranslate">Galaxy</span>.</p>

<blockquote class="details">
  <h3 id="details-further-investigation-optional-1"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> Further investigation (optional)</h3>

  <p>There are visualizations available in <span class="notranslate">Galaxy</span> for producing various types of plots - for example, a scatter plot of RMSD (compared to optimal docking pose) against docking score can be calculated very easily:</p>

  <figure id="figure-5"><img src="/training-material/topics/computational-chemistry/images/scatterplot.png" alt="Scatter plot of RMSD against docking score" /><figcaption><span class="figcaption-prefix">Figure 5:</span> Scatter plot of RMSD against docking score.</figcaption></figure>

  <p>The plot shows a correlation between the two variables, as expected, though only a slight one, given the narrow range of docking scores in the dataset and the structural similarity of the ligands tested.</p>

  <p>A more advanced exercise would be to generate molecular descriptors for the molecule (there are three tools available for this in <span class="notranslate">Galaxy</span>: RDKit, Mordred and PaDEL) and to identify those which are particularly predictive of docking score, either by inspecting plots or using the statistics tools built into <span class="notranslate">Galaxy</span>.</p>
</blockquote>

<p>Use the NGLviewer to inspect the protein and various ligand poses generated by docking. This can be done using either the visualization of NGLViewer in <span class="notranslate">Galaxy</span>, or via the <a href="http://nglviewer.org/ngl/">NGL website</a>.</p>

<figure id="figure-6"><img src="/training-material/topics/computational-chemistry/images/activesite.gif" alt="Two docking poses for a ligand bound to Hsp90" /><figcaption><span class="figcaption-prefix">Figure 6:</span> Two docking poses for a ligand bound to the active site of Hsp90. One (docking score -8.4) can be seen to be bound deeper in the active site than the other (docking score -5.7), which is reflected in the difference between the docking scores.</figcaption></figure>


                    
                    <blockquote class="key_points">
                        <h3><i class="fas fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>
                        <ul>
                            
                            <li><p>Docking allows ‚Äòvirtual screening‚Äô of drug candidates</p>
</li>
                            
                            <li><p>Molecular fingerprints encode features into a bitstring</p>
</li>
                            
                            <li><p>The ChemicalToolbox contains many tools for cheminformatics analysis</p>
</li>
                            
                        </ul>
                    </blockquote>
                    

                    
                    <h1 data-toc-skip>Useful literature</h1>
                    <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/computational-chemistry#references">here</a>.</p>
                    

                    
                    <h1 id="bibliography">References</h1>
                    <ol class="bibliography"><li><span id="Humphrey1996">Humphrey, W., A. Dalke, and K. Schulten, 1996 <b>VMD ‚Äì Visual Molecular Dynamics</b>. Journal of Molecular Graphics 14: 33‚Äì38.</span>
    
    .
    
    
    

</li>
<li><span id="Butina1999">Butina, D., 1999 <b>Unsupervised data base clustering based on daylight‚Äôs fingerprint and Tanimoto similarity: A fast and automated way to cluster small and large data sets</b>. Journal of Chemical Information and Computer Sciences 39: 747‚Äì750.</span>
    
    
    

</li>
<li><span id="Lipinski2004">Lipinski, C. A., 2004 <b>Lead- and drug-like compounds: the rule-of-five revolution</b>. Drug Discovery Today: Technologies 1: 337‚Äì341.</span>
    
    
    <a href="https://doi.org/10.1016/j.ddtec.2004.11.007">10.1016/j.ddtec.2004.11.007</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li>
<li><span id="Pearl2006">Pearl, L. H., and C. Prodromou, 2006 <b>Structure and Mechanism of the Hsp90 Molecular Chaperone Machinery.</b> Annual Review of Biochemistry 75: 271‚Äì294.</span>
    
    
    <a href="https://doi.org/10.1146/annurev.biochem.75.103004.142738">10.1146/annurev.biochem.75.103004.142738</a>
    
    

</li>
<li><span id="Trott2009">Trott, O., and A. J. Olson, 2009 <b>AutoDock Vina: Improving the speed and accuracy of docking with a new scoring function,  efficient optimization,  and multithreading</b>. Journal of Computational Chemistry NA‚ÄìNA.</span>
    
    
    <a href="https://doi.org/10.1002/jcc.21334">10.1002/jcc.21334</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li>
<li><span id="LeGuilloux2009">Le Guilloux, V., P. Schmidtke, and P. Tuffery, 2009 <b>Fpocket: an open source platform for ligand pocket detection</b>. BMC bioinformatics 10: 168.</span>
    
    
    

</li>
<li><span id="OBoyle2011">O‚ÄôBoyle, N. M., M. Banck, C. A. James, C. Morley, T. Vandermeersch <i>et al.</i>, 2011 <b>Open Babel: An open chemical toolbox</b>. Journal of Cheminformatics 3:</span>
    
    
    <a href="https://doi.org/10.1186/1758-2946-3-33">10.1186/1758-2946-3-33</a>
    
    
      <!-- prevent duplicate doi links -->
      
    

</li>
<li><span id="Dalke2013">Dalke, A., 2013 <b>The FPS fingerprint format and chemfp toolkit</b>. Journal of cheminformatics 5: P36.</span>
    
    
    

</li>
<li><span id="Gaulton2016">Gaulton, A., A. Hersey, M. Nowotka, Bento A Patrƒ±ÃÅcia, J. Chambers <i>et al.</i>, 2016 <b>The ChEMBL database in 2017</b>. Nucleic acids research 45: D945‚ÄìD954.</span>
    
    
    

</li></ol>
                    

                    <h1>Feedback</h1>
                    <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">how it went</a>.</p>

                    <div id="feedback-button">
                        <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                    </div>
                    <div id="feedback-form">
                    </div>
                    <script type="text/javascript">
                        (function (window, document) {
                            function onDocumentReady(fn) {
                                if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                    fn();
                                } else {
                                    document.addEventListener('DOMContentLoaded', fn);
                                }
                            }

                            onDocumentReady(function () {
                                $("#feedback-button").click(function(evt){
                                    var e = $(evt.target)
                                    e.hide();

                                    $("#feedback-form").html(`
                                        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Protein-ligand docking (Computational chemistry)">Loading...</iframe>
                                    `)
                                })
                            });
                        })(window, document);
                    </script>



                    <h1>Citing this Tutorial</h1>
                    <p>
                        <ol>
                            <li id="citation-text">Simon Bray, 2021 <b>Protein-ligand docking (Galaxy Training Materials)</b>. <a href="/training-material/topics/computational-chemistry/tutorials/cheminformatics/tutorial.html">/training-material/topics/computational-chemistry/tutorials/cheminformatics/tutorial.html</a> Online; accessed TODAY
                            </li>
                            <li>
                            Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                            </li>
                        </ol>
                    </p>


                    <blockquote class="details">
                      <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                      <p style="display: none;">

                    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{computational-chemistry-cheminformatics,
    author = "Simon Bray",
    title = "Protein-ligand docking (Galaxy Training Materials)",
    year = "2021",
    month = "01",
    day = "06"
    url = "\url{/training-material/topics/computational-chemistry/tutorials/cheminformatics/tutorial.html}",
    note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
        doi = {10.1016/j.cels.2018.05.012},
        url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
        year = 2018,
        month = {jun},
        publisher = {Elsevier {BV}},
        volume = {6},
        number = {6},
        pages = {752--758.e1},
        author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and Bj√∂rn Gr√ºning},
        title = {Community-Driven Data Analysis Training for Biology},
        journal = {Cell Systems}
}</code>
                    </pre></div></div>
                    </p>
                    </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                </div>
            </div>
        </div>

        <h3><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Simon Bray)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/computational-chemistry/tutorials/cheminformatics/tutorial.md">GitHub</a>.
        </p>
        <p>
    The content of the tutorials and website is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
