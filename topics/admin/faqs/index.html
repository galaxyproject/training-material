<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>FAQs / Galaxy Server administration</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@715a5f0aefd15f73c5a3222b576a5f6c21ada9c5",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/admin/faqs/">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.40d4e218.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2021-03-24 13:50:23 +0000"><meta name="description" content="Here you can learn everything you need to become a Pro Galaxy Administrator! These resources cover everything from setup, to configuration, to monitoring, to customisation. ">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Galaxy Server administration / FAQs">
        <meta property="og:description" content="Here you can learn everything you need to become a Pro Galaxy Administrator! These resources cover everything from setup, to configuration, to monitoring, to customisation. ">
        <meta property="og:image" content="https://training.galaxyproject.org/training-material//assets/images/gat.png"></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
			

                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/admin/faqs/" title="Check our FAQs for the Galaxy Server administration topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/admin/faqs/index.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/admin/faqs/">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            <a class="dropdown-item" href="/training-material/feedback.html">
                <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        


<section class="faqs">

   <nav aria-label="breadcrumb">
    <ol class="breadcrumb">

     <li class="breadcrumb-item "><a href="/training-material/faqs">All FAQs</a></li>
     
     <li class="breadcrumb-item "><a href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
     
     
     
     
     <li class="breadcrumb-item active">Topic FAQs</li>
     

     
     </ol>
    </nav>

    <h1 data-toc-skip>Frequently Asked Questions</h1>
    
    <div class="container">
        <div class="row">

            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2">
                <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
            </div>
            <div class="col-sm-10">
                













<h3 id="ansible"> <a href="#ansible"> Ansible </a></h3>

<hr/>



<h4 class="faq-area"> Debugging Memory Leaks <a href="/training-material/topics/admin/faqs/python-memory-leaks.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-debugging-memory-leaks"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-debugging-memory-leaks" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Debugging Memory Leaks</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p><a href="https://github.com/bloomberg/memray">memray</a> is a great memory profiler for debugging memory issues.</p>   <p>In the context of Galaxy, this is significantly easier for job handlers. Install it in your <code class="language-plaintext highlighter-rouge">virtualenv</code> and</p>   <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">memray run  --trace-python-allocators -o the_dump &lt;your_handler_startup_command_here&gt;</span><span class="w"><br></span></code></pre></div></div>   <p>Once you’ve collected enough data,</p>   <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">memray flamegraph --leaks --temporal the_dump -o the_dump.html<br></span></code></pre></div></div>   <p>would then produce a report that shows allocation made but not freed over time.</p>   <p>It might also be useful to just check what the process is doing with py-spy dump.</p>   <p>You can follow web workers in gunicorn with</p>   <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">memray run --follow-fork -o the_dump gunicorn 'galaxy.webapps.galaxy.fast_factory:factory()' --timeout 600 --pythonpath lib -k galaxy.webapps.galaxy.workers.Worker -b localhost:8082 --config python:galaxy.web_stack.gunicorn_config -w 1 --preload<br></span></code></pre></div></div>   <p>the traced app will run on port 8082, you can then for instance in an upstream nginx section direct a portion of the traffic to your profiled app.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Define once, reference many times <a href="/training-material/topics/admin/faqs/ansible_define-once.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-define-once-reference-many-times"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-define-once-reference-many-times" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Define once, reference many times</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Using variables, either by defining them ahead of time, or simply accessing them via existing data structures that have been defined, e.g.:</p>   <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># defining a variable that gets reused is great!</span><br><span class="na">galaxy_user</span><span class="pi">:</span> <span class="s">galaxy</span><br><br><span class="na">galaxy_config</span><span class="pi">:</span><br>  <span class="na">galaxy</span><span class="pi">:</span><br>    <span class="c1"># Re-using the galaxy_config_dir variable saves time and ensures everything</span><br>    <span class="c1"># is in sync!</span><br>    <span class="na">datatypes_config_file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config_dir</span><span class="nv"> </span><span class="s">}}/datatypes_conf.xml"</span><br><br><span class="c1"># and now we can re-use "{{ galaxy_config.galaxy.datatypes_config_file }}"</span><br><span class="c1"># in other places!</span><br><br><span class="na">galaxy_config_templates</span><span class="pi">:</span><br>  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/datatypes_conf.xml</span><br>    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.datatypes_config_file</span><span class="nv"> </span><span class="s">}}"</span><br></code></pre></div></div>   <p>Practices like those shown above help to avoid problems caused when paths are defined differently in multiple places. The datatypes config file will be copied to the same path as Galaxy is configured to find it in, because that path is only defined in one place. Everything else is a reference to the original definition! If you ever need to update that definition, everything else will be updated accordingly.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Error: "skipping: no hosts matched" <a href="/training-material/topics/admin/faqs/ansible_error-no-hosts-matched.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-error-quot-skipping-no-hosts-matched-quot"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-error-quot-skipping-no-hosts-matched-quot" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Error: &quot;skipping: no hosts matched&quot;</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>There can be multiple reasons this happens, so we’ll step through all of them. We’ll start by assuming you’re running the command</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml<br></code></pre></div></div>   <p>The following things can cause issues:</p>   <ol>   <li>Within your <code class="language-plaintext highlighter-rouge">galaxy.yml</code>, you’ve referred to a host group that doesn’t exist or is misspelled. Check the <code class="language-plaintext highlighter-rouge">hosts: galaxyservers</code> to ensure it matches the host group defined in the <code class="language-plaintext highlighter-rouge">hosts</code> file.</li>   <li>Vice-versa, the group in your <code class="language-plaintext highlighter-rouge">hosts</code> file should match the hosts selected in the playbook, <code class="language-plaintext highlighter-rouge">galaxy.yml</code>.</li>   <li>If neither of these are the issue, it’s possible Ansible doesn’t know to check the <code class="language-plaintext highlighter-rouge">hosts</code> file for the inventory. Make sure you’ve specified <code class="language-plaintext highlighter-rouge">inventory = hosts</code> in your <code class="language-plaintext highlighter-rouge">ansible.cfg</code>.</li> </ol> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Failing all jobs from a specific user <a href="/training-material/topics/admin/faqs/maintain_fail-users-jobs.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-failing-all-jobs-from-a-specific-user"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-failing-all-jobs-from-a-specific-user" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Failing all jobs from a specific user</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>This command will let you quickly fail every job from the user ‘service-account’ (replace with your preferred user)</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gxadmin tsvquery jobs --user=service-account --nonterminal | awk '{print $1}' |  xargs -I {} -n 1 gxadmin mutate fail-job {} --commit<br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Galaxy Admin Training Path <a href="/training-material/topics/admin/faqs/git-gat-path.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="comment">   <div class="box-title comment-title" id="comment-galaxy-admin-training-path"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Galaxy Admin Training Path</div>   <p>The yearly Galaxy Admin Training follows a specific ordering of tutorials. Use this timeline to help keep track of where you are in Galaxy Admin Training.</p>   <ol id="git-gat-timeline">                    <li class="disabled">         <a href="/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html">             <div>Step 1</div>             <div>ansible-galaxy</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/backup-cleanup/tutorial.html">             <div>Step 2</div>             <div>backup-cleanup</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/customization/tutorial.html">             <div>Step 3</div>             <div>customization</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/tus/tutorial.html">             <div>Step 4</div>             <div>tus</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/cvmfs/tutorial.html">             <div>Step 5</div>             <div>cvmfs</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/apptainer/tutorial.html">             <div>Step 6</div>             <div>apptainer</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/tool-management/tutorial.html">             <div>Step 7</div>             <div>tool-management</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/reference-genomes/tutorial.html">             <div>Step 8</div>             <div>reference-genomes</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/data-library/tutorial.html">             <div>Step 9</div>             <div>data-library</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/dev/tutorials/bioblend-api/tutorial.html">             <div>Step 10</div>             <div>dev/bioblend-api</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/connect-to-compute-cluster/tutorial.html">             <div>Step 11</div>             <div>connect-to-compute-cluster</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/job-destinations/tutorial.html">             <div>Step 12</div>             <div>job-destinations</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/pulsar/tutorial.html">             <div>Step 13</div>             <div>pulsar</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/celery/tutorial.html">             <div>Step 14</div>             <div>celery</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/gxadmin/tutorial.html">             <div>Step 15</div>             <div>gxadmin</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/reports/tutorial.html">             <div>Step 16</div>             <div>reports</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/monitoring/tutorial.html">             <div>Step 17</div>             <div>monitoring</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/tiaas/tutorial.html">             <div>Step 18</div>             <div>tiaas</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/sentry/tutorial.html">             <div>Step 19</div>             <div>sentry</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/ftp/tutorial.html">             <div>Step 20</div>             <div>ftp</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="disabled">         <a href="/training-material/topics/admin/tutorials/beacon/tutorial.html">             <div>Step 21</div>             <div>beacon</div>         </a>     </li>           </ol> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> How do I know what I can do with a role? What variables are available? <a href="/training-material/topics/admin/faqs/ansible_role-properties.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-how-do-i-know-what-i-can-do-with-a-role-what-variables-are-available"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-do-i-know-what-i-can-do-with-a-role-what-variables-are-available" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: How do I know what I can do with a role? What variables are available?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>You don’t. There is no standard way for reporting this, but well written roles by trusted authors (e.g. geerlingguy, galaxyproject) do it properly and write all of the variables in the README file of the repository. We try to pick sensible roles for you in this course, but, in real life it may not be that simple.</p>   <p>So, definitely check there first, but if they aren’t there, then you’ll need to read through <code class="language-plaintext highlighter-rouge">defaults/</code> and <code class="language-plaintext highlighter-rouge">tasks/</code> and <code class="language-plaintext highlighter-rouge">templates/</code> to figure out what the role does and how you can control and modify it to accomplish your goals.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> How do I see what variables are set for a host? <a href="/training-material/topics/admin/faqs/ansible_see_inventory.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-how-do-i-see-what-variables-are-set-for-a-host"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-do-i-see-what-variables-are-set-for-a-host" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: How do I see what variables are set for a host?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>If you are using a simple <code class="language-plaintext highlighter-rouge">group_vars</code> file only, per group, and no other variable sources, then it’s relatively easy to tell what variables are getting set for your host! Just look at that one file.</p>   <p>But if you have graduated into using a more complex setup, perhaps with multiple sets of variables, like for example:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── group_vars<br>│   ├── all<br>│   │   ├── all.yml<br>│   │   └── secret.yml<br>│   ├── galaxyservers.yml<br>│   └── pulsarservers.yml<br>├── hosts<br>├── host_vars<br>│   ├── galaxy.example.org<br>│   │   ├── all.yml<br>│   │   └── secret.yml<br>│   ├── pulsar.example.org<br>│   │   ├── all.yml<br>│   │   ├── pulsar.yml<br>│   │   └── secret.yml<br>...<br></code></pre></div></div>   <p>Then it might be harder to figure out what variables are being set, in full. This is where <a href="https://docs.ansible.com/ansible/latest/cli/ansible-inventory.html"><code class="language-plaintext highlighter-rouge">ansible-inventory</code></a> command can be useful.</p>   <p><strong>Graph</strong> shows you the structure of your host groups:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ansible-inventory --graph<br>@all:<br>  |--@cluster:<br>  |  |--allie.example.com<br>  |  |--bob.example.com<br>  |  |--charlie.example.com<br>[...]<br></code></pre></div></div>   <p>Here is a relatively simple, flat example, but this can be more complicated if you nest sub-groups of hosts:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@all:<br>  |--@local:<br>  |  |--localhost<br>  |--@ungrouped:<br>  |--@workshop_instances:<br>  |  |--@workshop_eu:<br>  |  |  |--gat-0.eu.training.galaxyproject.eu<br>  |  |  |--gat-1.eu.training.galaxyproject.eu<br>  |  |--@workshop_oz:<br>  |  |--@workshop_us:<br></code></pre></div></div>   <p><strong>List</strong> shows you all defined variables:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ansible-inventory --host galaxy.example.com | head<br>[WARNING]: While constructing a mapping from<br>/group_vars/galaxyservers.yml, line 3, column<br>1, found a duplicate dict key (tiaas_templates_dir). Using last defined value<br>only.<br>{<br>    "ansible_connection": "local",<br>    "ansible_user": "ubuntu",<br>    "certbot_agree_tos": "--agree-tos",<br>    "certbot_auth_method": "--webroot",<br>    "certbot_auto_renew": true,<br>    "certbot_auto_renew_hour": "{{ 23 |random(seed=inventory_hostname)  }}",<br>    "certbot_auto_renew_minute": "{{ 59 |random(seed=inventory_hostname)  }}",<br><br></code></pre></div></div>   <p>And, helpfully, if variables are overridden in precedence you can see that as well with the above warnings.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Is YAML sensitive to True/true/False/false <a href="/training-material/topics/admin/faqs/ansible_yaml.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-is-yaml-sensitive-to-true-true-false-false"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-is-yaml-sensitive-to-true-true-false-false" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Is YAML sensitive to True/true/False/false</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>By <a href="https://yaml.org/refcard.html">this reference</a>, YAML doesn’t really care:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ Y, true, Yes, ON   }    : Boolean true<br>{ n, FALSE, No, off  }    : Boolean false<br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Mapping Jobs to Specific Storage By User <a href="/training-material/topics/admin/faqs/mapping_by_user.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-mapping-jobs-to-specific-storage-by-user"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-mapping-jobs-to-specific-storage-by-user" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Mapping Jobs to Specific Storage By User</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>It is possible to map your jobs to use specific storage backends based on user! If you have e.g. specific user groups that need their data stored separately from other users, for whatever political reasons, then in your dynamic destination you can do something like:</p>   <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">job_destination</span> <span class="o">=</span> <span class="n">app</span><span class="p">.</span><span class="n">job_config</span><span class="p">.</span><span class="nf">get_destination</span><span class="p">(</span><span class="n">destination_id</span><span class="p">)</span><br><span class="k">if</span> <span class="n">user</span> <span class="o">==</span> <span class="sh">"</span><span class="s">alice</span><span class="sh">"</span><span class="p">:</span><br>    <span class="n">job_destination</span><span class="p">.</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">object_store_id</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">foo</span><span class="sh">'</span> <span class="c1"># Maybe lookup the ID from a mapping somewhere<br></span></code></pre></div></div>   <p>If you manage to do this in production, please let us know and we can update this FAQ with any information you encounter.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Operating system compatibility <a href="/training-material/topics/admin/faqs/admin-testing.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-operating-system-compatibility"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-operating-system-compatibility" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Operating system compatibility</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>These Ansible roles and training materials were last tested on Centos 7 and Ubuntu 18.04, but will probably work on other RHEL and Debian variants.</p>   <p>The roles that are used in these training are currently used by <code class="language-plaintext highlighter-rouge">usegalaxy.*</code>, and other, servers in maintaining their infrastructure. (<a href="https://github.com/galaxyproject/infrastructure-playbook/">US</a>, <a href="https://github.com/usegalaxy-eu/infrastructure-playbook">EU</a>, both are running CentOS 7)</p>   <p>If you have an issue running these trainings on your OS flavour, please report <a href="https://github.com/galaxyproject/training-material/issues/new">the issue</a> in the training material and we can see if it is possible to solve.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Running Ansible on your remote machine <a href="/training-material/topics/admin/faqs/ansible_local.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-running-ansible-on-your-remote-machine"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-running-ansible-on-your-remote-machine" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Running Ansible on your remote machine</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>It is possible to have ansible installed on the remote machine and run it there, not just from your local machine connecting to the remote machine.</p>   <p>Your hosts file will need to use <code class="language-plaintext highlighter-rouge">localhost</code>,  and whenever you run playbooks with <code class="language-plaintext highlighter-rouge">ansible-playbook -i hosts playbook.yml</code>, you will need to add <code class="language-plaintext highlighter-rouge">-c local</code> to your command.</p>   <p>Be <strong>certain</strong> that the playbook that you’re writing on the remote machine is stored somewhere safe, like your user home directory, or backed up on your local machine. The cloud can be unreliable and things can disappear at any time.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Updating from 22.01 to 23.0 with Ansible <a href="/training-material/topics/admin/faqs/galaxy-update-22.05.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-updating-from-22-01-to-23-0-with-ansible"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-updating-from-22-01-to-23-0-with-ansible" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Updating from 22.01 to 23.0 with Ansible</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Galaxy introduced a number of changes in 22.05 and 23.0 that are extremely important to be aware of during the upgrade process. Namely a new database migration system, and a new required running environment (gunicorn instead of uwsgi).</p>   <p>The scripts to migrate to the new database migration system are only compatible with release 22.05, and then were subsequently removed, so it is <strong>mandatory</strong> to upgrade to 22.05 if you want to go further.</p>   <p>Here is the recommended update procedure with ansible:</p>   <ol>   <li>Update to 22.01 normally</li>   <li>Change the release to 22.05, and run the upgrade     <ol>       <li>Galaxy will probably not start correctly here, ignore it (even if the build fail, this if fine, just ignore).</li>       <li>         <p>Run the database migration manually (with the galaxy user with the venv activated)</p>         <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GALAXY_CONFIG_FILE=/srv/galaxy/config/galaxy.yml sh /srv/galaxy/server/manage_db.sh -c /srv/galaxy/config/galaxy.yml upgrade<br></code></pre></div>        </div>       </li>     </ol>   </li>   <li>Update your system’s ansible, you probably need something with a major version of at least 2.</li>   <li>     <p>Set the release to <code class="language-plaintext highlighter-rouge">23.0</code> and make other required changes. There are a lot of useful changes, but the easiest procedure is probably something like:</p>     <ol>       <li>git clone https://github.com/hexylena/git-gat/</li>       <li>cd git-gat</li>       <li>git checkout c2e7bf6d3584fbf3281fb57d8024a9189f957e0e (this corresponds to the version of the repo after the 23.0 integration without too much customization and after potential bug fixes)</li>       <li>         <p>Diff and sync (e.g. <code class="language-plaintext highlighter-rouge">vimdiff group_vars/galaxyservers.yml git-gat/group_vars/galaxyservers.yml</code>) for the main configuration files:</p>         <ul>           <li>group_vars/all.yml</li>           <li>group_vars/dbservers.yml</li>           <li>galaxy.yml</li>           <li>requirements.yml (and don’t forget to install the new role versions)</li>           <li>hosts</li>           <li>templates/nginx/galaxy.j2</li>         </ul>       </li>     </ol>     <p>But the main change is the swap from uwsgi to gravity+gunicorn</p>     <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-  uwsgi:<br>-    socket: 127.0.0.1:8080<br>-    buffer-size: 16384<br>-    processes: 1<br>-    threads: 4<br>-    offload-threads: 2<br>-    static-map:<br>-      - /static=/static<br>-      - /favicon.ico=/static/favicon.ico<br>-    static-safe: client/galaxy/images<br>-    master: true<br>-    virtualenv: ""<br>-    pythonpath: "/lib"<br>-    module: galaxy.webapps.galaxy.buildapp:uwsgi_app()<br>-    thunder-lock: true<br>-    die-on-term: true<br>-    hook-master-start:<br>-      - unix_signal:2 gracefully_kill_them_all<br>-      - unix_signal:15 gracefully_kill_them_all<br>-    py-call-osafterfork: true<br>-    enable-threads: true<br>-    mule:<br>-      - lib/galaxy/main.py<br>-      - lib/galaxy/main.py<br>-    farm: job-handlers:1,2<br></span><span class="gi">+  gravity:<br>+    process_manager: systemd<br>+    galaxy_root: "/server"<br>+    galaxy_user: ""<br>+    virtualenv: ""<br>+    gunicorn:<br>+      # listening options<br>+      bind: "unix:/gunicorn.sock"<br>+      # performance options<br>+      workers: 2<br>+      # Other options that will be passed to gunicorn<br>+      # This permits setting of 'secure' headers like REMOTE_USER (and friends)<br>+      # https://docs.gunicorn.org/en/stable/settings.html#forwarded-allow-ips<br>+      extra_args: '--forwarded-allow-ips="*"'<br>+      # This lets Gunicorn start Galaxy completely before forking which is faster.<br>+      # https://docs.gunicorn.org/en/stable/settings.html#preload-app<br>+      preload: true<br>+    celery:<br>+      concurrency: 2<br>+      loglevel: DEBUG<br>+    handlers:<br>+      handler:<br>+        processes: 2<br>+        pools:<br>+          - job-handlers<br>+          - workflow-schedulers<br></span></code></pre></div>    </div>     <p>Some other important changes include:</p>     <ul>       <li>uchida.miniconda is replaced with galaxyproject.conda</li>       <li>usegalaxy_eu.systemd is no longer needed</li>       <li><code class="language-plaintext highlighter-rouge">galaxy_user_name</code> is defined in all.yml in the latest git-gat</li>       <li>the <code class="language-plaintext highlighter-rouge">galaxy_job_config</code> needs to have a database <code class="language-plaintext highlighter-rouge">handling</code> specified - assign set to <code class="language-plaintext highlighter-rouge">db-skip-locked</code></li>       <li>git-gat also separates out the DB serving into a <code class="language-plaintext highlighter-rouge">dbservers.yml</code> host group</li>     </ul>   </li>   <li>Backup your <code class="language-plaintext highlighter-rouge">venv</code>, <code class="language-plaintext highlighter-rouge">mv /srv/galaxy/venv/ /srv/galaxy/venv-old/</code>, as your NodeJS is probably out of date and Galaxy doesn’t handle that gracefully</li>   <li>Do any local customs for luck (knocking on wood, etc.)</li>   <li>Run the playbook</li>   <li>Things might go wrong with systemd units     <ul>       <li>try running <code class="language-plaintext highlighter-rouge">galaxyctl -c /srv/galaxy/config/galaxy.yml update</code> as root</li>       <li>you may also need to <code class="language-plaintext highlighter-rouge">rm /etc/systemd/system/galaxy.service</code> which is then no longer needed</li>       <li>you’ll have a <code class="language-plaintext highlighter-rouge">galaxy.target</code> and you can instead <code class="language-plaintext highlighter-rouge">systemctl daemon-reload</code> and <code class="language-plaintext highlighter-rouge">systemctl start galaxy.target</code></li>     </ul>   </li>   <li>You may need to restart galaxy manually with <code class="language-plaintext highlighter-rouge">sudo galaxyctl restart</code></li> </ol> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Variable connection <a href="/training-material/topics/admin/faqs/ansible-connection.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-variable-connection"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-variable-connection" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Variable connection</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>When the playbook runs, as part of the setup, it collects any variables that are set. For a playbook affecting a group of hosts named <code class="language-plaintext highlighter-rouge">my_hosts</code>, it checks many different places for variables, including “group_vars/my_hosts.yml”. If there are variables there, they’re added to the collection of current variables. It also checks “group_vars/all.yml” (for the built-in host group <code class="language-plaintext highlighter-rouge">all</code>). There is a precedence order, but then these variables are available for roles and tasks to consume.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> What if you forget `--diff`? <a href="/training-material/topics/admin/faqs/ansible_diff.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-what-if-you-forget-diff"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-what-if-you-forget-diff" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: What if you forget `--diff`?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>If you forget to use <code class="language-plaintext highlighter-rouge">--diff</code>, it is not easy to see what has changed. Some modules like the <code class="language-plaintext highlighter-rouge">copy</code> and <code class="language-plaintext highlighter-rouge">template</code> modules have a <code class="language-plaintext highlighter-rouge">backup</code> option. If you set this option, then it will keep a backup copy next to the destination file.</p>   <p>However, most modules do not have such an option, so if you want to know what changes, always use <code class="language-plaintext highlighter-rouge">--diff</code>.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> What is the difference between the roles with `role:` prefix and without? <a href="/training-material/topics/admin/faqs/ansible_role-prefix.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-what-is-the-difference-between-the-roles-with-role-prefix-and-without"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-what-is-the-difference-between-the-roles-with-role-prefix-and-without" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: What is the difference between the roles with `role:` prefix and without?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>The bare role name is just simplified syntax for the roles, you could equally specifiy <code class="language-plaintext highlighter-rouge">role: &lt;name&gt;</code> every time but it’s only necessary if you want to set additional variables like <code class="language-plaintext highlighter-rouge">become_user</code></p> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="data-libraries"> <a href="#data-libraries"> Data-libraries </a></h3>

<hr/>



<h4 class="faq-area"> Library Permission Issues <a href="/training-material/topics/admin/faqs/library-permissions.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-library-permission-issues"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-library-permission-issues" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Library Permission Issues</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>When running <code class="language-plaintext highlighter-rouge">setup-data-libraries</code> it imports the library with the permissions of the admin user, rather locked down to the account that handled the importing.</p>   <p>Due to how data libraries have been implemented, it isn’t sufficient to share the folder with another user, instead you must also share individual items within this folder. This is an unfortunate issue with Galaxy that we hope to fix someday.</p>   <p>Until then, we can recommend you install the latest version of Ephemeris which includes the <code class="language-plaintext highlighter-rouge">set-library-permissions</code> command which let’s you recursively correct the permissions on a data library. Simply run:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>set-library-permissions -g https://galaxy.example.com -a $API_KEY LIBRARY --roles ROLES role1,role2,role3<br></code></pre></div></div>   <p>Where <code class="language-plaintext highlighter-rouge">LIBRARY</code> is the id of the library you wish to correct.</p> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="debugging"> <a href="#debugging"> Debugging </a></h3>

<hr/>



<h4 class="faq-area"> Why isn't my history updating? <a href="/training-material/topics/admin/faqs/why-isnt-my-history-updating.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-why-isn-t-my-history-updating"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-why-isn-t-my-history-updating" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Why isn't my history updating?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Have you ever experienced that you would submit a job but your history wouldn’t update? Maybe it doesn’t scroll or the datasets stay permanently grey even when you know they should be complete, <em>until you refresh the webpage</em>?</p>   <p>One possible cause of this can be a difference in the clocks of your browser and the server. Check that your clocks match, and if not, reconfigure them! If you are following the Galaxy Admin Training, you will have setup <code class="language-plaintext highlighter-rouge">chrony</code>. Check that your <code class="language-plaintext highlighter-rouge">chrony</code> configuration is valid and requesting time from a local pool.</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chronyc -n sources<br>210 Number of sources = 1<br>MS Name/IP address         Stratum Poll Reach LastRx Last sample               <br>===============================================================================<br>^? 169.254.169.123               0   7     0     -     +0ns[   +0ns] +/-    0ns<br><br></code></pre></div></div>   <p>This command should return some valid sources. THe above shows an example of a time source that isn’t working, 0ns is not a realistic office and LastRx is empty. Instead it should look more like::</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chronyc -n sources<br>210 Number of sources = 5<br>MS Name/IP address         Stratum Poll Reach LastRx Last sample               <br>===============================================================================<br>^? 169.254.169.123               0   6     0     -     +0ns[   +0ns] +/-    0ns<br>^? 178.239.19.58                 0   6     0     -     +0ns[   +0ns] +/-    0ns<br>^? 194.104.0.153                 2   6     1     0   +138us[ +138us] +/-   30ms<br>^? 45.138.55.61                  1   6     1     1   -103us[ -103us] +/- 3158us<br>^? 178.239.19.57                 2   6     1     1   -301us[ -301us] +/- 3240us<br></code></pre></div></div>   <p>Here we see a number of sources, with more plausible offsets and non-empty LastRx.</p>   <p>If your time was misconfigured, you might now see something like:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chronyc -n tracking<br>Reference ID    : B950F724 (185.80.247.36)<br>Stratum         : 2<br>Ref time (UTC)  : Tue Oct 22 09:44:29 2024<br>System time     : 929.234680176 seconds slow of NTP time<br></code></pre></div></div>   <p>as chrony slowly adjusts the system clock to match NTP time.</p> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="deployment"> <a href="#deployment"> Deployment </a></h3>

<hr/>



<h4 class="faq-area"> Blank page or no CSS/JavaScript <a href="/training-material/topics/admin/faqs/galaxy-blank-screen.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-blank-page-or-no-css-javascript"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-blank-page-or-no-css-javascript" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Blank page or no CSS/JavaScript</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>This generally means that serving of static content is broken:</p>   <ul>   <li>Check browser console for 404 errors.</li>   <li>Check proxy error log for permission errors.</li>   <li>Verify that your proxy static configuration is correct.</li>   <li>If you have recently upgraded Galaxy or changed the GUI in some way, you will need to rebuild the client</li> </ul> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Database Issues <a href="/training-material/topics/admin/faqs/database-slow-query.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-database-issues"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-database-issues" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Database Issues</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>For slow queries, start with <code class="language-plaintext highlighter-rouge">EXPLAIN ANALYZE</code></p>   <ul>   <li><a href="https://gist.github.com/natefoo/da46bea8136ba67d65f616c86a27c454">Example of the “jobs ready to run” query</a></li> </ul>   <p>However it can be useful to dig into the queries with the <a href="https://tatiyants.com/pev/#/plans">Postgres EXPLAIN Visualizer (PEV)</a> to get a more visual and clear representation. (Try it with this <a href="https://gist.github.com/hexylena/467c7726b5ab9e18c47080893dbc072e">demo data</a>)</p>   <p>You can set some options in the Galaxy configuration or database that will help debugging this:</p>   <ul>   <li><code class="language-plaintext highlighter-rouge">database_engine_option_echo</code> (but warning, extremely verbose)</li>   <li><code class="language-plaintext highlighter-rouge">slow_query_log_threshold</code> logs to Galaxy log file</li>   <li><code class="language-plaintext highlighter-rouge">sentry_sloreq_threshold</code> if using Sentry</li> </ul>   <p>Additionally check that your database is running <code class="language-plaintext highlighter-rouge">VACUUM</code> regularly enough and look at <code class="language-plaintext highlighter-rouge">VACUUM ANALYZE</code></p>   <p>There are some <code class="language-plaintext highlighter-rouge">gxadmin query pg-*</code> commands which can help you monitor and track this information.</p>   <p>Lastly, check your database settings! It might not have enough resources allocated. Check <a href="https://pgtune.leopard.in.ua/">PGTune</a> for some suggestions of optimised parameters.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Debugging tool errors <a href="/training-material/topics/admin/faqs/galaxy-tool-error.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-debugging-tool-errors"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-debugging-tool-errors" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Debugging tool errors</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Tool stdout/stderr is available in UI under “i” icon on history dataset</p>   <ol>   <li>Set <code class="language-plaintext highlighter-rouge">cleanup_job</code> to <code class="language-plaintext highlighter-rouge">onsuccess</code></li>   <li>Cause a job failure</li>   <li>Go to job working directory (find in logs or <code class="language-plaintext highlighter-rouge">/data/jobs/&lt;hash&gt;/&lt;job_id&gt;</code>)</li>   <li>Poke around, try running things (<code class="language-plaintext highlighter-rouge">srun --pty bash</code> considered useful)</li> </ol>   <p>Familiarize yourself with the places Galaxy keeps things</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Debugging tool memory errors <a href="/training-material/topics/admin/faqs/galaxy-tool-memory-error.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-debugging-tool-memory-errors"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-debugging-tool-memory-errors" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Debugging tool memory errors</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Often the tool output contains one of:</p>   <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">MemoryError                 #</span><span class="w"> </span>Python<br><span class="gp">what():  std::bad_alloc     #</span><span class="w"> </span>C++<br><span class="gp">Segmentation Fault          #</span><span class="w"> </span>C - but could be other problems too<br><span class="gp">Killed                      #</span><span class="w"> </span>Linux OOM Killer<br></code></pre></div></div>   <p>Solutions:</p>   <ul>   <li>Change input sizes or params     <ul>       <li>Map/reduce?</li>     </ul>   </li>   <li>Decrease the amount of memory the tool needs</li>   <li>Increase the amount of memory available to the job     <ul>       <li>Request more memory from cluster scheduler</li>       <li>Use job resubmission to automatically rerun with a larger memory allocation</li>     </ul>   </li>   <li>Cross your fingers and rerun the job</li> </ul> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Galaxy UI is slow <a href="/training-material/topics/admin/faqs/galaxy-ui-slow.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-galaxy-ui-is-slow"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-galaxy-ui-is-slow" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Galaxy UI is slow</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>There is a great <a href="https://docs.galaxyproject.org/en/master/dev/finding_and_improving_slow_code.html#profiling">Tutorial from @mvdbeek</a> which we recommend you follow.</p>   <p>Additionally you can use <code class="language-plaintext highlighter-rouge">py-spy</code> to record the issue and generate a flame graph.</p> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Tool missing from Galaxy <a href="/training-material/topics/admin/faqs/galaxy-tool-missing.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-tool-missing-from-galaxy"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-tool-missing-from-galaxy" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Tool missing from Galaxy</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>First, restart Galaxy and watch the log for lines like:</p>   <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Loaded tool id: toolshed.g2.bx.psu.edu/repos/iuc/sickle/sickle/1.33, version: 1.33 into tool panel....<br></span></code></pre></div></div>   <p>After startup, check <code class="language-plaintext highlighter-rouge">integrated_tool_panel.xml</code> for a line like the following to be sure it was loaded properly and added to the toolbox (if not, check the logs further)</p>   <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tool</span> <span class="na">id=</span><span class="s">"toolshed.g2.bx.psu.edu/repos/iuc/sickle/sickle/1.33"</span> <span class="nt">/&gt;</span><br></code></pre></div></div>   <p>If it is a toolshed tool, check <code class="language-plaintext highlighter-rouge">shed_tool_conf.xml</code> for</p>   <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tool</span> <span class="na">file=</span><span class="s">"toolshed.g2.bx.psu.edu/repos/iuc/sickle/43e081d32f90/sickle/sickle.xml"</span> <span class="na">guid=</span><span class="s">"toolshed.g2.bx.psu.edu/repos/iuc/sickle/sickle/1.33"</span><span class="nt">&gt;</span><br>...<br><span class="nt">&lt;/tool&gt;</span><br></code></pre></div></div>   <p>Additionally if you have multiple job handlers, <em>sometimes</em>, rarely they don’t all get the update. Just restart them if that’s the case. Alternatively you can send an (authenticated) API requested:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X PUT https://galaxy.example.org/api/configuration<br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Using data source tools with Pulsar <a href="/training-material/topics/admin/faqs/data-source-with-pulsar.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-using-data-source-tools-with-pulsar"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-using-data-source-tools-with-pulsar" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Using data source tools with Pulsar</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Data source tools such as UCSC Main will fail if Pulsar is the default destination.</p>   <p>To fix this issue you can force individual tools to run on a specific destination or handler by adding to your job_conf file:</p>   <p>For job_conf.xml</p>   <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tools&gt;</span><br>    <span class="nt">&lt;tool</span> <span class="na">id=</span><span class="s">"ucsc_table_direct1"</span> <span class="na">destination=</span><span class="s">"my-local"</span> <span class="nt">/&gt;</span><br><span class="nt">&lt;/tools&gt;</span><br></code></pre></div></div>   <p>For job_conf.yml</p>   <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">tools</span><span class="pi">:</span><br><span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">ucsc_table_direct1</span><br>  <span class="na">handler</span><span class="pi">:</span> <span class="s">my-local</span><br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="diffs"> <a href="#diffs"> Diffs </a></h3>

<hr/>



<h4 class="faq-area"> How to read a Diff <a href="/training-material/topics/admin/faqs/diffs.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-how-to-read-a-diff"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-to-read-a-diff" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: How to read a Diff</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>If you haven’t worked with diffs before, this can be something quite new or different.</p>   <p>If we have two files, let’s say a grocery list, in two files. We’ll call them ‘a’ and ‘b’.</p>   <blockquote class="code-2col">   <blockquote class="code-in">     <div class="box-title code-in-title" id="code-in-old"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Old</div>     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat old<br>🍎<br>🍐<br>🍊<br>🍋<br>🍒<br>🥑<br></code></pre></div>    </div>   </blockquote>   <blockquote class="code-out">     <div class="box-title code-out-title" id="code-out-new"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: New</div>     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat new<br>🍎<br>🍐<br>🍊<br>🍋<br>🍍<br>🥑<br></code></pre></div>    </div>   </blockquote> </blockquote>   <p>We can see that they have some different entries. We’ve removed 🍒 because they’re awful, and replaced them with an 🍍</p>   <p>Diff lets us compare these files</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff old new<br>5c5<br>&lt; 🍒<br><span class="nt">---</span><br><span class="o">&gt;</span> 🍍<br></code></pre></div></div>   <p>Here we see that 🍒 is only in a, and 🍍 is only in b. But otherwise the files are identical.</p>   <p>There are a couple different formats to diffs, one is the ‘unified diff’</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff <span class="nt">-U2</span> old new<br><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br>+++ new	2022-02-16 14:06:36.340962616 +0100<br>@@ <span class="nt">-3</span>,4 +3,4 @@<br> 🍊<br> 🍋<br>-🍒<br>+🍍<br> 🥑<br></code></pre></div></div>   <p>This is basically what you see in the training materials which gives you a lot of context about the changes:</p>   <ul>   <li><code class="language-plaintext highlighter-rouge">--- old</code> is the ‘old’ file in our view</li>   <li><code class="language-plaintext highlighter-rouge">+++ new</code> is the ‘new’ file</li>   <li>@@ these lines tell us where the change occurs and how many lines are added or removed.</li>   <li>Lines starting with a - are removed from our ‘new’ file</li>   <li>Lines with a + have been added.</li> </ul>   <p>So when you go to apply these diffs to your files in the training:</p>   <ol>   <li>Ignore the header</li>   <li>Remove lines starting with - from your file</li>   <li>Add lines starting with + to your file</li> </ol>   <p>The other lines (🍊/🍋 and 🥑) above just provide “context”, they help you know where a change belongs in a file, but <strong>should not be edited</strong> when you’re making the above change. Given the above diff, you would find a line with a 🍒, and replace it with a 🍍</p>   <h4 id="added--removed-lines">Added &amp; Removed Lines</h4>   <p>Removals are very easy to spot, we just have removed lines</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br>+++ new	2022-02-16 14:10:14.370722802 +0100<br>@@ <span class="nt">-4</span>,3 +4,2 @@<br> 🍋<br> 🍒<br>-🥑<br></code></pre></div></div>   <p>And additions likewise are very easy, just add a new line, between the other lines in your file.</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br>+++ new	2022-02-16 14:11:11.422135393 +0100<br>@@ <span class="nt">-1</span>,3 +1,4 @@<br> 🍎<br>+🍍<br> 🍐<br> 🍊<br></code></pre></div></div>   <h4 id="completely-new-files">Completely new files</h4>   <p>Completely new files look a bit different, there the “old” file is <code class="language-plaintext highlighter-rouge">/dev/null</code>, the empty file in a Linux machine.</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff <span class="nt">-U2</span> /dev/null old<br><span class="nt">---</span> /dev/null	2022-02-15 11:47:16.100000270 +0100<br>+++ old	2022-02-16 14:06:19.697132568 +0100<br>@@ <span class="nt">-0</span>,0 +1,6 @@<br>+🍎<br>+🍐<br>+🍊<br>+🍋<br>+🍒<br>+🥑<br></code></pre></div></div>   <p>And removed files are similar, except with the new file being /dev/null</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br>+++ /dev/null	2022-02-15 11:47:16.100000270 +0100<br>@@ <span class="nt">-1</span>,6 +0,0 @@<br>-🍎<br>-🍐<br>-🍊<br>-🍋<br>-🍒<br>-🥑<br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="galaxy"> <a href="#galaxy"> Galaxy </a></h3>

<hr/>



<h4 class="faq-area"> How can I get my container requiring jobs to run in a container? <a href="/training-material/topics/admin/faqs/galaxy-jobs-in-containers.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-how-can-i-get-my-container-requiring-jobs-to-run-in-a-container"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-can-i-get-my-container-requiring-jobs-to-run-in-a-container" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: How can I get my container requiring jobs to run in a container?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Some tools will only run in a container, i.e. they have a container defined in the ‘requirements’ section of the tool’s XML file. Galaxy will not refuse to run these tools if the container isn’t available or if Galaxy isn’t configured use containers. Instead it’ll run in the host system and likely fail.</p>   <h2 id="job-configuration">Job Configuration</h2>   <p>You can resolve this by configuring your job conf to have destinations that support containers (or even require them.):</p>   <p>The destination must have <code class="language-plaintext highlighter-rouge">docker_enabled</code> (Or <code class="language-plaintext highlighter-rouge">singularity_enabled</code>), and you can consider adding <code class="language-plaintext highlighter-rouge">require_container</code> to make sure the job will fail if the container isn’t available. The <code class="language-plaintext highlighter-rouge">docker_volumes</code> string will allow you to control which volumes are attached to that container;</p>   <p>In TPV configuration (provided by @gtn:thanhleviet) this would look like:</p>   <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">docker</span><span class="pi">:</span><br>    <span class="na">inherits</span><span class="pi">:</span> <span class="s">slurm</span><br>    <span class="na">scheduling</span><span class="pi">:</span><br>      <span class="na">require</span><span class="pi">:</span><br>        <span class="pi">-</span> <span class="s">docker</span><br>    <span class="na">params</span><span class="pi">:</span><br>      <span class="na">docker_enabled</span><span class="pi">:</span> <span class="kc">true</span><br>      <span class="na">require_container</span><span class="pi">:</span> <span class="kc">true</span><br><br>  <span class="na">singularity</span><span class="pi">:</span><br>    <span class="na">inherits</span><span class="pi">:</span> <span class="s">slurm</span><br>    <span class="na">scheduling</span><span class="pi">:</span><br>      <span class="na">require</span><span class="pi">:</span><br>        <span class="pi">-</span> <span class="s">singularity</span><br>    <span class="na">params</span><span class="pi">:</span><br>      <span class="na">singularity_enabled</span><span class="pi">:</span> <span class="kc">true</span><br><br>  <span class="na">podman</span><span class="pi">:</span><br>    <span class="na">inherits</span><span class="pi">:</span> <span class="s">slurm</span><br>    <span class="na">scheduling</span><span class="pi">:</span><br>      <span class="na">require</span><span class="pi">:</span><br>        <span class="pi">-</span> <span class="s">podman</span><br>    <span class="na">params</span><span class="pi">:</span><br>      <span class="na">docker_enabled</span><span class="pi">:</span> <span class="kc">true</span><br>      <span class="na">require_container</span><span class="pi">:</span> <span class="kc">true</span><br>      <span class="na">docker_volumes</span><span class="pi">:</span> <span class="s2">"</span><span class="s">$galaxy_root:ro,$tool_directory:ro,$job_directory:ro,$working_directory:z,$default_file_path:z"</span><br>      <span class="na">docker_sudo</span><span class="pi">:</span> <span class="kc">false</span><br>      <span class="na">docker_cmd</span><span class="pi">:</span> <span class="s">/usr/bin/podman</span><br>      <span class="na">docker_run_extra_arguments</span><span class="pi">:</span> <span class="s2">"</span><span class="s">--userns=keep-id"</span><br></code></pre></div></div>   <p>Or in XML:</p>   <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;destination</span> <span class="na">id=</span><span class="s">"docker"</span> <span class="na">runner=</span><span class="s">"local"</span><span class="nt">&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"docker_enabled"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/param&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"require_container"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/param&gt;</span><br><span class="nt">&lt;/destionation&gt;</span><br><br><span class="nt">&lt;destination</span> <span class="na">id=</span><span class="s">"podman"</span> <span class="na">runner=</span><span class="s">"local"</span><span class="nt">&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"docker_enabled"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/param&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"require_container"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/param&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"docker_sudo"</span><span class="nt">&gt;</span>false<span class="nt">&lt;/param&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"docker_cmd"</span><span class="nt">&gt;</span>/usr/bin/podman<span class="nt">&lt;/param&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"docker_run_extra_arguments"</span><span class="nt">&gt;</span>--userns=keep-id<span class="nt">&lt;/param&gt;</span><br>    <span class="c">&lt;!-- This will not work until https://github.com/galaxyproject/galaxy/pull/18998 is merged for SELinux users. For now you may want to patch it manually. --&gt;</span><br>    <span class="c">&lt;!-- &lt;param id="docker_volumes"&gt;$galaxy_root:ro,$tool_directory:ro,$job_directory:ro,$working_directory:z,$default_file_path:z&lt;/param&gt; --&gt;</span><br><span class="nt">&lt;/destination&gt;</span><br><br><span class="nt">&lt;destination</span> <span class="na">id=</span><span class="s">"singularity"</span> <span class="na">runner=</span><span class="s">"local"</span><span class="nt">&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"singularity_enabled"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/param&gt;</span><br>    <span class="nt">&lt;param</span> <span class="na">id=</span><span class="s">"require_container"</span><span class="nt">&gt;</span>true<span class="nt">&lt;/param&gt;</span><br><span class="nt">&lt;/destionation&gt;</span><br></code></pre></div></div>   <p>Configuring a tool to use this destination would look like:</p>   <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">toolshed.g2.bx.psu.edu/repos/thanhlv/metaphlan4/metaphlan4/4.0.3</span><span class="pi">:</span><br>    <span class="na">cores</span><span class="pi">:</span> <span class="m">12</span><br>    <span class="na">mem</span><span class="pi">:</span> <span class="s">cores * </span><span class="m">8</span><br>    <span class="na">params</span><span class="pi">:</span><br>      <span class="na">singularity_enabled</span><span class="pi">:</span> <span class="kc">true</span><br></code></pre></div></div>   <p>Or in XML:</p>   <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tools&gt;</span><br>    <span class="nt">&lt;tool</span> <span class="na">id=</span><span class="s">"toolshed.g2.bx.psu.edu/repos/thanhlv/metaphlan4/metaphlan4/4.0.3"</span> <span class="na">destination=</span><span class="s">"docker"</span><span class="nt">/&gt;</span><br><span class="nt">&lt;/tools&gt;</span><br></code></pre></div></div>   <h2 id="container-resolvers-configuration">Container Resolvers Configuration</h2>   <p>If you’re using the default <code class="language-plaintext highlighter-rouge">container_resolvers_conf.yml</code> then there is nothing you need to do. Otherwise you may want to ensure that you have items in there such as <code class="language-plaintext highlighter-rouge">explicit</code> and <code class="language-plaintext highlighter-rouge">explicit_singularity</code> among others. See the <a href="https://docs.galaxyproject.org/en/master/admin/container_resolvers.html">galaxy documentation</a> on the topic.</p>   <h2 id="testing">Testing</h2>   <p>Here is an example of a tool that requires a container, that you can use to test your container configuration:</p>   <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tool</span> <span class="na">name=</span><span class="s">"container-test"</span> <span class="na">id=</span><span class="s">"container"</span> <span class="na">version=</span><span class="s">"5.0"</span> <span class="na">profile=</span><span class="s">"21.09"</span><span class="nt">&gt;</span><br>        <span class="nt">&lt;requirements&gt;</span><br>                <span class="nt">&lt;container</span> <span class="na">type=</span><span class="s">"docker"</span><span class="nt">&gt;</span>ubuntu:22.04<span class="nt">&lt;/container&gt;</span><br>        <span class="nt">&lt;/requirements&gt;</span><br>        <span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[<br>                pwd &gt;</span>&gt; '$output';<br>                hostname -f &gt;&gt; '$output';<br>                echo "" &gt;&gt; '$output';<br>                cat /etc/os-release &gt;&gt; '$output';<br>                echo "" &gt;&gt; '$output';<br>                env | sort &gt;&gt; '$output';<br>]]&gt;<span class="nt">&lt;/command&gt;</span><br>        <span class="nt">&lt;inputs&gt;</span><br>        <span class="nt">&lt;/inputs&gt;</span><br>        <span class="nt">&lt;outputs&gt;</span><br>                <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"output"</span> <span class="na">format=</span><span class="s">"txt"</span> <span class="na">label=</span><span class="s">"log"</span> <span class="nt">/&gt;</span><br>        <span class="nt">&lt;/outputs&gt;</span><br>        <span class="nt">&lt;help&gt;</span><span class="cp">&lt;![CDATA[]]&gt;</span><span class="nt">&lt;/help&gt;</span><br><span class="nt">&lt;/tool&gt;</span><br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> How many mules? <a href="/training-material/topics/admin/faqs/galaxy-how-many-mules.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-how-many-mules"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-many-mules" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: How many mules?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Start with 2 and add more as needed. If you notice that your jobs seem to inexplicably sit for a long time before being dispatched to the cluster, or after they have finished on the cluster, you may need additional handlers.</p> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="galaxy admin interface"> <a href="#galaxy admin interface"> Galaxy admin interface </a></h3>

<hr/>



<h4 class="faq-area"> Install tools via the Admin UI <a href="/training-material/topics/admin/faqs/install_tool.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-install-tools-via-the-admin-ui"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-install-tools-via-the-admin-ui" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Install tools via the Admin UI</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Open Galaxy in your browser and type `` in the tool search box on the left. If “” is among the search results, you can skip the following steps.</li>   <li>Access the Admin menu from the top bar (you need to be logged-in with an email specified in the <code class="language-plaintext highlighter-rouge">admin_users</code> setting)</li>   <li>Click “Install and Uninstall”, which can be found on the left, under “Tool Management”</li>   <li>Enter `` in the search interface</li>   <li>Click on the first hit, having <code class="language-plaintext highlighter-rouge">devteam</code> as owner</li>   <li>Click the “Install” button for the latest revision</li>   <li>Enter “” as the target section and click “OK”.</li> </ol> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="gat"> <a href="#gat"> Gat </a></h3>

<hr/>



<h4 class="faq-area"> Time to git commit <a href="/training-material/topics/admin/faqs/git-commit.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="notranslate hands_on">   <div class="box-title hands_on-title" id="hands-on-time-to-git-commit"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Time to git commit</div>   <p>It’s time to commit your work! Check the status with</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git status<br></code></pre></div></div>   <p>Add your changed files with</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add ... # any files you see that are changed<br></code></pre></div></div>   <p>And then commit it!</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit -m 'Finished '<br></code></pre></div></div> </blockquote> <!--END_SNIPPET-->




<h4 class="faq-area"> Using Git With Ansible Vaults <a href="/training-material/topics/admin/faqs/git-attributes.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="notranslate hands_on">   <div class="box-title hands_on-title" id="hands-on-using-git-with-ansible-vaults"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Using Git With Ansible Vaults</div>   <p>When looking at <code class="language-plaintext highlighter-rouge">git log</code> to see what you changed, you cannot easily look into Ansible Vault changes: you just see the changes in the encrypted versions which is unpleasant to read.</p>   <p>Instead we can use <a href="https://www.git-scm.com/docs/gitattributes"><code class="language-plaintext highlighter-rouge">.gitattributes</code></a> to tell <code class="language-plaintext highlighter-rouge">git</code> that we want to use a different program to visualise differences between two versions of a file, namely <code class="language-plaintext highlighter-rouge">ansible-vault</code>.</p>   <ol>   <li>Check your <code class="language-plaintext highlighter-rouge">git log -p</code> and see how the Vault changes look (you can type <code class="language-plaintext highlighter-rouge">/vault</code> to search). Notice that they’re just changed encoded content.</li>   <li>     <p>Create the file <code class="language-plaintext highlighter-rouge">.gitattributes</code> in the same folder as your <code class="language-plaintext highlighter-rouge">galaxy.yml</code> playbook, with the following contents:</p>     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group_vars/secret.yml diff=ansible-vault merge=binary<br></code></pre></div>    </div>   </li>   <li>Try again to <code class="language-plaintext highlighter-rouge">git log -p</code> and look for the vault changes. Note that you can now see the decrypted content! Very useful.</li> </ol> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="tips"> <a href="#tips"> Tips </a></h3>

<hr/>



<h4 class="faq-area"> Opening a split screen in byobu <a href="/training-material/topics/admin/faqs/byobu-shortcuts.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="tip">   <div class="box-title tip-title" id="tip-opening-a-split-screen-in-byobu"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-opening-a-split-screen-in-byobu" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Opening a split screen in byobu</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <div class="box-title tip-title" id="tip-opening-a-split-screen-in-byobu-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-opening-a-split-screen-in-byobu-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Opening a split screen in byobu</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p><kbd>Shift-F2</kbd>: Create a horizontal split</p>   <p><kbd>Shift-Left/Right/Up/Down</kbd>: Move focus among splits</p>   <p><kbd>Ctrl-F6</kbd>:  Close split in focus</p>   <p><kbd>Ctrl-D</kbd>:  (Linux, Mac users) Close split in focus</p>   <p>There are more byobu commands described in this <a href="https://gist.github.com/devhero/7b9a7281db0ac4ba683f">gist</a></p> </blockquote> <!--END_SNIPPET-->



 <br> 

<h3 id="utilities"> <a href="#utilities"> Utilities </a></h3>

<hr/>



<h4 class="faq-area"> Got lost along the way? <a href="/training-material/topics/admin/faqs/missed-something.html"><i class="fas fa-external-link-alt"></i></a> </h4>

<!--SNIPPET--><blockquote class="comment">   <div class="box-title comment-title" id="comment-got-lost-along-the-way"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Got lost along the way?</div>   <p>If you missed any steps, you can compare against the <a href="https://github.com/hexylena/git-gat/tree/step-">reference files</a>, or see what changed since <a href="https://github.com/hexylena/git-gat/compare/step--1...step-#files_bucket">the previous tutorial</a>.</p>   <p>If you’re using <code class="language-plaintext highlighter-rouge">git</code> to track your progress, remember to add your changes and commit with a good commit message!</p> </blockquote> <!--END_SNIPPET-->











<br><br><hr>
<h5>Still have questions?</h5>

<!--
add a button, include configuration options:

 link: "https://example.com"
 label: this text goes on button
 size: small/medium/large/extralarge
 colour:  blue/purple/green/red/yellow/lightblue/white/black
 square: false , if you want a regular rectangular button
-->




<a href="https://gitter.im/Galaxy-Training-Network/Lobby" class="btn btn-square-medium btn-yellow"><div>Gitter Chat Support</div></a>


<!--
add a button, include configuration options:

 link: "https://example.com"
 label: this text goes on button
 size: small/medium/large/extralarge
 colour:  blue/purple/green/red/yellow/lightblue/white/black
 square: false , if you want a regular rectangular button
-->




<a href="https://help.galaxyproject.org" class="btn btn-square-medium btn-purple"><div>Galaxy Help Forum</div></a>



            </div>
        </div>
    </div>
</section>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides learners with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/about.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/admin/faqs/index.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/admin/faqs/index.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/715a5f0aefd15f73c5a3222b576a5f6c21ada9c5">715a5f0</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>

				<span style="font-size: 1.3em">Publications</span>
				<ul class="no-bullets">
					<li><a href="https://doi.org/10.1371/journal.pcbi.1010752">Hiltemann et al. 2023</a></li>
					<li><a href="https://doi.org/10.1016/j.cels.2018.05.012"> Batut et al. 2018</a></li>
					<li><a href="/training-material/faqs/gtn/gtn_citing.html">Citing Us</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.40d4e218.js'></script>

	
	

    </body>
</html>