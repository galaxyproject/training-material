<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Slide Deck: Slide Deck: Hands-on: Galaxy Monitoring with Telegraf and Grafana / Galaxy Server administration</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@833df4cae620969d9853a9323c2d68ffac048906",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/admin/tutorials/monitoring/slides-plain.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.105e595f.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Galaxy Monitoring with Telegraf and Grafana">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-04-16 09:31:36 +0000">
<meta name="DC.creator" content="Nate Coraor">
<meta name="DC.creator" content="Björn Grüning">
<meta name="DC.creator" content="Simon Gladman">
<meta name="DC.creator" content="Helena Rasche"><meta name="description" content="# Telegraf, InfluxDB, and Grafana  General purpose tools for monitoring systems and services.  Tool     | Use ---      | --- [Telegraf](https://github.com/influxdata/telegraf) | plugin-driven server agent for collecting & reporting metrics [Influxdb](https://github.com/influxdata/influxdb/) | purpose built time series database [Grafana](https://grafana.com/)  | dashboard for beautiful analytics and monitoring  Dataflow:  - Galaxy produces data - Telegraf consumes and buffers it, before sending it to - InfluxDB which stores the data - And Grafana is used to visualise it  ???  - Monitoring in Galaxy is easy to setup. - Galaxy produces data, which is consumed by telegraf. - telegrafends data to Influx DB. - This data is visualized in Grafana.  --- # Grafana showcase  * usegalaxy.eu [public server](https://stats.galaxyproject.eu) * usegalaxy.org.au [public server](https://stats.genome.edu.au) * usegalaxy.org private server  If you see a dashboard you can export its configuration and put...">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Galaxy Server administration / Slide Deck: Hands-on: Galaxy Monitoring with Telegraf and Grafana">
        <meta property="og:description" content="# Telegraf, InfluxDB, and Grafana  General purpose tools for monitoring systems and services.  Tool     | Use ---      | --- [Telegraf](https://github.com/influxdata/telegraf) | plugin-driven server agent for collecting & reporting metrics [Influxdb](https://github.com/influxdata/influxdb/) | purpose built time series database [Grafana](https://grafana.com/)  | dashboard for beautiful analytics and monitoring  Dataflow:  - Galaxy produces data - Telegraf consumes and buffers it, before sending it to - InfluxDB which stores the data - And Grafana is used to visualise it  ???  - Monitoring in Galaxy is easy to setup. - Galaxy produces data, which is consumed by telegraf. - telegrafends data to Influx DB. - This data is visualized in Grafana.  --- # Grafana showcase  * usegalaxy.eu [public server](https://stats.galaxyproject.eu) * usegalaxy.org.au [public server](https://stats.genome.edu.au) * usegalaxy.org private server  If you see a dashboard you can export its configuration and put...">
        
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png"></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
			

                        
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/./topics/admin/tutorials/monitoring/slides.html">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/admin/tutorials/monitoring/slides-plain.html">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            <a class="dropdown-item" href="/training-material/feedback.html">
                <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        <section class="tutorial">
	<a href="https://github.com/galaxyproject/training-material/blob/main//topics/admin/tutorials/monitoring/slides.html">View markdown source on GitHub</a>
	<h1>Galaxy Monitoring with Telegraf and Grafana</h1>
		<h2>Contributors</h2>
<div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/natefoo/" class="contributor-badge contributor-natefoo"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/natefoo?s=36" alt="Nate Coraor avatar" width="36" class="avatar" />
    Nate Coraor</a><a href="/training-material/hall-of-fame/bgruening/" class="contributor-badge contributor-bgruening"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bgruening?s=36" alt="Björn Grüning avatar" width="36" class="avatar" />
    Björn Grüning</a><a href="/training-material/hall-of-fame/slugger70/" class="contributor-badge contributor-slugger70"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/slugger70?s=36" alt="Simon Gladman avatar" width="36" class="avatar" />
    Simon Gladman</a><a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge contributor-hexylena"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/hexylena?s=36" alt="Helena Rasche avatar" width="36" class="avatar" />
    Helena Rasche</a>
	</div>

</div>


		
		<h2>Questions</h2>
		<ul>
		
		<li><p>How to monitor Galaxy with Telegraf</p>
</li>
		
		<li><p>How do I set up InfluxDB</p>
</li>
		
		<li><p>How can I make graphs in Grafana?</p>
</li>
		
		<li><p>How can I best alert on important metrics?</p>
</li>
		
		</ul>
		

		
		<h2>Objectives</h2>
		<ul>
		
		<li><p>Setup InfluxDB</p>
</li>
		
		<li><p>Setup Telegraf</p>
</li>
		
		<li><p>Setup Grafana</p>
</li>
		
		<li><p>Create several charts</p>
</li>
		
		</ul>
		

		

		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Published:</strong> Jan 1, 1970 </div>
		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last Updated:</strong> Apr 16, 2024 </div>

	<hr />


	<h1 id="telegraf-influxdb-and-grafana">Telegraf, InfluxDB, and Grafana</h1>

<p>General purpose tools for monitoring systems and services.</p>

<table>
  <thead>
    <tr>
      <th>Tool</th>
      <th>Use</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://github.com/influxdata/telegraf">Telegraf</a></td>
      <td>plugin-driven server agent for collecting &amp; reporting metrics</td>
    </tr>
    <tr>
      <td><a href="https://github.com/influxdata/influxdb/">Influxdb</a></td>
      <td>purpose built time series database</td>
    </tr>
    <tr>
      <td><a href="https://grafana.com/">Grafana</a></td>
      <td>dashboard for beautiful analytics and monitoring</td>
    </tr>
  </tbody>
</table>

<p>Dataflow:</p>

<ul>
  <li>Galaxy produces data</li>
  <li>Telegraf consumes and buffers it, before sending it to</li>
  <li>InfluxDB which stores the data</li>
  <li>And Grafana is used to visualise it</li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Monitoring in Galaxy is easy to setup.</li>
  <li>Galaxy produces data, which is consumed by telegraf.</li>
  <li>telegrafends data to Influx DB.</li>
  <li>This data is visualized in Grafana.</li>
</ul>

<hr />
<h1 id="grafana-showcase">Grafana showcase</h1>

<ul>
  <li>usegalaxy.eu <a href="https://stats.galaxyproject.eu">public server</a></li>
  <li>usegalaxy.org.au <a href="https://stats.genome.edu.au">public server</a></li>
  <li>usegalaxy.org private server</li>
</ul>

<p>If you see a dashboard you can export its configuration and put it on your Grafana with your data. Copy away!</p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>We have several public Grafana servers.</li>
  <li>If you like any of our graphs, you can copy them.</li>
</ul>

<hr />

<p><img src="../../images/grafana/galaxy.png" alt="galaxy dashboard showing route timings, user counts, job counts, etc." /></p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>We have built numerous dashboards for monitoring Galaxy.</li>
  <li>These include scripts and playbooks and configuration for everything.</li>
  <li>Here is EU’s galaxy dashboard showing active users, running and unscheduled jobs, etc.</li>
</ul>

<hr />

<p><img src="../../images/grafana/node.png" alt="node detail dashboard with filesystem usage, process states, cpu, memory, load, network, etc." /></p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>However sometimes we notice something going wrong with our infrastructure.</li>
  <li>We use the node detail dashboard to begin our investigation.</li>
  <li>It gives us a very fast overview of the server.</li>
  <li>This can help efficiently pinpoint isuses.</li>
</ul>

<hr />

<p><img src="../../images/grafana/db.png" alt="DB dashboard showing transactions, tuples fetched/modified, and index sizes for each database" /></p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>We also monitor the database heavily.</li>
  <li>All of this monitoring is built into telegraf.</li>
  <li>We need to be able to correlate latency with autovacuums or contention.</li>
  <li>We monitor table size changes to check for anomalies.</li>
</ul>

<hr />

<p><img src="../../images/grafana/stats.png" alt="user statistics page for Eu with 23k users, 30k workflows, 400k histories, 13M jobs, and 30M datasets. Additional breakdowns provided for years of compute time on various clusters included 1k years on de.NBI cloud." /></p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Our staff often needs to report numbers for their grants.</li>
  <li>We produced this user statistics dashboard to help them.</li>
  <li>Now they can answer their own questions, and make their own graphs, without admin help.</li>
</ul>

<hr />

<p><img src="../../images/grafana/cvmfs.png" alt="cvmfs dashboard showing which repos each server supports in green, and missing ones in white. ~90% of repos are supported" /></p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>We don’t just monitor Galaxy though.</li>
  <li>We also monitor CVMFS, and the availability of repositories in each server.</li>
  <li>This can give a good view of which repositories are replicated.</li>
</ul>



	<hr />


<h2>Key Points</h2>

<ul>

<li>Telegraf provides an easy solution to monitor servers</li>

<li>Galaxy can send metrics to Telegraf</li>

<li>Telegraf can run arbitrary commands like `gxadmin`, which provides influx formatted output</li>

<li>InfluxDB can collect metrics from Telegraf</li>

<li>Use Grafana to visualise these metrics, and monitor their values</li>

</ul>







<h2>Thank you!</h2>

This material is the result of a collaborative work. Thanks to the <a href="https://training.galaxyproject.org" aria-label="Visit the GTN">Galaxy Training Network</a> and all the contributors!



<img src="/training-material/assets/images/gat.png" alt="page logo" style="height: 100px;"/>



Tutorial Content is licensed under

  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

</section>





        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-6" style="text-align: left">
				<p>
					The <a href="https://galaxyproject.org/teach/gtn/">Galaxy Training Network</a>
					provides researchers with online training materials, connects them with local trainers, and helps promoting FAIR and Open Science practices worldwide. All contributions are subject to the <a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Galaxy Project Code of Conduct</a>.
				</p>
				<p>
				The GTN infrastructure is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
				</p>
				<p>
				Revision <a href="https://github.com/galaxyproject/training-material/commit/833df4cae620969d9853a9323c2d68ffac048906">833df4c</a>, built with Jekyll (4.3.2 | production)
				</p>
			</div>
			<div class="col-sm-6" style="text-align: right">
				
				<p>
					<i>This Material</i>:
					
					is licensed under
					<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
						Creative Commons Attribution 4.0 International License
					</a>
				</p>
				<p>
					<a href="https://github.com/galaxyproject/training-material/edit/main/./topics/admin/tutorials/monitoring/slides.html" title="Edit on GitHub">
					<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
					</a>
				</p>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.105e595f.js'></script>

	
	
    </body>
</html>
