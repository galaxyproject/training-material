<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Slide Deck: Slide Deck: Controlling Galaxy with systemd or Supervisor / Galaxy Server administration</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@6d58dcda159f1edca14f9076e5437988d499318d",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/admin/tutorials/systemd-supervisor/slides-plain.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.f1f2de89.js?v=1705796078' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.03aefefa.js?v=1705796078' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Controlling Galaxy with systemd or Supervisor">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-01-21 00:14:38 +0000">
<meta name="DC.creator" content="Nate Coraor">
<meta name="DC.creator" content="Helena Rasche"><meta name="description" content="class: special  # systemd  The current Linux init system  Used to bootstrap the user space and to manage system processes after booting  ???  - systemd is a popular linux init system. - It manages processes and ensures they are running after boot. - It can restart processes when they crash.  --- class: left  # systemd  Replaces: - `/etc/init.d/*`, `/etc/rc?.d` - `service` command - Upstart - `update-rc.d`  INI config format  ???  - systemd replaces many previous alternative init systems - it is quite easy to work with  --- # systemd - Layout  - `/lib/systemd/system` - System service definitions - `/etc/systemd/system` - User-defined service definitions  ???  - systemd has two separate pools of service definitions. - in lib are the system and package provided definitions. - in etc are the user provided definitions. - Galaxy's will be in /etc.  --- # systemd - Galaxy service unit  ```ini [Unit] Description=Galaxy After=network.target After=time-sync.target  [Service] UMask=022 Type=si...">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Galaxy Server administration / Slide Deck: Controlling Galaxy with systemd or Supervisor">
        <meta property="og:description" content="class: special  # systemd  The current Linux init system  Used to bootstrap the user space and to manage system processes after booting  ???  - systemd is a popular linux init system. - It manages processes and ensures they are running after boot. - It can restart processes when they crash.  --- class: left  # systemd  Replaces: - `/etc/init.d/*`, `/etc/rc?.d` - `service` command - Upstart - `update-rc.d`  INI config format  ???  - systemd replaces many previous alternative init systems - it is quite easy to work with  --- # systemd - Layout  - `/lib/systemd/system` - System service definitions - `/etc/systemd/system` - User-defined service definitions  ???  - systemd has two separate pools of service definitions. - in lib are the system and package provided definitions. - in etc are the user provided definitions. - Galaxy's will be in /etc.  --- # systemd - Galaxy service unit  ```ini [Unit] Description=Galaxy After=network.target After=time-sync.target  [Service] UMask=022 Type=si...">
        
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png"></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script src='/training-material/assets/js/bundle.f1f2de89.js?v=1705796078'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
			

                        
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/./topics/admin/tutorials/systemd-supervisor/slides.html">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/admin/tutorials/systemd-supervisor/slides-plain.html">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            <a class="dropdown-item" href="/training-material/feedback.html">
                <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/smorgasbord2023/topics/admin/tutorials/systemd-supervisor/slides-plain.html">smorgasbord2023</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2024-01-01/topics/admin/tutorials/systemd-supervisor/slides-plain.html">2024-01-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2023-12-01/topics/admin/tutorials/systemd-supervisor/slides-plain.html">2023-12-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        <section class="tutorial">
	<a href="https://github.com/galaxyproject/training-material/blob/main//topics/admin/tutorials/systemd-supervisor/slides.html">View markdown source on GitHub</a>
	<h1>Controlling Galaxy with systemd or Supervisor</h1>
		<h2>Contributors</h2>
<div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/natefoo/" class="contributor-badge contributor-natefoo"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/natefoo?s=36" alt="Nate Coraor avatar" width="36" class="avatar" />
    Nate Coraor</a><a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge contributor-hexylena"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/hexylena?s=36" alt="Helena Rasche avatar" width="36" class="avatar" />
    Helena Rasche</a>
	</div>

</div>


		

		

		

		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Published:</strong> Jan 21, 2024 </div>
		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last Updated:</strong> Jan 21, 2024 </div>

	<hr />


	<p>class: special</p>

<h1 id="systemd">systemd</h1>

<p>The current Linux init system</p>

<p>Used to bootstrap the user space and to manage system processes after booting</p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>systemd is a popular linux init system.</li>
  <li>It manages processes and ensures they are running after boot.</li>
  <li>It can restart processes when they crash.</li>
</ul>

<hr />
<p>class: left</p>

<h1 id="systemd-1">systemd</h1>

<p>Replaces:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">/etc/init.d/*</code>, <code class="language-plaintext highlighter-rouge">/etc/rc?.d</code></li>
  <li><code class="language-plaintext highlighter-rouge">service</code> command</li>
  <li>Upstart</li>
  <li><code class="language-plaintext highlighter-rouge">update-rc.d</code></li>
</ul>

<p>INI config format</p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>systemd replaces many previous alternative init systems</li>
  <li>it is quite easy to work with</li>
</ul>

<hr />
<h1 id="systemd---layout">systemd - Layout</h1>

<ul>
  <li><code class="language-plaintext highlighter-rouge">/lib/systemd/system</code> - System service definitions</li>
  <li><code class="language-plaintext highlighter-rouge">/etc/systemd/system</code> - User-defined service definitions</li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>systemd has two separate pools of service definitions.</li>
  <li>in lib are the system and package provided definitions.</li>
  <li>in etc are the user provided definitions.</li>
  <li>Galaxy’s will be in /etc.</li>
</ul>

<hr />
<h1 id="systemd---galaxy-service-unit">systemd - Galaxy service unit</h1>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[Unit]</span>
<span class="py">Description</span><span class="p">=</span><span class="s">Galaxy</span>
<span class="py">After</span><span class="p">=</span><span class="s">network.target</span>
<span class="py">After</span><span class="p">=</span><span class="s">time-sync.target</span>

<span class="nn">[Service]</span>
<span class="py">UMask</span><span class="p">=</span><span class="s">022</span>
<span class="py">Type</span><span class="p">=</span><span class="s">simple</span>
<span class="py">User</span><span class="p">=</span><span class="s">galaxy</span>
<span class="py">Group</span><span class="p">=</span><span class="s">galaxy</span>
<span class="py">WorkingDirectory</span><span class="p">=</span><span class="s">/srv/galaxy/server</span>
<span class="py">TimeoutStartSec</span><span class="p">=</span><span class="s">10</span>
<span class="py">ExecStart</span><span class="p">=</span><span class="s">/srv/galaxy/venv/bin/uwsgi --yaml /srv/galaxy/config/galaxy.yml --stats 127.0.0.1:4010</span>
<span class="py">Environment</span><span class="p">=</span><span class="s">HOME=/srv/galaxy VIRTUAL_ENV=/srv/galaxy/venv PATH=/srv/galaxy/venv/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin DOCUTILSCONFIG= PYTHONPATH=/srv/galaxy/server/lib/galaxy/jobs/rules</span>
<span class="py">MemoryLimit</span><span class="p">=</span><span class="s">32G</span>
<span class="py">Restart</span><span class="p">=</span><span class="s">always</span>

<span class="py">MemoryAccounting</span><span class="p">=</span><span class="s">yes</span>
<span class="py">CPUAccounting</span><span class="p">=</span><span class="s">yes</span>
<span class="py">BlockIOAccounting</span><span class="p">=</span><span class="s">yes</span>

<span class="nn">[Install]</span>
<span class="py">WantedBy</span><span class="p">=</span><span class="s">multi-user.target</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Here is an example systemd service definition, or a unit.</li>
  <li>At the top section, it describes the service name, and any dependencies.</li>
  <li>For galaxy, we only want it to start when the network is available.</li>
  <li>Next is the service section.</li>
  <li>here we define that it is a simple service, run by the user and group galaxy.</li>
  <li>it starts in a particular working directory.</li>
  <li>and if it does not start within 10 seconds, something is wrong.</li>
  <li>We provide a command that should be run.</li>
  <li>And some environment variables like the path or home directory.</li>
  <li>A memory limit is provided, which systemd enforces through cgroups.</li>
  <li>next, the process should always restart if it crashes.</li>
  <li>And various accounting is enabled.</li>
</ul>

<hr />
<h1 id="systemd---systemctl">systemd - systemctl</h1>

<p><code class="language-plaintext highlighter-rouge">systemctl</code> is the command line interface to systemd</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">systemctl status &lt;name&gt;[.service]</code></li>
  <li><code class="language-plaintext highlighter-rouge">systemctl &lt;start|stop|restart|...&gt; &lt;name&gt;[.service]</code></li>
  <li><code class="language-plaintext highlighter-rouge">systemctl &lt;enable|disable&gt; &lt;name&gt;[.service]</code></li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>the systemctl command lets you interact with the service.</li>
  <li>You can start, stop, or restart the service.</li>
  <li>You can enable or disable the service if you do or do not want it to start at boot.</li>
</ul>

<hr />
<h1 id="systemd---galaxy-service">systemd - Galaxy service</h1>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>systemctl status galaxy
<span class="go">● galaxy.service - Galaxy
</span><span class="gp">   Loaded: loaded (/etc/systemd/system/galaxy.service;</span><span class="w"> </span>enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
<span class="gp">   Active: active (running) since Wed 2020-02-26 19:46:03 UTC;</span><span class="w"> </span>1 day 20h ago
<span class="go"> Main PID: 7845 (uwsgi)
    Tasks: 45 (limit: 4915)
   Memory: 569.2M (limit: 32.0G)
      CPU: 5h 43min 35.436s
   CGroup: /system.slice/galaxy.service
           ├─7845 /srv/galaxy/venv/bin/python3 /srv/galaxy/venv/bin/uwsgi --yaml /srv/galaxy/config/galaxy.yml --stats 127.0.0.1:4010
           ├─8106 /srv/galaxy/venv/bin/python3 /srv/galaxy/venv/bin/uwsgi --yaml /srv/galaxy/config/galaxy.yml --stats 127.0.0.1:4010
           ├─8111 /srv/galaxy/venv/bin/python3 /srv/galaxy/venv/bin/uwsgi --yaml /srv/galaxy/config/galaxy.yml --stats 127.0.0.1:4010
           └─8112 /srv/galaxy/venv/bin/python3 /srv/galaxy/venv/bin/uwsgi --yaml /srv/galaxy/config/galaxy.yml --stats 127.0.0.1:4010
</span></code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Here is an example output of the status command.</li>
  <li>The word enabled in the loaded line shows that the service will start at boot</li>
  <li>The service is running since 1 day and 20 hours.</li>
  <li>We are told the main PID.</li>
  <li>And shown the memory usage next to the memory usage limit.</li>
  <li>systemd starts services in a cgroup, so all children can be kept track of.</li>
  <li>Child processes which are started by the parent process are likewise listed.</li>
</ul>

<hr />

<h1 id="supervisor">Supervisor</h1>

<p>The former recommended method for managing multiple Galaxy processes</p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Before systemd there was supervisor.</li>
  <li>We do not use this as much anymore.</li>
</ul>

<hr />
<h1 id="supervisor-1">Supervisor</h1>

<p>A process manager written in Python</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">supervisord</code> daemon
    <ul>
      <li>Privileged or unprivileged</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">supervisorctl</code> command line interface</li>
  <li>INI config format</li>
  <li><code class="language-plaintext highlighter-rouge">[program:x]</code> defines a program to control</li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Supervisor was a process manager written in python.</li>
  <li>It could run as an unprivileged user, and was similar to systemd.</li>
</ul>

<hr />
<p>class: smaller</p>
<h1 id="supervisor---supervisorctl">Supervisor - supervisorctl</h1>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>supervisorctl <span class="nb">help</span>
<span class="go">
</span><span class="gp">default commands (type help &lt;topic&gt;</span><span class="o">)</span>:
<span class="go">=====================================
add    clear  fg        open  quit    remove  restart   start   stop  update
avail  exit   maintail  pid   reload  reread  shutdown  status  tail  version

</span><span class="gp">$</span><span class="w"> </span>supervisorctl status
<span class="go">galaxy_main:handler0             RUNNING    pid 30554, uptime 7 days, 23:15:11
galaxy_main:handler1             RUNNING    pid 30555, uptime 7 days, 23:15:11
galaxy_main:handler2             RUNNING    pid 30556, uptime 7 days, 23:15:10
galaxy_main:impersonate          RUNNING    pid 30567, uptime 7 days, 23:15:08
galaxy_main:installer            RUNNING    pid 30574, uptime 7 days, 23:15:07
galaxy_main:reports              RUNNING    pid 30563, uptime 7 days, 23:15:09
galaxy_main_supervisord          RUNNING    pid 2108, uptime 8 days, 6:43:54
galaxy_main_uwsgi                RUNNING    pid 3568, uptime 8 days, 6:39:07
nginx                            RUNNING    pid 1917, uptime 8 days, 6:44:21
proftpd                          RUNNING    pid 1916, uptime 8 days, 6:44:21
</span></code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>The supervisor status command would show running parent processes.</li>
  <li>Very similar to systemd</li>
</ul>

<hr />
<h1 id="supervisor---program">Supervisor - program</h1>

<p>A config for running a Galaxy server under uWSGI has been installed at <code class="language-plaintext highlighter-rouge">/etc/supervisor/conf.d/galaxy.conf</code>:</p>

<div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[program:galaxy]</span>
<span class="py">command</span>         <span class="p">=</span> <span class="s">uwsgi --plugin python --virtualenv /srv/galaxy/server/.venv --ini-paste /srv/galaxy/server/galaxy.yml</span>
<span class="py">directory</span>       <span class="p">=</span> <span class="s">/srv/galaxy/server</span>
<span class="py">autostart</span>       <span class="p">=</span> <span class="s">true</span>
<span class="py">autorestart</span>     <span class="p">=</span> <span class="s">true</span>
<span class="py">startsecs</span>       <span class="p">=</span> <span class="s">10</span>
<span class="py">user</span>            <span class="p">=</span> <span class="s">galaxy</span>
<span class="py">stopsignal</span>      <span class="p">=</span> <span class="s">INT</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>The service definition for a supervisor process group.</li>
  <li>Here it is named galaxy.</li>
  <li>A command and working directory are provided.</li>
  <li>A user to run the command is listed.</li>
  <li>comparable to systemd service definitions.</li>
</ul>

<hr />
<h1 id="supervisor--systemd">Supervisor + systemd</h1>

<p>If you prefer, you can use Supervisor to manage the Galaxy processes. The OS needs to ensure the Supervisor daemon is running, and probably manages it with systemd, as is common on most systems currently.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>systemctl status supervisor
<span class="go">● supervisor.service - Supervisor process control system for UNIX
</span><span class="gp">   Loaded: loaded (/lib/systemd/system/supervisor.service;</span><span class="w"> </span>enabled<span class="o">)</span>
<span class="gp">   Active: active (running) since Mon 2016-10-10 14:19:34 EDT;</span><span class="w"> </span>3 weeks 3 days ago
<span class="go"> Main PID: 481 (supervisord)
   CGroup: /system.slice/supervisor.service
           ├─  481 /usr/bin/python /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf
           ├─ 6264 /usr/bin/uwsgi --plugin python --virtualenv /srv/galaxy/server/.venv --ini-paste /srv/galaxy/server/galaxy.yml
           ├─ 6268 /usr/bin/uwsgi --plugin python --virtualenv /srv/galaxy/server/.venv --ini-paste /srv/galaxy/server/galaxy.yml
           ├─10109 /srv/galaxy/server/.venv/bin/python ./scripts/galaxy-main -c /srv/galaxy/server/galaxy.yml --server-name=handler0
           └─10142 /srv/galaxy/server/.venv/bin/python ./scripts/galaxy-main -c /srv/galaxy/server/galaxy.yml --server-name=handler1
</span></code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>These two can be combined.</li>
  <li>systemd can start supervisor, if you have reason to need supervisor.</li>
</ul>


	<hr />








<h2>Thank you!</h2>

This material is the result of a collaborative work. Thanks to the <a href="https://training.galaxyproject.org" aria-label="Visit the GTN">Galaxy Training Network</a> and all the contributors!



<img src="/training-material/assets/images/gat.png" alt="page logo" style="height: 100px;"/>



Tutorial Content is licensed under

  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

</section>





        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-6" style="text-align: left">
				<p>
					The <a href="https://galaxyproject.org/teach/gtn/">Galaxy Training Network</a>
					provides researchers with online training materials, connects them with local trainers, and helps promoting FAIR and Open Science practices worldwide. All contributions are subject to the <a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Galaxy Project Code of Conduct</a>.
				</p>
				<p>
				The GTN infrastructure is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
				</p>
				<p>
				Revision <a href="https://github.com/galaxyproject/training-material/commit/6d58dcda159f1edca14f9076e5437988d499318d">6d58dcd</a>, built with Jekyll (4.3.2 | production)
				</p>
			</div>
			<div class="col-sm-6" style="text-align: right">
				
				<p>
					<i>This Material</i>:
					
					is licensed under
					<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
						Creative Commons Attribution 4.0 International License
					</a>
				</p>
				<p>
					<a href="https://github.com/galaxyproject/training-material/edit/main/./topics/admin/tutorials/systemd-supervisor/slides.html" title="Edit on GitHub">
					<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
					</a>
				</p>
			</div>
		</div>
	</div>
</footer>


        <script src='/training-material/assets/js/bundle.03aefefa.js?v=1705796078'></script>
        
    </body>
</html>
