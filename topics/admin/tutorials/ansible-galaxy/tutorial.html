<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hands-on: Galaxy Installation with Ansible / Galaxy Installation with Ansible / Galaxy Server administration</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@55607e95d8efdacc58f4eb03501f1419ce408b25",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.40d4e218.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Galaxy Installation with Ansible">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-06-14 09:56:50 +0000">
<meta name="DC.creator" content="Helena Rasche">
<meta name="DC.creator" content="Nate Coraor">
<meta name="DC.creator" content="Simon Gladman"><meta name="description" content="Here you can learn everything you need to become a Pro Galaxy Administrator! These resources cover everything from setup, to configuration, to monitoring, to customisation. ">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Galaxy Server administration / Galaxy Installation with Ansible / Hands-on: Galaxy Installation with Ansible">
        <meta property="og:description" content="Here you can learn everything you need to become a Pro Galaxy Administrator! These resources cover everything from setup, to configuration, to monitoring, to customisation. ">
        <meta property="og:image" content="https://galaxy-training.s3.amazonaws.com/social/topics/admin/tutorials/ansible-galaxy/tutorial.png">
	<script type="application/ld+json">


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Galaxy Administrators"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Galaxy Installation with Ansible",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "provider": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "dateModified": "2024-06-14 09:56:50 +0000",
  "datePublished": "2019-01-28 10:40:06 +0000",
  "copyrightHolder": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "funder": [

  ],
  "funding": [

  ],
  "identifier": "https://gxy.io/GTN:T00001",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Galaxy Server administration",
    "description": "Here you can learn everything you need to become a Pro Galaxy Administrator! These resources cover everything from setup, to configuration, to monitoring, to customisation.\n",
    "url": "https://training.galaxyproject.org/training-material/topics/admin/"
  },
  "abstract": "This tutorial assumes you have some familiarity with [Ansible](https://www.ansible.com/resources/get-started) and are comfortable with writing and running playbooks.  If not, please consider following our [Ansible Tutorial](http://localhost:4000/training-material/topics/admin/tutorials/ansible/tutorial.html) first.",
  "learningResourceType": "e-learning",
  "name": "Galaxy Installation with Ansible",
  "url": "https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html",
  "version": 99,
  "timeRequired": "PT2H30M",
  "teaches": "- Have an understanding of how Galaxy's Ansible roles are structured and interact with one another\n- Be able to use an Ansible playbook to install different flavors of Galaxy for different purposes",
  "keywords": [
    "Galaxy Server administration",
    "ansible",
    "deploying",
    "git-gat"
  ],
  "description": "## Abstract\n\nThis tutorial assumes you have some familiarity with [Ansible](https://www.ansible.com/resources/get-started) and are comfortable with writing and running playbooks.  If not, please consider following our [Ansible Tutorial](http://localhost:4000/training-material/topics/admin/tutorials/ansible/tutorial.html) first.\n\n\n## About This Material\n\nThis is a Hands-on Tutorial from the GTN which is usable either for individual self-study, or as a teaching material in a classroom.\n\n\n## Questions this  will address\n\n - How does the Galaxy Ansible module work internally?\n - How can I install a Galaxy server with Ansible\n\n\n## Learning Objectives\n\n- Have an understanding of how Galaxy's Ansible roles are structured and interact with one another\n- Be able to use an Ansible playbook to install different flavors of Galaxy for different purposes\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible/slides.html",
      "name": "Ansible",
      "description": "Slides for 'Ansible' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible/tutorial.html",
      "name": "Ansible",
      "description": "Hands-on for 'Ansible' tutorial",
      "learningResourceType": "e-learning",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    },
    "A VM with at least 2 vCPUs and 4 GB RAM, preferably running Ubuntu 20.04 - 22.04."
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/",
      "name": "Helena Rasche",
      "image": "https://avatars.githubusercontent.com/hexylena",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/erasmusmc/",
          "name": "Erasmus Medical Center",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusmc.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/by-covid/",
          "name": "BeYond-COVID",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://by-covid.org/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-converge/",
          "name": "ELIXIR-CONVERGE",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org/about-us/how-funded/eu-projects/converge"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9760-8992",
      "orcid": "https://orcid.org/0000-0001-9760-8992"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/natefoo/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/natefoo/",
      "name": "Nate Coraor",
      "image": "https://avatars.githubusercontent.com/natefoo",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-8083-2963",
      "orcid": "https://orcid.org/0000-0001-8083-2963"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/slugger70/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/slugger70/",
      "name": "Simon Gladman",
      "image": "https://avatars.githubusercontent.com/slugger70",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-6100-4385",
      "orcid": "https://orcid.org/0000-0002-6100-4385"
    }
  ],
  "contributor": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/shiltemann/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/shiltemann/",
      "name": "Saskia Hiltemann",
      "image": "https://avatars.githubusercontent.com/shiltemann",
      "description": "Researcher at Erasmus Medical Center",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/CINECA-Project/",
          "name": "Common Infrastructure for National Cohorts in Europe, Canada, and Africa",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.cineca-project.eu"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/erasmusmc/",
          "name": "Erasmus Medical Center",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusmc.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/uni-freiburg/",
          "name": "University of Freiburg",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.uni-freiburg.de/"
        }
      ],
      "identifier": "https://orcid.org/0000-0003-3803-468X",
      "orcid": "https://orcid.org/0000-0003-3803-468X"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/nsoranzo/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/nsoranzo/",
      "name": "Nicola Soranzo",
      "image": "https://avatars.githubusercontent.com/nsoranzo",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/earlham/",
          "name": "Earlham Institute",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.earlham.ac.uk/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0003-3627-5340",
      "orcid": "https://orcid.org/0000-0003-3627-5340"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/gmauro/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/gmauro/",
      "name": "Gianmauro Cuccuru",
      "image": "https://avatars.githubusercontent.com/gmauro",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-5335-545X",
      "orcid": "https://orcid.org/0000-0002-5335-545X"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/mvdbeek/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/mvdbeek/",
      "name": "Marius van den Beek",
      "image": "https://avatars.githubusercontent.com/mvdbeek",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/martenson/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/martenson/",
      "name": "Martin Čech",
      "image": "https://avatars.githubusercontent.com/martenson",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-9318-1781",
      "orcid": "https://orcid.org/0000-0002-9318-1781"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/jmchilton/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/jmchilton/",
      "name": "John Chilton",
      "image": "https://avatars.githubusercontent.com/jmchilton",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-6794-0756",
      "orcid": "https://orcid.org/0000-0002-6794-0756"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/davebx/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/davebx/",
      "name": "Dave B.",
      "image": "https://avatars.githubusercontent.com/davebx",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/lecorguille/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/lecorguille/",
      "name": "Gildas Le Corguillé",
      "image": "https://avatars.githubusercontent.com/lecorguille",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/abretaud/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/abretaud/",
      "name": "Anthony Bretaudeau",
      "image": "https://avatars.githubusercontent.com/abretaud",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/eurosciencegateway/",
          "name": "EuroScienceGateway",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://galaxyproject.org/projects/esg/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0003-0914-2470",
      "orcid": "https://orcid.org/0000-0003-0914-2470"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/lldelisle/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/lldelisle/",
      "name": "Lucille Delisle",
      "image": "https://avatars.githubusercontent.com/lldelisle",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-1964-4960",
      "orcid": "https://orcid.org/0000-0002-1964-4960"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/mira-miracoli/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/mira-miracoli/",
      "name": "Mira Kuntz",
      "image": "https://avatars.githubusercontent.com/mira-miracoli",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/uni-freiburg/",
          "name": "University of Freiburg",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.uni-freiburg.de/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/deNBI/",
          "name": "de.NBI",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.denbi.de/"
        }
      ],
      "identifier": "https://orcid.org/0000-0003-4302-5091",
      "orcid": "https://orcid.org/0000-0003-4302-5091"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/edmontosaurus/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/edmontosaurus/",
      "name": "Edwin den Haas",
      "image": "https://avatars.githubusercontent.com/edmontosaurus",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Galaxy Server administration",
      "description": "Here you can learn everything you need to become a Pro Galaxy Administrator! These resources cover everything from setup, to configuration, to monitoring, to customisation.\n",
      "url": "https://training.galaxyproject.org/training-material/topics/admin/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3489",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3489",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3489"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0605",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0605",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0605"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3071",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3071",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3071"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [

  ]
}</script></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/admin" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Galaxy Server administration
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/admin/faqs/" title="Check our FAQs for the Galaxy Server administration topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/admin/tutorials/ansible-galaxy/tutorial.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html">
                    <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-admin">
    <h1 data-toc-skip>Galaxy Installation with Ansible</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge contributor-hexylena"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/hexylena?s=36" alt="Helena Rasche avatar" width="36" class="avatar" />
    Helena Rasche</a><a href="/training-material/hall-of-fame/natefoo/" class="contributor-badge contributor-natefoo"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/natefoo?s=36" alt="Nate Coraor avatar" width="36" class="avatar" />
    Nate Coraor</a><a href="/training-material/hall-of-fame/slugger70/" class="contributor-badge contributor-slugger70"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/slugger70?s=36" alt="Simon Gladman avatar" width="36" class="avatar" />
    Simon Gladman</a>
		</td>
	</tr>
	

	

	

	

	

	
	<tr>
		<td><abbr title="These people edited the text, either for spelling and grammar, flow, GTN-fit, or other similar editing categories">Editor(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/shiltemann/" class="contributor-badge contributor-shiltemann"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/shiltemann?s=36" alt="Saskia Hiltemann avatar" width="36" class="avatar" />
    Saskia Hiltemann</a><a href="/training-material/hall-of-fame/nsoranzo/" class="contributor-badge contributor-nsoranzo"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/nsoranzo?s=36" alt="Nicola Soranzo avatar" width="36" class="avatar" />
    Nicola Soranzo</a><a href="/training-material/hall-of-fame/gmauro/" class="contributor-badge contributor-gmauro"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/gmauro?s=36" alt="Gianmauro Cuccuru avatar" width="36" class="avatar" />
    Gianmauro Cuccuru</a><a href="/training-material/hall-of-fame/mvdbeek/" class="contributor-badge contributor-mvdbeek"><img src="https://avatars.githubusercontent.com/mvdbeek?s=36" alt="Marius van den Beek avatar" width="36" class="avatar" />
    Marius van den Beek</a><a href="/training-material/hall-of-fame/martenson/" class="contributor-badge contributor-martenson"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/martenson?s=36" alt="Martin Čech avatar" width="36" class="avatar" />
    Martin Čech</a><a href="/training-material/hall-of-fame/jmchilton/" class="contributor-badge contributor-jmchilton"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/jmchilton?s=36" alt="John Chilton avatar" width="36" class="avatar" />
    John Chilton</a><a href="/training-material/hall-of-fame/davebx/" class="contributor-badge contributor-davebx"><img src="https://avatars.githubusercontent.com/davebx?s=36" alt="Dave B. avatar" width="36" class="avatar" />
    Dave B.</a><a href="/training-material/hall-of-fame/lecorguille/" class="contributor-badge contributor-lecorguille"><img src="https://avatars.githubusercontent.com/lecorguille?s=36" alt="Gildas Le Corguillé avatar" width="36" class="avatar" />
    Gildas Le Corguillé</a><a href="/training-material/hall-of-fame/abretaud/" class="contributor-badge contributor-abretaud"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/abretaud?s=36" alt="Anthony Bretaudeau avatar" width="36" class="avatar" />
    Anthony Bretaudeau</a><a href="/training-material/hall-of-fame/lldelisle/" class="contributor-badge contributor-lldelisle"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/lldelisle?s=36" alt="Lucille Delisle avatar" width="36" class="avatar" />
    Lucille Delisle</a></td>
	</tr>
	

	
	<tr>
		<td><abbr title="These people tested the tutorial to ensure it works correctly for students, or reported issues with the tutorial.">Tester(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/mira-miracoli/" class="contributor-badge contributor-mira-miracoli"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/mira-miracoli?s=36" alt="Mira Kuntz avatar" width="36" class="avatar" />
    Mira Kuntz</a><a href="/training-material/hall-of-fame/edmontosaurus/" class="contributor-badge contributor-edmontosaurus"><img src="https://avatars.githubusercontent.com/edmontosaurus?s=36" alt="Edwin den Haas avatar" width="36" class="avatar" />
    Edwin den Haas</a></td>
	</tr>
	

	

	

</table>


	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png" width="88" height="31"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>How does the Galaxy Ansible module work internally?</p>
</li>
        
        <li><p>How can I install a Galaxy server with Ansible</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Have an understanding of how Galaxy’s Ansible roles are structured and interact with one another</p>
</li>
        
        <li><p>Be able to use an Ansible playbook to install different flavors of Galaxy for different purposes</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        

        
    
        
        
        
            
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                            <li>
                              <a href="/training-material/topics/admin/tutorials/ansible/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> Slides: Ansible</a>
                            </li>
                        
                        
                            
                                <li>
                                  <a href="/training-material/topics/admin/tutorials/ansible/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> Hands-on: Ansible</a>
                                </li>
                            
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
    

    
      <li>
        A VM with at least 2 vCPUs and 4 GB RAM, preferably running Ubuntu 20.04 - 22.04.
      </li>
    


        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 2 hours 30 minutes</div>
        

        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            
                <li class="btn btn-default"><a href="/training-material/topics/admin/tutorials/ansible-galaxy/slides.html" title="Slides for this tutorial">
                    <i class="fab fa-slideshare" aria-hidden="true"></i> Slides
                </a></li>
            

            

            

            

            

            

            

            
            
            
                <li class="btn btn-default supporting_material">    <a class="topic-icon" href="/training-material/topics/admin/tutorials/ansible-galaxy/faqs/" title="Frequently Asked Questions">
        <i class="far fa-question-circle" aria-hidden="true"></i> FAQs
    </a>
</li>
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            











<li class="btn btn-default supporting_material">


  <!-- dropdown with all recordings -->
  <a href="/training-material/topics/admin/tutorials/ansible-galaxy/recordings/" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Latest recordings of this material in the GTN Video Library">
        <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span>&nbsp;Recordings
  </a>


  <ul class="dropdown-menu">
    

    
      
      
      
    <li><a class="dropdown-item" href="/training-material/topics/admin/tutorials/ansible-galaxy/recordings/index.html#tutorial-recording-1-march-2022" title="View the recording for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Tutorial (March 2022) - 2h50m</a>
    </li>
      
    
      
      
      
    <li><a class="dropdown-item" href="/training-material/topics/admin/tutorials/ansible-galaxy/recordings/index.html#tutorial-recording-28-june-2021" title="View the recording for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Tutorial (June 2021) - 2h47m</a>
    </li>
      
    
      
      
      
    <li><a class="dropdown-item" href="/training-material/topics/admin/tutorials/ansible-galaxy/recordings/index.html#tutorial-recording-15-february-2021" title="View the recording for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Tutorial (February 2021) - 53m</a>
    </li>
      
    
    <li><a class="dropdown-item" href="/training-material/topics/admin/tutorials/ansible-galaxy/recordings/" title="View all recordings for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> View All</a>
    </li>

  </ul>

  
</li>
  





            
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Published:</strong> Jan 28, 2019 </div>
        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Jun 14, 2024 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            Tutorial Content is licensed under
            
              <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
            The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span> <abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00001">https://gxy.io/GTN:T00001</a> </div>
        

	
	

	
	
	<div><strong><i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">rating</span> Rating:</strong> <a href="#feedback-responses">4.0</a> (1 recent ratings, 35 all time)</div>
	
	<div><strong><i class="fas fa-code-commit" aria-hidden="true"></i><span class="visually-hidden">version</span> Revision:</strong> 99 </div>

    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <p>This tutorial assumes you have some familiarity with <a href="https://www.ansible.com/resources/get-started">Ansible</a> and are comfortable with writing and running playbooks.  If not, please consider following our <a href="/training-material/topics/admin/tutorials/ansible/tutorial.html">Ansible Tutorial</a> first.</p>

<p>Here we’ll see how to install a Galaxy server using an Ansible playbook. The Galaxy Project has decided on Ansible for all of its deployment recipes. For our project, Ansible is even more fitting due to its name:</p>

<blockquote class="quote" cite="https://en.wikipedia.org/wiki/Ansible">
  <p>An ansible is a category of fictional device or technology capable of instantaneous or faster-than-light communication. It can send and receive messages to and from a corresponding device over any distance or obstacle whatsoever with no delay, even between star systems</p>
</blockquote>

<p>We want to give you a comprehensive understanding of how the Galaxy installation occurs, but we want to avoid you having to write a “custom” Galaxy installation playbook which you would eventually throw away, in order to use the official playbooks. Given these goals, we will go through the playbook in depth first, and then move to a hands-on portion later. If you are not interested in the inner workings, you can <a href="#installing-galaxy">skip to that section now</a>.</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

<ol id="markdown-toc">
  <li><a href="#playbook-overview" id="markdown-toc-playbook-overview">Playbook Overview</a>    <ol>
      <li><a href="#configuration" id="markdown-toc-configuration">Configuration</a></li>
      <li><a href="#tasks" id="markdown-toc-tasks">Tasks</a></li>
      <li><a href="#handlers" id="markdown-toc-handlers">Handlers</a></li>
      <li><a href="#defaults" id="markdown-toc-defaults">Defaults</a></li>
      <li><a href="#summary" id="markdown-toc-summary">Summary</a></li>
    </ol>
  </li>
  <li><a href="#installing-galaxy" id="markdown-toc-installing-galaxy">Installing Galaxy</a>    <ol>
      <li><a href="#requirements" id="markdown-toc-requirements">Requirements</a></li>
      <li><a href="#postgresql" id="markdown-toc-postgresql">PostgreSQL</a></li>
      <li><a href="#galaxy" id="markdown-toc-galaxy">Galaxy</a></li>
      <li><a href="#nginx" id="markdown-toc-nginx">NGINX</a></li>
      <li><a href="#log-in-to-galaxy" id="markdown-toc-log-in-to-galaxy">Log in to Galaxy</a></li>
      <li><a href="#job-configuration" id="markdown-toc-job-configuration">Job Configuration</a></li>
      <li><a href="#productionising-galaxy" id="markdown-toc-productionising-galaxy">Productionising Galaxy</a></li>
      <li><a href="#disaster-strikes-optional" id="markdown-toc-disaster-strikes-optional">Disaster Strikes! (Optional)</a></li>
    </ol>
  </li>
  <li><a href="#production--maintenance" id="markdown-toc-production--maintenance">Production &amp; Maintenance</a>    <ol>
      <li><a href="#keeping-galaxy-updated" id="markdown-toc-keeping-galaxy-updated">Keeping Galaxy Updated</a></li>
      <li><a href="#upgrading-galaxy-optional" id="markdown-toc-upgrading-galaxy-optional">Upgrading Galaxy (Optional)</a></li>
      <li><a href="#user-support" id="markdown-toc-user-support">User Support</a></li>
      <li><a href="#running-on-a-cluster" id="markdown-toc-running-on-a-cluster">Running on a cluster</a></li>
      <li><a href="#other-software" id="markdown-toc-other-software">Other software</a></li>
    </ol>
  </li>
  <li><a href="#loving-ansible-convert-your-own-servers" id="markdown-toc-loving-ansible-convert-your-own-servers">Loving Ansible? Convert your own servers!</a></li>
  <li><a href="#final-notes" id="markdown-toc-final-notes">Final Notes</a></li>
</ol>

</blockquote>

<!--SNIPPET-->
<blockquote class="comment">   <div class="box-title comment-title" id="comment-galaxy-admin-training-path"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Galaxy Admin Training Path</div>   <p>The yearly Galaxy Admin Training follows a specific ordering of tutorials. Use this timeline to help keep track of where you are in Galaxy Admin Training.</p>   <ol id="git-gat-timeline">                    <li class="active">         <a href="/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html">             <div>Step 1</div>             <div>ansible-galaxy</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/backup-cleanup/tutorial.html">             <div>Step 2</div>             <div>backup-cleanup</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/customization/tutorial.html">             <div>Step 3</div>             <div>customization</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/tus/tutorial.html">             <div>Step 4</div>             <div>tus</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/cvmfs/tutorial.html">             <div>Step 5</div>             <div>cvmfs</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/apptainer/tutorial.html">             <div>Step 6</div>             <div>apptainer</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/tool-management/tutorial.html">             <div>Step 7</div>             <div>tool-management</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/reference-genomes/tutorial.html">             <div>Step 8</div>             <div>reference-genomes</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/data-library/tutorial.html">             <div>Step 9</div>             <div>data-library</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/dev/tutorials/bioblend-api/tutorial.html">             <div>Step 10</div>             <div>dev/bioblend-api</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/connect-to-compute-cluster/tutorial.html">             <div>Step 11</div>             <div>connect-to-compute-cluster</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/job-destinations/tutorial.html">             <div>Step 12</div>             <div>job-destinations</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/pulsar/tutorial.html">             <div>Step 13</div>             <div>pulsar</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/celery/tutorial.html">             <div>Step 14</div>             <div>celery</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/gxadmin/tutorial.html">             <div>Step 15</div>             <div>gxadmin</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/reports/tutorial.html">             <div>Step 16</div>             <div>reports</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/monitoring/tutorial.html">             <div>Step 17</div>             <div>monitoring</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/tiaas/tutorial.html">             <div>Step 18</div>             <div>tiaas</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/sentry/tutorial.html">             <div>Step 19</div>             <div>sentry</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/ftp/tutorial.html">             <div>Step 20</div>             <div>ftp</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/beacon/tutorial.html">             <div>Step 21</div>             <div>beacon</div>         </a>     </li>           </ol> </blockquote>
<p><!--END_SNIPPET--></p>

<!--SNIPPET-->
<blockquote class="tip">   <div class="box-title tip-title" id="tip-operating-system-compatibility"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-operating-system-compatibility" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Operating system compatibility</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>These Ansible roles and training materials were last tested on Centos 7 and Ubuntu 18.04, but will probably work on other RHEL and Debian variants.</p>   <p>The roles that are used in these training are currently used by <code class="language-plaintext highlighter-rouge">usegalaxy.*</code>, and other, servers in maintaining their infrastructure. (<a href="https://github.com/galaxyproject/infrastructure-playbook/">US</a>, <a href="https://github.com/usegalaxy-eu/infrastructure-playbook">EU</a>, both are running CentOS 7)</p>   <p>If you have an issue running these trainings on your OS flavour, please report <a href="https://github.com/galaxyproject/training-material/issues/new">the issue</a> in the training material and we can see if it is possible to solve.</p> </blockquote>
<p><!--END_SNIPPET--></p>

<h1 id="playbook-overview">Playbook Overview</h1>

<h2 id="configuration">Configuration</h2>

<p>We’ll be using the <a href="https://github.com/galaxyproject/ansible-galaxy">official Galaxy role</a> to install and manage Galaxy. This role is found in <a href="https://galaxy.ansible.com/">Ansible Galaxy</a> (no relation - it is Ansible’s system for sharing reusable Ansible roles) as <a href="https://galaxy.ansible.com/galaxyproject/galaxy">galaxyproject.galaxy</a>.</p>

<p>The official role is extremely configurable, everything that you want to change is exposed as a variable, and then tasks will change behaviour based on that. The <a href="https://github.com/galaxyproject/ansible-galaxy#role-variables">role documentation</a> is the most up-to-date source of documentation for the variables. You should take a minute and read over the variables listed there.</p>

<p>The important variables for this tutorial are:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">galaxy_root</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_commit_id</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_config</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_server_dir</code> (automatically set based on <code class="language-plaintext highlighter-rouge">galaxy_root</code>)</li>
</ul>

<p>These are largely self explanatory: a directory for all of Galaxy’s code and configuration, which commit should be installed, and the Galaxy configuration. We will not explain Galaxy configuration variables in detail as they are covered sufficiently in the <code class="language-plaintext highlighter-rouge">galaxy.yml</code> sample file or the <a href="https://docs.galaxyproject.org/en/master/admin/config.html#configuration-options">online documentation</a>.</p>

<p>The official recommendation is that you should have a variables file such as <code class="language-plaintext highlighter-rouge">group_vars/galaxyservers.yml</code> for storing all of the Galaxy configuration.</p>

<h2 id="tasks">Tasks</h2>

<p>As with every role, the entry point for execution is the <code class="language-plaintext highlighter-rouge">tasks/main.yml</code> file. <a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/tasks/main.yml">In the case of the galaxyproject.galaxy role</a>, this includes a few groups of important tasks:</p>

<ul>
  <li><a href="#cloning-galaxy">Clone (or Download) Galaxy</a></li>
  <li><a href="#managing-configuration">Managing Configuration</a></li>
  <li><a href="#dependencies">Fetching Dependencies</a></li>
  <li><a href="#mutable-setup">Managing Mutable Setup</a></li>
  <li><a href="#managing-the-database">Managing the Database</a></li>
  <li><a href="#building-the-client">Building the Client</a></li>
</ul>

<p>The actions each set of tasks performs are described below.</p>

<h3 id="cloning-galaxy">Cloning Galaxy</h3>

<p>The <a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/tasks/clone.yml">clone</a> task is the one which is primarily interesting to us, it downloads Galaxy, using git, at a specific commit (or more generally, any <a href="https://git-scm.com/book/en/v2/Git-Internals-Git-References">git reference</a>).</p>

<ol>
  <li>Ansible tries to update Galaxy, cloning it if it is missing, or otherwise attempting to update to the correct commit (or latest commit of the given branch).</li>
  <li>Any change is reported.</li>
  <li>The virtualenv is set up:
    <ol>
      <li>An empty virtualenv is created.</li>
      <li>Pip is updated within the virtualenv.</li>
    </ol>
  </li>
  <li>Any <code class="language-plaintext highlighter-rouge">.pyc</code> files are removed, as this can occasionally result in Python loading the cached code, even if the corresponding <code class="language-plaintext highlighter-rouge">.py</code> file is no longer present at the checked-out commit. For safety, all of these are removed.</li>
</ol>

<p>With that Galaxy is cloned to disk and is ready to be configured by the next task.</p>

<h3 id="managing-configuration">Managing Configuration</h3>

<p>The <a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/tasks/static_setup.yml">static configuration setup</a> is relatively straightforward:</p>

<ol>
  <li>The directories for Galaxy configuration data and for the shed tools are created</li>
  <li>Any config files are copied over</li>
  <li>Any templates are copied over</li>
  <li>The <code class="language-plaintext highlighter-rouge">galaxy.yml</code> is deployed</li>
</ol>

<p>The setup for deploying extra Galaxy configuration templates and files is a little bit non-standard by Ansible best practices. Here you are expected to provide your own templates and static config files, and then describe them as a list of files and where they should be deployed to.</p>

<p>Using the <a href="https://github.com/usegalaxy-eu/infrastructure-playbook/blob/02ca578211bfee45044facf36635d28208e5dbb3/group_vars/galaxy.yml#L578">UseGalaxy.eu</a> configuration as an example, we have something like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">galaxy_config_templates</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/builds.txt</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.builds_file_path</span><span class="nv"> </span><span class="s">}}"</span>
  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/data_manager_conf.xml</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.data_manager_config_file</span><span class="nv"> </span><span class="s">}}"</span>
  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/datatypes_conf.xml</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.datatypes_config_file</span><span class="nv"> </span><span class="s">}}"</span>
  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/dependency_resolvers_conf.xml</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.dependency_resolvers_config_file</span><span class="nv"> </span><span class="s">}}"</span>
  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/disposable_email_blocklist.conf</span>
    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.blocklist_file</span><span class="nv"> </span><span class="s">}}"</span>
</code></pre></div></div>

<p>The configuration here is a bit different, it references the <code class="language-plaintext highlighter-rouge">galaxy_config</code>, which is structured like:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">galaxy_config</span><span class="pi">:</span>
  <span class="na">galaxy</span><span class="pi">:</span>
    <span class="na">builds_file_path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config_dir</span><span class="nv">  </span><span class="s">}}/builds.txt"</span>
    <span class="na">datatypes_config_file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config_dir</span><span class="nv">  </span><span class="s">}}/datatypes_conf.xml"</span>
</code></pre></div></div>

<p>So the references in <code class="language-plaintext highlighter-rouge">galaxy_config_templates</code> to <code class="language-plaintext highlighter-rouge">galaxy_config</code> are done to ensure that the setting for e.g. “location of the datatypes config file” is the same between where we have configured Galaxy to looking for it, and where the file has been deployed, without requiring us to make variables changes in numerous places.</p>

<!--SNIPPET-->
<blockquote class="tip">   <div class="box-title tip-title" id="tip-define-once-reference-many-times"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-define-once-reference-many-times" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Define once, reference many times</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Using variables, either by defining them ahead of time, or simply accessing them via existing data structures that have been defined, e.g.:</p>   <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># defining a variable that gets reused is great!</span><br /><span class="na">galaxy_user</span><span class="pi">:</span> <span class="s">galaxy</span><br /><br /><span class="na">galaxy_config</span><span class="pi">:</span><br />  <span class="na">galaxy</span><span class="pi">:</span><br />    <span class="c1"># Re-using the galaxy_config_dir variable saves time and ensures everything</span><br />    <span class="c1"># is in sync!</span><br />    <span class="na">datatypes_config_file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config_dir</span><span class="nv"> </span><span class="s">}}/datatypes_conf.xml"</span><br /><br /><span class="c1"># and now we can re-use "{{ galaxy_config.galaxy.datatypes_config_file }}"</span><br /><span class="c1"># in other places!</span><br /><br /><span class="na">galaxy_config_templates</span><span class="pi">:</span><br />  <span class="pi">-</span> <span class="na">src</span><span class="pi">:</span> <span class="s">templates/galaxy/config/datatypes_conf.xml</span><br />    <span class="na">dest</span><span class="pi">:</span> <span class="s2">"</span><span class="s">{{</span><span class="nv"> </span><span class="s">galaxy_config.galaxy.datatypes_config_file</span><span class="nv"> </span><span class="s">}}"</span><br /></code></pre></div></div>   <p>Practices like those shown above help to avoid problems caused when paths are defined differently in multiple places. The datatypes config file will be copied to the same path as Galaxy is configured to find it in, because that path is only defined in one place. Everything else is a reference to the original definition! If you ever need to update that definition, everything else will be updated accordingly.</p> </blockquote>
<p><!--END_SNIPPET--></p>

<h3 id="dependencies">Dependencies</h3>

<p>Now that Galaxy is available on disk, Ansible is ready to start processing <a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/tasks/dependencies.yml">dependencies</a> of Galaxy.</p>

<ol>
  <li>The virtualenv is updated with data from the <code class="language-plaintext highlighter-rouge">galaxy_requirements_file</code>, by default pointing to the requirements file in the codebase: <code class="language-plaintext highlighter-rouge">{{ galaxy_server_dir }}/lib/galaxy/dependencies/pinned-requirements.txt</code>.</li>
  <li>Any necessary conditional dependencies of Galaxy are <a href="https://github.com/galaxyproject/galaxy/blob/dev/lib/galaxy/dependencies/__init__.py">collected by processing the config file</a></li>
  <li>and then installed to the virtualenv.</li>
</ol>

<h3 id="mutable-setup">Mutable Setup</h3>

<p><a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/tasks/mutable_setup.yml">This task</a> creates a directory and initializes “mutable” (written/managed by Galaxy itself) configuration files. It also deploys any hand-managed mutable config files, but it is unlikely that you want to manage these directly, as Galaxy does a sufficient job. Any changes you make to Galaxy, for example installing some tools, would result in the tools being “forgotten about”, if you re-ran the playbook and overwrote the <code class="language-plaintext highlighter-rouge">shed_tool_conf.xml</code> mutable config file with a hand-managed one.</p>

<h3 id="managing-the-database">Managing the Database</h3>

<p>The <a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/tasks/database.yml">database management tasks</a> are extremely convenient; any time you run the playbook to update Galaxy, this will automatically run the database schema migration as needed.</p>

<ol>
  <li>The role first obtains the current DB version and the maximum possible DB version based on the codebase.</li>
  <li>If needed, the database is created.</li>
  <li>Both versions are reported for the runner of the playbook.</li>
  <li>If the versions are different, then Ansible runs the command to upgrade the database to the latest version.</li>
</ol>

<p>As an administrator who often forgot to run the upgrade, and would only notice it once Galaxy crashed during startup, having this process completely automated is extremely nice.</p>

<h3 id="building-the-client">Building the Client</h3>

<p>Galaxy is a modern web application that includes both a server (written in Python) and a client (written in Javascript). After the server is installed and its database prepared, the next step is to build the client application. This means fetching its dependencies, bundling components, creating minified copies of static content, etc. This process ensures that the smallest possible amount of data is transferred to the user when accessing Galaxy over the web, which is important for the performance of the website.</p>

<p>This process can be lengthy and resource intensive. Future plans for Galaxy include pre-building the client so that the build process is not necessary as long as you run “release” versions of Galaxy.</p>

<p>The client lives in the Galaxy code under the <a href="https://github.com/galaxyproject/galaxy/blob/dev/client/">client/</a> directory, and the build process deploys it to the <a href="https://github.com/galaxyproject/galaxy/tree/dev/static/">static/</a> directory, which we will configure a webserver to serve in this tutorial.</p>

<h2 id="handlers">Handlers</h2>

<p>A number of the tasks that are executed will trigger a restart of Galaxy. The auto-magic implementation of this restart <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_handlers.html">handler</a> should work for most cases, but it is possible to define your own custom handlers if necessary. If this is the case for you, the role provides a way to do this by notifying handlers that <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_handlers.html#naming-handlers">“listen”</a> to certain notifications. See the <a href="https://github.com/galaxyproject/ansible-galaxy/tree/main/handlers">role handlers</a> for details.</p>

<h2 id="defaults">Defaults</h2>

<p>As with other roles, numerous <a href="https://github.com/galaxyproject/ansible-galaxy/blob/master/defaults/main.yml">default values</a> are provided, but these are useful mostly as reference, and not to go through individually.</p>

<h2 id="summary">Summary</h2>

<p>Installation of Galaxy with the playbook follows generally the steps you would expect:</p>

<ul>
  <li>Galaxy is cloned (or updated)</li>
  <li>A virtualenv is created if it doesn’t exist</li>
  <li>Configuration files are installed</li>
  <li>Any missing dependencies are installed</li>
  <li>Any database updates are applied</li>
  <li>The client application is built and deployed</li>
</ul>

<p>It would not be difficult to write a role that does this yourself, but by using
the <code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code> role, you know that you’re getting all of the Galaxy
best practices and knowledge from previous admins codified for you.</p>

<h1 id="installing-galaxy">Installing Galaxy</h1>

<p>With the necessary background in place, you are ready to install Galaxy with Ansible. The playbooks will start simple, and grow over time. We will start with the minimal Galaxy playbook which only requires setting the <code class="language-plaintext highlighter-rouge">galaxy_root</code> and expand from there. First, however, we need a database for Galaxy to connect to, so we will do that now.</p>

<p>To proceed from here it is expected that:</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-requirements-for-running-this-tutorial"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Requirements for Running This Tutorial</div>

  <ol>
    <li>
      <p>You have <a href="https://docs.ansible.com/ansible/2.9/installation_guide/intro_installation.html">Ansible installed</a> on the machine where you will install Galaxy</p>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-running-ansible-on-remote-machine"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Running Ansible on remote machine</div>
        <p>It is possible to have Ansible installed on your laptop/local machine and run it against some remote hosts as well. We will <strong>not</strong> do that in this training.</p>
      </blockquote>
    </li>
    <li>Your <code class="language-plaintext highlighter-rouge">ansible</code> version is <code class="language-plaintext highlighter-rouge">&gt;=2.10</code>, you can check this by running <code class="language-plaintext highlighter-rouge">ansible --version</code></li>
    <li>You have an <a href="../ansible/tutorial.html#inventory-file">inventory file</a> with the VM or host specified where you will deploy Galaxy and Galaxy’s database. We will refer to these group of hosts as “galaxyservers” and “dbservers,” respectively.</li>
    <li>Your VM has a public DNS name: this tutorial sets up SSL certificates from the start and as an integral part of the tutorial.</li>
    <li>
      <p>Your VM has <code class="language-plaintext highlighter-rouge">python3</code> installed.</p>

      <p>If you follow the official Ansible instructions to install Ansible on a blank machine, you will probably end up with py2 installed. You will need to install python3 in addition.</p>
    </li>
    <li>
      <p>In your inventory file, you have written the full DNS hostname that has been provided, and <strong>not</strong> <code class="language-plaintext highlighter-rouge">localhost</code>, as we will be requesting SSL certificates.</p>
    </li>
    <li>
      <p>You have the following ports exposed:</p>

      <ul>
        <li>22 for SSH, this can be a different port or via VPN or similar.</li>
        <li>80 for HTTP, this needs to be available to the world if you want to follow the LetsEncrypt portion of the tutorial.</li>
        <li>443 for HTTPs, this needs to be available to the world if you want to follow the LetsEncrypt portion of the tutorial.</li>
        <li>5671 for AMQP for Pulsar, needed if you plan to setup Pulsar for remote job running.</li>
      </ul>
    </li>
  </ol>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-ubuntu-or-debian-centos-or-rhel"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Ubuntu or Debian, CentOS or RHEL?</div>
  <p>The training tutorial is only tested on Ubuntu, as that is the training platform most often used. The training <em>should</em> work on RHEL/CentOS, and the roles we use are definitely compatible with both. If any of the variable values differ between Ubuntu and CentOS, we try to note it in the tutorial. Any places we don’t note it are bugs.</p>

  <p>There are known issues with CentOS7 and python3, which is used in this tutorial. If you use this setup, you should have python2 and python3 coexisting, and use python2 for Ansible (i.e. do not set <code class="language-plaintext highlighter-rouge">interpreter_python</code> in your <code class="language-plaintext highlighter-rouge">ansible.cfg</code>) and python3 for Galaxy. This setup requires numerous changes that you will need to discover, which are not covered in this tutorial.</p>

  <p>On older versions, both <code class="language-plaintext highlighter-rouge">python-psycopg2</code> and <code class="language-plaintext highlighter-rouge">python3-psycopg2</code> may need to be installed.</p>

  <p>CentOS8 (and RHEL in general) have significantly different package names for some modules, beware!</p>
</blockquote>

<h2 id="requirements">Requirements</h2>

<p>We have codified all of the dependencies you will need into a YAML file that <code class="language-plaintext highlighter-rouge">ansible-galaxy</code> can install.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-installing-roles"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Installing roles</div>

  <ol>
    <li>
      <p>Create a new directory <code class="language-plaintext highlighter-rouge">galaxy</code> in your home folder, and <code class="language-plaintext highlighter-rouge">cd</code> into that directory</p>
    </li>
    <li>
      <p>Create a new file in your working directory called <code class="language-plaintext highlighter-rouge">requirements.yml</code> and include the following contents:</p>

      <div data-commit="Add requirements" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/requirements.yml
</span><span class="p">@@ -0,0 +1,13 @@</span>
<span class="gi">+# Galaxy, Postgres, Nginx
+- src: galaxyproject.galaxy
+  version: 0.10.14
+- src: galaxyproject.nginx
+  version: 0.7.1
+- src: galaxyproject.postgresql
+  version: 1.1.2
+- src: galaxyproject.postgresql_objects
+  version: 1.2.0
+- src: galaxyproject.miniconda
+  version: 0.3.1
+- src: usegalaxy_eu.certbot
+  version: 0.1.11
</span>   
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-how-to-read-a-diff"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-to-read-a-diff" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: How to read a Diff</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>If you haven’t worked with diffs before, this can be something quite new or different.</p>   <p>If we have two files, let’s say a grocery list, in two files. We’ll call them ‘a’ and ‘b’.</p>   <blockquote class="code-2col">   <blockquote class="code-in">     <div class="box-title code-in-title" id="code-in-old"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Old</div>     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat old<br />🍎<br />🍐<br />🍊<br />🍋<br />🍒<br />🥑<br /></code></pre></div>    </div>   </blockquote>   <blockquote class="code-out">     <div class="box-title code-out-title" id="code-out-new"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: New</div>     <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat new<br />🍎<br />🍐<br />🍊<br />🍋<br />🍍<br />🥑<br /></code></pre></div>    </div>   </blockquote> </blockquote>   <p>We can see that they have some different entries. We’ve removed 🍒 because they’re awful, and replaced them with an 🍍</p>   <p>Diff lets us compare these files</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff old new<br />5c5<br />&lt; 🍒<br /><span class="nt">---</span><br /><span class="o">&gt;</span> 🍍<br /></code></pre></div></div>   <p>Here we see that 🍒 is only in a, and 🍍 is only in b. But otherwise the files are identical.</p>   <p>There are a couple different formats to diffs, one is the ‘unified diff’</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff <span class="nt">-U2</span> old new<br /><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br />+++ new	2022-02-16 14:06:36.340962616 +0100<br />@@ <span class="nt">-3</span>,4 +3,4 @@<br /> 🍊<br /> 🍋<br />-🍒<br />+🍍<br /> 🥑<br /></code></pre></div></div>   <p>This is basically what you see in the training materials which gives you a lot of context about the changes:</p>   <ul>   <li><code class="language-plaintext highlighter-rouge">--- old</code> is the ‘old’ file in our view</li>   <li><code class="language-plaintext highlighter-rouge">+++ new</code> is the ‘new’ file</li>   <li>@@ these lines tell us where the change occurs and how many lines are added or removed.</li>   <li>Lines starting with a - are removed from our ‘new’ file</li>   <li>Lines with a + have been added.</li> </ul>   <p>So when you go to apply these diffs to your files in the training:</p>   <ol>   <li>Ignore the header</li>   <li>Remove lines starting with - from your file</li>   <li>Add lines starting with + to your file</li> </ol>   <p>The other lines (🍊/🍋 and 🥑) above just provide “context”, they help you know where a change belongs in a file, but <strong>should not be edited</strong> when you’re making the above change. Given the above diff, you would find a line with a 🍒, and replace it with a 🍍</p>   <h4 id="added--removed-lines">Added &amp; Removed Lines</h4>   <p>Removals are very easy to spot, we just have removed lines</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br />+++ new	2022-02-16 14:10:14.370722802 +0100<br />@@ <span class="nt">-4</span>,3 +4,2 @@<br /> 🍋<br /> 🍒<br />-🥑<br /></code></pre></div></div>   <p>And additions likewise are very easy, just add a new line, between the other lines in your file.</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br />+++ new	2022-02-16 14:11:11.422135393 +0100<br />@@ <span class="nt">-1</span>,3 +1,4 @@<br /> 🍎<br />+🍍<br /> 🍐<br /> 🍊<br /></code></pre></div></div>   <h4 id="completely-new-files">Completely new files</h4>   <p>Completely new files look a bit different, there the “old” file is <code class="language-plaintext highlighter-rouge">/dev/null</code>, the empty file in a Linux machine.</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>diff <span class="nt">-U2</span> /dev/null old<br /><span class="nt">---</span> /dev/null	2022-02-15 11:47:16.100000270 +0100<br />+++ old	2022-02-16 14:06:19.697132568 +0100<br />@@ <span class="nt">-0</span>,0 +1,6 @@<br />+🍎<br />+🍐<br />+🍊<br />+🍋<br />+🍒<br />+🥑<br /></code></pre></div></div>   <p>And removed files are similar, except with the new file being /dev/null</p>   <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span> old	2022-02-16 14:06:19.697132568 +0100<br />+++ /dev/null	2022-02-15 11:47:16.100000270 +0100<br />@@ <span class="nt">-1</span>,6 +0,0 @@<br />-🍎<br />-🍐<br />-🍊<br />-🍋<br />-🍒<br />-🥑<br /></code></pre></div></div> </blockquote>
      <p><!--END_SNIPPET--></p>

      <blockquote class="details">
        <div class="box-title details-title" id="details-what-do-each-of-these-roles-do"><button class="gtn-boxify-button details" type="button" aria-controls="details-what-do-each-of-these-roles-do" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: What do each of these roles do?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>We’ll cover it in more detail as we use each of the roles but briefly:</p>

        <table>
          <thead>
            <tr>
              <th>Role</th>
              <th>Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code></td>
              <td>Installs and configures the Galaxy application</td>
            </tr>
            <tr>
              <td><code class="language-plaintext highlighter-rouge">galaxyproject.nginx</code></td>
              <td>Sets up a webserver</td>
            </tr>
            <tr>
              <td><code class="language-plaintext highlighter-rouge">galaxyproject.postgresql</code></td>
              <td>Installs our database, PostgreSQL</td>
            </tr>
            <tr>
              <td><code class="language-plaintext highlighter-rouge">galaxyproject.postgresql_objects</code></td>
              <td>Creates users and databases within PostgreSQL</td>
            </tr>
            <tr>
              <td><code class="language-plaintext highlighter-rouge">galaxyproject.miniconda</code></td>
              <td>Installs miniconda, which is used by Galaxy</td>
            </tr>
            <tr>
              <td><code class="language-plaintext highlighter-rouge">usegalaxy_eu.certbot</code></td>
              <td>Installs certbot and requests SSL certificates</td>
            </tr>
          </tbody>
        </table>
      </blockquote>

      <blockquote class="details">
        <div class="box-title details-title" id="details-role-version-vs-galaxy-version"><button class="gtn-boxify-button details" type="button" aria-controls="details-role-version-vs-galaxy-version" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Role version vs Galaxy version?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>Q: Is there a correspondence between galaxy role versions and galaxy versions?
A: They are correlated (because generally new Galaxy versions could introduce e.g. new configuration options that the galaxy role would then need to adopt), but the Galaxy role can install older versions of Galaxy.</p>
      </blockquote>
    </li>
    <li>
      <p>In the same directory, run:</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-galaxy <span class="nb">install</span> <span class="nt">-p</span> roles <span class="nt">-r</span> requirements.yml
</code></pre></div>        </div>
      </blockquote>

      <p>This will install all of the required modules for this training into the <code class="language-plaintext highlighter-rouge">roles/</code> folder. We choose to install to a folder to give you easy access to look through the different roles when you have questions on their behaviour.</p>
    </li>
    <li>
      <p>Inspect the contents of the newly created <code class="language-plaintext highlighter-rouge">roles/</code> directory in your working directory.</p>
    </li>
    <li>
      <p>It’s good practice to put your playbooks and configuration files under version control (usually in a git repository), but there is no need to keep track of the content of the <code class="language-plaintext highlighter-rouge">roles/</code> directory, as all of that data can be perfectly recreated from the <code class="language-plaintext highlighter-rouge">requirements.yml</code> file.</p>

      <p>If you plan to put this git repository online (e.g. on GitHub), any file containing clear-text passwords should <em>never</em> ever be committed to the repository, even if the repository is private. For this reason, we should tell git, ahead of time, to ignore one such file, <code class="language-plaintext highlighter-rouge">.vault-password.txt</code> , which will use later on in this lesson.</p>

      <p>To configure git to ignore certain files and directories, they need to be listed in a file called <code class="language-plaintext highlighter-rouge">.gitignore</code> , which should be instead tracked as part of your git repository. You can now create the <code class="language-plaintext highlighter-rouge">.gitignore</code> file with the following content:</p>

      <div data-commit="Add .gitignore" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/.gitignore
</span><span class="p">@@ -0,0 +1,2 @@</span>
<span class="gi">+roles/
+.vault-password.txt
</span>   
</code></pre></div>      </div>

      <p>When you run <code class="language-plaintext highlighter-rouge">git status</code> you’ll notice that the <code class="language-plaintext highlighter-rouge">roles/</code> folder is not listed among the other “Untracked files”.</p>

      <p>Now you can do <code class="language-plaintext highlighter-rouge">git add .</code> to add all of the files in the current directory to your repository, and not worry about committing these files and directories by mistake!</p>
    </li>
  </ol>
</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-configuration-files"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Configuration files</div>

  <ol>
    <li>
      <p>Create a <code class="language-plaintext highlighter-rouge">ansible.cfg</code> file (next to your playbook) to <a href="https://docs.ansible.com/ansible/2.9/reference_appendices/config.html">configure settings</a> like the inventory file (and save ourselves some typing!), or the Python interpreter to use:</p>

      <div data-commit="Add ansible.cfg" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/ansible.cfg
</span><span class="p">@@ -0,0 +1,11 @@</span>
<span class="gi">+[defaults]
+interpreter_python = /usr/bin/python3
+inventory = hosts
+# Use the YAML callback plugin.
+stdout_callback = yaml
+# Use the stdout_callback when running ad-hoc commands.
+bin_ansible_callbacks = True
+
+# Show diffs of changes
+[diff]
+always = True
</span>   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-centos7"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-centos7" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: CentOS7</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>As mentioned in the “Ubuntu or Debian, CentOS or RHEL?” comment above, if you are using CentOS7 do not set <code class="language-plaintext highlighter-rouge">interpreter_python</code> in <code class="language-plaintext highlighter-rouge">ansible.cfg</code> .</p>
      </blockquote>

      <p>There is an additional useful option that you might want to add to your <code class="language-plaintext highlighter-rouge">ansible.cfg</code> file if you are connecting over SSH:</p>

      <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[ssh_connection]</span>
<span class="py">pipelining</span> <span class="p">=</span> <span class="s">true</span>
</code></pre></div>      </div>

      <p>Pipelining will make <a href="https://docs.ansible.com/ansible/2.9/reference_appendices/config.html#ansible-pipelining">Ansible run faster</a> by significantly reducing the number of new SSH connections that must be opened.</p>
    </li>
    <li>
      <p>Create the <code class="language-plaintext highlighter-rouge">hosts</code> inventory file if you have not done so yet, defining a <code class="language-plaintext highlighter-rouge">[galaxyservers]</code> group with the address of the host where you want to install Galaxy. If you are running Ansible on the same machine where Galaxy will be installed to, you should set the <code class="language-plaintext highlighter-rouge">ansible_connection=local</code> variable. Lastly, you should explicitly set the <code class="language-plaintext highlighter-rouge">ansible_user</code> variable to the username to use when connecting to the server. Ansible has changed its behaviour over time regarding whether or not <code class="language-plaintext highlighter-rouge">ansible_user</code> is defined, and it is most effective to define it explicitly even when it can sometimes be inferred.</p>

      <p>You should also define a <code class="language-plaintext highlighter-rouge">[dbservers]</code> group for the hosts that will run Galaxy’s database. In many cases (and in the case of the Galaxy Admin Training), these will be the same host, but the tutorial is designed to support either scenario, and helps to strengthen understanding of the purpose of host groupings in Ansible for more advanced real-world deployments. Here however we suggest using <code class="language-plaintext highlighter-rouge">[dbservers:children]</code> and adding <code class="language-plaintext highlighter-rouge">galaxyservers</code> as the child of that.</p>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-1"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>hosts
</code></pre></div>          </div>
        </blockquote>

        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-bash"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

          <p>Your hostname is probably different:</p>

          <div data-commit="Add hosts" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/hosts
</span><span class="p">@@ -0,0 +1,4 @@</span>
<span class="gi">+[galaxyservers]
+gat-0.eu.galaxy.training ansible_connection=local ansible_user=ubuntu
+[dbservers:children]
+galaxyservers
</span><span class="err">
</span></code></pre></div>          </div>
        </blockquote>
      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-separate-database-server"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-separate-database-server" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Separate database server</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>In the hosts file above, we have defined the <code class="language-plaintext highlighter-rouge">galaxyservers</code> group to be a “child” of the <code class="language-plaintext highlighter-rouge">dbservers</code> group. This means that the host defined in <code class="language-plaintext highlighter-rouge">[galaxyservers]</code> is also a member of <code class="language-plaintext highlighter-rouge">[dbservers]</code>. If we instead wanted to define a separate host as the Galaxy database server, we would replace the <code class="language-plaintext highlighter-rouge">[dbservers:children]</code> section with something like:</p>

        <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[dbservers]</span>
<span class="err">galaxy-db.example.org</span>
</code></pre></div>        </div>
      </blockquote>
    </li>
    <li>
      <p>Create the <code class="language-plaintext highlighter-rouge">group_vars</code> directory and create the file <code class="language-plaintext highlighter-rouge">group_vars/all.yml</code>. These variables are applied to <em>all</em> hosts, regardless of group membership. The variables we set will be used to ensure Python 3 is always used on older systems where Python 2 might also still be installed. We will also set a few variables that must be known by both the Galaxy server and the database server: Galaxy’s system/database username, as well as the database name.</p>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-2"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>group_vars/all.yml
</code></pre></div>          </div>
        </blockquote>

        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-bash-1"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

          <div data-commit="Add initial all hosts variables file" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/group_vars/all.yml
</span><span class="p">@@ -0,0 +1,7 @@</span>
<span class="gi">+---
+# Python 3 support
+pip_virtualenv_command: /usr/bin/python3 -m venv  # usegalaxy_eu.certbot, usegalaxy_eu.tiaas2, galaxyproject.galaxy
+
+# Common variables needed by all hosts
+galaxy_user_name: galaxy
+galaxy_db_name: galaxy
</span><span class="err">
</span></code></pre></div>          </div>
        </blockquote>
      </blockquote>
    </li>
  </ol>

</blockquote>

<h2 id="postgresql">PostgreSQL</h2>

<p>Galaxy is capable of talking to multiple databases through SQLAlchemy drivers. SQLite is the development database, but PostgreSQL (/ˈpoʊstɡrɛs ˌkjuː ˈɛl/, POHST-gres kyoo el) is recommended in production. MySQL is a possibility, but does not receive the same testing or bugfixes from the main development team as PostgreSQL, so we will only show installation with PostgreSQL.</p>

<p>PostgreSQL maintains its own user database apart from the system user database. By default, PostgreSQL uses the “peer” authentication method which allows access for system users with matching PostgreSQL usernames (other authentication mechanisms are available, see the <a href="https://www.postgresql.org/docs/current/static/client-authentication.html">PostgreSQL Client Authentication documentation</a>.</p>

<p>For this tutorial, we will use the default “peer” authentication, so we need to create a PostgreSQL user matching the system user under which Galaxy will be running, i.e. <code class="language-plaintext highlighter-rouge">galaxy</code>. This is normally done with the PostgreSQL <code class="language-plaintext highlighter-rouge">createuser</code> command, and it must be run as the <code class="language-plaintext highlighter-rouge">postgres</code> user. In our case, we will use the <code class="language-plaintext highlighter-rouge">galaxyproject.postgresql_objects</code> role to handle this step.</p>
<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-installing-postgresql"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Installing PostgreSQL</div>

  <ol>
    <li>
      <p>Create and edit <code class="language-plaintext highlighter-rouge">group_vars/dbservers.yml</code> and add some variables to configure PostgreSQL:</p>

      <div data-commit="Add initial dbservers group variables file" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/group_vars/dbservers.yml
</span><span class="p">@@ -0,0 +1,7 @@</span>
<span class="gi">+---
+# PostgreSQL
+postgresql_objects_users:
+  - name: "{{ galaxy_user_name }}"
+postgresql_objects_databases:
+  - name: "{{ galaxy_db_name }}"
+    owner: "{{ galaxy_user_name }}"
</span>   
</code></pre></div>      </div>

      <p>Notice that we have used the variables we defined in <code class="language-plaintext highlighter-rouge">group_vars/all.yml</code> for the Galaxy user and database names in the previous section, implementing the principle of “define once, reference many times.”</p>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-using-postgres-via-the-network"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-using-postgres-via-the-network" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Using postgres via the network</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>To use postgres via another machine, or via the network, you can add lines like the following:</p>

        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">postgresql_pg_hba_conf</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s">host all all 127.0.0.1/32 md5</span>
</code></pre></div>        </div>

        <p>Here you should either add multiple lines per IP address that needs access to the Postgres server (with netmask <code class="language-plaintext highlighter-rouge">/32</code>), or a less specific IP range defined also <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks">via netmask.</a></p>

        <p>Additionally you’ll need to change the <code class="language-plaintext highlighter-rouge">postgresql_objects_users</code> statement to include a password (maybe stored in a vault, discussed later!)</p>

        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">postgresql_objects_users</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">galaxy</span>
    <span class="na">password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
</code></pre></div>        </div>
      </blockquote>
    </li>
    <li>
      <p>Create and open <code class="language-plaintext highlighter-rouge">galaxy.yml</code> which will be our playbook. Write the following:</p>

      <ul>
        <li>Create a play that will run on the <code class="language-plaintext highlighter-rouge">dbservers</code> group, as the root user (you will need <code class="language-plaintext highlighter-rouge">become</code>/<code class="language-plaintext highlighter-rouge">become_user</code>)</li>
        <li>Add a pre-task to install the necessary dependency at this stage: <code class="language-plaintext highlighter-rouge">acl</code></li>
        <li>Use the role <code class="language-plaintext highlighter-rouge">galaxyproject.postgresql</code>. This will handle the installation of PostgreSQL.</li>
        <li>Use the role <code class="language-plaintext highlighter-rouge">galaxyproject.postgresql_objects</code>, run as the postgres user. This role allows for managing users and databases within PostgreSQL.</li>
      </ul>

      <div data-commit="Add initial galaxy playbook" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/galaxy.yml
</span><span class="p">@@ -0,0 +1,13 @@</span>
<span class="gi">+---
+- hosts: dbservers
+  become: true
+  become_user: root
+  pre_tasks:
+    - name: Install Dependencies
+      package:
+        name: 'acl'
+  roles:
+    - galaxyproject.postgresql
+    - role: galaxyproject.postgresql_objects
+      become: true
+      become_user: postgres
</span>   
</code></pre></div>      </div>

      <blockquote class="question">
        <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <p>What should we expect to see in our folder?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

          <ul>
            <li>a playbook</li>
            <li>a hosts file</li>
            <li>a requirements file</li>
            <li>some group variables</li>
            <li>all of our roles</li>
          </ul>

          <blockquote class="code-in">
            <div class="box-title code-in-title" id="code-in-bash-3"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
            <p>Let’s investigate our directory.</p>
            <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tree <span class="nt">-L</span> 2
</code></pre></div>            </div>
          </blockquote>

          <blockquote class="code-out code-max-300">
            <div class="box-title code-out-title" id="code-out-bash-2"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

            <p>Your directory should look approximately like this:</p>

            <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">.</span>
<span class="err">├──</span> <span class="err">ansible.cfg</span>
<span class="err">├──</span> <span class="err">galaxy.yml</span>
<span class="err">├──</span> <span class="err">group_vars</span>
<span class="err">│  </span> <span class="err">├──</span> <span class="err">all.yml</span>
<span class="err">│  </span> <span class="err">└──</span> <span class="err">dbservers.yml</span>
<span class="err">├──</span> <span class="err">hosts</span>
<span class="err">├──</span> <span class="err">requirements.yml</span>
<span class="err">└──</span> <span class="err">roles</span>
    <span class="err">├──</span> <span class="err">galaxyproject.galaxy</span>
    <span class="err">├──</span> <span class="err">galaxyproject.miniconda</span>
    <span class="err">├──</span> <span class="err">galaxyproject.nginx</span>
    <span class="err">├──</span> <span class="err">galaxyproject.postgresql</span>
    <span class="err">├──</span> <span class="err">galaxyproject.postgresql_objects</span>
    <span class="err">└──</span> <span class="err">usegalaxy_eu.certbot</span>

<span class="err">8</span> <span class="err">directories,</span> <span class="err">6</span> <span class="err">files</span>
</code></pre></div>            </div>
          </blockquote>

        </blockquote>

      </blockquote>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-what-is-the-difference-between-the-roles-with-role-prefix-and-without"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-what-is-the-difference-between-the-roles-with-role-prefix-and-without" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: What is the difference between the roles with `role:` prefix and without?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>The bare role name is just simplified syntax for the roles, you could equally specifiy <code class="language-plaintext highlighter-rouge">role: &lt;name&gt;</code> every time but it’s only necessary if you want to set additional variables like <code class="language-plaintext highlighter-rouge">become_user</code></p> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-is-yaml-sensitive-to-true-true-false-false"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-is-yaml-sensitive-to-true-true-false-false" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Is YAML sensitive to True/true/False/false</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>By <a href="https://yaml.org/refcard.html">this reference</a>, YAML doesn’t really care:</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ Y, true, Yes, ON   }    : Boolean true<br />{ n, FALSE, No, off  }    : Boolean false<br /></code></pre></div></div> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Run the playbook:</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-4"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="code-out code-max-300">
        <div class="box-title code-out-title" id="code-out-bash-3"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

        <p>Note: we have stripped out the “diff” output for compactness, your output will be more verbose.</p>

        <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">PLAY</span> <span class="nn">[dbservers]</span> <span class="err">***************************************************************</span>

<span class="err">TASK</span> <span class="nn">[Gathering Facts]</span> <span class="err">*********************************************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[Install Dependencies]</span> <span class="err">****************************************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : include_tasks]</span> <span class="err">********************************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.postgresql/tasks/debian.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : APT keyrings directory]</span> <span class="err">***********************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install pgdg package signing key (Debian/pgdg)]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install pgdg repository (Debian/pgdg)]</span> <span class="err">********</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install PostgreSQL (Debian)]</span> <span class="err">******************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Get installed version]</span> <span class="err">************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set version fact]</span> <span class="err">*****************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install psycopg2]</span> <span class="err">*****************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set version fact]</span> <span class="err">*****************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set OS-specific variables]</span> <span class="err">********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set pgdata fact]</span> <span class="err">******************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set conf dir fact]</span> <span class="err">****************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : include_tasks]</span> <span class="err">********************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Create conf.d]</span> <span class="err">********************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Check for conf.d include in postgresql.conf]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set conf.d include in postgresql.conf]</span> <span class="err">********</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Include 25ansible_postgresql.conf in postgresql.conf]</span> <span class="err">***</span>
<span class="nn">[WARNING]</span><span class="err">:</span> <span class="err">Module</span> <span class="err">remote_tmp</span> <span class="err">/root/.ansible/tmp</span> <span class="err">did</span> <span class="err">not</span> <span class="err">exist</span> <span class="err">and</span> <span class="err">was</span> <span class="err">created</span>
<span class="err">with</span> <span class="err">a</span> <span class="err">mode</span> <span class="err">of</span> <span class="err">0700,</span> <span class="err">this</span> <span class="err">may</span> <span class="err">cause</span> <span class="err">issues</span> <span class="err">when</span> <span class="err">running</span> <span class="err">as</span> <span class="err">another</span> <span class="err">user.</span> <span class="err">To</span>
<span class="err">avoid</span> <span class="err">this,</span> <span class="err">create</span> <span class="err">the</span> <span class="err">remote_tmp</span> <span class="err">dir</span> <span class="err">with</span> <span class="err">the</span> <span class="err">correct</span> <span class="err">permissions</span> <span class="err">manually</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set config options]</span> <span class="err">***************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install pg_hba.conf]</span> <span class="err">**************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : include_tasks]</span> <span class="err">********************************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.postgresql/tasks/backup.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Create backup directories]</span> <span class="err">********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/var/lib/postgresql/backups)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/var/lib/postgresql/backups/bin)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Create backup output directory]</span> <span class="err">***************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install backup script templates]</span> <span class="err">**************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">archive_wal.sh)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Install backup script files]</span> <span class="err">******************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">backup.py)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Set WAL archive config options]</span> <span class="err">***************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Schedule backups]</span> <span class="err">*****************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Remove PostgreSQL working WAL backup cron job]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql : Ensure PostgreSQL is running]</span> <span class="err">*****************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Warn if deprecated user priv param is set]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy)</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Revoke extra privileges]</span> <span class="err">**************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Drop databases]</span> <span class="err">***********************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">{'name': 'galaxy', 'owner': 'galaxy'})</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Create and drop users]</span> <span class="err">****************</span>
<span class="nn">[WARNING]</span><span class="err">:</span> <span class="err">Module</span> <span class="err">remote_tmp</span> <span class="err">/var/lib/postgresql/.ansible/tmp</span> <span class="err">did</span> <span class="err">not</span> <span class="err">exist</span> <span class="err">and</span>
<span class="err">was</span> <span class="err">created</span> <span class="err">with</span> <span class="err">a</span> <span class="err">mode</span> <span class="err">of</span> <span class="err">0700,</span> <span class="err">this</span> <span class="err">may</span> <span class="err">cause</span> <span class="err">issues</span> <span class="err">when</span> <span class="err">running</span> <span class="err">as</span> <span class="err">another</span>
<span class="err">user.</span> <span class="err">To</span> <span class="err">avoid</span> <span class="err">this,</span> <span class="err">create</span> <span class="err">the</span> <span class="err">remote_tmp</span> <span class="err">dir</span> <span class="err">with</span> <span class="err">the</span> <span class="err">correct</span> <span class="err">permissions</span>
<span class="err">manually</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Create groups]</span> <span class="err">************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Add or remove users from groups]</span> <span class="err">******</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Drop groups]</span> <span class="err">**************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Create databases]</span> <span class="err">*********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.postgresql_objects : Grant extra privileges]</span> <span class="err">***************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.postgresql : Reload PostgreSQL]</span> <span class="err">*****************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">PLAY</span> <span class="err">RECAP</span> <span class="err">*********************************************************************</span>
<span class="err">gat-0.eu.galaxy.training</span>   <span class="err">:</span> <span class="py">ok</span><span class="p">=</span><span class="s">27   changed=15   unreachable=0    failed=0    skipped=13   rescued=0    ignored=0</span>
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-error-postgresql-version-is-version-compare-9-3-gt-failed"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Error: `postgresql_version is version_compare('9.3', '&gt;=')' failed`</div>
        <p>You might see an error like this, if you’re running with <code class="language-plaintext highlighter-rouge">--check</code> mode. Unfortunately here <code class="language-plaintext highlighter-rouge">--check</code> mode meets real life: not all modules support it because some rely on running command line tools to obtain version numbers, something that cannot be mocked with check mode. You can solve this by running it without <code class="language-plaintext highlighter-rouge">--check</code>.</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fatal: [gat-0.eu.galaxy.training]: FAILED! =&gt; {"msg": "The conditional check 'postgresql_version is version_compare('9.3', '&gt;=')' failed. The error was: Input version value cannot be empty\n\nThe error appears to be in '/home/ubuntu/galaxy/roles/galaxyproject.postgresql/tasks/main.yml': line 42, column 3, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n# etc.). So check for a match first and then add if there's no match.\n- name: Check for conf.d include in postgresql.conf\n ^ here\n"}
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-when-running-ansible"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: When running Ansible</div>
        <p>Always pay close attention to tasks reported as <strong>changed</strong> and ensure that the changes were expected!</p>
      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-why-didn-t-we-use-i-in-our-ansible-command"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-why-didn-t-we-use-i-in-our-ansible-command" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Why didn't we use `-i` in our ansible command?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>In our <code class="language-plaintext highlighter-rouge">ansible.cfg</code> file we specified the inventory was stored in a file called <code class="language-plaintext highlighter-rouge">hosts</code>:</p>

        <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">[defaults]</span>
<span class="py">interpreter_python</span> <span class="p">=</span> <span class="s">/usr/bin/python3</span>
<span class="py">inventory</span> <span class="p">=</span> <span class="s">hosts</span>
<span class="py">retry_files_enabled</span> <span class="p">=</span> <span class="s">false</span>
</code></pre></div>        </div>
      </blockquote>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-error-quot-skipping-no-hosts-matched-quot"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-error-quot-skipping-no-hosts-matched-quot" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Error: &quot;skipping: no hosts matched&quot;</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>There can be multiple reasons this happens, so we’ll step through all of them. We’ll start by assuming you’re running the command</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml<br /></code></pre></div></div>   <p>The following things can cause issues:</p>   <ol>   <li>Within your <code class="language-plaintext highlighter-rouge">galaxy.yml</code>, you’ve referred to a host group that doesn’t exist or is misspelled. Check the <code class="language-plaintext highlighter-rouge">hosts: galaxyservers</code> to ensure it matches the host group defined in the <code class="language-plaintext highlighter-rouge">hosts</code> file.</li>   <li>Vice-versa, the group in your <code class="language-plaintext highlighter-rouge">hosts</code> file should match the hosts selected in the playbook, <code class="language-plaintext highlighter-rouge">galaxy.yml</code>.</li>   <li>If neither of these are the issue, it’s possible Ansible doesn’t know to check the <code class="language-plaintext highlighter-rouge">hosts</code> file for the inventory. Make sure you’ve specified <code class="language-plaintext highlighter-rouge">inventory = hosts</code> in your <code class="language-plaintext highlighter-rouge">ansible.cfg</code>.</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Inspect the changes that have been made on your Galaxy server. Places to look include:</p>

      <ul>
        <li><code class="language-plaintext highlighter-rouge">/etc/postgresql</code></li>
        <li>Databases and users in PostgreSQL.</li>
      </ul>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-5"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <p>List available databases.  You can now login and access the database, but only as the <code class="language-plaintext highlighter-rouge">postgres</code> user. You will need to <code class="language-plaintext highlighter-rouge">sudo -iu postgres</code> first, and then you can run <code class="language-plaintext highlighter-rouge">psql galaxy</code>.</p>
          <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> <span class="nt">-iu</span> postgres psql <span class="nt">-l</span>
</code></pre></div>          </div>
        </blockquote>

        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-bash-4"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

          <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                              <span class="err">List</span> <span class="err">of</span> <span class="err">databases</span>
   <span class="err">Name</span>    <span class="err">|</span>  <span class="err">Owner</span>   <span class="err">|</span> <span class="err">Encoding</span> <span class="err">|</span> <span class="err">Collate</span> <span class="err">|</span>  <span class="err">Ctype</span>  <span class="err">|</span>   <span class="err">Access</span> <span class="err">privileges</span>
<span class="err">-----------+----------+----------+---------+---------+-----------------------</span>
 <span class="err">galaxy</span>    <span class="err">|</span> <span class="err">galaxy</span>   <span class="err">|</span> <span class="err">UTF8</span>     <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span>
 <span class="err">postgres</span>  <span class="err">|</span> <span class="err">postgres</span> <span class="err">|</span> <span class="err">UTF8</span>     <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span>
 <span class="err">template0</span> <span class="err">|</span> <span class="err">postgres</span> <span class="err">|</span> <span class="err">UTF8</span>     <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span> <span class="err">=c/postgres</span>          <span class="err">+</span>
           <span class="err">|</span>          <span class="err">|</span>          <span class="err">|</span>         <span class="err">|</span>         <span class="err">|</span> <span class="py">postgres</span><span class="p">=</span><span class="s">CTc/postgres</span>
 <span class="err">template1</span> <span class="err">|</span> <span class="err">postgres</span> <span class="err">|</span> <span class="err">UTF8</span>     <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span> <span class="err">C.UTF-8</span> <span class="err">|</span> <span class="err">=c/postgres</span>          <span class="err">+</span>
           <span class="err">|</span>          <span class="err">|</span>          <span class="err">|</span>         <span class="err">|</span>         <span class="err">|</span> <span class="py">postgres</span><span class="p">=</span><span class="s">CTc/postgres</span>
<span class="err">(4</span> <span class="err">rows)</span>
</code></pre></div>          </div>
        </blockquote>
      </blockquote>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-6"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <p>Access postgres and list some users</p>
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> <span class="nt">-iu</span> postgres psql
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="code-out">
        <div class="box-title code-out-title" id="code-out-bash-5"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>
        <p>The database will currently be empty (check relations with \d and list of roles with \dg) as Galaxy has not yet connected to it. Once you install Galaxy in the next step, the database will be populated. (Quit database with \q)</p>
        <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">psql</span> <span class="err">(10.12</span> <span class="err">(Ubuntu</span> <span class="err">10.12-0ubuntu0.18.04.1))</span>
<span class="err">Type</span> <span class="err">"help"</span> <span class="err">for</span> <span class="err">help.</span>

<span class="py">postgres</span><span class="p">=</span><span class="c"># \d
</span><span class="s">Did not find any relations.</span>
<span class="py">postgres</span><span class="p">=</span><span class="c"># \dg
</span>                                   <span class="s">List of roles</span>
 <span class="err">Role</span> <span class="err">name</span> <span class="err">|</span>                         <span class="err">Attributes</span>                         <span class="err">|</span> <span class="err">Member</span> <span class="err">of</span>
<span class="err">-----------+------------------------------------------------------------+-----------</span>
 <span class="err">galaxy</span>    <span class="err">|</span>                                                            <span class="err">|</span> <span class="err">{}</span>
 <span class="err">postgres</span>  <span class="err">|</span> <span class="err">Superuser,</span> <span class="err">Create</span> <span class="err">role,</span> <span class="err">Create</span> <span class="err">DB,</span> <span class="err">Replication,</span> <span class="err">Bypass</span> <span class="err">RLS</span> <span class="err">|</span> <span class="err">{}</span>

<span class="py">postgres</span><span class="p">=</span><span class="c"># \q
</span></code></pre></div>        </div>
      </blockquote>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-7"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <p>Inspect the postgres directory</p>
          <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> /etc/postgresql/<span class="k">*</span>/main/
</code></pre></div>          </div>
        </blockquote>

        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-bash-6"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

          <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">conf.d</span>
<span class="err">environment</span>
<span class="err">pg_ctl.conf</span>
<span class="err">pg_hba.conf</span>
<span class="err">pg_hba.conf.3350.2020-07-08@11:51:47~</span>
<span class="err">pg_ident.conf</span>
<span class="err">postgresql.conf</span>
<span class="err">start.conf</span>
</code></pre></div>          </div>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<h2 id="galaxy">Galaxy</h2>

<p>Next we will dive right in to deploying a copy of Galaxy onto our server.</p>

<p>For a normal Galaxy instance there are a few configuration changes you make very early during deployment:</p>

<ul>
  <li>Changing the database connection</li>
  <li>Configuring the admin user list</li>
</ul>

<p>Additionally we’ll go ahead and set up the production-ready <a href="https://docs.galaxyproject.org/en/master/admin/scaling.html#deployment-options">Gunicorn + Webless</a> deployment, which separates Galaxy’s web and job handling into separate processes. This is done by configuring Galaxy’s process manager, <a href="https://gravity.readthedocs.io">Gravity</a>.</p>

<p>Finally, best admin practices are to not run Galaxy as a user with <code class="language-plaintext highlighter-rouge">sudo</code> access, like your login user probably has. Additionally, it is best to install the Galaxy code and configs as a separate user, for security purposes. So we will instruct the <code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code> role to create a new user account specifically to run Galaxy under.</p>

<p>The configuration is quite simple thanks to the many sensible defaults that are provided in the Ansible roles.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-minimal-galaxy-playbook"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Minimal Galaxy Playbook</div>

  <ol>
    <li>
      <p>Open <code class="language-plaintext highlighter-rouge">galaxy.yml</code> with your text editor and do the following:</p>

      <ul>
        <li>Create a new play that will run on the <code class="language-plaintext highlighter-rouge">galaxyservers</code> group, as the root user (you will need <code class="language-plaintext highlighter-rouge">become</code>/<code class="language-plaintext highlighter-rouge">become_user</code>)</li>
        <li>Add a pre-task to install the necessary dependencies for the Galaxy server: <code class="language-plaintext highlighter-rouge">acl</code>, <code class="language-plaintext highlighter-rouge">bzip2</code>, <code class="language-plaintext highlighter-rouge">git</code>, <code class="language-plaintext highlighter-rouge">make</code>, <code class="language-plaintext highlighter-rouge">tar</code>, <code class="language-plaintext highlighter-rouge">python3-venv</code>, and <code class="language-plaintext highlighter-rouge">python3-setuptools</code></li>
        <li>Use the roles <code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code> and <code class="language-plaintext highlighter-rouge">galaxyproject.miniconda</code> (in this order), with <code class="language-plaintext highlighter-rouge">galaxyproject.miniconda</code> run as the <code class="language-plaintext highlighter-rouge">galaxy</code> user.</li>
      </ul>

      <div data-commit="Add miniconda, galaxy to playbook" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/galaxy.yml
</span><span class="gi">+++ b/galaxy.yml
</span><span class="p">@@ -11,3 +11,16 @@</span>
     - role: galaxyproject.postgresql_objects
       become: true
       become_user: postgres
<span class="gi">+
+- hosts: galaxyservers
+  become: true
+  become_user: root
+  pre_tasks:
+    - name: Install Dependencies
+      package:
+        name: ['acl', 'bzip2', 'git', 'make', 'tar', 'python3-venv', 'python3-setuptools']
+  roles:
+    - galaxyproject.galaxy
+    - role: galaxyproject.miniconda
+      become: true
+      become_user: "{{ galaxy_user_name }}"
</span>   
</code></pre></div>      </div>
    </li>
    <li>
      <p>Create and edit <code class="language-plaintext highlighter-rouge">group_vars/galaxyservers.yml</code> and add some variables to configure Galaxy:</p>

      <p>We need to set the following variables at the top level:</p>

      <table>
        <thead>
          <tr>
            <th>Variable</th>
            <th>Value</th>
            <th>Purpose</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_create_user</code></td>
            <td><code class="language-plaintext highlighter-rouge">true</code></td>
            <td>Instruct the role to create a Galaxy user</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_separate_privileges</code></td>
            <td><code class="language-plaintext highlighter-rouge">true</code></td>
            <td>Enable separation mode to install the Galaxy code as <code class="language-plaintext highlighter-rouge">root</code> but run the Galaxy server as <code class="language-plaintext highlighter-rouge">galaxy</code></td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_manage_paths</code></td>
            <td><code class="language-plaintext highlighter-rouge">true</code></td>
            <td>Instruct the role to create the needed directories.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_layout</code></td>
            <td><code class="language-plaintext highlighter-rouge">root-dir</code></td>
            <td>This enables the <code class="language-plaintext highlighter-rouge">galaxy_root</code> Galaxy deployment layout: all of the code, configuration, tools, and mutable-data (like caches, location files, etc.) folders will live by default beneath <code class="language-plaintext highlighter-rouge">galaxy_root</code>. User data is stored under <code class="language-plaintext highlighter-rouge">file_path</code>, a variable we will set later.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_root</code></td>
            <td><code class="language-plaintext highlighter-rouge">/srv/galaxy</code></td>
            <td>This is the root of the Galaxy deployment.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_user</code></td>
            <td><code class="language-plaintext highlighter-rouge">{name: "", shell: /bin/bash}</code></td>
            <td>The user that Galaxy will run as.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_commit_id</code></td>
            <td><code class="language-plaintext highlighter-rouge">release_23.0</code></td>
            <td>The git reference to check out, which in this case is the branch for Galaxy Release 23.0</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">galaxy_force_checkout</code></td>
            <td><code class="language-plaintext highlighter-rouge">true</code></td>
            <td>If we make any modifications to the Galaxy codebase, they will be removed. This way we know we’re getting an unmodified Galaxy and no one has made any unexpected changes to the codebase.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">miniconda_prefix</code></td>
            <td><code class="language-plaintext highlighter-rouge">"{{ galaxy_tool_dependency_dir }}/_conda"</code></td>
            <td>We will manually install conda as well. Normally Galaxy will attempt to auto-install this, but since we will set up a production-ready instance with multiple handlers, there is the chance that they can become deadlocked.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">miniconda_version</code></td>
            <td><code class="language-plaintext highlighter-rouge">23.9</code></td>
            <td>Install a specific miniconda version, the latest one at the time of writing that was tested and working.</td>
          </tr>
          <tr>
            <td><code class="language-plaintext highlighter-rouge">miniconda_channels</code>          `</td>
            <td><code class="language-plaintext highlighter-rouge">['conda-forge', 'defaults']</code></td>
            <td>Use the community-maintained conda-forge channel in addition to the standard defaults channel of Conda.</td>
          </tr>
        </tbody>
      </table>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-different-galaxy-releases"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-different-galaxy-releases" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Different Galaxy Releases!</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>In the time between this tutorial was last updated (), and when you are now reading it, one or more new releases of Galaxy may have occured.</p>

        <p>If you wish to use a different version of Galaxy than the one listed, you can do so, but there is no guarantee this tutorial will work without modifications.</p>

        <p>Please ensure you consult the <a href="https://docs.galaxyproject.org/en/master/releases/index.html">releases documentation</a></p>
      </blockquote>

      <div data-commit="Configure miniconda and galaxy" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -0,0 +1,12 @@</span>
<span class="gi">+# Galaxy
+galaxy_create_user: true # False by default, as e.g. you might have a 'galaxy' user provided by LDAP or AD.
+galaxy_separate_privileges: true # Best practices for security, configuration is owned by 'root' (or a different user) than the processes
+galaxy_manage_paths: true # False by default as your administrator might e.g. have root_squash enabled on NFS. Here we can create the directories so it's fine.
+galaxy_layout: root-dir
+galaxy_root: /srv/galaxy
+galaxy_user: {name: "{{ galaxy_user_name }}", shell: /bin/bash}
+galaxy_commit_id: release_23.0
+galaxy_force_checkout: true
+miniconda_prefix: "{{ galaxy_tool_dependency_dir }}/_conda"
+miniconda_version: 23.9
+miniconda_channels: ['conda-forge', 'defaults']
</span>   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-following-this-training-outside-of-a-gat-course"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-following-this-training-outside-of-a-gat-course" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Following this training outside of a GAT course?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>Consider updating the Galaxy Commit ID to the latest version of Galaxy available, this will probably give better results (given that dependencies are always updating) than using a potentially outdated version.</p>
      </blockquote>
    </li>
    <li>
      <p>Again edit the galaxyservers group variables file and add a variable for <code class="language-plaintext highlighter-rouge">galaxy_config</code>. It will be a hash with one key, <code class="language-plaintext highlighter-rouge">galaxy</code> which will also be a hash. Inside here you can place all of your Galaxy configuration.</p>

      <p>So the structure looks like:</p>
      <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">galaxy_config</span><span class="pi">:</span>
  <span class="na">galaxy</span><span class="pi">:</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">value</span>
</code></pre></div>      </div>

      <p>Now you should set:</p>
      <ol>
        <li><code class="language-plaintext highlighter-rouge">admin_users</code> to the email address you will use with this Galaxy.</li>
        <li><code class="language-plaintext highlighter-rouge">database_connection</code> to point to the database you setup earlier (<code class="language-plaintext highlighter-rouge">postgresql:///galaxy?host=/var/run/postgresql</code>).</li>
        <li><code class="language-plaintext highlighter-rouge">file_path</code> to a place to store data, <code class="language-plaintext highlighter-rouge">/data</code> is fine for this lesson which sets up a single-node Galaxy. If you have separate compute machines, this will normally need to be storage shared between the Galaxy node and compute nodes.</li>
        <li><code class="language-plaintext highlighter-rouge">tool_data_path</code> to <code class="language-plaintext highlighter-rouge">{{ galaxy_mutable_data_dir }}/tool-data</code>, so that when tools are installed, due to privilege separation, this will happen in a directory Galaxy can actually write into.</li>
        <li><code class="language-plaintext highlighter-rouge">object_store_store_by</code> to <code class="language-plaintext highlighter-rouge">uuid</code>, this is a better way of storing files that will ensure better filesystem balancing than the older system.</li>
        <li><code class="language-plaintext highlighter-rouge">id_secret</code> to <code class="language-plaintext highlighter-rouge">{{ vault_id_secret }}</code>, we’ll define this variable next but it will be used to encode the IDs used in Galaxy URLs and for securing session cookies.</li>
      </ol>

      <div data-commit="Configure galaxy config" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -10,3 +10,17 @@</span> galaxy_force_checkout: true
 miniconda_prefix: "{{ galaxy_tool_dependency_dir }}/_conda"
 miniconda_version: 23.9
 miniconda_channels: ['conda-forge', 'defaults']
<span class="gi">+
+galaxy_config:
+  galaxy:
+    # Main Configuration
+    admin_users:
+    - admin@example.org
+    database_connection: "postgresql:///{{ galaxy_db_name }}?host=/var/run/postgresql"
+    file_path: /data/datasets
+    job_working_directory: /data/jobs
+    object_store_store_by: uuid
+    id_secret: "{{ vault_id_secret }}"
+
+galaxy_extra_dirs:
+  - /data
</span>   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-data-storage"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-data-storage" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Data storage</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>Galaxy datasets cannot be separated by user or other attribute currently, but you can spread data unintelligently across 1 or more storage pools.</p>
      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-postgresql-connection-string"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-postgresql-connection-string" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: PostgreSQL connection string</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>If you want to run your database on a different machine, you will need to change the connection string. In your hosts file, place the hostname of the machine you’re installing on. <code class="language-plaintext highlighter-rouge">ansible_connection</code> can be left off entirely and it will connect over ssh. You may need to set <code class="language-plaintext highlighter-rouge">ansible_user</code> to the username of the admin user (who can run sudo).</p>

        <p>Here are some examples of connection strings:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite:///./database/universe.sqlite?isolation_level=IMMEDIATE
postgresql://&lt;name&gt;:&lt;password&gt;@localhost:5432/galaxy
postgresql:///galaxy?host=/var/run/postgresql
</code></pre></div>        </div>

      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-using-postgres-via-the-network-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-using-postgres-via-the-network-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Using postgres via the network</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>Here you’ll need to re-use the connection details you specified during <code class="language-plaintext highlighter-rouge">postgresql_objects_users</code>. You can reference it like the following, for example. <code class="language-plaintext highlighter-rouge">localhost</code> may need to change if you’re hosting the database on another host.</p>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+    database_connection: "postgres://:@localhost:5432/"
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-ansible-variable-templating"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Ansible Variable Templating</div>
        <p>In this step we use some templated variables. These are seen in our group variables, among other places, and look like <code class="language-plaintext highlighter-rouge">miniconda_prefix: "{{ galaxy_tool_dependency_dir  }}/_conda"</code>.</p>

        <p>When Ansible runs:</p>

        <ol>
          <li>It collects variables defined in group variables and other places</li>
          <li>The first task for each machine is the <a href="https://docs.ansible.com/ansible/2.9/modules/setup_module.html"><code class="language-plaintext highlighter-rouge">setup</code> module</a> which gathers facts about the host, which are added to the available variables</li>
          <li>As roles are executed:
            <ol>
              <li>Their defaults are added to the set of variables (the group variables having precedence over these variables)</li>
              <li>They can also dynamically define more variables which may not be set until that role is run</li>
            </ol>
          </li>
          <li>Before use (in templates, commands, etc.), variables are resolved to their final value
So it is not always easy to tell what variables will be set, or what their finaly value will be, without running the playbook. It is possible, but non trivial.</li>
        </ol>

      </blockquote>
    </li>
    <li>
      <p>In order to enable the Gunicorn + Webless strategy, we need to edit the Gravity configuration, which is (by default) configured in its own section of the Galaxy configuration. This has a default value, but we will have to override it. Add the following configuration as a child of the <code class="language-plaintext highlighter-rouge">galaxy_config</code> variable:</p>

      <div data-commit="Configure gravity" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -21,6 +21,32 @@</span> galaxy_config:
     job_working_directory: /data/jobs
     object_store_store_by: uuid
     id_secret: "{{ vault_id_secret }}"
<span class="gi">+  gravity:
+    process_manager: systemd
+    galaxy_root: "{{ galaxy_root }}/server"
+    galaxy_user: "{{ galaxy_user_name }}"
+    virtualenv: "{{ galaxy_venv_dir }}"
+    gunicorn:
+      # listening options
+      bind: "unix:{{ galaxy_mutable_config_dir }}/gunicorn.sock"
+      # performance options
+      workers: 2
+      # Other options that will be passed to gunicorn
+      # This permits setting of 'secure' headers like REMOTE_USER (and friends)
+      # https://docs.gunicorn.org/en/stable/settings.html#forwarded-allow-ips
+      extra_args: '--forwarded-allow-ips="*"'
+      # This lets Gunicorn start Galaxy completely before forking which is faster.
+      # https://docs.gunicorn.org/en/stable/settings.html#preload-app
+      preload: true
+    celery:
+      concurrency: 2
+      loglevel: DEBUG
+    handlers:
+      handler:
+        processes: 2
+        pools:
+          - job-handlers
+          - workflow-schedulers
</span>    
 galaxy_extra_dirs:
   - /data
   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-options-explanations"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-options-explanations" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Options explanations.</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <ol>
          <li><code class="language-plaintext highlighter-rouge">workers</code>: Controls the number of Galaxy application processes Gunicorn will spawn. Increased web performance can be attained by increasing this value. If Gunicorn is the only application on the server, a good starting value is the number of CPUs * 2 + 1. 4-12 workers should be able to handle hundreds if not thousands of requests per second.</li>
          <li><code class="language-plaintext highlighter-rouge">extra_args</code>: You can specify additional arguments to pass to gunicorn here.</li>
          <li><code class="language-plaintext highlighter-rouge">handlers</code>: Two dedicated “webless” job handler processes will be started. These processes also handle workflow invocations.</li>
        </ol>
      </blockquote>
    </li>
    <li>
      <p>Let’s set up our vault to store the secrets for these tutorials.</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-8"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rand <span class="nt">-base64</span> 24 <span class="o">&gt;</span> .vault-password.txt
</code></pre></div>        </div>
      </blockquote>
    </li>
    <li>
      <p>Tell Ansible where to find the decryption key. Edit your file <code class="language-plaintext highlighter-rouge">ansible.cfg</code> and add the <code class="language-plaintext highlighter-rouge">vault_password_file</code> variable to the <code class="language-plaintext highlighter-rouge">[defaults]</code> section.</p>

      <div data-commit="Setup the vault file" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/ansible.cfg
</span><span class="gi">+++ b/ansible.cfg
</span><span class="p">@@ -5,6 +5,7 @@</span> inventory = hosts
 stdout_callback = yaml
 # Use the stdout_callback when running ad-hoc commands.
 bin_ansible_callbacks = True
<span class="gi">+vault_password_file = .vault-password.txt
</span>    
 # Show diffs of changes
 [diff]
   
</code></pre></div>      </div>
    </li>
    <li>
      <p>Create the vault:</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-9"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-vault create group_vars/secret.yml
</code></pre></div>        </div>
      </blockquote>

      <p>This will open the editor. Within that file, define your <code class="language-plaintext highlighter-rouge">vault_id_secret</code> to be a long random value.</p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault_id_secret: secret # CHANGE ME NOW!!!
</code></pre></div>      </div>
      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-how-to-get-a-good-random-value"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-how-to-get-a-good-random-value" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: How to get a good random value?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>You can use the same command we ran before: <code class="language-plaintext highlighter-rouge">openssl rand -base64 24</code> to get a good, secure <code class="language-plaintext highlighter-rouge">id_secret</code> for your Galaxy</p>
      </blockquote>

      <p>Your vault should probably look <em>something</em> like this, it’s safe to commit to GitHub (or another public Distributed Version Control System (DVCS)) now that you’ve got the secrets safely encrypted.</p>

      <div data-commit="Add id_secret to the vault" data-comment="The password is password" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/group_vars/secret.yml
</span><span class="p">@@ -0,0 +1,7 @@</span>
<span class="gi">+$ANSIBLE_VAULT;1.1;AES256
+32653961383866636531396135663630386630346237333333653633313436663439643535323964
+6363626330336430363332643638646262316338313937320a666566306539373462386266383166
+30326165393863633463353234613561393939326164376432633732316264636464313061383161
+3532373937656138320a616361343664353264613332616236623231326137316635323465623562
+66656539346130353639623736633034653932373438663330646436656336666637313933666264
+3636313438626533633831323239373461373538646635613637
</span>   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-using-git"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-using-git" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Using `git`?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>If you’re using git, and storing all of these steps in your git history,
you’ll find that working with Vault secrets can be rather annoying as
the opaque blobs are impossible to read. There’s a way to make this
<em>much</em> easier though:</p>

        <p>Create a file <code class="language-plaintext highlighter-rouge">.gitattributes</code> with the following content:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>group_vars/secret.yml diff=ansible-vault merge=binary
</code></pre></div>        </div>

        <p>You can add this file to your repository with <code class="language-plaintext highlighter-rouge">git add .gitattributes</code>
to ensure colleagues get a copy of the file too. Just <strong>be sure</strong>
<code class="language-plaintext highlighter-rouge">.vault-password.txt</code> is listed in your <code class="language-plaintext highlighter-rouge">.gitignore</code> file!</p>

        <p>You will also need to run this command to define how the <code class="language-plaintext highlighter-rouge">ansible-vault</code> differ should work:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git config --global diff.ansible-vault.textconv "ansible-vault view"
</code></pre></div>        </div>

        <p>If you have more vault secrets, you can adjust this line (or add more,
wildcards are supported) to list all of your secret files. This tells
<code class="language-plaintext highlighter-rouge">git</code> to use <code class="language-plaintext highlighter-rouge">ansible-vault</code> to diff the two files, as you can see in
the following real (redacted) snippet from a vault stored in a public
github project.</p>

        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>git log <span class="nt">-p</span> group_vars/all/secret.yml
<span class="go">commit a137d7d6aa4ed374c29545ac4728837815c460aa
</span><span class="gp">Author: Helena Rasche &lt;hxr@hx42.org&gt;</span><span class="w">
</span><span class="go">Date:   Thu Dec 2 12:52:55 2021 +0100

    fix automation password

diff --git a/group_vars/all/secret.yml b/group_vars/all/secret.yml
index 3fe4444..11831ae 100644
--- a/group_vars/all/secret.yml
+++ b/group_vars/all/secret.yml
@@ -1,6 +1,6 @@
 ---
 id_secret: "..."
-jenkins_password: "old-secret-value"
+jenkins_password: "new-secret-value"
 grafana_admin_pass:    "..."
 secret_tiaas_admin_pw: "..."

</span></code></pre></div>        </div>
      </blockquote>
    </li>
    <li>
      <p>Load the secrets in the playbook</p>

      <div data-commit="Load the vault in the playbook" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/galaxy.yml
</span><span class="gi">+++ b/galaxy.yml
</span><span class="p">@@ -15,6 +15,8 @@</span>
 - hosts: galaxyservers
   become: true
   become_user: root
<span class="gi">+  vars_files:
+    - group_vars/secret.yml
</span>   pre_tasks:
     - name: Install Dependencies
       package:
   
</code></pre></div>      </div>
    </li>
    <li>
      <p>Run the playbook.</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-10"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="code-out code-max-300">
        <div class="box-title code-out-title" id="code-out-bash-7"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

        <p>Note: we have only included the <code class="language-plaintext highlighter-rouge">galaxyservers</code> play output and have stripped out the “diff” output for compactness, your output will be more verbose.</p>

        <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">PLAY</span> <span class="nn">[galaxyservers]</span> <span class="err">***********************************************************</span>

<span class="err">TASK</span> <span class="nn">[Gathering Facts]</span> <span class="err">*********************************************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[Install Dependencies]</span> <span class="err">****************************************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure that mutually exclusive options are not set]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="py">changed</span><span class="p">=</span><span class="s">false</span>
  <span class="err">msg:</span> <span class="err">All</span> <span class="err">assertions</span> <span class="err">passed</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set privilege separation default variables]</span> <span class="err">*******</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include layout vars]</span> <span class="err">******************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set any unset variables from layout defaults]</span> <span class="err">*****</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_venv_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_server_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_config_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_mutable_data_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_mutable_config_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_shed_tools_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_cache_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_local_tools_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy_tool_data_path)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Check that any explicitly set Galaxy config options match the values of explicitly set variables]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">tool_dependency_dir)</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">file_path)</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">job_working_directory)</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">shed_tool_config_file)</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set any unset variables corresponding to Galaxy config options from galaxy_config or layout defaults]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">tool_dependency_dir)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">file_path)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">job_working_directory)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include user creation tasks]</span> <span class="err">**********************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/user.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy group]</span> <span class="err">******************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy user]</span> <span class="err">*******************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy privilege separation user]</span> <span class="err">**********</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Get group IDs for Galaxy users]</span> <span class="err">*******************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">root)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Get group names for Galaxy users]</span> <span class="err">*****************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">galaxy)</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">root)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set Galaxy user facts]</span> <span class="err">****************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Determine whether to restrict to group permissions]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include path management tasks]</span> <span class="err">********************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/paths.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create galaxy_root]</span> <span class="err">*******************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create additional privilege separated directories]</span> <span class="err">***</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/venv)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/server)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/config)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/local_tools)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create additional directories]</span> <span class="err">********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var/config)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var/cache)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var/shed_tools)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var/dependencies)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/data)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/jobs)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var/tool_data)</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">/srv/galaxy/var/log)</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include clone tasks]</span> <span class="err">******************************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/clone.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Update Galaxy to specified ref]</span> <span class="err">*******************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Report Galaxy version change]</span> <span class="err">*********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span>
  <span class="err">msg:</span> <span class="err">Galaxy</span> <span class="err">version</span> <span class="err">changed</span> <span class="err">from</span> <span class="err">''</span> <span class="err">to</span> <span class="err">'b338e10899e48a91eab0efca071a206620b13d9d'</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy virtualenv]</span> <span class="err">*************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure pip is the desired release]</span> <span class="err">****************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Remove orphaned .pyc files and compile bytecode]</span> <span class="err">***</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include download tasks]</span> <span class="err">***************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include manage existing galaxy tasks]</span> <span class="err">*************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include static config setup tasks]</span> <span class="err">****************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/static_setup.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure Galaxy version is set]</span> <span class="err">*********************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/_inc_galaxy_version.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Collect Galaxy version file]</span> <span class="err">**********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Determine Galaxy version]</span> <span class="err">*************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install additional Galaxy config files (static)]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install additional Galaxy config files (template)]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install local tools]</span> <span class="err">******************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install local_tool_conf.xml]</span> <span class="err">**********************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Append local_tool_conf.xml to tool_config_file Galaxy config option]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Append shed_tool_conf.xml to tool_config_file Galaxy config option]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure dynamic job rules paths exists]</span> <span class="err">************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install dynamic job rules (static)]</span> <span class="err">***************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install dynamic job rules (template)]</span> <span class="err">*************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure dynamic rule __init__.py's exist]</span> <span class="err">**********</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy job metrics configuration file]</span> <span class="err">*****</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy dependency resolvers configuration file]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy container resolvers configuration file]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy configuration file]</span> <span class="err">*****************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include dependency setup tasks]</span> <span class="err">*******************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/dependencies.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy virtualenv]</span> <span class="err">*************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure pip is the desired release]</span> <span class="err">****************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install Galaxy base dependencies]</span> <span class="err">*****************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Collect Galaxy conditional dependency requirement strings]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install Galaxy conditional dependencies]</span> <span class="err">**********</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install additional packages into galaxy's virtual environment]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include mutable config setup tasks]</span> <span class="err">***************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/mutable_setup.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure Galaxy version is set]</span> <span class="err">*********************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Instantiate mutable configuration files]</span> <span class="err">**********</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">{'src': 'shed_data_manager_conf.xml', 'dest': '/srv/galaxy/var/config/shed_data_manager_conf.xml'})</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">{'src': 'shed_tool_data_table_conf.xml', 'dest': '/srv/galaxy/var/config/shed_tool_data_table_conf.xml'})</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Instantiate mutable configuration templates]</span> <span class="err">******</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">{'src': 'shed_tool_conf.xml.j2', 'dest': '/srv/galaxy/var/config/migrated_tools_conf.xml'})</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span> <span class="err">(</span><span class="py">item</span><span class="p">=</span><span class="s">{'src': 'shed_tool_conf.xml.j2', 'dest': '/srv/galaxy/var/config/shed_tool_conf.xml'})</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include database management tasks]</span> <span class="err">****************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/database.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Get current Galaxy DB version]</span> <span class="err">********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Get maximum Galaxy DB version]</span> <span class="err">********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Report current and max Galaxy database]</span> <span class="err">***********</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Upgrade Galaxy DB]</span> <span class="err">********************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include client build tasks]</span> <span class="err">***********************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/client.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure client_build_hash.txt exists]</span> <span class="err">**************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Get current client commit id]</span> <span class="err">*********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Check if Galaxy was checked out from git]</span> <span class="err">*********</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Get current Galaxy commit id]</span> <span class="err">*********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set client build version fact]</span> <span class="err">********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set client build version fact]</span> <span class="err">********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Report client version mismatch]</span> <span class="err">*******************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span>
  <span class="err">msg:</span> <span class="err">'Galaxy</span> <span class="err">client</span> <span class="err">is</span> <span class="err">out</span> <span class="err">of</span> <span class="err">date:</span> <span class="err">new-unbuilt</span> <span class="err">!=</span> <span class="err">b338e10899e48a91eab0efca071a206620b13d9d'</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure galaxy_node_version is set]</span> <span class="err">****************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/_inc_node_version.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Collect Galaxy Node.js version file]</span> <span class="err">**************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set Galaxy Node.js version fact]</span> <span class="err">******************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Report Node.js version file version]</span> <span class="err">**************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span>
  <span class="err">galaxy_node_version:</span> <span class="err">18.12.1</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Override Galaxy Node.js version]</span> <span class="err">******************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Check whether nodeenv is available]</span> <span class="err">***************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Create Galaxy virtualenv]</span> <span class="err">*************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure pip is the desired release]</span> <span class="err">****************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install nodeenv if it doesn't exist]</span> <span class="err">**************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Report preferred Node.js version]</span> <span class="err">*****************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span> <span class="err">=&gt;</span>
  <span class="err">galaxy_node_version:</span> <span class="err">18.12.1</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Check if node is installed]</span> <span class="err">***********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Collect installed node version]</span> <span class="err">*******************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Remove node_modules directory when upgrading node]</span> <span class="err">***</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install or upgrade node]</span> <span class="err">**************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Install yarn]</span> <span class="err">*************************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include client build process]</span> <span class="err">*********************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/_inc_client_build_make.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Build client]</span> <span class="err">*************************************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Fetch client version]</span> <span class="err">*****************************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Set client build version fact]</span> <span class="err">********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Ensure that client update succeeded]</span> <span class="err">**************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include error document setup tasks]</span> <span class="err">***************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include Gravity setup tasks]</span> <span class="err">**********************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.galaxy/tasks/gravity.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Register Galaxy config with Gravity (Gravity &lt; 1)]</span> <span class="err">***</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Deploy galaxyctl wrapper script]</span> <span class="err">******************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include systemd unit setup tasks (Galaxy)]</span> <span class="err">********</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include systemd unit setup tasks (Reports)]</span> <span class="err">*******</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.galaxy : Include cleanup scheduling tasks]</span> <span class="err">*****************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Check for miniconda existence]</span> <span class="err">*****************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Include install tasks]</span> <span class="err">*************************</span>
<span class="err">included:</span> <span class="err">/home/ubuntu/galaxy/roles/galaxyproject.miniconda/tasks/install.yml</span> <span class="err">for</span> <span class="err">gat-0.eu.galaxy.training</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Create miniconda installer tempfile]</span> <span class="err">***********</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Collect miniconda installer]</span> <span class="err">*******************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Run miniconda installer]</span> <span class="err">***********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Remove minicoda installer]</span> <span class="err">*********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Collect miniconda version]</span> <span class="err">*********************</span>
<span class="err">ok:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Update miniconda version (exact)]</span> <span class="err">**************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Update miniconda version (latest)]</span> <span class="err">*************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Install packages to conda base environment]</span> <span class="err">****</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Create conda envs]</span> <span class="err">*****************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Update conda envs]</span> <span class="err">*****************************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">TASK</span> <span class="nn">[galaxyproject.miniconda : Create Galaxy conda env]</span> <span class="err">***********************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.postgresql : Reload PostgreSQL]</span> <span class="err">*****************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.galaxy : galaxy mule restart]</span> <span class="err">*******************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.galaxy : galaxy gravity restart]</span> <span class="err">****************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.galaxy : galaxyctl update]</span> <span class="err">**********************</span>
<span class="err">skipping:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.galaxy : galaxyctl update]</span> <span class="err">**********************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">RUNNING</span> <span class="err">HANDLER</span> <span class="nn">[galaxyproject.galaxy : galaxy gravity restart]</span> <span class="err">****************</span>
<span class="err">changed:</span> <span class="nn">[gat-0.eu.galaxy.training]</span>

<span class="err">PLAY</span> <span class="err">RECAP</span> <span class="err">*********************************************************************</span>
<span class="err">gat-0.eu.galaxy.training</span> <span class="err">:</span> <span class="py">ok</span><span class="p">=</span><span class="s">101  changed=28   unreachable=0    failed=0    skipped=53   rescued=0    ignored=0</span>
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-free-knowledge"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Free knowledge</div>
        <p>You will notice the significant volume of output from this playbook! There are
many, many steps for deploying a production Galaxy, and there is a vast
amount of knowledge encoded into these playbooks by the developers and
admins who use them. While we recommend this, choosing to use Ansible
and the official playbooks means you are opting in to receive all of this
knowledge applied automatically to your systems. You are welcome to use
a different Configuration Management system which works for your infrastructure, but it might
mean re-creating a large amount of existing work that is maintained by a
large community of admins.</p>
      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-slow-deployment"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-slow-deployment" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Slow Deployment</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>The deployment can be slowed down by the client build.
The client is only re-built when there are changes in the files needed for the Galaxy user interface (JavaScript, CSS). Because we are tracking a release branch, we’ll receive updates that are published to that branch during the training since the last time the playbook was run.</p>
      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-error-failed-to-set-permissions-on-the-temporary-files"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-error-failed-to-set-permissions-on-the-temporary-files" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: ERROR: Failed to set permissions on the temporary files</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>Did you get an error message like this?</p>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fatal: [localhost]: FAILED! =&gt; {"msg": "Failed to set permissions on the temporary files Ansible needs to create when becoming an unprivileged user (rc: 1, err: chown: changing ownership of '/var/tmp/ansible-tmp-1607430009.739602-32983298209838/': Operation not permitted\nchown: changing ownership of '/var/tmp/ansible-tmp-1607430009.739602-32983298209838/source': Operation not permitted\n}). For information on working around this, see https://docs.ansible.com/ansible/become.html#becoming-an-unprivileged-user"}
</code></pre></div>        </div>

        <p>You’re missing the <code class="language-plaintext highlighter-rouge">setfacl</code> command provided by the <code class="language-plaintext highlighter-rouge">acl</code> package. <a href="https://github.com/georchestra/ansible/issues/55#issuecomment-588313638">reference</a></p>

      </blockquote>
    </li>
    <li>
      <p>Explore what has been set up for you.</p>

      <ul>
        <li>Galaxy has been deployed to <code class="language-plaintext highlighter-rouge">/srv/galaxy/server</code></li>
        <li>The configuration lives in <code class="language-plaintext highlighter-rouge">/srv/galaxy/config/galaxy.yml</code> - be sure to look through it to see what options have been set for you</li>
        <li>Note the ownership and permissions of the contents of <code class="language-plaintext highlighter-rouge">/srv/galaxy</code></li>
        <li>Some config files that Galaxy maintains itself, such as <code class="language-plaintext highlighter-rouge">shed_tool_conf.xml</code>, which controls what tools that you have installed from the Tool Shed will be loaded, have been instantiated in <code class="language-plaintext highlighter-rouge">/srv/galaxy/var/config</code></li>
        <li>A Python virtualenv - an isolated Python environment - with all of the Galaxy framework’s dependencies has been installed in <code class="language-plaintext highlighter-rouge">/srv/galaxy/venv</code></li>
      </ul>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-11"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tree <span class="nt">-L</span> 1 /srv/galaxy/
</code></pre></div>          </div>
          <ul>
            <li><code class="language-plaintext highlighter-rouge">config</code> holds all static Galaxy config files</li>
            <li><code class="language-plaintext highlighter-rouge">jobs</code> is where all job files will go (e.g. temporary working dirs, job scripts, etc.)</li>
            <li><code class="language-plaintext highlighter-rouge">local_tools</code> is a directory for custom, non-ToolShed tools managed by the Ansible playbook</li>
            <li><code class="language-plaintext highlighter-rouge">server</code> contains all of the Galaxy server code</li>
            <li><code class="language-plaintext highlighter-rouge">var</code> is a directory for all files created by Galaxy, e.g. whenever tools are installed from the ToolShed, the Galaxy-managed cache, and the integrated tool panel file.</li>
            <li><code class="language-plaintext highlighter-rouge">venv</code> contains the Galaxy virtual environment and all dependencies, like Gunicorn.</li>
          </ul>
        </blockquote>

        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-bash-8"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

          <div class="language-ini highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">/srv/galaxy/</span>
<span class="err">├──</span> <span class="err">config</span>
<span class="err">├──</span> <span class="err">datasets</span>
<span class="err">├──</span> <span class="err">jobs</span>
<span class="err">├──</span> <span class="err">local_tools</span>
<span class="err">├──</span> <span class="err">server</span>
<span class="err">├──</span> <span class="err">var</span>
<span class="err">└──</span> <span class="err">venv</span>

<span class="err">7</span> <span class="err">directories,</span> <span class="err">0</span> <span class="err">files</span>
</code></pre></div>          </div>
        </blockquote>
      </blockquote>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-12"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /srv/galaxy/config/galaxy.yml
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="code-out code-max-300">
        <div class="box-title code-out-title" id="code-out-bash-9"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>
        <p>You’ll notice that the file is significantly different from the configuration you have set up in your group variables. The Ansible role adds a significant number of additional configuration options which all require a path, and templates the appropriate paths into all of them.</p>
        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">---</span>
<span class="c1">##</span>
<span class="c1">## This file is managed by Ansible.  ALL CHANGES WILL BE OVERWRITTEN.</span>
<span class="c1">##</span>

<span class="na">gravity</span><span class="pi">:</span>
    <span class="na">celery</span><span class="pi">:</span>
        <span class="na">concurrency</span><span class="pi">:</span> <span class="m">2</span>
        <span class="na">loglevel</span><span class="pi">:</span> <span class="s">DEBUG</span>
    <span class="na">galaxy_root</span><span class="pi">:</span> <span class="s">/srv/galaxy/server</span>
    <span class="na">galaxy_user</span><span class="pi">:</span> <span class="s">galaxy</span>
    <span class="na">gunicorn</span><span class="pi">:</span>
        <span class="na">bind</span><span class="pi">:</span> <span class="s">unix:/srv/galaxy/var/config/gunicorn.sock</span>
        <span class="na">extra_args</span><span class="pi">:</span> <span class="s">--forwarded-allow-ips="*"</span>
        <span class="na">preload</span><span class="pi">:</span> <span class="kc">true</span>
        <span class="na">workers</span><span class="pi">:</span> <span class="m">2</span>
    <span class="na">handlers</span><span class="pi">:</span>
        <span class="na">handler</span><span class="pi">:</span>
            <span class="na">pools</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">job-handlers</span>
            <span class="pi">-</span> <span class="s">workflow-schedulers</span>
            <span class="na">processes</span><span class="pi">:</span> <span class="m">2</span>
    <span class="na">process_manager</span><span class="pi">:</span> <span class="s">systemd</span>
    <span class="na">virtualenv</span><span class="pi">:</span> <span class="s">/srv/galaxy/venv</span>


<span class="na">galaxy</span><span class="pi">:</span>
    <span class="na">admin_users</span><span class="pi">:</span> <span class="s">admin@example.org</span>
    <span class="na">builds_file_path</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/tool-data/shared/ucsc/builds.txt.sample</span>
    <span class="na">container_resolvers_config_file</span><span class="pi">:</span> <span class="s1">'</span><span class="s">'</span>
    <span class="na">data_dir</span><span class="pi">:</span> <span class="s">/srv/galaxy/var</span>
    <span class="na">data_manager_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/data_manager_conf.xml.sample</span>
    <span class="na">database_connection</span><span class="pi">:</span> <span class="s">postgresql:///galaxy?host=/var/run/postgresql</span>
    <span class="na">datatypes_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/datatypes_conf.xml.sample</span>
    <span class="na">dependency_resolvers_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/config/dependency_resolvers_conf.xml</span>
    <span class="na">external_service_type_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/external_service_types_conf.xml.sample</span>
    <span class="na">file_path</span><span class="pi">:</span> <span class="s">/data</span>
    <span class="na">id_secret</span><span class="pi">:</span> <span class="s">BxI6zlQVhoHLPVf3gqQ</span>
    <span class="na">integrated_tool_panel_config</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/config/integrated_tool_panel.xml</span>
    <span class="na">job_metrics_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/config/job_metrics_conf.xml</span>
    <span class="na">job_working_directory</span><span class="pi">:</span> <span class="s">/srv/galaxy/jobs</span>
    <span class="na">migrated_tools_config</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/config/migrated_tools_conf.xml</span>
    <span class="na">object_store_store_by</span><span class="pi">:</span> <span class="s">uuid</span>
    <span class="na">openid_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/openid_conf.xml.sample</span>
    <span class="na">shed_data_manager_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/config/shed_data_manager_conf.xml</span>
    <span class="na">shed_tool_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/config/shed_tool_conf.xml</span>
    <span class="na">shed_tool_data_table_config</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/config/shed_tool_data_table_conf.xml</span>
    <span class="na">tool_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/tool_conf.xml.sample</span>
    <span class="na">tool_data_path</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/tool-data</span>
    <span class="na">tool_data_table_config_path</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/tool_data_table_conf.xml.sample</span>
    <span class="na">tool_dependency_dir</span><span class="pi">:</span> <span class="s">/srv/galaxy/var/dependencies</span>
    <span class="na">tool_sheds_config_file</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/config/tool_sheds_conf.xml.sample</span>
    <span class="na">ucsc_build_sites</span><span class="pi">:</span> <span class="s">/srv/galaxy/server/tool-data/shared/ucsc/ucsc_build_sites.txt.sample</span>
    <span class="na">visualization_plugins_directory</span><span class="pi">:</span> <span class="s">config/plugins/visualizations</span>
</code></pre></div>        </div>
      </blockquote>
    </li>
  </ol>

</blockquote>

<p>Galaxy is now configured with an admin user, a database, and a place to store data. We’ve immediately configured standalone Galaxy servers to handle jobs and workflow scheduling. Additionally, Galaxy’s process manager, Gravity, has written out <a href="https://freedesktop.org/wiki/Software/systemd/">systemd</a> configuration files called <em>service units</em> that are used to define how to start and stop Galaxy’s various services. Your Galaxy server should now be running!</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-status-check"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Status Check</div>

  <ol>
    <li>
      <p>Log in and check the status with <code class="language-plaintext highlighter-rouge">sudo galaxyctl status</code></p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-13"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>galaxyctl status
</code></pre></div>        </div>
      </blockquote>

      <blockquote class="code-out code-max-300">
        <div class="box-title code-out-title" id="code-out-bash-10"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Bash</div>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  UNIT                       LOAD   ACTIVE SUB     DESCRIPTION
  galaxy-celery-beat.service loaded active running Galaxy celery-beat
  galaxy-celery.service      loaded active running Galaxy celery
  galaxy-gunicorn.service    loaded active running Galaxy gunicorn
  galaxy-handler@0.service   loaded active running Galaxy handler (process 0)
  galaxy-handler@1.service   loaded active running Galaxy handler (process 1)
  galaxy.target              loaded active active  Galaxy

LOAD   = Reflects whether the unit definition was properly loaded.
ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
SUB    = The low-level unit activation state, values depend on unit type.
6 loaded units listed.
To show all installed unit files use 'systemctl list-unit-files'.
</code></pre></div>        </div>
      </blockquote>

      <p>To inspect individual services in detail, use <code class="language-plaintext highlighter-rouge">sudo galaxyctl status &lt;service&gt;</code> where <code class="language-plaintext highlighter-rouge">&lt;service&gt;</code> is a service from the Gravity configuration such as <code class="language-plaintext highlighter-rouge">gunicorn</code> or <code class="language-plaintext highlighter-rouge">handler</code>. Alternatively, you can invoke <code class="language-plaintext highlighter-rouge">sudo systemctl status &lt;service-unit&gt;</code> where <code class="language-plaintext highlighter-rouge">&lt;service-unit&gt;</code> (such as <code class="language-plaintext highlighter-rouge">galaxy-gunicorn.service</code> and <code class="language-plaintext highlighter-rouge">galaxy-handler@0.service</code>) can be found in the output above (the <code class="language-plaintext highlighter-rouge">.service</code> suffix is implied and optional, so you can leave it off for convenience).</p>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-did-this-fail"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-did-this-fail" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Did this fail?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>If any of the services show as failed, inspect them using one of the above methods, e.g.:</p>

        <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>galaxyctl status gunicorn
<span class="go">× galaxy-gunicorn.service - Galaxy gunicorn
</span><span class="gp">     Loaded: loaded (/etc/systemd/system/galaxy-gunicorn.service;</span><span class="w"> </span>disabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
<span class="gp">     Active: failed (Result: exit-code) since Thu 2023-03-16 01:15:15 UTC;</span><span class="w"> </span>1s ago
<span class="go">    Process: 20306 ExecStart=/srv/galaxy/venv/bin/galaxyctl --config-file /srv/galaxy/config/galaxy.yml exec _default_ gunicorn (code=exited, status=1/FAILURE)
   Main PID: 20306 (code=exited, status=1/FAILURE)
        CPU: 3.381s

Mar 16 01:15:14 gat galaxyctl[20306]:   File "/srv/galaxy/venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
Mar 16 01:15:14 gat galaxyctl[20306]:     self.dialect.do_execute(
Mar 16 01:15:14 gat galaxyctl[20306]:   File "/srv/galaxy/venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
Mar 16 01:15:14 gat galaxyctl[20306]:     cursor.execute(statement, parameters)
Mar 16 01:15:14 gat galaxyctl[20306]: sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InsufficientPrivilege) permission denied to create database
Mar 16 01:15:14 gat galaxyctl[20306]: [SQL: CREATE DATABASE bork ENCODING 'utf8' TEMPLATE template1]
Mar 16 01:15:14 gat galaxyctl[20306]: (Background on this error at: https://sqlalche.me/e/14/f405)
Mar 16 01:15:15 gat systemd[1]: galaxy-gunicorn.service: Main process exited, code=exited, status=1/FAILURE
Mar 16 01:15:15 gat systemd[1]: galaxy-gunicorn.service: Failed with result 'exit-code'.
Mar 16 01:15:15 gat systemd[1]: galaxy-gunicorn.service: Consumed 3.381s CPU time.
</span></code></pre></div>        </div>

        <p>Check your /srv/galaxy/config/galaxy.yml and ensure that it lines up exactly with what you expect. You might observe a warning that <code class="language-plaintext highlighter-rouge">Dynamic handlers are configured in Gravity but Galaxy is not configured to assign jobs to handlers dynamically</code>. We will address this <a href="#job-configuration">below</a>, and you can disregard it for now.</p>
      </blockquote>
    </li>
    <li>
      <p>Some things to note:</p>

      <ol>
        <li>Although the playbook will restart Galaxy upon config changes, you will sometimes need to restart it by hand, which can be done with <code class="language-plaintext highlighter-rouge">sudo galaxyctl restart galaxy</code></li>
        <li>You can use <code class="language-plaintext highlighter-rouge">sudo galaxyctl follow</code> or <code class="language-plaintext highlighter-rouge">journalctl -fu 'galaxy-*'</code> to see the logs of Galaxy. You can see the logs of indivudual services using <code class="language-plaintext highlighter-rouge">sudo galaxyctl follow &lt;service&gt;</code> or <code class="language-plaintext highlighter-rouge">journalctl -fu &lt;service-unit&gt;</code>.</li>
      </ol>
    </li>
  </ol>

</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-ansible-failures-and-notifications"><button class="gtn-boxify-button details" type="button" aria-controls="details-ansible-failures-and-notifications" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Ansible, failures, and notifications</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>Sometimes Ansible tasks will fail. Usually due to misconfiguration, but occasionally due to other issues like your coworker restarted the server while you were doing maintenance, or network failures, or any other possible error. It happens. An unfortunate side effect can be observed in specific situations:</p>

  <p>Let’s say you’re running a playbook that updates the <code class="language-plaintext highlighter-rouge">galaxy.yml</code>, which will in turn notify the handler <code class="language-plaintext highlighter-rouge">Restart Galaxy</code>. If this change is made, and notification triggered, but a failure occurs before Ansible can reach the step where it runs the handlers. The handlers will not run during this Ansible execution.</p>

  <p>The next time you run the playbook, Ansible will not observe any configuration files changing (because they were changed in the last run), and so the handler that restarts Galaxy will not run.</p>

  <p>If you encounter this situation you just have to be mindful of the fact, and remember to manually run the handler. There is no general solution to this problem unfortunately. This applies mostly to development setups. In production you’re probably running that playbook somewhat regularly and do not expect failures as everything is quite stable.</p>

</blockquote>

<blockquote class="hidden">
  <div data-test="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0-galaxy-up.sh
</code></pre></div>  </div>
</blockquote>

<h2 id="nginx">NGINX</h2>

<p>With this we have:</p>

<ul>
  <li>PostgreSQL running</li>
  <li>Galaxy running (managed by Gravity + systemd)</li>
</ul>

<p>Although Gunicorn can serve HTTP for us directly, a reverse proxy in front of Gunicorn can automatically compress selected content, and we can easily apply caching headers to specific types of content like CSS or images. It is also necessary if we want to serve multiple sites at once, e.g. with a group website at <code class="language-plaintext highlighter-rouge">/</code> and Galaxy at <code class="language-plaintext highlighter-rouge">/galaxy</code>. Lastly, it can provide authentication as well, as noted in the <a href="/training-material/topics/admin/tutorials/external-auth/tutorial.html">External Authentication</a> tutorial.</p>

<p>For this, we will use NGINX (pronounced “engine X” /ˌɛndʒɪnˈɛks/ EN-jin-EKS). It is possible to configure Galaxy with Apache and potentially other webservers but this is not the configuration that receives the most testing. We recommend NGINX unless you have a specific need for Apache.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-nginx"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: NGINX</div>

  <ol>
    <li>
      <p>Add the role <code class="language-plaintext highlighter-rouge">galaxyproject.nginx</code> to the end of your playbook and have it run as root.</p>

      <div data-commit="Add nginx to playbook" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/galaxy.yml
</span><span class="gi">+++ b/galaxy.yml
</span><span class="p">@@ -26,3 +26,4 @@</span>
     - role: galaxyproject.miniconda
       become: true
       become_user: "{{ galaxy_user_name }}"
<span class="gi">+    - galaxyproject.nginx
</span>   
</code></pre></div>      </div>
    </li>
    <li>
      <p>We need to configure the virtualhost. This is a slightly more complex process as we have to write the proxying configuration ourselves. This may seem annoying, but it is often the case that sites have individual needs to cater to, and it is difficult to provide a truly generic webserver configuration. Additionally, we will enable secure communication via HTTPS using SSL/TLS certificates provided by <a href="https://certbot.eff.org/">certbot</a>.</p>

      <p>Add the following to your group variables file:</p>

      <div data-commit="Configure nginx, certbot" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -50,3 +50,55 @@</span> galaxy_config:
    
 galaxy_extra_dirs:
   - /data
<span class="gi">+
+# Certbot
+certbot_auto_renew_hour: "{{ 23 |random(seed=inventory_hostname)  }}"
+certbot_auto_renew_minute: "{{ 59 |random(seed=inventory_hostname)  }}"
+certbot_auth_method: --webroot
+certbot_install_method: virtualenv
+certbot_auto_renew: yes
+certbot_auto_renew_user: root
+certbot_environment: staging
+certbot_well_known_root: /srv/nginx/_well-known_root
+certbot_share_key_users:
+  - www-data
+certbot_post_renewal: |
+    systemctl restart nginx || true
+certbot_domains:
+ - "{{ inventory_hostname }}"
+certbot_agree_tos: --agree-tos
+
+# NGINX
+nginx_selinux_allow_local_connections: true
+nginx_servers:
+  - redirect-ssl
+nginx_ssl_servers:
+  - galaxy
+nginx_enable_default_server: false
+nginx_conf_http:
+  client_max_body_size: 1g
+  # gzip: "on" # This is enabled by default in Ubuntu, and the duplicate directive will cause a crash.
+  gzip_proxied: "any"
+  gzip_static: "on"   # The ngx_http_gzip_static_module module allows sending precompressed files with the ".gz" filename extension instead of regular files.
+  gzip_vary: "on"
+  gzip_min_length: 128
+  gzip_comp_level: 6  # Tradeoff of better compression for slightly more CPU time.
+  gzip_types: |
+      text/plain
+      text/css
+      text/xml
+      text/javascript
+      application/javascript
+      application/x-javascript
+      application/json
+      application/xml
+      application/xml+rss
+      application/xhtml+xml
+      application/x-font-ttf
+      application/x-font-opentype
+      image/png
+      image/svg+xml
+      image/x-icon
+nginx_ssl_role: usegalaxy_eu.certbot
+nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem
+nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-www-data.pem
</span>   
</code></pre></div>      </div>

      <blockquote class="details">
        <div class="box-title details-title" id="details-certbot-details"><button class="gtn-boxify-button details" type="button" aria-controls="details-certbot-details" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Certbot details</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>This is a lot of configuration but it is not very complex to understand. We’ll go through it step by step:</p>

        <ul>
          <li><code class="language-plaintext highlighter-rouge">certbot_auto_renew_hour/minute</code>: Certbot certificates are short lived, they only last 90 days. As a consequence, automated renewal is a significant part of the setup and well integrated. The certbot role installs a cron job which checks if the certificate needs to be renewed (when it has &lt;30 days of lifetime left) and attempts to renew the certificate as needed. In order to reduce load on the certbot servers, we randomly set the time when the request will be made, so not all of the requests occur simultaneously. For training VMs this will likely never be reached. For real-life machines, this is more important.</li>
          <li><code class="language-plaintext highlighter-rouge">certbot_auth_method</code>: <a href="https://certbot.eff.org/docs/using.html">Multiple authentication methods</a> are supported, we will use the webroot method since that integrates nicely with <code class="language-plaintext highlighter-rouge">galaxyproject.nginx</code>. This writes out a file onto the webserver’s root (that we specify in <code class="language-plaintext highlighter-rouge">certbot_well_known_root</code>) which certbot’s servers will check.</li>
          <li><code class="language-plaintext highlighter-rouge">certbot_auto_renew</code>: Automatically attempt renewing the certificate as the <code class="language-plaintext highlighter-rouge">certbot_auto_renew_user</code></li>
          <li><code class="language-plaintext highlighter-rouge">certbot_environment</code>: The options here are <code class="language-plaintext highlighter-rouge">production</code> and <code class="language-plaintext highlighter-rouge">staging</code>, we will set this to staging and obtain a verified but invalid certificate as browsers are intentionally not configured to trust the certbot staging certificates. The staging environment has higher <a href="https://letsencrypt.org/docs/rate-limits/">rate limits</a> and allows requesting more certificates during trainings. If you are deploying on a production machine you should set this to <code class="language-plaintext highlighter-rouge">production</code>.</li>
          <li><code class="language-plaintext highlighter-rouge">certbot_share_key_users</code>: This variable automatically shares the certificates with any system users that might need to access them. Here just nginx needs access.</li>
          <li><code class="language-plaintext highlighter-rouge">certbot_post_renewal</code>: Often services need to be notified or restarted once the certificates have been updated.</li>
          <li><code class="language-plaintext highlighter-rouge">certbot_domains</code>: These are the domains that are requested for verification. Any entries you place here <strong>must</strong> all be publicly resolvable.</li>
          <li><code class="language-plaintext highlighter-rouge">certbot_agree_tos</code>: We automatically agree to the certbot TOS. You can read the current one on <a href="https://letsencrypt.org/repository/">their website</a></li>
        </ul>
      </blockquote>

      <blockquote class="details">
        <div class="box-title details-title" id="details-nginx-details"><button class="gtn-boxify-button details" type="button" aria-controls="details-nginx-details" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Nginx details</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>Likewise the nginx configuration has a couple of important points:</p>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">nginx_selinux_allow_local_connections</code>: Specific to CentOS hosts where Nginx will need to access Galaxy</li>
          <li><code class="language-plaintext highlighter-rouge">nginx_enable_default_server/vhost</code>: Most Nginx packages come with a default configuration for the webserver. We do not want this.</li>
          <li><code class="language-plaintext highlighter-rouge">nginx_conf_http</code>: Here we can write any extra configuration we have, <code class="language-plaintext highlighter-rouge">client_max_body_size: 1g</code> increases the POST limit to 1Gb which makes uploads easier.</li>
        </ul>

        <p>These control the SSL configuration</p>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">nginx_conf_ssl_certificate/key</code>: Location of the certificate / private key.</li>
        </ul>

        <p>The configuration variables we added in our group variables file has the following variables</p>
        <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">nginx_servers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">redirect-ssl</span>
<span class="na">nginx_ssl_servers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">galaxy</span>
</code></pre></div>        </div>

        <p>The <code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code> role expects to find two files with these names in <code class="language-plaintext highlighter-rouge">templates/nginx/redirect-ssl.j2</code> and <code class="language-plaintext highlighter-rouge">templates/nginx/galaxy.j2</code></p>

      </blockquote>

      <blockquote class="details">
        <div class="box-title details-title" id="details-running-this-tutorial-with-your-own-ssl-certificates"><button class="gtn-boxify-button details" type="button" aria-controls="details-running-this-tutorial-with-your-own-ssl-certificates" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Running this tutorial with your own SSL certificates</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>If you want, you can run this with your own SSL certificates. You can read about all of the variables you need to set <a href="https://github.com/galaxyproject/ansible-nginx#ssl-configuration">in the ansible NGINX role</a>.</p>

      </blockquote>

      <blockquote class="details">
        <div class="box-title details-title" id="details-running-this-tutorial-i-without-i-ssl"><button class="gtn-boxify-button details" type="button" aria-controls="details-running-this-tutorial-i-without-i-ssl" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Running this tutorial <i>without</i> SSL</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>If you want, you can run this tutorial without SSL. We will provide a sketch of the configuration changes needed, but this is of course not recommended for production, so we will not go into detail here:</p>

        <p>Instead of the above step you should do:</p>

        <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -83,12 +83,7 @@</span> certbot_agree_tos: --agree-tos
 # NGINX
 nginx_selinux_allow_local_connections: true
 nginx_servers:
<span class="gd">-  - redirect-ssl
-nginx_ssl_servers:
</span>   - galaxy
 nginx_enable_default_server: false
 nginx_conf_http:
   client_max_body_size: 1g
<span class="gd">-nginx_ssl_role: usegalaxy_eu.certbot
-nginx_conf_ssl_certificate: /etc/ssl/certs/fullchain.pem
-nginx_conf_ssl_certificate_key: /etc/ssl/user/privkey-www-data.pem
</span></code></pre></div>        </div>

        <p>Please also see the changes in <a href="#details-running-this-tutorial-i-without-i-ssl-1">the other SSL tip box</a></p>
      </blockquote>
    </li>
    <li>
      <p>Create the directory <code class="language-plaintext highlighter-rouge">templates/nginx</code> (staying in galaxy directory, after which groups_vars, roles will be siblings of templates), where we will place our configuration files which should be templated out to the server.</p>

      <p>Create the <code class="language-plaintext highlighter-rouge">templates/nginx/redirect-ssl.j2</code> with the following contents:</p>

      <div data-commit="Setup http to https redirect" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/templates/nginx/redirect-ssl.j2
</span><span class="p">@@ -0,0 +1,14 @@</span>
<span class="gi">+server {
+	listen 80 default_server;
+	listen [::]:80 default_server;
+
+	server_name "{{ inventory_hostname }}";
+
+	location /.well-known/ {
+		root {{ certbot_well_known_root }};
+	}
+
+	location / {
+		return 302 https://$host$request_uri;
+	}
+}
</span>   
</code></pre></div>      </div>

      <p>This will redirect all requests to use HTTPS.</p>
    </li>
    <li>
      <p>Create <code class="language-plaintext highlighter-rouge">templates/nginx/galaxy.j2</code> with the following contents:</p>

      <div data-commit="Configure nginx vhost for galaxy" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/templates/nginx/galaxy.j2
</span><span class="p">@@ -0,0 +1,61 @@</span>
<span class="gi">+upstream galaxy {
+	server {{ galaxy_config.gravity.gunicorn.bind }};
+
+	# Or if you serve galaxy at a path like http(s)://fqdn/galaxy
+	# Remember to set galaxy_url_prefix in the galaxy.yml file.
+	# server {{ galaxy_config.gravity.gunicorn.bind }}:/galaxy;
+}
+
+server {
+	# Listen on port 443
+	listen        *:443 ssl default_server;
+	# The virtualhost is our domain name
+	server_name   "{{ inventory_hostname }}";
+
+	# Our log files will go to journalctl
+	access_log  syslog:server=unix:/dev/log;
+	error_log   syslog:server=unix:/dev/log;
+
+	# The most important location block, by default all requests are sent to gunicorn
+	# If you serve galaxy at a path like /galaxy, change that below (and all other locations!)
+	location / {
+		# This is the backend to send the requests to.
+		proxy_pass http://galaxy;
+
+		proxy_set_header Host $http_host;
+		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
+		proxy_set_header X-Forwarded-Proto $scheme;
+		proxy_set_header Upgrade $http_upgrade;
+	}
+
+	# Static files can be more efficiently served by Nginx. Why send the
+	# request to Gunicorn which should be spending its time doing more useful
+	# things like serving Galaxy!
+	location /static {
+		alias {{ galaxy_server_dir }}/static;
+		expires 24h;
+	}
+
+	# In Galaxy instances started with run.sh, many config files are
+	# automatically copied around. The welcome page is one of them. In
+	# production, this step is skipped, so we will manually alias that.
+	location /static/welcome.html {
+		alias {{ galaxy_server_dir }}/static/welcome.html.sample;
+		expires 24h;
+	}
+
+	# serve visualization and interactive environment plugin static content
+	location ~ ^/plugins/(?&lt;plug_type&gt;[^/]+?)/((?&lt;vis_d&gt;[^/_]*)_?)?(?&lt;vis_name&gt;[^/]*?)/static/(?&lt;static_file&gt;.*?)$ {
+		alias {{ galaxy_server_dir }}/config/plugins/$plug_type/;
+		try_files $vis_d/${vis_d}_${vis_name}/static/$static_file
+		          $vis_d/static/$static_file =404;
+	}
+
+	location /robots.txt {
+		alias {{ galaxy_server_dir }}/static/robots.txt;
+	}
+
+	location /favicon.ico {
+		alias {{ galaxy_server_dir }}/static/favicon.ico;
+	}
+}
</span>   
</code></pre></div>      </div>

      <p>You’ll notice that we have set a 24 hour cache timeout on static content served by NGINX. <a href="https://developers.google.com/speed/pagespeed/insights/">Google’s PageSpeed Tools</a> can identify any additional compression or caching improvements you can make.</p>

      <blockquote class="details">
        <div class="box-title details-title" id="details-running-this-tutorial-i-without-i-ssl-1"><button class="gtn-boxify-button details" type="button" aria-controls="details-running-this-tutorial-i-without-i-ssl-1" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Running this tutorial <i>without</i> SSL</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>Please be sure to also make the changes in <a href="#details-running-this-tutorial-i-without-i-ssl">the other SSL box</a>.</p>

        <p>In your <code class="language-plaintext highlighter-rouge">galaxy.j2</code> in the above step, you should change the <code class="language-plaintext highlighter-rouge">listen</code> parameter:</p>

        <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/templates/nginx/galaxy.j2
</span><span class="gi">+++ b/templates/nginx/galaxy.j2
</span><span class="gd">-listen        *:443 ssl default_server;
</span><span class="gi">+listen        *:80 default_server;
</span></code></pre></div>        </div>

      </blockquote>
    </li>
    <li>
      <p>Run the playbook. At the very end, you should see output like the following indicating that Galaxy has been restarted:</p>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-14"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml
</code></pre></div>          </div>
        </blockquote>
        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-output"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Output</div>
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
RUNNING HANDLER [restart galaxy] ****************************************
changed: [gat-0.eu.galaxy.training]
</code></pre></div>          </div>
        </blockquote>
      </blockquote>

      <p>If you didn’t, you might have missed the first step in this hands-on.</p>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-install-nginx-failed-emerg-socket-80-failed"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-install-nginx-failed-emerg-socket-80-failed" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Install nginx - Failed [emerg] socket() [::]:80 failed</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>If you see this message:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nginx: [emerg] socket() [::]:80 failed (97: Address family not supported by protocol)
</code></pre></div>        </div>

        <p>This may be due to missing IPv6 support on your machine. It is extremely unlikely your operating system doesn’t support it, instead it was probably disabled. Check <code class="language-plaintext highlighter-rouge">/etc/sysctl.conf</code> and <code class="language-plaintext highlighter-rouge">/etc/sysctl.d/*</code> for <code class="language-plaintext highlighter-rouge">net.ipv6.conf.*.disable_ipv6=1</code>, or <code class="language-plaintext highlighter-rouge">/etc/default/grub</code> for <code class="language-plaintext highlighter-rouge">ipv6.disable=1</code></p>
      </blockquote>
    </li>
    <li>
      <p>Check out the changes made to your server in <code class="language-plaintext highlighter-rouge">/etc/nginx/sites-enabled/</code>, particularly the directory containing the Galaxy virtualhost.</p>
    </li>
    <li>
      <p>Check out the nginx logs with <code class="language-plaintext highlighter-rouge">journalctl</code></p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-15"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>journalctl <span class="nt">-fu</span> nginx
</code></pre></div>        </div>
      </blockquote>
    </li>
  </ol>
</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-quot-potential-security-risk-quot-letsencrypt-staging-environment"><button class="gtn-boxify-button details" type="button" aria-controls="details-quot-potential-security-risk-quot-letsencrypt-staging-environment" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: &quot;Potential Security Risk&quot; / LetsEncrypt Staging Environment</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>LetsEncrypt has rate limits on requesting trusted certificates to prevent abuse of their service.
In a training setting there is no need to request certificates that will be trusted by all browsers. So we will request a testing certificate to show how it works, and by changing <code class="language-plaintext highlighter-rouge">staging</code> to <code class="language-plaintext highlighter-rouge">production</code>, you can request browser trusted certificates.</p>

  <p>You will probably see an error like this, when trying to access your Galaxy:</p>

  <figure id="figure-1" style="max-width: 90%;"><img src="../../images/ssl-warning0.png" alt="Browser warning for invalid certificate. " width="947" height="493" loading="lazy" /><a target="_blank" href="../../images/ssl-warning0.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 1</strong>:</span> A browser warning for an invalid certificate. But because we requested a staging certificate, we expected this.</figcaption></figure>

  <p>If you view the details of the certificate, you can see that it is trusted, but by the Fake LE Intermediate, which browsers do not trust.</p>

  <figure id="figure-2" style="max-width: 90%;"><img src="../../images/ssl-warning1.png" alt="Certificate information. " width="650" height="331" loading="lazy" /><a target="_blank" href="../../images/ssl-warning1.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 2</strong>:</span> Investigating the certificate a little, we can see that it was signed, just untrusted.</figcaption></figure>

  <p>Clicking through the warnings (with full knowledge of why) we will see our secured Galaxy:</p>

  <figure id="figure-3" style="max-width: 90%;"><img src="../../images/working-galaxy.png" alt="The finally working Galaxy. " width="1141" height="510" loading="lazy" /><a target="_blank" href="../../images/working-galaxy.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 3</strong>:</span> Galaxy is alive!</figcaption></figure>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-role-dependencies"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Role Dependencies</div>

  <p>Throughout the playbook we added roles in a specific order. Partially this was to mimic the original training and build up a working Galaxy server from nothing, but partially this is also because of some hidden role dependencies on each other. Some must run before others, in order to set certain variables. Looking at the dependencies in detail:</p>

  <table>
    <thead>
      <tr>
        <th>Role</th>
        <th>Role-Role Dependencies</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code class="language-plaintext highlighter-rouge">galaxyproject.postgresql</code></td>
        <td>None</td>
      </tr>
      <tr>
        <td><code class="language-plaintext highlighter-rouge">galaxyproject.postgresql_objects</code></td>
        <td>None</td>
      </tr>
      <tr>
        <td><code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code></td>
        <td>None</td>
      </tr>
      <tr>
        <td><code class="language-plaintext highlighter-rouge">galaxyproject.miniconda</code></td>
        <td>In our group variables, we define the path of <code class="language-plaintext highlighter-rouge">miniconda_prefix</code> to <code class="language-plaintext highlighter-rouge">{{ galaxy_tool_dependency_dir }}/_conda</code>, so Galaxy needs to have set those variables</td>
      </tr>
      <tr>
        <td><code class="language-plaintext highlighter-rouge">galaxyproject.nginx</code></td>
        <td>This requires Galaxy variables to find the static assets</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h2 id="log-in-to-galaxy">Log in to Galaxy</h2>

<p>Now that your production-ready Galaxy is running, try registering a new user and logging in!</p>

<p>In order to be the administrator user, you will need to register an account with the same email address you used in the group variables under the <code class="language-plaintext highlighter-rouge">admin_users</code> setting.</p>

<h2 id="job-configuration">Job Configuration</h2>

<p>One of the most important configuration files for a large Galaxy server is the job configuration. This tells Galaxy where to run all of the jobs that users execute. If Galaxy can’t find a job conf file or no job configuration has been specified inline in the <code class="language-plaintext highlighter-rouge">galaxy.yml</code> file, it will use a simple default configuration where all jobs are run on the Galaxy server and are handled by the web serving process, rather than the job handler(s). Galaxy’s job running system is highly configurable, the full range of configuration can be found in the sample job configuration file, <a href="https://github.com/galaxyproject/galaxy/blob/release_23.0/lib/galaxy/config/sample/job_conf.sample.yml"><code class="language-plaintext highlighter-rouge">job_conf.sample.yml</code></a>.</p>

<p>The job configuration allows Galaxy to run jobs in multiple locations using a variety of different mechanisms. Some of these mechanisms include:</p>

<ul>
  <li>Local - Galaxy runs jobs on the same computer that Galaxy itself is running on.</li>
  <li>DRMAA - Galaxy can connect to a cluster and submit jobs via a distributed resource manager such as Slurm, Condor, PBS Torque or Sun Grid Engine.</li>
  <li>Pulsar - Galaxy can also send jobs to remote compute hosts over the internet using Pulsar.</li>
</ul>

<p>The job configuration can either be defined inline in the Galaxy configuration under <code class="language-plaintext highlighter-rouge">galaxy_config.galaxy.job_config</code>, or in its own file, the path to which is specified in <code class="language-plaintext highlighter-rouge">galaxy_config.galaxy.job_config_file</code>. The syntax of the configuration is the same in both cases.</p>

<h3 id="the-job-configuration---basics">The job configuration - basics</h3>

<p>The job configuration has three basic sections:</p>

<ul>
  <li><strong>runners</strong> - This section lists the types of job management systems that this Galaxy server is configured to use, and tells Galaxy to load the drivers for each type.</li>
  <li><strong>execution</strong> - This section lists the different attributes such as locations, queues, etc. that Galaxy can send jobs to. Each set of attributes together are called an <em>environment</em> (formerly <em>destination</em>), has a name, and uses a <em>plugin</em> to communicate with that location. They can specify things like the number of CPUs, amount of RAM to be allocated, etc. for DRMAA locations. Usually, one of the destinations is set to be the default.</li>
  <li><strong>tools</strong> - This section lists the various tools that you would like to send to a non-default <em>destination</em>. Each line in this section pairs up a tool in Galaxy with a particular job <em>destination</em>. Every time Galaxy gets a job for that particular tool, it is always sent to that <em>destination</em>.</li>
</ul>

<p>A basic job configuration looks like this:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">runners</span><span class="pi">:</span>
  <span class="na">local_runner</span><span class="pi">:</span>
    <span class="na">load</span><span class="pi">:</span> <span class="s">galaxy.jobs.runners.local:LocalJobRunner</span>
    <span class="na">workers</span><span class="pi">:</span> <span class="m">4</span>
<span class="na">execution</span><span class="pi">:</span>
  <span class="na">default</span><span class="pi">:</span> <span class="s">local_env</span>
  <span class="na">environments</span><span class="pi">:</span>
    <span class="na">local_env</span><span class="pi">:</span>
      <span class="na">runner</span><span class="pi">:</span> <span class="s">local_runner</span>
      <span class="na">tmp_dir</span><span class="pi">:</span> <span class="kc">true</span>
<span class="na">tools</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">id</span><span class="pi">:</span> <span class="s">bwa</span>
  <span class="na">environment</span><span class="pi">:</span> <span class="s">local_env</span>
</code></pre></div></div>

<p>The above job configuration defines a <em>runner</em> and an <em>execution</em> to allow Galaxy to run user jobs on the local computer (i.e. The computer that Galaxy is running on.)</p>

<p>Firstly, the <code class="language-plaintext highlighter-rouge">runners</code> section contains a plugin called <code class="language-plaintext highlighter-rouge">local_runner</code> which loads the python code module for supporting local jobs. Next, the <code class="language-plaintext highlighter-rouge">execution</code> section contains an environment named <code class="language-plaintext highlighter-rouge">local_env</code> using the runner <code class="language-plaintext highlighter-rouge">local_runner</code>. It is also set as the default. So now everytime a user clicks “Execute” on a tool form, Galaxy will run the corresponding job locally using the python code specified.</p>

<p>Finally, we have explicitly mapped the tool <code class="language-plaintext highlighter-rouge">bwa</code> to run in the <code class="language-plaintext highlighter-rouge">local_env</code> environment. This is more useful once you begin defining additional environments (especially those that run on clusters).</p>

<blockquote class="tip">
  <div class="box-title tip-title" id="tip-want-to-use-something-else"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-want-to-use-something-else" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Want to use something else?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p>There are a lot of other plugins available for Galaxy for using other resources such as docker containers, kubernetes clusters, Pulsar servers, and HPC clusters to name a few. See the Galaxy documentation on <a href="https://docs.galaxyproject.org/en/master/admin/jobs.html">job configuration</a> for more details on these plugins and their configuration.</p>
</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-job-conf"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Job Conf</div>

  <ol>
    <li>
      <p>Add a new <code class="language-plaintext highlighter-rouge">job_config</code> section to the <code class="language-plaintext highlighter-rouge">galaxy</code> section of <code class="language-plaintext highlighter-rouge">galaxy_config</code> in <code class="language-plaintext highlighter-rouge">group_vars/galaxyservers.yml</code>. Note: placement and whitespace is important here - <code class="language-plaintext highlighter-rouge">job_config</code> should be a child of <code class="language-plaintext highlighter-rouge">galaxy_config.galaxy</code>, at the same level as other options like <code class="language-plaintext highlighter-rouge">id_secret</code>.</p>

      <div data-commit="Add job conf" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -11,6 +11,24 @@</span> miniconda_prefix: "{{ galaxy_tool_dependency_dir }}/_conda"
 miniconda_version: 23.9
 miniconda_channels: ['conda-forge', 'defaults']
    
<span class="gi">+# Galaxy Job Configuration
+galaxy_job_config:
+  runners:
+    local_runner:
+      load: galaxy.jobs.runners.local:LocalJobRunner
+      workers: 4
+  handling:
+    assign: ['db-skip-locked']
+  execution:
+    default: local_env
+    environments:
+      local_env:
+        runner: local_runner
+        tmp_dir: true
+  tools:
+    - class: local # these special tools that aren't parameterized for remote execution - expression tools, upload, etc
+      environment: local_env
+
</span> galaxy_config:
   galaxy:
     # Main Configuration
<span class="p">@@ -21,6 +39,7 @@</span> galaxy_config:
     job_working_directory: /data/jobs
     object_store_store_by: uuid
     id_secret: "{{ vault_id_secret }}"
<span class="gi">+    job_config: "{{ galaxy_job_config }}" # Use the variable we defined above
</span>   gravity:
     process_manager: systemd
     galaxy_root: "{{ galaxy_root }}/server"
   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-workers-4"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-workers-4" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: workers: 4</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>In the local runner, <code class="language-plaintext highlighter-rouge">workers: 4</code> means “number of jobs that can be running at one time”. For every other job runner, it means the number of threads that are created to handle Galaxy’s internal pre- and post-job tasks. E.g. if you are in a class and 50 people submit jobs, then there are four threads that can handle these jobs at once. But additional job handlers can be more useful as well.</p>
      </blockquote>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-tmp-dir-true"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-tmp-dir-true" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: tmp_dir: true</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>In the environment local_env, <code class="language-plaintext highlighter-rouge">tmp_dir: true</code> means “create a temp directory in the job directory”. By default, it is set to <code class="language-plaintext highlighter-rouge">false</code> and if the job uses a temp directory it will create one in the <code class="language-plaintext highlighter-rouge">/tmp/</code> partition and galaxy will not clean it at the end of the job. This can be problematic if the admin does not do regular cleanup of the <code class="language-plaintext highlighter-rouge">/tmp/</code> partition or if the <code class="language-plaintext highlighter-rouge">/tmp/</code> partition is rather small. That’s why we recommand to set this option to <code class="language-plaintext highlighter-rouge">true</code> so the admin does not need to worry about the <code class="language-plaintext highlighter-rouge">/tmp/</code> partition for galaxy jobs.</p>
      </blockquote>
    </li>
    <li>
      <p>Run the playbook. At the very end, you should see output like the following indicating that Galaxy has been restarted:</p>

      <blockquote class="code-2col">
        <blockquote class="code-in">
          <div class="box-title code-in-title" id="code-in-bash-16"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
          <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml
</code></pre></div>          </div>
        </blockquote>
        <blockquote class="code-out">
          <div class="box-title code-out-title" id="code-out-output-1"><i class="fas fa-laptop-code" aria-hidden="true" ></i> Output: Output</div>
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
RUNNING HANDLER [galaxyproject.galaxy : galaxy gravity restart] ****************
changed: [gat-0.eu.galaxy.training]
</code></pre></div>          </div>
        </blockquote>
      </blockquote>
    </li>
  </ol>

</blockquote>

<p>We have installed a fairly simple job configuration that does pretty much the same as the default, with one exception: the <code class="language-plaintext highlighter-rouge">handling</code> section contains an instruction for Galaxy to use the <code class="language-plaintext highlighter-rouge">db-skip-locked</code> method for assigning which process will handle Galaxy jobs. This causes Galaxy to use the job handler processes we defined earlier in the tutorial to handle jobs, rather than handling them in the (gunicorn) web server process. More details can be found in the <a href="https://docs.galaxyproject.org/en/master/admin/scaling.html#job-handler-assignment-methods">Scaling and Load Balancing</a> section of the Galaxy documentation.</p>

<p>Later tutorials will build on this simple job configuration.</p>

<h2 id="productionising-galaxy">Productionising Galaxy</h2>

<p>This is a fantastic base Galaxy installation but there are numerous additional options we should be setting for a real production Galaxy.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-more-features"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: More Features!</div>

  <ol>
    <li>
      <p>Make the following changes to your <code class="language-plaintext highlighter-rouge">group_vars/galaxyservers.yml</code>:</p>

      <div data-commit="Add production facing vars" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -40,6 +40,28 @@</span> galaxy_config:
     object_store_store_by: uuid
     id_secret: "{{ vault_id_secret }}"
     job_config: "{{ galaxy_job_config }}" # Use the variable we defined above
<span class="gi">+    # SQL Performance
+    slow_query_log_threshold: 5
+    enable_per_request_sql_debugging: true
+    # File serving Performance
+    nginx_x_accel_redirect_base: /_x_accel_redirect
+    # Automation / Ease of Use / User-facing features
+    watch_job_rules: 'auto'
+    allow_path_paste: true
+    enable_quotas: true
+    allow_user_deletion: true
+    show_welcome_with_login: true
+    expose_user_name: true
+    expose_dataset_path: true
+    expose_potentially_sensitive_job_metrics: true
+    # NFS workarounds
+    retry_job_output_collection: 3
+    # Debugging
+    cleanup_job: onsuccess
+    allow_user_impersonation: true
+    # Tool security
+    outputs_to_working_directory: true
+    new_user_dataset_access_role_default_private: true # Make datasets private by default
</span>   gravity:
     process_manager: systemd
     galaxy_root: "{{ galaxy_root }}/server"
   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-what-do-these-do"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-what-do-these-do" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: What do these do?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>Check out the full details in the <a href="https://docs.galaxyproject.org/en/master/admin/config.html#configuration-options">Galaxy documentation</a>, but we’ll discuss a couple briefly:</p>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">nginx_x_accel_redirect_base</code>: This is required to have NGINX serve user files. You don’t want Galaxy to waste time reading a 100GB fastq file a user has asked for, so you offload that to NGINX. The request is passed through to Galaxy, so permissions checks still occur, but Galaxy instead replies to NGINX just the path to the file that it should send to the requesting user.</li>
          <li><code class="language-plaintext highlighter-rouge">enable_quotas</code>: You definitely want to set a default quota for your users!</li>
          <li><code class="language-plaintext highlighter-rouge">expose_user_name</code>: This exposes usernames in the history and dataset sharing forms which makes life easier for your users.</li>
          <li><code class="language-plaintext highlighter-rouge">expose_dataset_path</code>: This shares the entire dataset path and enable the user to have access to the command line that the wrapper launched.</li>
          <li><code class="language-plaintext highlighter-rouge">cleanup_job</code>: This prevents a job’s files from being cleaned up from disk if it failed, allowing you to debug and see what went wrong.</li>
          <li><code class="language-plaintext highlighter-rouge">allow_user_impersonation</code>: Users submit horrible bug reports (often screenshots of unrelated things), impersonation means you can just see their history and look at what went wrong.</li>
        </ul>
      </blockquote>
    </li>
    <li>
      <p>Make the following changes to your <code class="language-plaintext highlighter-rouge">templates/nginx/galaxy.j2</code>:</p>

      <div data-commit="Add nginx x-accel-redir and g-i-g webhook config to nginx" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/templates/nginx/galaxy.j2
</span><span class="gi">+++ b/templates/nginx/galaxy.j2
</span><span class="p">@@ -58,4 +58,14 @@</span> server {
 	location /favicon.ico {
 		alias {{ galaxy_server_dir }}/static/favicon.ico;
 	}
<span class="gi">+
+	location /_x_accel_redirect {
+		internal;
+		alias /;
+	}
+
+	# Support click-to-run in the GTN-in-Galaxy Webhook
+	location /training-material/ {
+		proxy_pass https://training.galaxyproject.org/training-material/;
+	}
</span> }
   
</code></pre></div>      </div>

      <blockquote class="tip">
        <div class="box-title tip-title" id="tip-what-do-these-do-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-what-do-these-do-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: What do these do?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <p>The <code class="language-plaintext highlighter-rouge">_x_accel_redirect</code> is required for the NGINX file serving discussed above. For information on the GTN-in-Galaxy Webhook, see the <a href="https://docs.galaxyproject.org/en/master/admin/special_topics/gtn.html?highlight=gtn%20galaxy">Galaxy Documentation</a>. It’s a very cool feature which helps your users access training materials directly in Galaxy.</p>
      </blockquote>
    </li>
    <li>
      <p>Run the playbook</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-17"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml
</code></pre></div>        </div>
      </blockquote>
    </li>
  </ol>

</blockquote>

<blockquote class="hidden">
  <div data-test="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1-galaxy-up.sh
</code></pre></div>  </div>
</blockquote>

<h2 id="disaster-strikes-optional">Disaster Strikes! (Optional)</h2>

<p>Because you’re an admin, you need to be prepared for any situation, including the worst case scenarios. So we’re going to simulate a disaster and show you how you can recover from it. It’ll be fun!</p>

<p>For this “disaster”, we will pretend that:</p>

<ol>
  <li>Your database is on another machine</li>
  <li>Your datasets are on an NFS server or some other remote machine.</li>
</ol>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-summon-the-apocalypse"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Summon the Apocalypse</div>

  <p>So let’s have a “worst case scenario”, where your Galaxy server gets destroyed</p>

  <ol>
    <li>Log on to your machine.</li>
    <li><strong>Carefully</strong>, as root, <code class="language-plaintext highlighter-rouge">rm -rf /srv/galaxy</code>, completely wipe out your Galaxy home directory.</li>
  </ol>

</blockquote>

<p>Your entire Galaxy server is gone! 😱</p>

<p>You were a responsible admin and had your user data and database stored on a separate system (and backed up), so at least those survived. Nevertheless, this is when most of us start feeling really bad; bosses start yelling, we start crying or reaching for bad coping habits.</p>

<p>But not you! You spent the day writing this Ansible playbook that describes your environment completely; all of the software that was installed, all of the configuration changes you have made. It leverages many community maintained roles and can be used to completely rebuild the server! With minimal effort on your part.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-revert-the-apocalypse"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Revert the Apocalypse</div>

  <ol>
    <li>
      <p>Run the playbook</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-18"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ansible-playbook galaxy.yml
</code></pre></div>        </div>
      </blockquote>
    </li>
    <li>
      <p>Get a hot beverage of your choice while it rebuilds.</p>
    </li>
    <li>
      <p>Congratulate yourself for saving the day.</p>
    </li>
  </ol>

</blockquote>

<p>And with that, Galaxy should be up and running again. If you log in, you should see the results of any jobs you ran earlier, you should still be able to log in with your old account, and everything should just work.</p>

<p>Ansible can save you from some really bad scenarios, <em>if and only if</em>:</p>

<ul>
  <li>You can replace the hardware or find somewhere new to re-deploy</li>
  <li>You’ve made absolutely certain that every change made to a system is recorded within your playbooks and roles (i.e. no manual package installation)</li>
</ul>

<p>Then you can potentially use it to recover.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-we-have-experience"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: We have experience</div>

  <p>We can tell you this, we can repeat it over and over, but unless you really have a disaster happen to you, it is hard to appreciate how important it is that machines are completely controlled in terms of configuration and software deployment.</p>

  <p>We’ve experienced these incidents and we know how horribly stressful it can be if an important service like Galaxy goes down and you cannot immediately replace it with another instance. We hope you will immediately apply the lessons from this training material, it can potentially save you a lot of stress and worry.</p>

</blockquote>

<h1 id="production--maintenance">Production &amp; Maintenance</h1>

<p>The time required to maintain a production Galaxy instance depends on the number of users and their specific needs, but a smallish server (&lt;= 25 users) will typically require a day or two per month of maintenance. Large public servers like usegalaxy.org and usegalaxy.eu are largely full time jobs (although even their admins do find time to do other things).</p>

<h2 id="keeping-galaxy-updated">Keeping Galaxy Updated</h2>

<p>If you have set your <code class="language-plaintext highlighter-rouge">galaxy_commit_id</code> group variable to a branch name like <code class="language-plaintext highlighter-rouge">release_23.0</code>, then all you need to do to keep Galaxy up to date (e.g. for security and bug fixes) is to run the playbook regularly. The <code class="language-plaintext highlighter-rouge">git</code> module in Ansible checks if you are on the latest commit of a given branch, and will update the clone of the repository if it is not.</p>

<h2 id="upgrading-galaxy-optional">Upgrading Galaxy (Optional)</h2>

<p>With Ansible, upgrading Galaxy to a new release is incredibly easy. Here is a commit from UseGalaxy.eu’s upgrade:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- a/group_vars/galaxyservers.yml
</span><span class="gi">+++ b/group_vars/galaxyservers.yml
</span><span class="p">@@ -345,7 +345,7 @@</span> galaxy_instance_hostname: usegalaxy.eu
<span class="err">
</span> galaxy_repo: 'https://github.com/usegalaxy-eu/galaxy.git'
<span class="gd">-galaxy_commit_id: 'release_19.05'
</span><span class="gi">+galaxy_commit_id: 'release_19.09'
</span> galaxy_force_checkout: true # discard any modified files
</code></pre></div></div>

<p>This is all that is required, changing the <code class="language-plaintext highlighter-rouge">galaxy_commit_id</code> and re-running the playbook. Everything else (building the client, database migrations, etc.) are taken care of for you.</p>

<p>It is recommend that you also do the following during an upgrade:</p>

<ul>
  <li><a href="https://docs.galaxyproject.org/en/latest/releases/index.html"><strong>Read the release notes</strong></a> for the new version of Galaxy</li>
  <li>Check out the latest <a href="https://github.com/galaxyproject/galaxy/blob/master/config/galaxy.yml.sample"><code class="language-plaintext highlighter-rouge">galaxy.yml.sample</code></a> for the new release, and see if there are any variables you want to set for your server</li>
  <li>Compare the <a href="https://github.com/galaxyproject/galaxy/tree/master/config">other configuration files</a> to see if there are new features you want to take advantage of (e.g. new job runner options or metrics you wish to capture.)</li>
</ul>

<p>When you’ve read the documentation and checked out the new features, you can then run the playbook and you’re done!</p>

<h2 id="user-support">User Support</h2>

<p>There are many user support resources available to you and your users online. <a href="https://help.galaxyproject.org">help.galaxyproject.org</a> is the primary landing point for Galaxy users. For helping individual users, you might find it useful to impersonate them if they fail to send adequate bug reports.</p>

<h3 id="impersonating">Impersonating</h3>

<p>You can activate user impersonation with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>allow_user_impersonation: true
</code></pre></div></div>

<p>It is recommended to ask permission or consent before impersonating a user: “Hey, mind if we look at your history?”
Also, since Galaxy is not normally a real-time collaborative activity, you should avoid running jobs in their history, which can confuse users when datasets show up unexpectedly.
Additionally you can automatically send failing job error reports, even if users do not submit one, and maybe proactively address those issues (depending on the number of your users).</p>

<h2 id="running-on-a-cluster">Running on a cluster</h2>

<p>If you need to run on a cluster with a shared file system, you will need to expose several directories to your cluster:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">galaxy_shed_tools_dir</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_tool_dependency_dir</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_file_path</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_job_working_directory</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_server_dir</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_venv_dir</code></li>
</ul>

<p>But this isn’t strictly true, not every one of these directories needs to be exported over the network. Instead, there are a couple of those directories that can be recreated in different locations (e.g. locally to nodes) using playbook tasks or simply by copying them to the relevant locations. Sometimes admins choose to do this for performance reasons when NFS can be slow or simply unnecessary:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">galaxy_server_dir</code></li>
  <li><code class="language-plaintext highlighter-rouge">galaxy_venv_dir</code></li>
</ul>

<p>Both of those directories can be re-created by running parts of the <code class="language-plaintext highlighter-rouge">galaxyproject.galaxy</code> role on different machines. As neither of these directories is written to during system operations, it is fine for them to be copies living on different machines, rather coming from a single source of truth like an NFS server. For the other directories (e.g. job working directory or tools directory) these need to be written to, and read from, simultaneously from different machines, and should be consistent across the network.</p>

<p>Most of us use NFS, those who are using something more exotic (ceph, gluster, etc) have some reason for that like “my uni provided it” or “we really wanted to try something shiny”. But NFS in most cases is decent and well tested and can be used. For larger deployments, a single NFS node may be insufficient, but at these scales it is common that your university or organisation provides some managed NFS service, e.g. Isilon which has load balancing built into its NFS service.</p>

<h2 id="other-software">Other software</h2>

<p>But what about your other software, things that are deployed along with Galaxy? Things without an ansible role or are quite weird and require “manual tricks” to deploy?</p>

<p>You can write roles for that! Sometimes they are really ugly roles, but it at least keeps it documented + in place. E.g. UseGalaxy.eu has a custom role for rewriting users and it’s ugly and untested and should not be used by anyone else in case it breaks their site. But it’s one of these manual tricks or bits of glue code, but we can encapsulate it as ansible. You can include tarballs in your role to be deployed and so on.</p>

<p>It may seem daunting to use ansible, but you don’t have to do everything in ansible! You can just do a little bit, for managing just Galaxy, and manage the rest of your stack separately. Whatever fits best for your deployment.</p>

<h1 id="loving-ansible-convert-your-own-servers">Loving Ansible? Convert your own servers!</h1>

<p>A common question we get is:</p>

<blockquote class="quote">
  <p>Is it possible to transform a Galaxy server which was installed by hand, into an ansible-managed one?</p>
</blockquote>

<p>Because of the great variance between sites and deployments it is not really possible to produce a guide for doing so. However, if you back your current deployment up and set all of the variables that control paths appropriately, it can be done!</p>

<p>It’s very possible to do this piecemeal, taking one component at a time to ansibilise. nginx is a very easy place to start, the database is as well. Galaxy can be rebuilt in a new location, many of us ran a hand-managed galaxy setup somewhere like <code class="language-plaintext highlighter-rouge">/home/janedoe/work/projects/galaxy</code> that suddenly became a permanent project, this is a good chance to keep that but rebuild an identical one in <code class="language-plaintext highlighter-rouge">/srv/galaxy</code> or similar, and then switch over the traffic to that new, production Galaxy. Relocating data is a bit tougher and can require rewriting entries in the database.</p>

<h1 id="final-notes">Final Notes</h1>

<p>If you’ve been following along you should have a production-ready Galaxy, secured, everything ready to go.</p>

<!--SNIPPET-->
<blockquote class="notranslate hands_on">   <div class="box-title hands_on-title" id="hands-on-time-to-git-commit"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Time to git commit</div>   <p>It’s time to commit your work! Check the status with</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git status<br /></code></pre></div></div>   <p>Add your changed files with</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add ... # any files you see that are changed<br /></code></pre></div></div>   <p>And then commit it!</p>   <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit -m 'Finished Galaxy Installation with Ansible'<br /></code></pre></div></div> </blockquote>
<p><!--END_SNIPPET--></p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-using-git-with-ansible-vaults"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Using Git with Ansible Vaults</div>
  <p>When looking at <code class="language-plaintext highlighter-rouge">git log</code> to see what you changed, you cannot easily look into
Ansible Vault changes: you just see the changes in the encrypted versions, which
is unpleasant to read.</p>

  <p>Instead we can use <a href="https://www.git-scm.com/docs/gitattributes"><code class="language-plaintext highlighter-rouge">.gitattributes</code></a> to tell <code class="language-plaintext highlighter-rouge">git</code> that we want to use a certain
program to convert some files before calculating their diffs,
in this case <code class="language-plaintext highlighter-rouge">ansible-vault view</code>.</p>

  <ol>
    <li>Check your <code class="language-plaintext highlighter-rouge">git log -p</code> and see how the Vault changes look (you can type <code class="language-plaintext highlighter-rouge">/vault</code> to search). Notice that they’re just changed encoded content.</li>
    <li>
      <p>Create the file <code class="language-plaintext highlighter-rouge">.gitattributes</code> in the same folder as your <code class="language-plaintext highlighter-rouge">galaxy.yml</code> playbook, with the following contents:</p>

      <div data-commit="Add git attributes" class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">--- /dev/null
</span><span class="gi">+++ b/.gitattributes
</span><span class="p">@@ -0,0 +1 @@</span>
<span class="gi">+group_vars/secret.yml diff=ansible-vault merge=binary
</span>   
</code></pre></div>      </div>

      <p>This set the <code class="language-plaintext highlighter-rouge">diff</code> attribute to <code class="language-plaintext highlighter-rouge">ansible-vault</code> for the <code class="language-plaintext highlighter-rouge">group_vars/secret.yml</code> file.
Additionally, the <code class="language-plaintext highlighter-rouge">merge=binary</code> option tells git not to attempt to do a three-way merge of this file.</p>
    </li>
    <li>
      <p>Run the following command to configure git to convert the files having the <code class="language-plaintext highlighter-rouge">diff</code> attribute set to <code class="language-plaintext highlighter-rouge">ansible-vault</code>, using the <code class="language-plaintext highlighter-rouge">ansible-vault view</code> command, before diffing them:</p>

      <blockquote class="code-in">
        <div class="box-title code-in-title" id="code-in-bash-19"><i class="far fa-keyboard" aria-hidden="true" ></i> Input: Bash</div>
        <div data-cmd="true" class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git config <span class="nt">--global</span> diff.ansible-vault.textconv <span class="s2">"ansible-vault view"</span>
</code></pre></div>        </div>
      </blockquote>
    </li>
    <li>Try again to <code class="language-plaintext highlighter-rouge">git log -p</code> and look for the vault changes. Note that you can now see the decrypted content! Very useful.</li>
  </ol>
</blockquote>

<!--SNIPPET-->
<blockquote class="comment">   <div class="box-title comment-title" id="comment-got-lost-along-the-way"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Got lost along the way?</div>   <p>If you missed any steps, you can compare against the <a href="https://github.com/hexylena/git-gat/tree/step-1">reference files</a>, or see what changed since <a href="https://github.com/hexylena/git-gat/compare/step-0...step-1#files_bucket">the previous tutorial</a>.</p>   <p>If you’re using <code class="language-plaintext highlighter-rouge">git</code> to track your progress, remember to add your changes and commit with a good commit message!</p> </blockquote>
<p><!--END_SNIPPET--></p>

<figure id="figure-4" style="max-width: 90%;"><img src="../../images/ansible-galaxy-3.png" alt="diagram of galaxy setup with postgres, galaxy, nginx, gunicorn, and storage." width="2796" height="1457" loading="lazy" /><a target="_blank" href="../../images/ansible-galaxy-3.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 4</strong>:</span> This approximately represents what you have setup today, NGINX proxies requests to Gunicorn which runs the Galaxy App. That talks to Postgres, and Storage.</figcaption></figure>

<!--SNIPPET-->
<blockquote class="comment">   <div class="box-title comment-title" id="comment-galaxy-admin-training-path-1"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Galaxy Admin Training Path</div>   <p>The yearly Galaxy Admin Training follows a specific ordering of tutorials. Use this timeline to help keep track of where you are in Galaxy Admin Training.</p>   <ol id="git-gat-timeline">                    <li class="active">         <a href="/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html">             <div>Step 1</div>             <div>ansible-galaxy</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/backup-cleanup/tutorial.html">             <div>Step 2</div>             <div>backup-cleanup</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/customization/tutorial.html">             <div>Step 3</div>             <div>customization</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/tus/tutorial.html">             <div>Step 4</div>             <div>tus</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/cvmfs/tutorial.html">             <div>Step 5</div>             <div>cvmfs</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/apptainer/tutorial.html">             <div>Step 6</div>             <div>apptainer</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/tool-management/tutorial.html">             <div>Step 7</div>             <div>tool-management</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/reference-genomes/tutorial.html">             <div>Step 8</div>             <div>reference-genomes</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/data-library/tutorial.html">             <div>Step 9</div>             <div>data-library</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/dev/tutorials/bioblend-api/tutorial.html">             <div>Step 10</div>             <div>dev/bioblend-api</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/connect-to-compute-cluster/tutorial.html">             <div>Step 11</div>             <div>connect-to-compute-cluster</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/job-destinations/tutorial.html">             <div>Step 12</div>             <div>job-destinations</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/pulsar/tutorial.html">             <div>Step 13</div>             <div>pulsar</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/celery/tutorial.html">             <div>Step 14</div>             <div>celery</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/gxadmin/tutorial.html">             <div>Step 15</div>             <div>gxadmin</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/reports/tutorial.html">             <div>Step 16</div>             <div>reports</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/monitoring/tutorial.html">             <div>Step 17</div>             <div>monitoring</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/tiaas/tutorial.html">             <div>Step 18</div>             <div>tiaas</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/sentry/tutorial.html">             <div>Step 19</div>             <div>sentry</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/ftp/tutorial.html">             <div>Step 20</div>             <div>ftp</div>         </a>     </li>               <span aria-hidden="true">         <i class="fas fa-arrow-right" aria-hidden="true"></i>     </span>                         <li class="">         <a href="/training-material/topics/admin/tutorials/beacon/tutorial.html">             <div>Step 21</div>             <div>beacon</div>         </a>     </li>           </ol> </blockquote>
<p><!--END_SNIPPET--></p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                        <h3>You've Finished the Tutorial</h3>
                        <button id="tutorial-finish-button" class="btn btn-primary" onclick="tutorial_finish()">I finished this tutorial 👍</button>
                        <p style="display: none" id="tutorial-finish-text">Please also consider filling out the <a href="#gtn-feedback">Feedback Form</a> as well!</p>
                        <script>
                        function tutorial_finish() {
                          if(typeof plausible !== 'undefined'){
                            // Plausible may be undefined (script blocked)
                            // or it may be defined, but opted-out (select box/DNT),
                            // which means `plausible()` will work but not send data, *nor* execute the callback.
                            plausible('TutorialComplete', {props: {path: document.location.pathname}})
                          }
                          // since the callback is completely cosmetic, we'll just issue it optimistically.
                          tutorial_finish_finish();
                        }
                        function tutorial_finish_finish() {
                          document.getElementById("tutorial-finish-button").innerText = 'Congrats! Thanks for letting us know! 🎉'
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-text").style.display = 'block'
                        }
                        </script>

                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>Basic deployment with Ansible is surprisingly easy</p>
</li>
                        
                        <li><p>Complexity can grow over time as your organisation does, no need to start with playbooks like UseGalaxy.org</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the <a href="faqs/">tutorial FAQ page</a> or the  <a href="/training-material/topics/admin/faqs/">FAQ page for the Galaxy Server administration topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                


                

                
                <h1 data-toc-skip>Glossary</h1>
                <dl>
                    
                    
                    <dt>DVCS</dt>
                    <dd>Distributed Version Control System</dd>
                    
                </dl>
                

                <h1 id="gtn-feedback">Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=admin/ansible-galaxy"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=admin/ansible-galaxy">Feedback Form</a></iframe>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Helena Rasche, Nate Coraor, Simon Gladman,  <b>Galaxy Installation with Ansible (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html">https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{admin-ansible-galaxy,
author = "Helena Rasche and Nate Coraor and Simon Gladman",
	title = "Galaxy Installation with Ansible (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/admin/tutorials/ansible-galaxy/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

        


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="details follow-up" id="admins-install-missing-tools">
                  <div id="admin-missing-tools" class="box-title">
                    <button type="button" aria-controls="admin-missing-tools" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Galaxy Administrators: Install the missing tools<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>


			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/admin/tutorials/ansible-galaxy/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools: []
</code></pre></div>
                </blockquote>
		

		<blockquote class="details hide-when-printing" id="feedback-responses">
                  <div id="feedback-response-c" class="box-title">
                    <button type="button" aria-controls="feedback-response-c" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Feedback<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>

		   <p>
		   
		   <table class="charts-css bar show-labels" style="--labels-size: 8rem; overflow-y: hidden">
		   
			<tr>
				<th scope="row"><span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 1.0">21</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.38095238095238093">8</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">3 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.09523809523809523">2</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">1 stars</span><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.047619047619047616">1</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">0 stars</span><i class="far fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.14285714285714285">3</td>
			</tr>
		   
		   </table>
		   </p>
		
        
        
		    
		    <b>July 2024</b>
		    <ul>
				
				<li>
					<span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Make me to the point
					<b>Disliked</b>: Anyway, kinda stuck at some unexpected error en route (like my machine use python 3.12, hence lack 2to3 lib)
				</li>
				
		    </ul>
		    
		    <b>March 2023</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Everything <script>console.log("Helena Testing");</script>
					
				</li>
				
		    </ul>
		    
		    <b>August 2022</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: The instructions were clear and helpful (especially with the video alongside)
					<b>Disliked</b>: It would be super helpful if there were more subsection links! I set followed this tutorial to setup a server for my team, and when they had questions or wanted more info on why or how I did certain things it would have been nice to be able to link them more specifically to the step I wanted instead of the bigger section and then giving them key words to search for
				</li>
				
		    </ul>
		    
		    <b>July 2022</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: relatively easy to follow, concept explanations are great 
					
				</li>
				
		    </ul>
		    
		    <b>June 2022</b>
		    <ul>
				
				<li>
					<span class="sr-only">1 stars</span><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: tree -l 2 was helpful as otherwise unclear which file goes where
					<b>Disliked</b>: Current version of the tutorial is broken, consider rolling back to archive. Ansible errors very hard to troubleshoot - ideally add more tips where things can go wrong, for ex ansible vault seems to enter an unfixable state if you mess up the secret yml file and have to make it again
				</li>
				
		    </ul>
		    
		    <b>March 2022</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: how seamless it was to deploy it
					
				</li>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Clear and structured - everything ran without issues on my machines
					
				</li>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: the structure, it was very well organized
					
				</li>
				
		    </ul>
		    
		    <b>February 2022</b>
		    <ul>
				
				<li>
					<span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Pretty simple step-by-step; A couple of syntax errors are included to make things "interesting" when trying to deploy.
					<b>Disliked</b>: Found another syntax error in the referenced tutorial:  In the galaxy.j2 file, "location /_x_accel_redirect" should be "location /_x_accel_redirect/"
				</li>
				
		    </ul>
		    
		    <b>January 2022</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Code examples that you customize to your server set-up; hints and sidebars are very helpful; as is the in-depth explanation of what the code is doing.
					<b>Disliked</b>: One solution to errors that arise would be to try newer playbook versions.  Although the tutorial cautioned that newer versions could create problems - in my case it solved problems.  I found that the version of galaxyproject.galaxy used in the tutorial-- version: 0.9.16 was incompatible with Ubuntu 20.04 LTS - resulting in a failure to install "futures".  When I changed to the newest galaxyproject.galaxy version the problem was solved. 
				</li>
				
		    </ul>
		    
		    <b>September 2021</b>
		    <ul>
				
				<li>
					<span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					
					<b>Disliked</b>: I think there is an error in the instructions around which galaxy release to use.  https://training.galaxyproject.org/archive/2021-08-01/topics/admin/tutorials/ansible-galaxy/tutorial.html#galaxy      step 9.   Fails with a pip install error for attmap at galaxy dependency installation:  FAILED! => {"changed": false, "cmd": ["/srv/galaxy/venv/bin/pip3", "install", "--index-url", "https://wheels.galaxyproject.org/simple/", "--extra-index-url", "https://pypi.python.org/simple", "-r", "/srv/galaxy/server/lib/galaxy/dependencies/pinned-requirements.txt"], "msg": "stdout: Looking in indexes: https://wheels.galaxyproject.org/simple, https://pypi.python.org/simple\nIgnoring importlib-metadata: markers 'python_version < \"3.8\"' don't match your environment\nIgnoring importlib-resources: markers 'python_version < \"3.7\"' don't match your environment\nIgnoring pathlib2: markers 'python_version < \"3.6\"' don't match your environment\nIgnoring ruamel.yaml.clib: markers 'platform_python_implementation == \"CPython\" and python_version < \"3.8\"' don't match your environment\nIgnoring typing: markers 'python_version < \"3.5\"' don't match your environment\nIgnoring zipp: markers 'python_version < \"3.8\"' don't match your environment\nCollecting adal==1.2.4\n  Using cached adal-1.2.4-py2.py3-none-any.whl (55 kB)\nCollecting amqp==2.6.0\n  Using cached amqp-2.6.0-py2.py3-none-any.whl (47 kB)\nCollecting appdirs==1.4.4\n  Using cached appdirs-1.4.4-py2.py3-none-any.whl (9.6 kB)\nCollecting attmap==0.12.11\n  Using cached attmap-0.12.11.tar.gz (9.9 kB)\n\n:stderr:     ERROR: Command errored out with exit status 1:\n     command: /srv/galaxy/venv/bin/python -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/tmp/pip-install-rswp62oy/attmap_d1e6f1f187954e539109df4d7760fde7/setup.py'\"'\"'; __file__='\"'\"'/tmp/pip-install-rswp62oy/attmap_d1e6f1f187954e539109df4d7760fde7/setup.py'\"'\"';f = getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__) if os.path.exists(__file__) else io.StringIO('\"'\"'from setuptools import setup; setup()'\"'\"');code = f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' egg_info --egg-base /tmp/pip-pip-egg-info-2gc_ov_9\n         cwd: /tmp/pip-install-rswp62oy/attmap_d1e6f1f187954e539109df4d7760fde7/\n    Complete output (1 lines):\n    error in attmap setup command: use_2to3 is invalid.\n    ----------------------------------------\nWARNING: Discarding https://files.pythonhosted.org/packages/d0/d4/8b8fca155270a6675bac9a1e49b7c616ae763f66af7b836042ecfc805552/attmap-0.12.11.tar.gz#sha256=95b1f7dbcdad7278a3702fa921be6271046c96e1c9ed9feb10e0d4c13092b0a0 (from https://pypi.org/simple/attmap/). Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.\nERROR: Could not find a version that satisfies the requirement attmap==0.12.11 (from versions: 0.1, 0.1.1, 0.1.2, 0.1.4, 0.1.5, 0.1.6, 0.1.7, 0.1.8, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.10, 0.11, 0.12, 0.12.1, 0.12.2, 0.12.3, 0.12.4, 0.12.5, 0.12.6, 0.12.7, 0.12.8, 0.12.9, 0.12.10, 0.12.11, 0.13.0)\nERROR: No matching distribution found for attmap==0.12.11\n"}   This occurs with galaxy_commit_id: release_20.09 (as per the instructions), but changing to  release_21.05 makes the error go away.  
				</li>
				
		    </ul>
		    
		    <b>July 2021</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Simple and short and easy THX
					
				</li>
				
		    </ul>
		    
		    <b>June 2021</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: All points were very well explained
					
				</li>
				
		    </ul>
		    
		    <b>February 2021</b>
		    <ul>
				
				<li>
					<span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Some good things to note and keep track of regarding moving to production, especially updating the version.
					
				</li>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Realy clear and solid explanations of how to use Ansible for Galaxy installation
					
				</li>
				
		    </ul>
		    
		    <b>January 2021</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: The clear explanation of every part of the roles, modules etc. What they do why they're there. Even if I wasn't interested in everything it's good to know that if I ever need that information I can look back to this tutorial
					<b>Disliked</b>: I don't know if it can be improved but the actual time of the tutorial is really long. After watching it, I totally understand why but if it could be something like 1 hour videos (or less) that would be less tiring. Of course I am fully aware that there is a broad range of topics that need to be covered.
				</li>
				
				<li>
					<span class="sr-only">0 stars</span><i class="far fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: the step by step exercises
					<b>Disliked</b>: for me as a noob some diagrams or schemes would often be helpful to see how things relate to each others
				</li>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: very easy to follow; excellent documentation
					<b>Disliked</b>: note about using non- let's encrypt certificate
				</li>
				
				<li>
					<span class="sr-only">0 stars</span><i class="far fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: very structured and understandable
					<b>Disliked</b>: templates/nginx/galaxy.j2 -> "uwsgi_pass 127.0.0.1:8080" should not be configured statically and changed to a variable from the groups_vars if the port is changed there in the uwsgi variable settings
				</li>
				
		    </ul>
		    
		    <b>August 2020</b>
		    <ul>
				
				<li>
					<span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: It is very practical tutorial
					<b>Disliked</b>: I had to change those two variables to make it work on my ubuntu machine: "virtualenv_command: pyvenv" as it also recommends in README but not the default in the galaxy role "__galaxy_mutable_config_dir: "{{ galaxy_root }}/var/config" " my Ansible didn't understand the previous line defined variable, so I had to define "__galaxy_mutable_config_dir" base on "galaxy_root" variable
				</li>
				
		    </ul>
		    
        
		</blockquote>




		
		
		

                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					
					<li><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00001">gxy.io/GTN:T00001</a></li>
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/admin/tutorials/ansible-galaxy/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/admin/tutorials/ansible-galaxy/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/55607e95d8efdacc58f4eb03501f1419ce408b25">55607e9</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.40d4e218.js'></script>

	
	

    </body>
</html>