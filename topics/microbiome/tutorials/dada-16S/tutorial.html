<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hands-on: Building an amplicon sequence variant (ASV) table from 16S data using DADA2 / Building an amplicon sequence variant (ASV) table from 16S data using DADA2 / Microbiome</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@398f9b8329ed79e4b78b4526bc25f1bf54b0ede8",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" as="script" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.20cf1f17.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Building an amplicon sequence variant (ASV) table from 16S data using DADA2">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-08-09 08:48:32 +0000">
<meta name="DC.creator" content="Bérénice Batut"><meta name="description" content="A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Microbiome / Building an amplicon sequence variant (ASV) table from 16S data using DADA2 / Hands-on: Building an amplicon sequence variant (ASV) table from 16S data using DADA2">
        <meta property="og:description" content="A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ">
        
	<meta property="og:image" content="https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png"><script type="application/ld+json">


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Building an amplicon sequence variant (ASV) table from 16S data using DADA2",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "provider": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "dateModified": "2024-08-09 08:48:32 +0000",
  "datePublished": "2024-06-05 14:29:10 +0000",
  "identifier": "https://gxy.io/GTN:T00441",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Microbiome",
    "description": "A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ",
    "url": "https://training.galaxyproject.org/training-material/topics/microbiome/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Building an amplicon sequence variant (ASV) table from 16S data using DADA2",
  "url": "https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/tutorial.html",
  "version": 7,
  "timeRequired": "PT3H",
  "teaches": "Identify the key steps in the DADA2 workflow for generating an ASV table from 16S rRNA gene sequencing data\n - Explain the importance of quality filtering, error rate learning, and chimera removal in ensuring accurate microbial community analysis\n - Execute the DADA2 pipeline to process raw 16S sequencing data and produce a high-resolution ASV table\n - Compare the advantages of ASV-based methods over traditional OTU-based approaches in terms of accuracy and resolution\n - Assess the effectiveness of using phyloseq for exploring and visualizing ASV data to gain ecological and evolutionary insights",
  "keywords": [
    "Microbiome",
    "metabarcoding",
    "16S",
    "microgalaxy"
  ],
  "description": "The questions this  addresses are:\n - What are the primary steps involved in generating an ASV table using DADA2 from 16S rRNA gene sequencing data?\n - How does DADA2 improve the accuracy of microbial community analysis compared to traditional OTU-based methods?\n - What is the importance of quality filtering in the DADA2 workflow, and how does it impact downstream analyses?\n - How does the error rate learning process contribute to the identification of true biological sequences in DADA2?\n - What role does chimera removal play in the DADA2 pipeline, and why is it crucial for obtaining reliable ASV data?\n - How can phyloseq be used to explore and visualize the ASV table generated by DADA2, and what types of ecological insights can it provide?\n\n\nThe objectives are:\n - Identify the key steps in the DADA2 workflow for generating an ASV table from 16S rRNA gene sequencing data\n - Explain the importance of quality filtering, error rate learning, and chimera removal in ensuring accurate microbial community analysis\n - Execute the DADA2 pipeline to process raw 16S sequencing data and produce a high-resolution ASV table\n - Compare the advantages of ASV-based methods over traditional OTU-based approaches in terms of accuracy and resolution\n - Assess the effectiveness of using phyloseq for exploring and visualizing ASV data to gain ecological and evolutionary insights\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    }
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "name": "Bérénice Batut",
      "image": "https://avatars.githubusercontent.com/bebatut",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "This project ([`2020-1-NL01-KA203-064717`](https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717)) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n![eu flag with the text: with the support of the erasmus programme of the european union](https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg)\n![erasmus plus logo](https://www.erasmusplus.nl/assets/images/logo.png)\n",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/ifb/",
          "name": "Institut Français de Bioinformatique",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.france-bioinformatique.fr/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9852-1987",
      "orcid": "https://orcid.org/0000-0001-9852-1987"
    }
  ],
  "contributor": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bernt-matthias/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bernt-matthias/",
      "name": "Matthias Bernt",
      "image": "https://avatars.githubusercontent.com/bernt-matthias",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/clsiguret/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/clsiguret/",
      "name": "Clea Siguret",
      "image": "https://avatars.githubusercontent.com/clsiguret",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/ifb/",
          "name": "Institut Français de Bioinformatique",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.france-bioinformatique.fr/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0009-0005-6140-0379",
      "orcid": "https://orcid.org/0009-0005-6140-0379"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Microbiome",
      "description": "A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ",
      "url": "https://training.galaxyproject.org/training-material/topics/microbiome/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3174",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3174",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3174"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3697",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3697",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3697"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0637",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0637",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0637"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0080",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0080",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0080"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_4038",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_4038",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_4038"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [
    {
      "@type": "Thing",
      "url": "https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/workflows/",
      "name": "Associated Workflows"
    },
    {
      "@type": "Thing",
      "url": "https://doi.org/10.5281/zenodo.800651",
      "name": "Associated Training Datasets"
    }
  ],
  "abstract": "The investigation of environmental microbial communities and microbiomes has been revolutionized by the "
}</script></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/microbiome" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Microbiome
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/microbiome/faqs/" title="Check our FAQs for the Microbiome topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/microbiome/tutorials/dada-16S/tutorial.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/microbiome/tutorials/dada-16S/tutorial.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html">
                    <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-microbiome">
    <h1 data-toc-skip>Building an amplicon sequence variant (ASV) table from 16S data using DADA2</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bebatut?s=36" alt="Bérénice Batut avatar" width="36" class="avatar" />
    Bérénice Batut</a>
		</td>
	</tr>
	

	

	

	

	

	
	<tr>
		<td><abbr title="These people edited the text, either for spelling and grammar, flow, GTN-fit, or other similar editing categories">Editor(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/bernt-matthias/" class="contributor-badge contributor-bernt-matthias"><img src="https://avatars.githubusercontent.com/bernt-matthias?s=36" alt="Matthias Bernt avatar" width="36" class="avatar" />
    Matthias Bernt</a><a href="/training-material/hall-of-fame/clsiguret/" class="contributor-badge contributor-clsiguret"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/clsiguret?s=36" alt="Clea Siguret avatar" width="36" class="avatar" />
    Clea Siguret</a></td>
	</tr>
	

	

	

	

</table>


	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png" width="88" height="31"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>What are the primary steps involved in generating an ASV table using DADA2 from 16S rRNA gene sequencing data?</p>
</li>
        
        <li><p>How does DADA2 improve the accuracy of microbial community analysis compared to traditional OTU-based methods?</p>
</li>
        
        <li><p>What is the importance of quality filtering in the DADA2 workflow, and how does it impact downstream analyses?</p>
</li>
        
        <li><p>How does the error rate learning process contribute to the identification of true biological sequences in DADA2?</p>
</li>
        
        <li><p>What role does chimera removal play in the DADA2 pipeline, and why is it crucial for obtaining reliable ASV data?</p>
</li>
        
        <li><p>How can phyloseq be used to explore and visualize the ASV table generated by DADA2, and what types of ecological insights can it provide?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Identify the key steps in the DADA2 workflow for generating an ASV table from 16S rRNA gene sequencing data</p>
</li>
        
        <li><p>Explain the importance of quality filtering, error rate learning, and chimera removal in ensuring accurate microbial community analysis</p>
</li>
        
        <li><p>Execute the DADA2 pipeline to process raw 16S sequencing data and produce a high-resolution ASV table</p>
</li>
        
        <li><p>Compare the advantages of ASV-based methods over traditional OTU-based approaches in terms of accuracy and resolution</p>
</li>
        
        <li><p>Assess the effectiveness of using phyloseq for exploring and visualizing ASV data to gain ecological and evolutionary insights</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    
        
        
        
        <li>
          <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        </li>
        
    


        

        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 3 hours</div>
        

        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://doi.org/10.5281/zenodo.800651">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/microbiome/tutorials/dada-16S/workflows/" title="Building an amplicon sequence variant (ASV) table from 16S data using DADA2 workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            

            

            
            
            
                <li class="btn btn-default supporting_material">    <a class="topic-icon" href="/training-material/topics/microbiome/tutorials/dada-16S/faqs/" title="Frequently Asked Questions">
        <i class="far fa-question-circle" aria-hidden="true"></i> FAQs
    </a>
</li>
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            












            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
	<li class="dropdown-header">
		<b>Known Working</b>
	</li>
	
	

    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.eu" title="">
			UseGalaxy.eu <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> <abbr title="This is a UseGalaxy.* server which meets minimum requirements for a public Galaxy">⭐️</abbr>
		</a>
	</li>
    
    
    
    

    
	<li class="dropdown-header">
		Containers
	</li>
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics/microbiome/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Published:</strong> Jun 5, 2024 </div>
        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Aug 9, 2024 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            Tutorial Content is licensed under
            
              <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
            The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span> <abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00441">https://gxy.io/GTN:T00441</a> </div>
        

	
	

	
	
	<div><strong><i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">rating</span> Rating:</strong> <a href="#feedback-responses">5.0</a> (1 recent ratings, 1 all time)</div>
	
	<div><strong><i class="fas fa-code-commit" aria-hidden="true"></i><span class="visually-hidden">version</span> Revision:</strong> 7 </div>

    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <p>The investigation of environmental microbial communities and microbiomes has been revolutionized by the 
development of high-throughput amplicon sequencing. In amplicon sequencing a particular genetic locus, 
for example the 16S rRNA gene (or a part of it) in bacteria, is amplified from DNA extracted from the community of interest, 
and then sequenced on a next-generation sequencing platform. This technique removes the need to culture 
microbes in order to detect their presence, and cost-effectively provides a deep census of a microbial community.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-sources"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Sources</div>

  <p>This tutorial is significantly based on <a href="https://benjjneb.github.io/dada2/tutorial.html">DADA2 Pipeline Tutorial</a> and <a href="https://bioconductor.org/packages/devel/bioc/vignettes/dada2/inst/doc/dada2-intro.html">“Introduction to dada2”</a></p>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-background-the-16s-ribosomal-rna-gene"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Background: The 16S ribosomal RNA gene</div>
  <p><img src="../../images/16S_gene.png" alt="The 16S ribosomal RNA gene" /> <br /><br /></p>

  <p>The 16S rRNA gene has several properties that make it ideally suited for our purposes</p>

  <ol>
    <li>Present in all prokaryotes</li>
    <li>Highly conserved + highly variable regions</li>
    <li>Huge reference databases</li>
  </ol>

  <p><img src="../../images/16S_variableregions.jpg" alt="16S Variable regions" /></p>

  <p>The highly conserved regions make it easy to target the gene across different organisms,
while the highly variable regions allow us to distinguish between different species.</p>

  <p>(slide credit <a href="https://www.slideshare.net/beiko/ccbc-tutorial-beiko">https://www.slideshare.net/beiko/ccbc-tutorial-beiko</a>)</p>
</blockquote>

<p>To process 16S amplicon sequencing data, several tools exist: <strong>QIIME2</strong> (<span class="citation"><a href="#Bolyen_2019">Bolyen <i>et al.</i> 2019</a></span>), <strong>Mothur</strong> (<span class="citation"><a href="#Schloss_2009">Schloss <i>et al.</i> 2009</a></span>), <strong>Lotus2</strong> (<span class="citation"><a href="#_zkurt_2022">Özkurt <i>et al.</i> 2022</a></span>), and <strong>DADA2</strong> (<span class="citation"><a href="#Callahan_2016">Callahan <i>et al.</i> 2016</a></span>). All these tools can be used in Galaxy. In this tutorial we will use <strong>DADA2</strong>.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-processing-16s-amplicon-data-in-galaxy-using-other-tools-than-dada2"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Processing 16S amplicon data in Galaxy using other tools than DADA2</div>

  <p>Tutorials are available for the other tools in Galaxy:</p>
  <ul>
    <li><a href="https://docs.qiime2.org/jupyterbooks/cancer-microbiome-intervention-tutorial/index.html#">QIIME 2 Cancer Microbiome Intervention</a></li>
    <li><a href="https://docs.qiime2.org/2024.2/tutorials/moving-pictures-usage">QIIME 2 Moving Pictures</a></li>
    <li><a href="/training-material/topics/microbiome/tutorials/mothur-miseq-sop/tutorial.html">16S Microbial Analysis with mothur</a></li>
  </ul>

</blockquote>

<p>The output of the dada2 pipeline is a feature table of amplicon sequence variants (an ASV table): A matrix with columns corresponding to samples and rows to ASVs, in which the value of each entry is the number of times that ASV was observed in that sample. This table is analogous to the traditional OTU table, except that one gets the actual sequences of the “true” sequence variants instead of rather anonymous and abstract entities called OTU1, OTU2, etc.</p>

<p>The process of amplicon sequencing introduces errors into the sequencing data, and these errors 
severely complicate the interpretation of the results. <strong>DADA2</strong> implements a novel algorithm that models the errors introduced during amplicon sequencing, and uses that error model to infer the true sample composition.</p>

<p><strong>DADA2</strong> replaces the traditional “OTU-picking” step in amplicon sequencing workflows, producing instead higher-resolution tables of amplicon sequence variants (ASVs).</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-background-what-are-operational-taxonomic-units-otus"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Background: What are Operational Taxonomic Units (OTUs)?</div>

  <p>In 16S metagenomics approaches, OTUs are clusters of similar sequence variants of the 16S rDNA marker gene
sequence. Each of these clusters is intended to represent a taxonomic unit of a bacteria species or genus
depending on the sequence similarity threshold. Typically, OTU cluster are defined by a 97% identity
threshold of the 16S gene sequence variants at species level. 98% or 99% identity is suggested for strain
separation.</p>

  <p><img src="../../images/OTU_graph.png" alt="OTU graph" /></p>

  <p>(Image credit: Danzeisen et al. 2013, 10.7717/peerj.237)</p>
</blockquote>

<p>As seen in the paper introducing DADA2 (<span class="citation"><a href="#Callahan_2016">Callahan <i>et al.</i> 2016</a></span>) and in <a href="http://benjjneb.github.io/dada2/SotA.html">further benchmarking</a>, the <strong>DADA2</strong> method is more sensitive and specific than traditional OTU methods: DADA2 detects real biological variation missed by OTU methods while outputting fewer spurious sequences.</p>

<p>To illustrate the 16S amplicon data processing using <strong>DADA2</strong>, we will use dataset generated by the Schloss lab in their
<a href="https://www.mothur.org/wiki/MiSeq_SOP">their mothur MiSeq SOP</a>: FASTQ files generated by 2x250 Illumina Miseq amplicon sequencing of the V4 region of the 16S rRNA gene from gut samples collected longitudinally from a mouse post-weaning. They <a href="https://www.mothur.org/wiki/MiSeq_SOP#Logistics">describe the experiment</a> as follows:</p>

<blockquote class="quote">
  <p><em>The Schloss lab is interested in understanding the effect of normal variation in the gut microbiome on host health. To that end,
we collected fresh feces from mice on a daily basis for 365 days post weaning. During the first 150 days post weaning (dpw),
nothing was done to our mice except allow them to eat, get fat, and be merry. We were curious whether the rapid change in
weight observed during the first 10 dpw affected the stability microbiome compared to the microbiome observed between days
140 and 150.</em></p>

</blockquote>

<p>To speed up analysis for this tutorial, we will use only a subset of this data. We will look at a single mouse at 20 different time points (10 early, 10 late).</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#prepare-galaxy-and-data" id="markdown-toc-prepare-galaxy-and-data">Prepare Galaxy and data</a></li>
  <li><a href="#processing-data-using-dada2" id="markdown-toc-processing-data-using-dada2">Processing data using DADA2</a></li>
  <li><a href="#prepare-reads" id="markdown-toc-prepare-reads">Prepare reads</a>    <ol>
      <li><a href="#inspect-read-quality-profiles" id="markdown-toc-inspect-read-quality-profiles">Inspect read quality profiles</a></li>
      <li><a href="#filter-and-trim" id="markdown-toc-filter-and-trim">Filter and trim</a></li>
      <li><a href="#learn-the-error-rates" id="markdown-toc-learn-the-error-rates">Learn the Error Rates</a></li>
      <li><a href="#infer-sample-composition" id="markdown-toc-infer-sample-composition">Infer Sample Composition</a></li>
      <li><a href="#merge-paired-reads" id="markdown-toc-merge-paired-reads">Merge paired reads</a></li>
    </ol>
  </li>
  <li><a href="#make-sequence-table" id="markdown-toc-make-sequence-table">Make sequence table</a>    <ol>
      <li><a href="#remove-chimeras" id="markdown-toc-remove-chimeras">Remove chimeras</a></li>
      <li><a href="#track-reads-through-the-pipeline" id="markdown-toc-track-reads-through-the-pipeline">Track reads through the pipeline</a></li>
    </ol>
  </li>
  <li><a href="#assign-taxonomy" id="markdown-toc-assign-taxonomy">Assign taxonomy</a></li>
  <li><a href="#exploration-of-asvs-with-phyloseq" id="markdown-toc-exploration-of-asvs-with-phyloseq">Exploration of ASVs with phyloseq</a>    <ol>
      <li><a href="#prepare-metadata-table-and-launch-phyloseq" id="markdown-toc-prepare-metadata-table-and-launch-phyloseq">Prepare metadata table and launch phyloseq</a></li>
      <li><a href="#visualize-alpha-diversity" id="markdown-toc-visualize-alpha-diversity">Visualize alpha-diversity</a></li>
      <li><a href="#plot-ordination" id="markdown-toc-plot-ordination">Plot Ordination</a></li>
      <li><a href="#plot-abundance-stacked-barplot" id="markdown-toc-plot-abundance-stacked-barplot">Plot abundance stacked barplot</a></li>
    </ol>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ol>

</blockquote>

<h1 id="prepare-galaxy-and-data">Prepare Galaxy and data</h1>

<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Create a new history for this analysis</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a new history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>To create a new history simply click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel:</p>   <p><img src="/training-material/shared/images/history_create_new.svg" alt="UI for creating new history" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Rename the history</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Renaming a history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li>   <li>To cancel renaming, click the <i class="fas fa-undo" aria-hidden="true"></i><span class="visually-hidden">galaxy-undo</span> “Cancel” button</li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which can be the case if you are using an older version of Galaxy) do the following:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>The starting point for the <strong>DADA2</strong> pipeline is a set of demultiplexed FASTQ files corresponding to the samples in your amplicon sequencing study. That is, <strong>DADA2</strong> expects there to be an individual FASTQ file for each sample (or two FASTQ files, one forward and one reverse, for each sample). Demultiplexing is often performed at the sequencing center, but if that has not been done there are a variety of tools do accomplish this.</p>

<p>In addition, <strong>DADA2</strong> expects that there are no non-biological bases in the sequencing data. This may require pre-processing with outside software if, as is relatively common, your PCR primers were included in the sequenced amplicon region.</p>

<p>For this tutorial, we have 20 pairs of files. For example, the following pair of files:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">F3D0_S188_L001_R1_001.fastq</code></li>
  <li><code class="language-plaintext highlighter-rouge">F3D0_S188_L001_R2_001.fastq</code></li>
</ul>

<p>The first part of the file name indicates the sample: <code class="language-plaintext highlighter-rouge">F3D0</code> here signifies that this sample was obtained from Female 3 on Day 0.</p>

<p>The rest of the file name is identical, except for <code class="language-plaintext highlighter-rouge">_R1</code> and <code class="language-plaintext highlighter-rouge">_R2</code>, this is used to indicate the forward and reverse reads respectively.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-import-datasets"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Import datasets</div>

  <ol>
    <li>
      <p>Import the following samples via link from <a href="https://doi.org/10.5281/zenodo.800651">Zenodo</a> or Galaxy shared data libraries:</p>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-list-of-zenodo-urls"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-list-of-zenodo-urls" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution: List of Zenodo URLs</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/800651/files/F3D0_R1.fastq
https://zenodo.org/record/800651/files/F3D0_R2.fastq
https://zenodo.org/record/800651/files/F3D141_R1.fastq
https://zenodo.org/record/800651/files/F3D141_R2.fastq
https://zenodo.org/record/800651/files/F3D142_R1.fastq
https://zenodo.org/record/800651/files/F3D142_R2.fastq
https://zenodo.org/record/800651/files/F3D143_R1.fastq
https://zenodo.org/record/800651/files/F3D143_R2.fastq
https://zenodo.org/record/800651/files/F3D144_R1.fastq
https://zenodo.org/record/800651/files/F3D144_R2.fastq
https://zenodo.org/record/800651/files/F3D145_R1.fastq
https://zenodo.org/record/800651/files/F3D145_R2.fastq
https://zenodo.org/record/800651/files/F3D146_R1.fastq
https://zenodo.org/record/800651/files/F3D146_R2.fastq
https://zenodo.org/record/800651/files/F3D147_R1.fastq
https://zenodo.org/record/800651/files/F3D147_R2.fastq
https://zenodo.org/record/800651/files/F3D148_R1.fastq
https://zenodo.org/record/800651/files/F3D148_R2.fastq
https://zenodo.org/record/800651/files/F3D149_R1.fastq
https://zenodo.org/record/800651/files/F3D149_R2.fastq
https://zenodo.org/record/800651/files/F3D150_R1.fastq
https://zenodo.org/record/800651/files/F3D150_R2.fastq
https://zenodo.org/record/800651/files/F3D1_R1.fastq
https://zenodo.org/record/800651/files/F3D1_R2.fastq
https://zenodo.org/record/800651/files/F3D2_R1.fastq
https://zenodo.org/record/800651/files/F3D2_R2.fastq
https://zenodo.org/record/800651/files/F3D3_R1.fastq
https://zenodo.org/record/800651/files/F3D3_R2.fastq
https://zenodo.org/record/800651/files/F3D5_R1.fastq
https://zenodo.org/record/800651/files/F3D5_R2.fastq
https://zenodo.org/record/800651/files/F3D6_R1.fastq
https://zenodo.org/record/800651/files/F3D6_R2.fastq
https://zenodo.org/record/800651/files/F3D7_R1.fastq
https://zenodo.org/record/800651/files/F3D7_R2.fastq
https://zenodo.org/record/800651/files/F3D8_R1.fastq
https://zenodo.org/record/800651/files/F3D8_R2.fastq
https://zenodo.org/record/800651/files/F3D9_R1.fastq
https://zenodo.org/record/800651/files/F3D9_R2.fastq
https://zenodo.org/record/800651/files/Mock_R1.fastq
https://zenodo.org/record/800651/files/Mock_R2.fastq
</code></pre></div>        </div>
      </blockquote>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing via links</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-data-from-a-data-library"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-data-from-a-data-library" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing data from a data library</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class="fas fa-caret-down" aria-hidden="true"></i><span class="visually-hidden">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>40 files are a lot of files to manage. Luckily Galaxy can make life a bit easier by allowing us to create <strong>dataset collections</strong>. This enables us to easily run tools on multiple datasets at once.</p>

<p>Since we have <strong>paired-end</strong> data, each sample consist of two separate FASTQ files:</p>
<ul>
  <li>one containing the forward reads, and</li>
  <li>one containing the reverse reads.</li>
</ul>

<p>We can recognize the pairing from the file names, which will differ only by <code class="language-plaintext highlighter-rouge">_R1</code> or <code class="language-plaintext highlighter-rouge">_R2</code> in the filename. We can tell Galaxy about this paired naming convention, so that our tools will know which files belong together. We do this by building a <strong>List of Dataset Pairs</strong></p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-organizing-our-data-into-a-sorted-paired-collection"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Organizing our data into a sorted paired collection</div>

  <ol>
    <li>
      <p>Create a paired collection named <code class="language-plaintext highlighter-rouge">Raw Reads</code>, rename your pairs with the sample name</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-paired-collection"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-paired-collection" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a paired collection</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src="/training-material/topics/galaxy-interface/images/historyItemControls.png" alt="Select Items button" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li><span class="tool" data-tool="__SORTLIST__" title="Sort collection tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Sort collection</strong></span> with the following parameters:
      <ul>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Input Collection”</em>: <code class="language-plaintext highlighter-rouge">Raw Reads</code></li>
      </ul>
    </li>
    <li>
      <p>Rename output collection to <code class="language-plaintext highlighter-rouge">Sorted Raw Reads</code></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-collection"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-collection" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Renaming a collection</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on the collection</li>   <li>Click on the name of the collection at the top</li>   <li>Change the name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>We can now start processing the reads using <strong>DADA2</strong>.</p>

<blockquote class="notranslate hands_on gtn-cyoa" id="gtn-cyoaworkflow">
	<div class="box-title" aria-label="hands-on box: choose your own tutorial"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"></span> Hands-on: Choose Your Own Tutorial</div>
	<p>This is a "Choose Your Own Tutorial" section, where you can select between multiple paths. Click one of the buttons below to select how you want to follow the tutorial</p>
	
	<p>
		Do you want to go step-by-step or using a workflow?
	</p>
	
	
		<input id="cyoa-opt1workflow" type="radio" name="cyoaworkflow" value="Step-by-step" onclick="cyoaChoice('Step-by-step', 'gtn-cyoaworkflow')" />
		<label for="cyoa-opt1workflow" class="select btn btn-secondary">Step-by-step</label>
	
	
		<input id="cyoa-opt2workflow" type="radio" name="cyoaworkflow" value="Workflow" onclick="cyoaChoice('Workflow', 'gtn-cyoaworkflow')" />
		<label for="cyoa-opt2workflow" class="select btn btn-secondary">Workflow</label>
	
	
	

	
	<script>
		function ready(fn) {
			if (document.readyState != 'loading'){
				fn();
			} else {
				document.addEventListener('DOMContentLoaded', fn);
			}
		}
		ready(function() {
			cyoaDefault("Step-by-step", "gtn-cyoaworkflow");
		})
	</script>
	
</blockquote>

<h1 id="processing-data-using-dada2">Processing data using DADA2</h1>

<p>Once demultiplexed FASTQ files without non-biological nucleotides are in hand, the <strong>DADA2</strong> pipeline proceeds as follows:</p>

<ol>
  <li>Prepare reads
    <ol>
      <li>Inspect read quality profiles</li>
      <li>Filter and trim</li>
      <li>Learn the Error Rates</li>
      <li>Infer sample composition</li>
      <li>Merge forward/reverse reads</li>
    </ol>
  </li>
  <li>Construct sequence table
    <ol>
      <li>Make sequence table</li>
      <li>Remove chimeras</li>
    </ol>
  </li>
  <li>Assign taxonomy</li>
  <li>Evaluate accuracy</li>
</ol>

<div class="Workflow">

  <!--SNIPPET-->
  <blockquote class="notranslate hands_on">   <div class="box-title hands_on-title" id="hands-on-importing-and-launching-a-workflowhub-eu-workflow"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Importing and Launching a WorkflowHub.eu Workflow</div>   <!-- GTN:IGNORE:011 _blank is used here due to iframeing sites that (can) set x-frame-options. The contexts in which _blank is set are only visible when iframe'd -->   <div class="show-when-galaxy-proxy-active"> <span class="workflow" data-workflow="https://workflowhub.eu/ga4gh/trs/v2/tools/790/versions/2">   Launch <strong>dada2/main (v2)</strong> <i class="fas fa-share-alt" aria-hidden="true"></i> </span> (<a target="_blank" href="https://workflowhub.eu/workflows/790?version=2">View on WorkflowHub</a>) </div>   <div class="hide-when-galaxy-proxy-active"> <a href="https://my.galaxy.training/?path=/workflows/trs_import%3ftrs_server=workflowhub.eu%26run_form=true%26trs_id=790%26trs_version=2">   Launch <strong>dada2/main (v2)</strong> <i class="fas fa-share-alt" aria-hidden="true"></i> </a> (<a href="https://workflowhub.eu/workflows/790?version=2">View on WorkflowHub</a>) </div>   <!--SNIPPET-->   <blockquote class="tip">   <div class="box-title tip-title" id="tip-if-this-does-not-work"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-if-this-does-not-work" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: If this does not work</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p><a href="https://workflowhub.eu/">WorkflowHub</a> is a workflow management system which allows workflows to be FAIR (Findable, Accessible, Interoperable, and Reusable), citable, have managed metadata profiles, and be openly available for review and analytics.</p>   <ol>   <li>Ensure that you are logged in to your Galaxy account.</li>   <li>Click on the <strong>Workflow</strong> menu, located in the top bar.</li>   <li>Click on the <strong>Import</strong> button, located in the right corner.</li>   <li>In the section “Import a Workflow from Configured GA4GH Tool Registry Servers (e.g. Dockstore)”, click on <strong>Search form</strong>.</li>   <li>In the <strong>TRS Server: <em>workflowhub.eu</em></strong> menu you should type <code class="language-plaintext highlighter-rouge">name:"dada2/main"</code> <img src="/training-material/topics/assembly/images/vgp_assembly/workflow_list.png" alt="galaxy TRS workflow search field, name:vgp is entered in the search bar, and five different workflows all labelled VGP are listed" /></li>   <li>Click on the desired workflow, and finally select the latest available version.</li> </ol>   <p>After that, the imported workflows will appear in the main workflow menu. In order to run the workflow, just need to click in the <i class="fas fa-play" aria-hidden="true"></i><span class="visually-hidden">workflow-run</span> <strong>Run workflow</strong> icon.</p>   <p>Below is a short video showing this uncomplicated procedure:</p>   <figure> <iframe credentialless="" allowfullscreen="" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" allow="accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; bluetooth 'none'; browsing-topics 'none'; camera 'none'; ch-ua 'none'; display-capture 'none'; domain-agent 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; gamepad 'none'; geolocation 'none'; gyroscope 'none'; hid 'none'; identity-credentials-get 'none'; idle-detection 'none'; keyboard-map 'none'; local-fonts 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; otp-credentials 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-create 'none'; publickey-credentials-get 'none'; screen-wake-lock 'none'; serial 'none'; speaker-selection 'none'; sync-xhr 'none'; usb 'none'; web-share 'none'; window-management 'none'; xr-spatial-tracking 'none'" csp="sandbox allow-scripts allow-same-origin;" width="560" height="315" src="https://www.youtube-nocookie.com/embed/hoP36Te5wko" title="Importing from WorkflowHub" frameborder="0" loading="lazy"></iframe> <figcaption>   <span class="figcaption-prefix"><strong>Video</strong>:</span> Importing from WorkflowHub</figcaption> </figure> </blockquote>   <p><!--END_SNIPPET--></p> </blockquote>
  <p><!--END_SNIPPET--></p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-define-dada2-workflow-parameters"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Define DADA2 workflow parameters</div>

    <ol>
      <li>Select following parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Paired short read data”</em>: <code class="language-plaintext highlighter-rouge">Raw Reads</code></li>
          <li><em>“Read length forward read”</em>: <code class="language-plaintext highlighter-rouge">240</code></li>
          <li><em>“Read length reverse read”</em>: <code class="language-plaintext highlighter-rouge">160</code></li>
          <li><em>“Pool samples”</em>: <code class="language-plaintext highlighter-rouge">process samples individually</code></li>
          <li><em>“Cached reference database”</em>: <code class="language-plaintext highlighter-rouge">Silva version 132</code></li>
        </ul>
      </li>
      <li>Run the workflow</li>
    </ol>
  </blockquote>

  <p>The workflow generates several outputs that we will inspect them given the step they correspond to.</p>

</div>

<h1 id="prepare-reads">Prepare reads</h1>

<p>The first step is to check and improve the quality of data.</p>

<h2 id="inspect-read-quality-profiles">Inspect read quality profiles</h2>

<p>We start by visualizing the quality profiles of the forward reads:</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-inspect-read-quality-profiles"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Inspect read quality profiles</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_plotqualityprofile/dada2_plotQualityProfile/1.28+galaxy0" title="dada2: plotQualityProfile tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: plotQualityProfile</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><em>“Processing mode”</em>: <code class="language-plaintext highlighter-rouge">Joint</code>
            <ul>
              <li><em>“Paired reads”</em>: <code class="language-plaintext highlighter-rouge">paired - in a data set pair</code>
                <ul>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Paired short read data”</em>: <code class="language-plaintext highlighter-rouge">Sorted Raw Reads</code></li>
                </ul>
              </li>
              <li><em>“Aggregate data”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
            </ul>
          </li>
          <li><em>“sample number”</em>: <code class="language-plaintext highlighter-rouge">10000000</code></li>
        </ul>
      </li>
    </ol>
  </blockquote>
</div>

<p><strong>dada2: plotQualityProfile</strong> generates 2 files with quality profiles per sample: 1 PDF for forward reads and 1 PDF for reverse reads.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-inspect-read-quality-profiles-1"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Inspect read quality profiles</div>

  <ol>
    <li>Inspect <strong>plotQualityProfile</strong> forward read output</li>
  </ol>
</blockquote>

<p><a href="./images/plotQualityProfile_forward.png" rel="noopener noreferrer"><img src="./images/plotQualityProfile_forward.png" alt="Quality Profiles for the forward reads of all samples with read length on the X-axis and Quality score on the Y-axis. " width="2694" height="2008" loading="lazy" /></a></p>

<p>In gray-scale is a heatmap of the frequency of each quality score at each base position. The mean quality score at each position is shown by the green line, and the quartiles of the quality score distribution by the orange lines. The red line shows the scaled proportion of reads that extend to at least that position (this is more useful for other sequencing technologies, as Illumina reads are typically all the same length, hence the flat red line).</p>

<blockquote class="question">
  <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>Are the forward reads good quality?</li>
    <li>We generally advise trimming the last few nucleotides to avoid less well-controlled errors that can arise there. What would you recommend as threshold?</li>
    <li>Are the reverse reads good quality?</li>
    <li>What would you recommend as threshold for trimming?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>The forward reads are good quality</li>
      <li>These quality profiles do not suggest that any additional trimming is needed. We will truncate the forward reads at position 240 (trimming the last 10 nucleotides).</li>
      <li>
        <p>The reverse reads are of significantly worse quality, especially at the end, which is common in Illumina sequencing. This isn’t too worrisome, as DADA2 incorporates quality information into its error model which makes the algorithm robust to lower quality sequence, but trimming as the average qualities crash will improve the algorithm’s sensitivity to rare sequence variants.</p>

        <p><a href="./images/plotQualityProfile_reverse.png" rel="noopener noreferrer"><img src="./images/plotQualityProfile_reverse.png" alt="Quality Profiles for the reverse reads of all samples with read length on the X-axis and Quality score on the Y-axis. " width="2696" height="2024" loading="lazy" /></a></p>
      </li>
      <li>Based on the profiles, we will truncate the reverse reads at position 160 where the quality distribution crashes.</li>
    </ol>

  </blockquote>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-considerations-for-your-own-data"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Considerations for your own data</div>

  <p>Your reads must still overlap after truncation in order to merge them later! The tutorial is using 2x250 V4 (expected size, 270 bp–387 bp) sequence data, so the forward and reverse reads almost completely overlap and our trimming can be completely guided by the quality scores. If you are using a less-overlapping primer set, like V1-V2 or V3-V4, your truncated length must be large enough to maintain \(20 + biological.length.variation\) nucleotides of overlap between them.</p>

</blockquote>

<h2 id="filter-and-trim">Filter and trim</h2>

<div class="Step-by-step">

  <p>Let’s now trim and filter the reads:</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-filter-and-trim"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Filter and trim</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_filterandtrim/dada2_filterAndTrim/1.28+galaxy0" title="dada2: filterAndTrim tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: filterAndTrim</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><em>“Paired reads”</em>: <code class="language-plaintext highlighter-rouge">paired - in a data set pair</code>
            <ul>
              <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Paired short read data”</em>: <code class="language-plaintext highlighter-rouge">Sorted Raw Reads</code></li>
            </ul>
          </li>
          <li>In <em>“Trimming parameters”</em>:
            <ul>
              <li><em>“Truncate read length”</em>: <code class="language-plaintext highlighter-rouge">240</code></li>
            </ul>
          </li>
          <li>In <em>“Filtering parameters”</em>:
            <ul>
              <li>
                <p><em>“Remove reads by number expected errors”</em>: <code class="language-plaintext highlighter-rouge">2</code></p>

                <p>This parameter sets the maximum number of “expected errors” allowed in a read, which is <a href="https://academic.oup.com/bioinformatics/article/31/21/3476/194979">a better filter than simply averaging quality scores</a>.</p>
              </li>
            </ul>
          </li>
          <li><em>“Separate filters and trimmers for reverse reads”</em>: <code class="language-plaintext highlighter-rouge">Yes</code>
            <ul>
              <li>In <em>“Trimming parameters”</em>:
                <ul>
                  <li><em>“Truncate read length”</em>: <code class="language-plaintext highlighter-rouge">160</code></li>
                </ul>
              </li>
              <li>In <em>“Filtering parameters”</em>:
                <ul>
                  <li><em>“Remove reads by number expected errors”</em>: <code class="language-plaintext highlighter-rouge">2</code></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ol>

  </blockquote>

  <blockquote class="comment">
    <div class="box-title comment-title" id="comment-speeding-up-downstream-computation"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Speeding up downstream computation</div>

    <p>The standard filtering parameters are starting points, not set in stone. If you want to speed up downstream computation, consider tightening the <em>“Remove reads by number expected errors”</em> value. If too few reads are passing the filter, consider relaxing the value, perhaps especially on the reverse reads (e.g. <em>“Remove reads by number expected errors”</em> to <code class="language-plaintext highlighter-rouge">2</code> for forward and <code class="language-plaintext highlighter-rouge">5</code> for reverse), and reducing the <em>“Truncate read length”</em> to remove low quality tails. Remember though, when choosing <em>“Truncate read length”</em> for paired-end reads you must maintain overlap after truncation in order to merge them later.</p>

  </blockquote>

  <blockquote class="comment">
    <div class="box-title comment-title" id="comment-its-data"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: ITS data</div>

    <p>For ITS sequencing, it is usually undesirable to truncate reads to a fixed length due to the large length variation at that locus. That is OK, just leave out  <em>“Truncate read length”</em>. See the <a href="https://benjjneb.github.io/dada2/ITS_workflow.html">DADA2 ITS workflow</a> for more information</p>

  </blockquote>

</div>

<p><strong>dada2: filterAndTrim</strong> generates 2 outputs:</p>
<ul>
  <li>1 paired-collection named <code class="language-plaintext highlighter-rouge">Paired reads</code> with the trimmed and filtered reads</li>
  <li>
    <p>1 collection with statistics for each sample</p>

    <blockquote class="question">
      <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <ol>
        <li>How many reads were in F3D0 sample before Filter and Trim?</li>
        <li>How many reads are in F3D0 sample after Filter and Trim?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>In F3D0 element in the collection, we see:</p>
        <ol>
          <li><code class="language-plaintext highlighter-rouge">reads.in</code>: 7793</li>
          <li><code class="language-plaintext highlighter-rouge">reads.out</code>: 7113</li>
        </ol>

      </blockquote>

    </blockquote>
  </li>
</ul>

<p>To better see the impact of filtering and trimming, we can inspect the read quality profiles and compare to the profiles before.</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-inspect-read-quality-profiles-after-filter-and-trim"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Inspect read quality profiles after Filter And Trim</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_plotqualityprofile/dada2_plotQualityProfile/1.28+galaxy0" title="dada2: plotQualityProfile tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: plotQualityProfile</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><em>“Processing mode”</em>: <code class="language-plaintext highlighter-rouge">Joint</code>
            <ul>
              <li><em>“Paired reads”</em>: <code class="language-plaintext highlighter-rouge">paired - in a data set pair</code>
                <ul>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Paired short read data”</em>: <code class="language-plaintext highlighter-rouge">Paired reads</code> output of <strong>dada2: filterAndTrim</strong></li>
                </ul>
              </li>
              <li><em>“Aggregate data”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
            </ul>
          </li>
          <li><em>“sample number”</em>: <code class="language-plaintext highlighter-rouge">10000000</code></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<blockquote class="question">
  <div class="box-title question-title" id="question-2"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>Looking at outputs of <strong>plotQualityProfile</strong> for reverse reads before and after <strong>dada2: filterAndTrim</strong></p>

  <!--SNIPPET-->
  <blockquote class="tip">   <div class="box-title tip-title" id="tip-using-the-window-manager-to-view-multiple-datasets"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-using-the-window-manager-to-view-multiple-datasets" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Using the Window Manager to view multiple datasets</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>If you would like to view two or more datasets at once, you can use the <strong>Window Manager</strong> feature in Galaxy:</p>   <ol>   <li><strong>Click</strong> on the <em>Window Manager</em> icon <i class="fas fa-th" aria-hidden="true"></i><span class="visually-hidden">galaxy-scratchbook</span> on the top menu bar.     <ul>       <li>You should see a little checkmark on the icon now</li>     </ul>   </li>   <li><strong>View</strong> <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> a dataset by clicking on the eye icon <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> to view the output     <ul>       <li>You should see the output in a window overlayed over Galaxy</li>       <li>You can resize this window by dragging the bottom-right corner</li>     </ul>   </li>   <li><strong>Click</strong> outside the file to exit the Window Manager</li>   <li><strong>View</strong> <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">galaxy-eye</span> a second dataset from your history     <ul>       <li>You should now see a second window with the new dataset</li>       <li>This makes it easier to compare the two outputs</li>     </ul>   </li>   <li>Repeat this for as many files as you would like to compare</li>   <li>You can turn off the <strong>Window Manager</strong> <i class="fas fa-th" aria-hidden="true"></i><span class="visually-hidden">galaxy-scratchbook</span> by clicking on the icon again</li> </ol> </blockquote>
  <p><!--END_SNIPPET--></p>

  <figure id="figure-1" style="max-width: 90%;"><img src="./images/plotQualityProfile_reverse.png" alt="Quality Profiles for forward reads of all samples with read length on the X-axis and Quality score on the Y-axis. " width="2696" height="2024" loading="lazy" /><a target="_blank" href="./images/plotQualityProfile_reverse.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 1</strong>:</span> Quality profiles for reverse reads before trimming and filtering</figcaption></figure>

  <figure id="figure-2" style="max-width: 90%;"><img src="./images/plotQualityProfile_reverse_after_filter_trim.png" alt="Quality Profiles for reverse reads of all samples with read length on the X-axis and Quality score on the Y-axis. " width="2696" height="2034" loading="lazy" /><a target="_blank" href="./images/plotQualityProfile_reverse_after_filter_trim.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 2</strong>:</span> Quality profiles for reverse reads after trimming and filtering</figcaption></figure>

  <p>How did trimming and filtering change the quality profiles for reverse reads?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>The reads have been trimmed making the profiles looking better.</p>

  </blockquote>

</blockquote>

<h2 id="learn-the-error-rates">Learn the Error Rates</h2>

<p>The DADA2 algorithm makes use of a parametric error model (<code class="language-plaintext highlighter-rouge">err</code>) and every amplicon dataset has a different set of error rates. The <strong>dada2: learnErrors</strong> method learns this error model from the data, by alternating estimation of the error rates and inference of sample composition until they converge on a jointly consistent solution. As in many machine-learning problems, the algorithm must begin with an initial guess, for which the maximum possible error rates in this data are used (the error rates if only the most abundant sequence is correct and all the rest are errors).</p>

<div class="Step-by-step">

  <p><strong>dada2: learnErrors</strong> tool expects as input one collection and not a paired collection. We then need to split to paired collection into 2 collections: one with forward reads and one with reverse reads.</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-unzip-paired-collection"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Unzip paired collection</div>

    <ol>
      <li><span class="tool" data-tool="__UNZIP_COLLECTION__" title="Unzip collection tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Unzip collection</strong></span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Paired input to unzip”</em>: <code class="language-plaintext highlighter-rouge">Paired reads</code> output of <strong>dada2: filterAndTrim</strong></li>
        </ul>
      </li>
      <li>
        <p>Tag the <code class="language-plaintext highlighter-rouge">(forward)</code> collection with <code class="language-plaintext highlighter-rouge">#forward</code></p>

        <!--SNIPPET-->
        <blockquote class="tip">   <div class="box-title tip-title" id="tip-adding-a-tag-to-a-collection"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-adding-a-tag-to-a-collection" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Adding a tag to a collection</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on the collection in your history to view it</li>   <li>Click on <strong>Edit</strong> <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> next to the collection name at the top of the history panel</li>   <li>Click on <strong>Add Tags</strong> <i class="fas fa-tags" aria-hidden="true"></i><span class="visually-hidden">galaxy-tags</span></li>   <li>Add a tag  named <code class="language-plaintext highlighter-rouge">#forward</code>     <ul>       <li>Tags starting with <code class="language-plaintext highlighter-rouge">#</code> will be automatically propagated to the outputs any tools using this dataset.</li>     </ul>   </li>   <li>Click <strong>Save</strong> <i class="far fa-save" aria-hidden="true"></i><span class="visually-hidden">galaxy-save</span></li>   <li>Check that the tag appears below the collection name</li> </ol> </blockquote>
        <p><!--END_SNIPPET--></p>
      </li>
      <li>Tag the <code class="language-plaintext highlighter-rouge">(reverse)</code> collection with <code class="language-plaintext highlighter-rouge">#reverse</code></li>
    </ol>
  </blockquote>

  <p>Let’s now run <strong>dada2: learnErrors</strong> on both collections.</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-learn-the-error-rate"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Learn the Error Rate</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/1.28+galaxy0" title="dada2: learnErrors tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: learnErrors</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Short read data”</em>: <code class="language-plaintext highlighter-rouge">forward</code> output of <strong>Unzip collection</strong></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_learnerrors/dada2_learnErrors/1.28+galaxy0" title="dada2: learnErrors tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: learnErrors</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Short read data”</em>: <code class="language-plaintext highlighter-rouge">reverse</code> output of <strong>Unzip collection</strong></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<figure id="figure-3" style="max-width: 90%;"><img src="./images/learnErrors_forward.png" alt="Error rates for each possible transition as a function of the associated quality score, the final estimated error rates, the initial input rates, and the expected error rates under the nominal definition of quality scores. " width="2694" height="2024" loading="lazy" /><a target="_blank" href="./images/learnErrors_forward.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 3</strong>:</span> Error rates for each possible transition for the forward reads</figcaption></figure>

<p>The error rates for each possible transition (A-&gt;C, A-&gt;G, …) are shown as a function of the associated quality score, the final estimated error rates (if they exist), the initial input rates, and the expected error rates under the nominal definition of quality scores. Points are the observed error rates for each consensus quality score. The black line shows the estimated error rates after convergence of the machine-learning algorithm. The red line shows the error rates expected under the nominal definition of the Q-score.</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-3"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>Are the estimated error rates (black line) in a good fit to the observed rates (points) for the forward reads?</li>
    <li>
      <p>What about the reverse reads?</p>

      <figure id="figure-4" style="max-width: 90%;"><img src="./images/learnErrors_reverse.png" alt="Error rates for each possible transition as a function of the associated quality score, the final estimated error rates, the initial input rates, and the expected error rates under the nominal definition of quality scores. " width="2690" height="2020" loading="lazy" /><a target="_blank" href="./images/learnErrors_reverse.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 4</strong>:</span> Error rates for each possible transition for the reverse reads</figcaption></figure>
    </li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>The estimated error rates (black line) are a good fit to the observed rates (points), and the error rates drop with increased quality as expected. Everything looks reasonable and we proceed with confidence.</li>
      <li>Same</li>
    </ol>

  </blockquote>

</blockquote>

<h2 id="infer-sample-composition">Infer Sample Composition</h2>

<p>In this step, the core sample inference algorithm (<span class="citation"><a href="#Callahan_2016">Callahan <i>et al.</i> 2016</a></span>) is applied to the filtered and trimmed sequence data.</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-sample-inference"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Sample Inference</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/1.28+galaxy0" title="dada2: dada tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: dada</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li>
            <p><em>“Process samples in batches”</em>: <code class="language-plaintext highlighter-rouge">no</code></p>

            <blockquote class="comment">
              <div class="box-title comment-title" id="comment-process-samples-in-batches-or-not"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Process samples in batches or not</div>

              <p>Choosing <code class="language-plaintext highlighter-rouge">yes</code> for <em>“Process samples in batches”</em> gives identical results as <code class="language-plaintext highlighter-rouge">no</code> if samples are not pooled.</p>

              <ul>
                <li><code class="language-plaintext highlighter-rouge">no</code>: a single Galaxy job is started where the samples are processed sequentially</li>
                <li><code class="language-plaintext highlighter-rouge">yes</code>: a separate Galaxy job is started for each sample (given compute resources, this can be much faster)</li>
              </ul>

              <p>If <code class="language-plaintext highlighter-rouge">yes</code>, the sorting of the collection is not needed.</p>

            </blockquote>

            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reads”</em>: output of <strong>Unzip collection</strong> with <code class="language-plaintext highlighter-rouge">#forward</code> tag</li>
              <li>
                <p><em>“Pool samples”</em>: <code class="language-plaintext highlighter-rouge">process samples individually</code></p>

                <blockquote class="comment">
                  <div class="box-title comment-title" id="comment-sample-pooling"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Sample pooling</div>

                  <p>By default, the <strong>dada2: dada</strong> function processes each sample independently. However, pooling information across samples can increase sensitivity to sequence variants that may be present at very low frequencies in multiple samples. Two types of pooling are possible:</p>

                  <ul>
                    <li><code class="language-plaintext highlighter-rouge">pool sample</code>: standard pooled processing, in which all samples are pooled together for sample inference</li>
                    <li><code class="language-plaintext highlighter-rouge">pseudo pooling between individually processed samples</code>: pseudo-pooling, in which samples are processed independently after sharing information between samples, approximating pooled sample inference in linear time.</li>
                  </ul>

                </blockquote>
              </li>
            </ul>
          </li>
          <li>
            <p><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Error rates”</em>: output of <strong>dada2: learnErrors</strong> with <code class="language-plaintext highlighter-rouge">#forward</code> tag</p>
          </li>
        </ul>
      </li>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_dada/dada2_dada/1.28+galaxy0" title="dada2: dada tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: dada</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><em>“Process samples in batches”</em>: <code class="language-plaintext highlighter-rouge">no</code>
            <ul>
              <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reads”</em>: output of <strong>Unzip collection</strong> with <code class="language-plaintext highlighter-rouge">#reverse</code> tag</li>
              <li><em>“Pool samples”</em>: <code class="language-plaintext highlighter-rouge">process samples individually</code></li>
            </ul>
          </li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Error rates”</em>: output of <strong>dada2: learnErrors</strong> with <code class="language-plaintext highlighter-rouge">#reverse</code> tag</li>
        </ul>
      </li>
    </ol>
  </blockquote>

</div>

<p>We can look at the number of true sequence variants from unique sequences have been inferred by <strong>DADA2</strong>.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-inspect-number-of-true-sequence-variants-from-unique-sequences"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Inspect number of true sequence variants from unique sequences</div>

  <ol>
    <li>Click one output collection of <strong>dada2: dada</strong></li>
    <li>Click on <i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> <em>Show Details</em></li>
    <li>Expand <em>Tool Standard Output</em></li>
  </ol>
</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question-4"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>How many unique sequences are in forward reads for sample F3D0?</li>
    <li>How many true sequence variants from unique sequences have been inferred by DADA2 for this dataset?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-4"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-4" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>7113 reads in 1979 unique sequences</li>
      <li>128 sequence variants were inferred from 1979 input unique sequences.</li>
    </ol>

  </blockquote>

</blockquote>

<h2 id="merge-paired-reads">Merge paired reads</h2>

<p>We now merge the forward and reverse reads together to obtain the full denoised sequences. Merging is performed by aligning the denoised forward reads with the reverse-complement of the corresponding denoised reverse reads, and then constructing the merged “contig” sequences. By default, merged sequences are only output if the forward and reverse reads overlap by at least 12 bases, and are identical to each other in the overlap region (but these conditions can be changed via tool parameters).</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-merge-paired-reads"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Merge paired reads</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_mergepairs/dada2_mergePairs/1.28+galaxy0" title="dada2: mergePairs tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: mergePairs</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Dada results for forward reads”</em>: output of <strong>dada2: dada</strong> with <code class="language-plaintext highlighter-rouge">#forward</code> tag</li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Forward reads”</em>: output of <strong>Unzip collection</strong> with <code class="language-plaintext highlighter-rouge">#forward</code> tag</li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Dada results for reverse reads”</em>:  output of <strong>dada2: dada</strong> with <code class="language-plaintext highlighter-rouge">#reverse</code> tag</li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Reverse reads”</em>: output of <strong>Unzip collection</strong> with <code class="language-plaintext highlighter-rouge">#reverse</code> tag</li>
          <li>
            <p><em>“Concatenated rather than merge”</em>: <code class="language-plaintext highlighter-rouge">No</code></p>

            <blockquote class="comment">
              <div class="box-title comment-title" id="comment-non-overlapping-reads"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Non-overlapping reads</div>

              <p>Non-overlapping reads are supported, but not recommended. In this case, <em>“Concatenated rather than merge”</em> should be <code class="language-plaintext highlighter-rouge">Yes</code>.</p>

            </blockquote>
          </li>
          <li><em>“Output detailed table”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        </ul>
      </li>
    </ol>
  </blockquote>

</div>

<p>Let’s inspect the merged data, more specifically the table in <code class="language-plaintext highlighter-rouge">details</code> collection</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-5"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>How many reads have been merged?</li>
    <li>What are the different columns in the detail table for F3D0?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-5"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-5" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>The detail table for F3D0 has 108 lines including a header. So 107 reads (over 128) have been merged</li>
      <li>The table contains:
        <ol>
          <li>merged sequence,</li>
          <li>its abundance,</li>
          <li>the indices of the forward sequence variants that were merged</li>
          <li>the indices of the reverse sequence variants that were merged</li>
          <li>number of match in the alignment between forward and reverse</li>
          <li>number of mismatch in the alignment between forward and reverse</li>
          <li>number of indels in the alignment between forward and reverse</li>
          <li>prefer</li>
          <li>status to accept</li>
        </ol>

        <p>Paired reads that did not exactly overlap were removed by mergePairs, further reducing spurious output.</p>
      </li>
    </ol>

  </blockquote>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-not-enough-reads-merged"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Not enough reads merged</div>

  <p>Most of the reads should successfully merge. If that is not the case upstream parameters may need to be revisited: Did you trim away the overlap between your reads?</p>

</blockquote>

<h1 id="make-sequence-table">Make sequence table</h1>

<p>In this step, we construct an amplicon sequence variant table (ASV) table, a higher-resolution version of the OTU table produced by traditional methods.</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-make-sequence-table"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Make sequence table</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_makesequencetable/dada2_makeSequenceTable/1.28+galaxy0" title="dada2: makeSequenceTable tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: makeSequenceTable</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“samples”</em>: output of <strong>dada2: mergePairs</strong></li>
          <li><em>“Length filter method”</em>: <code class="language-plaintext highlighter-rouge">No filter</code></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<p><strong>dada2: makeSequenceTable</strong> generates 2 outputs:</p>
<ol>
  <li>
    <p>A sequence table: a matrix with rows corresponding to (and named by) the samples, and columns corresponding to (and named by) the sequence variants.</p>

    <blockquote class="question">
      <div class="box-title question-title" id="question-6"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <p>How many ASVs have been identified?</p>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-6"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-6" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <p>The file contains 294 lines, including an header. So 293 ASVs have been identified.</p>

      </blockquote>

    </blockquote>
  </li>
  <li>
    <p>An image with sequence length distribution</p>

    <p><a href="./images/sequence_length_distribution.png" rel="noopener noreferrer"><img src="./images/sequence_length_distribution.png" alt="Histogram representing sequence length distribution. " width="2128" height="2138" loading="lazy" /></a></p>

    <blockquote class="question">
      <div class="box-title question-title" id="question-7"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <ol>
        <li>What is the range of merged sequences?</li>
        <li>Does the range make sense given the type of amplicon?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-7"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-7" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ol>
          <li>The lengths of merged sequences are between 251 and 255bp</li>
          <li>The range falls within the expected range for this V4 amplicon.</li>
        </ol>

      </blockquote>

    </blockquote>

    <blockquote class="comment">
      <div class="box-title comment-title" id="comment-sequences-too-long-or-too-short"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Sequences too long or too short</div>

      <p>Sequences that are much longer or shorter than expected may be the result of non-specific priming. Non-target-length sequences can be removed directly from the sequence table. This is analogous to “cutting a band” in-silico to get amplicons of the targeted length.</p>

    </blockquote>
  </li>
</ol>

<h2 id="remove-chimeras">Remove chimeras</h2>

<p>The core DADA method corrects substitution and indel errors, but chimeras remain. Fortunately, the accuracy of sequence variants after denoising makes identifying chimeric ASVs simpler than when dealing with fuzzy OTUs. Chimeric sequences are identified if they can be exactly reconstructed by combining a left-segment and a right-segment from two more abundant “parent” sequences.</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-remove-chimeras"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Remove chimeras</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_removebimeradenovo/dada2_removeBimeraDenovo/1.28+galaxy0" title="dada2: removeBimeraDenovo tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: removeBimeraDenovo</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“sequence table”</em>: output of <strong>dada2: makeSequenceTable</strong></li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<blockquote class="question">
  <div class="box-title question-title" id="question-8"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>How many non chimeric reads have been found?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-8"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-8" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>remaining nonchimeric:  96.40374 % (visible when expanding the dataset in history)</p>

  </blockquote>

</blockquote>

<p>The frequency of chimeric sequences varies substantially from dataset to dataset, and depends on on factors including experimental procedures and sample complexity. Here chimeras make up about 21% of the merged sequence variants, but when we account for the abundances of those variants we see they account for only about 4% of the merged sequence reads.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-sequences-too-long-or-too-short-1"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Sequences too long or too short</div>

  <p>Most of the <strong>reads</strong> should remain after chimera removal (it is not uncommon for a majority of <strong>sequence variants</strong> to be removed though). If most of the reads were removed as chimeric, upstream processing may need to be revisited. In almost all cases this is caused by primer sequences with ambiguous nucleotides that were not removed prior to beginning the DADA2 pipeline.</p>

</blockquote>

<h2 id="track-reads-through-the-pipeline">Track reads through the pipeline</h2>

<p>As a final check of our progress, we’ll look at the number of reads that made it through each step in the pipeline.</p>

<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-track-reads-through-the-pipeline"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Track reads through the pipeline</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_seqcounts/dada2_seqCounts/1.28+galaxy0" title="dada2: sequence counts tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: sequence counts</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li>In <em>“data sets”</em>:
            <ul>
              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert data sets”</em>
                <ul>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: filterAndTrim</strong></li>
                  <li><em>“name”</em>: <code class="language-plaintext highlighter-rouge">FiltTrim</code></li>
                </ul>
              </li>
              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert data sets”</em>
                <ul>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: dada</strong> with <code class="language-plaintext highlighter-rouge">#forward</code> tag</li>
                  <li><em>“name”</em>: <code class="language-plaintext highlighter-rouge">Dada Forward</code></li>
                </ul>
              </li>
              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert data sets”</em>
                <ul>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: dada</strong> with <code class="language-plaintext highlighter-rouge">#reverse</code> tag</li>
                  <li><em>“name”</em>: <code class="language-plaintext highlighter-rouge">Dada Reverse</code></li>
                </ul>
              </li>
              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert data sets”</em>
                <ul>
                  <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Dataset(s)”</em>: output of <strong>dada2: mergePairs</strong></li>
                  <li><em>“name”</em>: <code class="language-plaintext highlighter-rouge">MakePairs</code></li>
                </ul>
              </li>
              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert data sets”</em>
                <ul>
                  <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Dataset(s)”</em>: output of <strong>dada2: makeSequenceTable</strong></li>
                  <li><em>“name”</em>: <code class="language-plaintext highlighter-rouge">SeqTab</code></li>
                </ul>
              </li>
              <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert data sets”</em>
                <ul>
                  <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Dataset(s)”</em>: output of <strong>dada2: removeBimeraDenovo</strong></li>
                  <li><em>“name”</em>: <code class="language-plaintext highlighter-rouge">Bimera</code></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<blockquote class="question">
  <div class="box-title question-title" id="question-9"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>Have we kept the majority of the raw reads for F3D143?</li>
    <li>Is there any exceptionally large drop associated with any single step for any sample?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-9"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-9" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>Yes</li>
      <li>No</li>
    </ol>

  </blockquote>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-sequences-too-long-or-too-short-2"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Sequences too long or too short</div>

  <p>This is a great place to do a last sanity check. Outside of filtering, there should no step in which a majority of reads are lost. If a majority of reads failed to merge, you may need to revisit the truncLen parameter used in the filtering step and make sure that the truncated reads span your amplicon. If a majority of reads were removed as chimeric, you may need to revisit the removal of primers, as the ambiguous nucleotides in unremoved primers interfere with chimera identification.</p>

</blockquote>

<h1 id="assign-taxonomy">Assign taxonomy</h1>

<p>It is common at this point, especially in 16S/18S/ITS amplicon sequencing, to assign taxonomy to the sequence variants. The DADA2 package provides a native implementation of the naive Bayesian classifier method (<span class="citation"><a href="#Wang_2007">Wang <i>et al.</i> 2007</a></span>) for this purpose. The <strong>dada2: assignTaxonomy</strong> function takes as input a set of sequences to be classified and a training set of reference sequences with known taxonomy, and outputs taxonomic assignments with at least <code class="language-plaintext highlighter-rouge">minBoot</code> bootstrap confidence.</p>

<p>DADA2 maintains <a href="https://benjjneb.github.io/dada2/training.html">formatted training fastas for the RDP training set, GreenGenes clustered at 97% identity, and the Silva reference database</a>, and additional trainings fastas suitable for protists and certain specific environments have been contributed. For fungal taxonomy, the General Fasta release files from the <a href="https://unite.ut.ee/repository.php">UNITE ITS database</a> can be used as is.</p>
<div class="Step-by-step">

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-assign-taxonomy"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Assign taxonomy</div>

    <ol>
      <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/dada2_assigntaxonomyaddspecies/dada2_assignTaxonomyAddspecies/1.28+galaxy0" title="dada2: assignTaxonomy and addSpecies tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>dada2: assignTaxonomy and addSpecies</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.28+galaxy0)</span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“sequences to be assigned”</em>: output of <strong>dada2: removeBimeraDenovo</strong></li>
          <li><em>“Select a reference dataset your history or use a built-in?”</em>: <code class="language-plaintext highlighter-rouge">Use a built-in reference</code>
            <ul>
              <li><em>“Select reference data set”</em>: <code class="language-plaintext highlighter-rouge">Silva version 132</code></li>
            </ul>
          </li>
          <li><em>“Add genus-species binomials to the taxonomic table”</em>: <code class="language-plaintext highlighter-rouge">Yes</code>
            <ul>
              <li><em>“Select a reference dataset your history or use a built-in?”</em>: <code class="language-plaintext highlighter-rouge">Use a built-in reference</code>
                <ul>
                  <li><em>“Select reference data set”</em>: <code class="language-plaintext highlighter-rouge">Silva version 132</code></li>
                </ul>
              </li>
              <li><em>“reporting options”</em>: <code class="language-plaintext highlighter-rouge">only unambiguous identifications</code></li>
            </ul>

            <blockquote class="comment">
              <div class="box-title comment-title" id="comment-species-level-assignments-based-on-exact-matching"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Species level assignments based on **exact matching**</div>

              <p>The method of DADA2 make <a href="https://benjjneb.github.io/dada2/assign.html#species-assignment">species level assignments is based on <strong>exact matching</strong></a> between ASVs and sequenced reference strains. Recent analysis suggests that exact matching (or 100% identity) is the only appropriate way to assign species to 16S gene fragments (<span class="citation"><a href="#edgar2018updating">Edgar 2018</a></span>). Currently, <a href="https://benjjneb.github.io/dada2/training.html">species-assignment training fastas are available for the Silva and RDP 16S databases</a>.</p>

            </blockquote>
          </li>
        </ul>
      </li>
    </ol>

  </blockquote>

</div>

<p><strong>dada2: assignTaxonomy and addSpecies</strong> generates a table with rows being the ASVs and columns the taxonomic levels. Let’s inspect the taxonomic assignments.</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-10"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>Which kingdom have been identified?</li>
    <li>Which phyla have been identified? And how many ASVs per phylum?</li>
    <li>How many ASVs have species assignments?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-10"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-10" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>
        <p>Only bacteria</p>

        <blockquote class="comment">
          <div class="box-title comment-title" id="comment-wrong-kingdom"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Wrong kingdom</div>

          <p>If your reads do not seem to be appropriately assigned, for example lots of your bacterial 16S sequences are being assigned as <code class="language-plaintext highlighter-rouge">Eukaryota</code>, your reads may be in the opposite orientation as the reference database. Tell DADA2 to try the reverse-complement orientation (<em>“Try reverse complement”</em>) with <strong>dada2: assignTaxonomy and addSpecies</strong> and see if this fixes the assignments.</p>

        </blockquote>
      </li>
      <li>To get the identified phyla and the number of associated ASVs, we run <span class="tool" data-tool="Grouping1" title=" Group data by a column tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong> Group data by a column</strong></span> with the following parameters:
        <ul>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Select data”</em>: output of <strong>dada2: assignTaxonomy and addSpecies</strong></li>
          <li><em>“Group by column”</em>:<code class="language-plaintext highlighter-rouge">Column 3</code></li>
          <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>Insert Operation</em>
            <ul>
              <li><em>“Type”</em>: <code class="language-plaintext highlighter-rouge">Count</code></li>
              <li><em>“On column”</em>: <code class="language-plaintext highlighter-rouge">Column 3</code></li>
            </ul>
          </li>
        </ul>

        <table>
          <thead>
            <tr>
              <th>Phyla</th>
              <th>Number of ASVs</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Actinobacteria</td>
              <td>6</td>
            </tr>
            <tr>
              <td>Bacteroidetes</td>
              <td>20</td>
            </tr>
            <tr>
              <td>Cyanobacteria</td>
              <td>3</td>
            </tr>
            <tr>
              <td>Deinococcus-Thermus</td>
              <td>1</td>
            </tr>
            <tr>
              <td>Epsilonbacteraeota</td>
              <td>1</td>
            </tr>
            <tr>
              <td>Firmicutes</td>
              <td>185</td>
            </tr>
            <tr>
              <td>Patescibacteria</td>
              <td>2</td>
            </tr>
            <tr>
              <td>Phylum</td>
              <td>1</td>
            </tr>
            <tr>
              <td>Proteobacteria</td>
              <td>7</td>
            </tr>
            <tr>
              <td>Tenericutes</td>
              <td>6</td>
            </tr>
            <tr>
              <td>Verrucomicrobia</td>
              <td>1</td>
            </tr>
          </tbody>
        </table>

        <p>Unsurprisingly, the Bacteroidetes and Firmicutes are well represented among the most abundant taxa in these fecal samples.</p>
      </li>
      <li>16/232 species assignments were made, both because it is often not possible to make unambiguous species assignments from subsegments of the 16S gene, and because there is surprisingly little coverage of the indigenous mouse gut microbiota in reference databases.</li>
    </ol>

  </blockquote>
</blockquote>

<h1 id="exploration-of-asvs-with-phyloseq">Exploration of ASVs with phyloseq</h1>

<p><strong>phyloseq</strong> (<span class="citation"><a href="#McMurdie_2013">McMurdie and Holmes 2013</a></span>) is a powerful framework for further analysis of microbiome data. It imports, stores, analyzes, and graphically displays complex phylogenetic sequencing data that has already been clustered into Operational Taxonomic Units (OTUs) or ASV, especially when there is associated sample data, phylogenetic tree, and/or taxonomic assignment of the OTUs/ASVs.</p>

<h2 id="prepare-metadata-table-and-launch-phyloseq">Prepare metadata table and launch phyloseq</h2>

<p>To use phyloseq properly, the best is to provide it a metadata table. Here, we will also uses the small amount of metadata we have: the samples are named by the gender (G), mouse subject number (X) and the day post-weaning (Y) it was sampled (eg. GXDY).</p>

<p>We will construct a simple sample table from the information encoded in the filenames. Usually this step would instead involve reading the sample data in from a file. Here we will:</p>

<ol>
  <li>Extract element identifiers of a collection</li>
  <li>Add information about gender, mouse subject number and the day post-weaning using the extracted element identifiers</li>
  <li>Remove last line</li>
  <li>Add extra column <code class="language-plaintext highlighter-rouge">When</code> to indicate if <code class="language-plaintext highlighter-rouge">Early</code> (days &lt; 100) or <code class="language-plaintext highlighter-rouge">Late</code> (day &gt; 100)</li>
  <li>Add a header</li>
</ol>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-prepare-metadata-table"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Prepare metadata table</div>
  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/collection_element_identifiers/collection_element_identifiers/0.0.2" title="Extract element identifiers tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Extract element identifiers</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 0.0.2)</span> with the following parameters:
      <ul>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Dataset collection”</em>: output of <strong>dada2: mergePairs</strong></li>
      </ul>

      <p>We will now extract from the names the factors:</p>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2" title="Replace Text in entire line tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Replace Text in entire line</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.1.2)</span>
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output of <strong>Extract element identifiers</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li>In <em>“Replacement”</em>:
          <ul>
            <li>In <em>“1: Replacement”</em>
              <ul>
                <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">(.)(.)D(.*)</code></li>
                <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">\1\2D\3\t\1\t\2\t\3</code></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>

      <p>The given pattern <code class="language-plaintext highlighter-rouge">..D.</code> will be applied to the identifiers, where <code class="language-plaintext highlighter-rouge">.</code> will match any single character and <code class="language-plaintext highlighter-rouge">.*</code> any number of any character. The additional parentheses will record the matched character such that it can be used in the replacement (e.g. <code class="language-plaintext highlighter-rouge">\1</code> will refer to the content that matched the pattern in the 1st pair of parentheses)
 This step creates 3 additional columns with the gender, the mouse subject number and the day post-weaning</p>
    </li>
    <li>
      <p>Change the datatype to <code class="language-plaintext highlighter-rouge">tabular</code></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-changing-the-datatype"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-changing-the-datatype" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Changing the datatype</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, click <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden">galaxy-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>   <li>In the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden">galaxy-chart-select-data</span> <strong>Assign Datatype</strong>, select <code class="language-plaintext highlighter-rouge">tabular</code> from “<em>New type</em>” dropdown     <ul>       <li>Tip: you can start typing the datatype into the field to filter the dropdown menu</li>     </ul>   </li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_head_tool/9.3+galaxy1" title="Select first lines from a dataset (head) tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Select first lines from a dataset (head)</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 9.3+galaxy1)</span> to remove the last line
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to select”</em>: output of <strong>Replace Text</strong></li>
        <li><em>“Operation”</em>: <code class="language-plaintext highlighter-rouge">Remove last lines</code></li>
        <li><em>“Number of lines”</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/devteam/column_maker/Add_a_column1/2.0" title="Compute tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Compute</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 2.0)</span> on rows with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Input file”</em>: output of <strong>Select first lines</strong></li>
        <li><em>“Input has a header line with column names?”</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li>In <em>“Expressions”</em>:
          <ul>
            <li><em>“Add expression”</em>: <code class="language-plaintext highlighter-rouge">bool(c4&gt;100)</code></li>
            <li><em>“Mode of the operation?”</em>: <code class="language-plaintext highlighter-rouge">Append</code></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/9.3+galaxy1" title="Replace Text in a specific column tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Replace Text in a specific column</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 9.3+galaxy1)</span> on rows with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: output of <strong>Compute</strong></li>
        <li>In <em>“Replacement”</em>:
          <ul>
            <li>In <em>“1: Replacement”</em>
              <ul>
                <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column: 5</code></li>
                <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">True</code></li>
                <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">Late</code></li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Replacement”</em></li>
            <li>In <em>“2: Replacement”</em>
              <ul>
                <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column: 5</code></li>
                <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">False</code></li>
                <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">Early</code></li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Replacement”</em></li>
            <li>In <em>“3: Replacement”</em>
              <ul>
                <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code></li>
                <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">F</code></li>
                <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">Female</code></li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Replacement”</em></li>
            <li>In <em>“4: Replacement”</em>
              <ul>
                <li><em>“in column”</em>: <code class="language-plaintext highlighter-rouge">Column: 2</code></li>
                <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">M</code></li>
                <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">Male</code></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <p>Create a new file (<code class="language-plaintext highlighter-rouge">header</code>) from the following (header line of the metadata table)</p>

      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sample	Gender	Mouse	Day	When
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-file"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-file" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a new file</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong> at the bottom</li>   <li>     <p>Paste the file contents into the text field</p>   </li>   <li>Change the dataset name from “New File” to <code class="language-plaintext highlighter-rouge">header</code></li>   <li>Change <strong>Type</strong> from “Auto-detect” to <code class="language-plaintext highlighter-rouge">tabular</code>* Press <strong>Start</strong> and <strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li><span class="tool" data-tool="cat1" title="Concatenate datasets tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Concatenate datasets</strong></span> to add this header line to the <strong>Replace Text</strong> output:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Concatenate Dataset”</em>: the <code class="language-plaintext highlighter-rouge">header</code> dataset</li>
        <li><em>“Dataset”</em>
          <ul>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“Insert Dataset”</em>
              <ul>
                <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“select”</em>: output of <strong>Replace Text</strong></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li>Rename the output to <code class="language-plaintext highlighter-rouge">Metadata table</code></li>
  </ol>
</blockquote>

<p>We have now a metadata table with five columns:</p>
<ol>
  <li>Sample</li>
  <li>Gender</li>
  <li>Mouse subject</li>
  <li>Day post-weaning</li>
  <li>When</li>
</ol>

<p>We now construct a phyloseq object directly with it and the DADA2 outputs and launch Shiny-phyloseq (<span class="citation"><a href="#mcmurdie2015shiny">McMurdie and Holmes 2015</a></span>) to explore the phyloseq object.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-create-phyloseq-object-and-launch-phyloseq-exploration"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Create phyloseq object and launch phyloseq exploration</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/phyloseq_from_dada2/phyloseq_from_dada2/1.46.0+galaxy0" title="Create phyloseq object from dada2 tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Create phyloseq object from dada2</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.46.0+galaxy0)</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Sequence table”</em>: output of <strong>dada2: removeBimeraDenovo</strong></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Taxonomy table”</em>: output of <strong>dada2: assignTaxonomy and addSpecies</strong></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Sample table”</em>: <code class="language-plaintext highlighter-rouge">Metadata table</code></li>
      </ul>
    </li>
    <li><span class="tool" data-tool="interactive_tool_phyloseq" title="Phyloseq tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Phyloseq</strong></span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Phyloseq R object”</em>: output of <strong>Create phyloseq object from dada2</strong></li>
      </ul>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-open-interactive-tool"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-open-interactive-tool" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Open interactive tool</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Go to User &gt; Active InteractiveTools</li>   <li>Wait for the  to be running (Job Info)</li>   <li>Click on</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>A new page will be launched with Shiny-phyloseq ready to explore the phyloseq object.</p>

<h2 id="visualize-alpha-diversity">Visualize alpha-diversity</h2>

<p>A <strong>diversity index</strong> is a quantitative measure that is used to assess the level of diversity or variety within a particular system, such as a biological community, a population, or a workplace. It provides a way to capture and quantify the distribution of different types or categories within a system.</p>

<p>Related to ecology, the term <strong>diversity</strong> describes the number of different species present in one particular area and their relative abundance. More specifically, several different metrics of diversity can be calculated. The most common ones are α, β and γ diversity.</p>

<p>The <strong>α diversity</strong> describes the diversity within a community. It considers the number of different species in an environment (also referred to as species <strong>richness</strong>). Additionally, it can take the abundance of each species into account to measure how evenly individuals are distributed across the sample (also referred to as species <strong>evenness</strong>).</p>

<p>There are several different indices used to calculate α diversity because different indexes capture different aspects of diversity and have varying sensitivities to different factors. These indexes have been developed to address specific research questions, account for different ecological or population characteristics, or highlight certain aspects of diversity.</p>

<figure id="figure-5" style="max-width: 90%;"><img src="./images/alphadiversity_metrics.png" alt="Explanation of the α diversity. " width="1400" height="1090" loading="lazy" /><a target="_blank" href="./images/alphadiversity_metrics.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 5</strong>:</span> <a href="https://medium.com/pjtorres-high-gut-alpha-diversity-and-health/high-alpha-diversity-and-health-65e5eca7fa36">Source</a></figcaption></figure>

<p>Here we will plot the <strong>α diversity</strong> for the samples given the Days using 2 measures:</p>

<ul>
  <li>
    <p>The <strong>Shannons</strong> index, which calculates the uncertainty in predicting the species identity of an individual that is selected from a community (<span class="citation"><a href="#Shannon.1948">Shannon 1948</a></span>).</p>
  </li>
  <li>
    <p>The <strong>Simpsons</strong> index, which calculates the probability that two individuals selected from a community will be of the same species. Obtains small values in datasets of high diversity and large values in datasets of low diversity (<span class="citation"><a href="#SIMPSON.1949">SIMPSON 1949</a></span>).</p>
  </li>
</ul>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-plot-α-diversity"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Plot α diversity</div>

  <ol>
    <li>Click on <strong>Alpha Diversity</strong> tab</li>
    <li>Select the following parameters:
      <ul>
        <li><em>“X”</em>: <code class="language-plaintext highlighter-rouge">Day</code></li>
        <li><em>“Color”</em>: <code class="language-plaintext highlighter-rouge">When</code></li>
        <li><em>“alpha Measures”</em>: <code class="language-plaintext highlighter-rouge">Shannon</code>, <code class="language-plaintext highlighter-rouge">Simpson</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><a href="./images/alpha_diversity.png" rel="noopener noreferrer"><img src="./images/alpha_diversity.png" alt="2 panels for 2 α diversity metrics (Shannon, Simpson) with α diversity value on Y axis and days on X axis. The points are colored given When. " width="1536" height="1536" loading="lazy" /></a></p>

<blockquote class="question">
  <div class="box-title question-title" id="question-11"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>Is there any obvious systematic difference in alpha-diversity between early and late samples?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-11"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-11" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>No</p>

  </blockquote>

</blockquote>

<h2 id="plot-ordination">Plot Ordination</h2>

<p>Ordination refers to a set of multivariate techniques used to analyze complex ecological data. It involves summarizing large datasets, such as species abundance across different samples, by projecting them onto a low-dimensional space. This visualization makes it easier to identify patterns and relationships within the data, such as how species distributions correspond to environmental gradients. Ordination helps understand the underlying factors that structure ecological communities and the relative importance of different environmental variables.</p>

<p>Phyloseq offers several ordination methods:</p>

<ol>
  <li>
    <p><strong>MDS (Multidimensional Scaling)</strong>: MDS is a technique that visualizes the level of similarity or dissimilarity of individual cases of a dataset by positioning them in a low-dimensional space.</p>
  </li>
  <li>
    <p><strong>PCoA (Principal Coordinates Analysis)</strong>: PCoA is a distance-based ordination method that transforms a distance matrix into a set of coordinates, allowing the visualization of the relationships between samples in a reduced dimensional space.</p>
  </li>
  <li>
    <p><strong>DCA (Detrended Correspondence Analysis)</strong>: DCA is an ordination method that removes the arch effect in Correspondence Analysis, providing a more accurate representation of ecological gradients.</p>
  </li>
  <li>
    <p><strong>CCA (Canonical Correspondence Analysis)</strong>: CCA is a direct gradient analysis technique that relates species composition data to measured environmental variables, highlighting the influence of these variables on community structure.</p>
  </li>
  <li>
    <p><strong>RDA (Redundancy Analysis)</strong>: RDA is a linear ordination method that combines features of regression and PCA, allowing the analysis of relationships between multiple response variables (e.g., species data) and explanatory variables (e.g., environmental data).</p>
  </li>
  <li>
    <p><strong>DPCoA (Double Principle Coordinate Analysis)</strong>: DPCoA is a multivariate technique that combines distance-based methods with correspondence analysis to account for phylogenetic or functional diversity among species.</p>
  </li>
  <li>
    <p><strong>NMDS (Non-metric Multidimensional Scaling)</strong>: NMDS is an ordination technique that aims to represent the pairwise dissimilarities between samples in a low-dimensional space, emphasizing the rank order of dissimilarities rather than their exact values.</p>
  </li>
</ol>

<p>Here we will plot <strong>NMDS</strong>.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-plot-nmds-ordination-plot"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Plot NMDS Ordination plot</div>

  <ol>
    <li>Click on <strong>Ordination</strong> tab</li>
    <li>Select the following parameters:
      <ul>
        <li><em>“Display”</em>: <code class="language-plaintext highlighter-rouge">Samples</code></li>
        <li><em>“Method”</em>: <code class="language-plaintext highlighter-rouge">NMDS</code></li>
        <li><em>“Transform”</em>: <code class="language-plaintext highlighter-rouge">Prop</code></li>
        <li><em>“Color”</em>: <code class="language-plaintext highlighter-rouge">When</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><a href="./images/ordination.png" rel="noopener noreferrer"><img src="./images/ordination.png" alt="Graph with NMDS1 on X axis and NMDS2 on Y axis. The points are colored in red for early and blue for late. " width="2400" height="2400" loading="lazy" /></a></p>

<blockquote class="question">
  <div class="box-title question-title" id="question-12"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>Is there a clear separation between the early and late samples?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-12"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-12" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>Yes</p>

  </blockquote>

</blockquote>

<h2 id="plot-abundance-stacked-barplot">Plot abundance stacked barplot</h2>

<p>Abundance barplots are graphical tools that display the relative abundance of different species or groups in a dataset, allowing for easy comparison and visualization of community composition and distribution patterns across samples.</p>

<p>Let’s plot an abundance stacked barplot at the family level.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-plot-abundance-stacked-barplot"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Plot abundance stacked barplot</div>

  <ol>
    <li>Click on <strong>Bar</strong> tab</li>
    <li>Select the following parameters:
      <ul>
        <li><em>“X-axis”</em>: <code class="language-plaintext highlighter-rouge">Samples</code></li>
        <li><em>“Color”</em>: <code class="language-plaintext highlighter-rouge">Family</code></li>
        <li><em>“Facet Col”</em>: <code class="language-plaintext highlighter-rouge">When</code></li>
      </ul>
    </li>
    <li>Click on <strong>(Re)Build Graphic</strong></li>
  </ol>
</blockquote>

<p><a href="./images/barplot1.png" rel="noopener noreferrer"><img src="./images/barplot1.png" alt="Stacked barplot with sample on X-axis and abundance on Y-axis. Each bar represent the different families (in different colors) for the sample. " width="2400" height="2400" loading="lazy" /></a></p>

<p>The barplot is hard to read here: many families are in white because the color palette is reduced and we can not distinguish them. We need to filter to data to display only the most abundant families. We will select only taxa with more than 500 counts.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-filter-and-plot-abundance-stacked-barplot"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on:  Filter and Plot abundance stacked barplot</div>

  <ol>
    <li>Click on <strong>Filter</strong> tab</li>
    <li>Select the following parameters:
      <ul>
        <li><em>” Taxa Min.”</em>: <code class="language-plaintext highlighter-rouge">500</code></li>
      </ul>
    </li>
    <li>Click on <strong>Execute Filter</strong></li>
    <li>Click on <strong>Bar</strong> tab</li>
    <li>Select the following parameters:
      <ul>
        <li><em>“X-axis”</em>: <code class="language-plaintext highlighter-rouge">Samples</code></li>
        <li><em>“Color”</em>: <code class="language-plaintext highlighter-rouge">Family</code></li>
        <li><em>“Facet Col”</em>: <code class="language-plaintext highlighter-rouge">When</code></li>
      </ul>
    </li>
    <li>Click on <strong>(Re)Build Graphic</strong></li>
  </ol>
</blockquote>

<p><a href="./images/barplot2.png" rel="noopener noreferrer"><img src="./images/barplot2.png" alt="Stacked barplot with sample on X-axis and abundance on Y-axis. Each bar represent the different families (in different colors) for the sample. " width="2400" height="2400" loading="lazy" /></a></p>

<blockquote class="question">
  <div class="box-title question-title" id="question-13"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <p>Is there an obvious change in taxonomy between the early and late samples?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-13"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-13" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>Not really</p>

  </blockquote>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-using-ampvis2-for-heatmap-instead-of-a-barplot"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Using ampvis2 for heatmap instead of a barplot</div>

  <p>ampvis2 (<span class="citation"><a href="#Andersen_2018">Andersen <i>et al.</i> 2018</a></span>) team suggests <a href="http://albertsenlab.org/ampvis2-heatmap/">not using stacked bar charts but heatmaps to represent community diversity</a>. You can do that in Galaxy as ampvis2 is available as a tool.</p>

</blockquote>

<h1 id="conclusion">Conclusion</h1>

<p>Constructing an Amplicon Sequence Variant (ASV) table from 16S data using DADA2 provides a robust and accurate method for analyzing microbial communities. This tutorial has guided you through the key steps, including quality filtering, dereplication, error rate learning, sample inference, and chimera removal, culminating in the generation of a high-resolution ASV table and visualization using Phyloseq. By following these steps, you can ensure that your microbial diversity analyses are based on precise and reproducible sequence variants, allowing for more reliable ecological and evolutionary insights.</p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                        <h3>You've Finished the Tutorial</h3>
                        <button id="tutorial-finish-button" class="btn btn-primary" onclick="tutorial_finish()">I finished this tutorial 👍</button>
                        <p style="display: none" id="tutorial-finish-text">Please also consider filling out the <a href="#gtn-feedback">Feedback Form</a> as well!</p>
                        <script>
                        function tutorial_finish() {
                          if(plausible !== undefined){
                            plausible('TutorialComplete', {callback: tutorial_finish_finish, props: {path: document.location.pathname}})
                          } else {
                            tutorial_finish_finish();
                          }
                        }
                        function tutorial_finish_finish() {
                          document.getElementById("tutorial-finish-button").innerText = 'Congrats! Thanks for letting us know! 🎉'
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-text").style.display = 'block'
                        }
                        </script>

                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>DADA2 allows for the generation of precise ASV tables, providing higher resolution and more accurate representation of microbial communities compared to traditional OTU-based methods.</p>
</li>
                        
                        <li><p>Key steps such as quality filtering, error rate learning, and chimera removal are essential in the DADA2 pipeline to ensure the reliability and accuracy of the resulting ASV data.</p>
</li>
                        
                        <li><p>Tools like phyloseq can be effectively used to explore and visualize ASV tables, facilitating deeper ecological and evolutionary insights into microbial diversity and community structure.</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the <a href="faqs/">tutorial FAQ page</a> or the  <a href="/training-material/topics/microbiome/faqs/">FAQ page for the Microbiome topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                
                <h1 data-toc-skip>Useful literature</h1>
                <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/microbiome#references">here</a>.</p>
                


                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="Shannon.1948">Shannon, C. E., 1948 <b>A Mathematical Theory of Communication</b>. Bell System Technical Journal 27: 379–423. <a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">10.1002/j.1538-7305.1948.tb01338.x</a></li>
<li id="SIMPSON.1949">SIMPSON, E. H., 1949 <b>Measurement of Diversity</b>. Nature 163: 688. <a href="https://doi.org/10.1038/163688a0">10.1038/163688a0</a></li>
<li id="Wang_2007">Wang, Q., G. M. Garrity, J. M. Tiedje, and J. R. Cole, 2007 <b>Nai\‘ Ive Bayesian Classifier for Rapid Assignment of rRNA Sequences into the New Bacterial Taxonomy</b>. Applied and Environmental Microbiology 73: 5261–5267. <a href="https://doi.org/10.1128/aem.00062-07">10.1128/aem.00062-07</a></li>
<li id="Schloss_2009">Schloss, P. D., S. L. Westcott, T. Ryabin, J. R. Hall, M. Hartmann <i>et al.</i>, 2009 <b>Introducing mothur: Open-Source, Platform-Independent, Community-Supported Software for Describing and Comparing Microbial Communities</b>. Applied and Environmental Microbiology 75: 7537–7541. <a href="https://doi.org/10.1128/aem.01541-09">10.1128/aem.01541-09</a></li>
<li id="McMurdie_2013">McMurdie, P. J., and S. Holmes, 2013 <b>phyloseq: An R Package for Reproducible Interactive Analysis and Graphics of Microbiome Census Data</b> (M. Watson, Ed.). PLoS ONE 8: e61217. <a href="https://doi.org/10.1371/journal.pone.0061217">10.1371/journal.pone.0061217</a></li>
<li id="mcmurdie2015shiny">McMurdie, P. J., and S. Holmes, 2015 <b>Shiny-phyloseq: Web application for interactive microbiome analysis with provenance tracking</b>. Bioinformatics 31: 282–283. <a href="https://doi.org/10.1093/bioinformatics/btu616">10.1093/bioinformatics/btu616</a></li>
<li id="Callahan_2016">Callahan, B. J., P. J. McMurdie, M. J. Rosen, A. W. Han, A. J. A. Johnson <i>et al.</i>, 2016 <b>DADA2: High-resolution sample inference from Illumina amplicon data</b>. Nature Methods 13: 581–583. <a href="https://doi.org/10.1038/nmeth.3869">10.1038/nmeth.3869</a></li>
<li id="Andersen_2018">Andersen, K. S., R. H. Kirkegaard, S. M. Karst, and M. Albertsen, 2018 <b>ampvis2: an R package to analyse and visualise 16S rRNA amplicon data</b>. <a href="https://doi.org/10.1101/299537">10.1101/299537</a></li>
<li id="edgar2018updating">Edgar, R. C., 2018 <b>Updating the 97% identity threshold for 16S ribosomal RNA OTUs</b>. Bioinformatics 34: 2371–2375. <a href="https://doi.org/10.1093/bioinformatics/bty113">10.1093/bioinformatics/bty113</a></li>
<li id="Bolyen_2019">Bolyen, E., J. R. Rideout, M. R. Dillon, N. A. Bokulich, C. C. Abnet <i>et al.</i>, 2019 <b>Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2</b>. Nature Biotechnology 37: 852–857. <a href="https://doi.org/10.1038/s41587-019-0209-9">10.1038/s41587-019-0209-9</a></li>
<li id="_zkurt_2022">Özkurt, E., J. Fritscher, N. Soranzo, D. Y. K. Ng, R. P. Davey <i>et al.</i>, 2022 <b>LotuS2: an ultrafast and highly accurate tool for amplicon sequencing analysis</b>. Microbiome 10: <a href="https://doi.org/10.1186/s40168-022-01365-1">10.1186/s40168-022-01365-1</a></li></ol>
                

                

                <h1 id="gtn-feedback">Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=microbiome/dada-16S"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=microbiome/dada-16S">Feedback Form</a></iframe>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Bérénice Batut,  <b>Building an amplicon sequence variant (ASV) table from 16S data using DADA2 (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/tutorial.html">https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{microbiome-dada-16S,
author = "Bérénice Batut",
	title = "Building an amplicon sequence variant (ASV) table from 16S data using DADA2 (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/dada-16S/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

		<h2 id="funding">Funding</h2>
		<p>These individuals or organisations provided funding support for the development of this resource</p>
                
                

                


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="details follow-up" id="admins-install-missing-tools">
                  <div id="admin-missing-tools" class="box-title">
                    <button type="button" aria-controls="admin-missing-tools" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Galaxy Administrators: Install the missing tools<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>


			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/microbiome/tutorials/dada-16S/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools:
- name: text_processing
  owner: bgruening
  revisions: 86755160afbf
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: text_processing
  owner: bgruening
  revisions: 86755160afbf
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: text_processing
  owner: bgruening
  revisions: d698c222f354
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: text_processing
  owner: bgruening
  revisions: 86755160afbf
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: column_maker
  owner: devteam
  revisions: 6595517c2dd8
  tool_panel_section_label: Text Manipulation
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: collection_element_identifiers
  owner: iuc
  revisions: d3c07d270a50
  tool_panel_section_label: Collection Operations
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_assigntaxonomyaddspecies
  owner: iuc
  revisions: 7c2100246a2f
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_assigntaxonomyaddspecies
  owner: iuc
  revisions: 65db807336bc
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_dada
  owner: iuc
  revisions: 96336c6a2bb7
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_dada
  owner: iuc
  revisions: 00f5005840fa
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_filterandtrim
  owner: iuc
  revisions: addaf9d22850
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_filterandtrim
  owner: iuc
  revisions: e8fba04706d3
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_learnerrors
  owner: iuc
  revisions: 75403243703a
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_learnerrors
  owner: iuc
  revisions: 5fe3edf19b9c
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_makesequencetable
  owner: iuc
  revisions: 43c99742158b
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_makesequencetable
  owner: iuc
  revisions: 75c8945b0da2
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_mergepairs
  owner: iuc
  revisions: 5c865a382933
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_mergepairs
  owner: iuc
  revisions: 35176674168c
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_plotqualityprofile
  owner: iuc
  revisions: 7b8cb2b02978
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_plotqualityprofile
  owner: iuc
  revisions: cae017b76acb
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_removebimeradenovo
  owner: iuc
  revisions: 7136e9ab70db
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_removebimeradenovo
  owner: iuc
  revisions: '073608a50ac3'
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_seqcounts
  owner: iuc
  revisions: 19299bb1c6af
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: dada2_seqcounts
  owner: iuc
  revisions: a7817705348e
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: phyloseq_from_dada2
  owner: iuc
  revisions: 87064cb77a52
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
</code></pre></div>
                </blockquote>
		

		<blockquote class="details hide-when-printing" id="feedback-responses">
                  <div id="feedback-response-c" class="box-title">
                    <button type="button" aria-controls="feedback-response-c" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Feedback<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>

		   <p>
		   
		   <table class="charts-css bar show-labels" style="--labels-size: 8rem; overflow-y: hidden">
		   
			<tr>
				<th scope="row"><span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 1.0">1</td>
			</tr>
		   
		   </table>
		   </p>
		
        
        
		    
		    <b>July 2024</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: So easy to follow
					
				</li>
				
		    </ul>
		    
        
		</blockquote>

		


		
		
		

                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					
					<li><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00441">gxy.io/GTN:T00441</a></li>
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/microbiome/tutorials/dada-16S/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/microbiome/tutorials/dada-16S/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/398f9b8329ed79e4b78b4526bc25f1bf54b0ede8">398f9b8</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.20cf1f17.js'></script>

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
	

    </body>
</html>