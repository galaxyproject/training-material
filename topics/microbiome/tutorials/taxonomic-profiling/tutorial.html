<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hands-on: Taxonomic Profiling and Visualization of Metagenomic Data / Taxonomic Profiling and Visualization of Metagenomic Data / Microbiome</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@5fe39b6156174c5a8df581974ab4d5fff4897ccd",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/taxonomic-profiling/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" as="script" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.20cf1f17.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Taxonomic Profiling and Visualization of Metagenomic Data">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-06-14 09:56:50 +0000">
<meta name="DC.creator" content="Sophia Hampe">
<meta name="DC.creator" content="Bérénice Batut">
<meta name="DC.creator" content="Paul Zierep"><meta name="description" content="A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Microbiome / Taxonomic Profiling and Visualization of Metagenomic Data / Hands-on: Taxonomic Profiling and Visualization of Metagenomic Data">
        <meta property="og:description" content="A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ">
        
	<meta property="og:image" content="https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png"><script type="application/ld+json">


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Taxonomic Profiling and Visualization of Metagenomic Data",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "provider": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "dateModified": "2024-06-14 09:56:50 +0000",
  "datePublished": "2023-05-03 14:34:02 +0000",
  "identifier": "https://gxy.io/GTN:T00395",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Microbiome",
    "description": "A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ",
    "url": "https://training.galaxyproject.org/training-material/topics/microbiome/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Taxonomic Profiling and Visualization of Metagenomic Data",
  "url": "https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/taxonomic-profiling/tutorial.html",
  "version": 4,
  "timeRequired": "PT2H",
  "teaches": "Explain what taxonomic assignment is\n - Explain how taxonomic assignment works\n - Apply Kraken and MetaPhlAn to assign taxonomic labels\n - Apply Krona and Pavian to visualize results of assignment and understand the output\n - Identify taxonomic classification tool that fits best depending on their data",
  "keywords": [
    "Microbiome",
    "metagenomics",
    "taxonomic profiling",
    "microgalaxy"
  ],
  "description": "The questions this  addresses are:\n - Which species (or genera, families, ...) are present in my sample?\n - What are the different approaches and tools to get the community profile of my sample?\n - How can we visualize and compare community profiles?\n\n\nThe objectives are:\n - Explain what taxonomic assignment is\n - Explain how taxonomic assignment works\n - Apply Kraken and MetaPhlAn to assign taxonomic labels\n - Apply Krona and Pavian to visualize results of assignment and understand the output\n - Identify taxonomic classification tool that fits best depending on their data\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    }
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/sophia120199/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/sophia120199/",
      "name": "Sophia Hampe",
      "image": "https://avatars.githubusercontent.com/sophia120199",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/bebatut/",
      "name": "Bérénice Batut",
      "image": "https://avatars.githubusercontent.com/bebatut",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "This project ([`2020-1-NL01-KA203-064717`](https://erasmus-plus.ec.europa.eu/projects/search/details/2020-1-NL01-KA203-064717)) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.\n![eu flag with the text: with the support of the erasmus programme of the european union](https://gallantries.github.io/assets/images/logosbeneficaireserasmusright_en.jpg)\n![erasmus plus logo](https://www.erasmusplus.nl/assets/images/logo.png)\n",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/ifb/",
          "name": "Institut Français de Bioinformatique",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.france-bioinformatique.fr/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9852-1987",
      "orcid": "https://orcid.org/0000-0001-9852-1987"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/paulzierep/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/paulzierep/",
      "name": "Paul Zierep",
      "image": "https://avatars.githubusercontent.com/paulzierep",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/uni-freiburg/",
          "name": "University of Freiburg",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.uni-freiburg.de/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0003-2982-388X",
      "orcid": "https://orcid.org/0000-0003-2982-388X"
    }
  ],
  "contributor": [

  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Microbiome",
      "description": "A microbiome is the community of microorganisms that can usually be found living together in any given habitat. Microbiome research has grown substantially over the past decade in terms of the range of biomes sampled, identified taxa, and the volume of data derived from the samples. ",
      "url": "https://training.galaxyproject.org/training-material/topics/microbiome/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3174",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3174",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3174"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3697",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3697",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3697"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0637",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0637",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0637"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0080",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0080",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0080"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [
    {
      "@type": "Thing",
      "url": "https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/taxonomic-profiling/workflows/",
      "name": "Associated Workflows"
    },
    {
      "@type": "Thing",
      "url": "https://zenodo.org/record/7871630",
      "name": "Associated Training Datasets"
    }
  ],
  "abstract": "The term **\"microbiome\"** describes \"a characteristic microbial community occupying a reasonably well-defined habitat which has distinct physio-chemical properties. The term thus not only refers to the microorganisms involved but also encompasses their theatre of activity\" ({% cite whipps1988mycoparasitism %})."
}</script></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/microbiome" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Microbiome
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/microbiome/faqs/" title="Check our FAQs for the Microbiome topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/microbiome/tutorials/taxonomic-profiling/tutorial.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/microbiome/tutorials/taxonomic-profiling/tutorial.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html">
                    <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-microbiome">
    <h1 data-toc-skip>Taxonomic Profiling and Visualization of Metagenomic Data</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/sophia120199/" class="contributor-badge contributor-sophia120199"><img src="https://avatars.githubusercontent.com/sophia120199?s=36" alt="Sophia Hampe avatar" width="36" class="avatar" />
    Sophia Hampe</a><a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bebatut?s=36" alt="Bérénice Batut avatar" width="36" class="avatar" />
    Bérénice Batut</a><a href="/training-material/hall-of-fame/paulzierep/" class="contributor-badge contributor-paulzierep"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/paulzierep?s=36" alt="Paul Zierep avatar" width="36" class="avatar" />
    Paul Zierep</a>
		</td>
	</tr>
	

	

	

	

	

	

	

	

	

</table>


	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png" width="88" height="31"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>Which species (or genera, families, …) are present in my sample?</p>
</li>
        
        <li><p>What are the different approaches and tools to get the community profile of my sample?</p>
</li>
        
        <li><p>How can we visualize and compare community profiles?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Explain what taxonomic assignment is</p>
</li>
        
        <li><p>Explain how taxonomic assignment works</p>
</li>
        
        <li><p>Apply Kraken and MetaPhlAn to assign taxonomic labels</p>
</li>
        
        <li><p>Apply Krona and Pavian to visualize results of assignment and understand the output</p>
</li>
        
        <li><p>Identify taxonomic classification tool that fits best depending on their data</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    
        
        
        
        <li>
          <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        </li>
        
    


        

        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 2 hours</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Level: </strong>
        


 Introductory <span class="visually-hidden">Introductory</span>
<span class="level introductory" title="Introductory Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/7871630">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/microbiome/tutorials/taxonomic-profiling/workflows/" title="Taxonomic Profiling and Visualization of Metagenomic Data workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            

            

            
            
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            











<li class="btn btn-default supporting_material">


  <!-- dropdown with all recordings -->
  <a href="/training-material/topics/microbiome/tutorials/taxonomic-profiling/recordings/" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Latest recordings of this material in the GTN Video Library">
        <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span>&nbsp;Recordings
  </a>


  <ul class="dropdown-menu">
    

    
      
      
      
    <li><a class="dropdown-item" href="/training-material/topics/microbiome/tutorials/taxonomic-profiling/recordings/index.html#tutorial-recording-16-may-2023" title="View the recording for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Tutorial (May 2023) - 1h15m</a>
    </li>
      
    
    <li><a class="dropdown-item" href="/training-material/topics/microbiome/tutorials/taxonomic-profiling/recordings/" title="View all recordings for this tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> View All</a>
    </li>

  </ul>

  
</li>
  





            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
	<li class="dropdown-header">
		<b>Known Working</b>
	</li>
	
	

    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.eu" title="">
			UseGalaxy.eu <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> <abbr title="This is a UseGalaxy.* server which meets minimum requirements for a public Galaxy">⭐️</abbr>
		</a>
	</li>
    
    
    
    
	<li class="dropdown-header">
		<b>Possibly Working</b>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.fr/" title="">
			UseGalaxy.fr
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.org.au" title="">
			UseGalaxy.org.au
		</a>
	</li>
    
    

    
	<li class="dropdown-header">
		Containers
	</li>
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics/microbiome/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Published:</strong> May 3, 2023 </div>
        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Jun 14, 2024 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            Tutorial Content is licensed under
            
              <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
            The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span> <abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00395">https://gxy.io/GTN:T00395</a> </div>
        

	
	

	
	
	<div><strong><i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">rating</span> Rating:</strong> <a href="#feedback-responses">4.3</a> (3 recent ratings, 5 all time)</div>
	
	<div><strong><i class="fas fa-code-commit" aria-hidden="true"></i><span class="visually-hidden">version</span> Revision:</strong> 4 </div>

    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <p>The term <strong>“microbiome”</strong> describes “a characteristic microbial community occupying a reasonably well-defined habitat which has distinct physio-chemical properties. The term thus not only refers to the microorganisms involved but also encompasses their theatre of activity” (<span class="citation"><a href="#whipps1988mycoparasitism">Whipps <i>et al.</i> 1988</a></span>).</p>

<p>Microbiome data can be gathered from different environments such as soil, water or the human gut. The biological interest lies in general in the question how the microbiome present at a specific site influences this environment. To study a microbiome, we need to use indirect methods like metagenomics or metatranscriptomics.</p>

<p><strong>Metagenomic samples</strong> contain DNA from different organisms at a specific site, where the sample was collected. Metagenomic data can be used to find out which organisms coexist in that niche and which genes are present in the different organisms.
<strong>Metatranscriptomic samples</strong> include the transcribed gene products, thus RNA, that therefore allow to not only study the presence of genes but additionally their expression in the given environment. The following tutorial will focus on metagenomics data, but the principle is the same for metatranscriptomics data.</p>

<p>The investigation of microorganisms present at a specific site and their relative abundance is also called <strong>“microbial community profiling”</strong>.
The main objective is to identify the microorganisms that are present within the given sample. This can be achieved for all known microbes, where the DNA sequence specific for a certain species is known.</p>

<p>For that we try to <strong>identify the taxon</strong> to which each individual read belongs.</p>

<!--SNIPPET-->
<blockquote class="details">   <div class="box-title details-title" id="details-what-is-taxonomy"><button class="gtn-boxify-button details" type="button" aria-controls="details-what-is-taxonomy" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true"></i> <span>Details: What is Taxonomy?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Taxonomy is the method used to naming, defining (circumscribing) and classifying groups of biological organisms based on shared characteristics such as morphological characteristics, phylogenetic characteristics, DNA data, etc. It is founded on the concept that the similarities descend from a common evolutionary ancestor.</p>   <p>Defined groups of organisms are known as <strong>taxa</strong>. Taxa are given a taxonomic rank and are aggregated into super groups of higher rank to create a taxonomic hierarchy. The taxonomic hierarchy includes eight levels: <strong>Domain, Kingdom, Phylum, Class, Order, Family, Genus and Species.</strong></p>   <p><img src="/training-material/topics/microbiome/faqs/images/taxonomy.png" alt="Example of taxonomy. It starts, top to bottom, with Kingdom &quot;Animalia&quot;, Phylum &quot;Chordata&quot;, Class &quot;Mammalia&quot;, and Order &quot;Carnivora&quot;. Then it splits in 3. On the left, Family &quot;Felidae&quot;, with 2 genus &quot;Felis&quot; and &quot;Panthera&quot; and below 3 species &quot;F. catus&quot; and &quot;F. pardalis&quot; below &quot;Felis&quot;, &quot;P. pardus&quot; below &quot;Panthera&quot;. In the middle, Family &quot;Canidae&quot;, genus &quot;Canis&quot; and 2 species &quot;C. familiaris&quot; and &quot;C. lupus&quot;. On the right, Family &quot;Ursidae&quot;, Genus &quot;Ursus&quot; and 2 species &quot;U. arctos&quot; and &quot;U. horribilus&quot;. Below each species is a illustration of the species" /></p>   <p>The classification system begins with <strong>3 domains</strong> that encompass all living and extinct forms of life</p>   <ul>   <li>The <strong>Bacteria</strong> and <strong>Archae</strong> are mostly microscopic, but quite widespread.</li>   <li>Domain <strong>Eukarya</strong> contains more complex organisms</li> </ul>   <p>When new species are found, they are assigned into taxa in the taxonomic hierarchy. For example for the cat:</p>   <table>   <thead>     <tr>       <th>Level</th>       <th>Classification</th>     </tr>   </thead>   <tbody>     <tr>       <td>Domain</td>       <td>Eukaryota</td>     </tr>     <tr>       <td>Kingdom</td>       <td>Animalia</td>     </tr>     <tr>       <td>Phylum</td>       <td>Chordata</td>     </tr>     <tr>       <td>Class</td>       <td>Mammalia</td>     </tr>     <tr>       <td>Order</td>       <td>Carnivora</td>     </tr>     <tr>       <td>Family</td>       <td>Felidae</td>     </tr>     <tr>       <td>Genus</td>       <td><em>Felis</em></td>     </tr>     <tr>       <td>Species</td>       <td><em>F. catus</em></td>     </tr>   </tbody> </table>   <p>From this classification, one can generate a tree of life, also known as a phylogenetic tree. It is a rooted tree that describes the relationship of all life on earth. At the root sits the “last universal common ancestor” and the three main branches (in taxonomy also called domains) are bacteria, archaea and eukaryotes. Most important for this is the idea that all life on earth is derived from a common ancestor and therefore when comparing two species, you will -sooner or later- find a common ancestor for all of them.</p>   <p>Let’s explore taxonomy in the Tree of Life, using <a href="https://lifemap.univ-lyon1.fr/">Lifemap</a></p>   <iframe id="Lifemap" src="https://lifemap.univ-lyon1.fr/explore.html" frameborder="0" width="100%" height="600px"></iframe> </blockquote>
<p><!--END_SNIPPET--></p>

<p>For metagenomic data analysis we start with sequences derived from DNA fragments that are isolated from the sample of interest. Ideally, the sequences from all microbes in the sample are present. The underlying idea of taxonomic assignment is to compare the DNA sequences found in the sample (reads) to DNA sequences of a database. When a read matches a database DNA sequence of a known microbe, we can derive a list with microbes present in the sample.</p>

<p>When talking about taxonomic assignment or taxonomic classification, most of the time we actually talk about two methods, that in practice are often used interchangeably:</p>
<ul>
  <li><strong>taxonomic binning</strong>: the clustering of individual sequence reads based on similarities criteria and assignation of clusters to reference taxa</li>
  <li><strong>taxonomic profiling</strong>: classification of individual reads to reference taxa to extract the relative abundances of the different taxa</li>
</ul>

<p>The reads can be obtained from <strong>amplicon sequencing</strong>  (e.g. 16S, 18S, ITS), where only specific gene or gene fragments are targeted (using specific primers) or <strong>shotgun metagenomic sequencing</strong>, where all the accessible DNA of a mixed community is amplified (using random primers). 
This tutorial focuses on reads obtained from shotgun metagenomic sequencing.</p>

<h2 id="taxonomic-profiling">Taxonomic profiling</h2>

<p>Tools for taxonomic profiling can be divided into three groups. Nevertheless, all of them require a pre-computed database based on previously sequenced microbial DNA or protein sequences.</p>
<ol>
  <li><strong>DNA-to-DNA</strong>: comparison of sequencing reads with genomic databases of DNA sequences with tools like Kraken (<span class="citation"><a href="#Wood2014">Wood and Salzberg 2014</a></span>)</li>
  <li><strong>DNA-to-Protein</strong> : comparison of sequencing reads with protein databases (more computationally intensive because all six frames of potential DNA-to amino acid translations need to be analyzed) with tools like DIAMOND)</li>
  <li><strong>Marker based</strong>: searching for marker genes (e.g. 16S rRNA sequence) in reads, which is quick, but introduces bias, with tools like MetaPhlAn (<span class="citation"><a href="#blanco2023extending">Blanco-Mı́guez Aitor <i>et al.</i> 2023</a></span>)</li>
</ol>

<p>The comparison of reads to database sequences can be done in different ways, leading to three different types of taxonomic assignment:</p>

<ul>
  <li>
    <p><strong>Genome based</strong> approach</p>

    <p>Reads are aligned to reference genomes. Considering the coverage and breadth, genomes are used to measure genome abundance. Furthermore, genes can be analyzed in genomic context. Advantages of this method are the high detection accuracy, that the unclassified percentage is known, that all SNVs can be detected and that high-resolution genomic comparisons are possible. This method takes medium compute cost.</p>
  </li>
  <li>
    <p><strong>Gene based</strong> approach</p>

    <p>Reads are aligned to reference genes. Next, marker genes are used to estimate species abundance. Furthermore, genes can be analyzed in isolation for presence or absence in a specific condition. The major advantage is the detection of the pangenome (entire set of genes within a species). Major disadvantages are the high compute cost, low detection accuracy and that the unclassified percentage is unknown. At least intragenic SNVs can be detected and low-resolution genomic comparison is possible.</p>
  </li>
  <li>
    <p><strong>k-mer based</strong> approach</p>

    <p>Databases as well as the samples DNA are broken into strings of length \(k\) for comparison. From all the genomes in the database, where a specific k-mer is found, a lowest common ancestor (LCA) tree is derived and the abundance of k-mers within the tree is counted. This is the basis for a root-to-leaf path calculation, where the path with the highest score is used for classification of the sample. By counting the abundance of k-mers, also an estimation of relative abundance of taxa is possible. The major advantage of k-mer based analysis is the low compute cost. Major disadvantages are the low detection accuracy, that the unclassified percentage is unknown and that there is no gene detection, no SNVs detection and no genomic comparison possible. An example for a k-mer based analysis tool is Kraken, which will be used in this tutorial.</p>
  </li>
</ul>

<p>After this theoretical introduction, let’s now get hands on analyzing an actual dataset!</p>

<h2 id="background-on-data">Background on data</h2>

<p>The dataset we will use for this tutorial comes from an oasis in the Mexican desert called Cuatro Ciénegas (<span class="citation"><a href="#Okie.2020">Okie <i>et al.</i> 2020</a></span>). The researchers were interested in genomic traits that affect the rates and costs of biochemical information processing within cells. They performed a whole-ecosystem experiment, thus fertilizing the pond to achieve nutrient enriched conditions.</p>

<p>Here we will use 2 datasets:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">JP4D</code>: a microbiome sample collected from the Lagunita Fertilized Pond</li>
  <li><code class="language-plaintext highlighter-rouge">JC1A</code>: a <strong>control</strong> samples from a control mesocosm.</li>
</ul>

<p>The datasets differ in size, but according to the authors this doesn’t matter for their analysis of genomic traits. Also, they underline that differences between the two samples reflect trait-mediated ecological dynamics instead of microevolutionary changes as the duration of the experiment was only 32 days. This means that depending on available nutrients, specific lineages within the pond grow more successfully than others because of their genomic traits.</p>

<p>The datafiles are named according to the first four characters of the filenames.
It is a collection of paired-end data with R1 being the forward reads and R2 being the reverse reads. Additionally, the reads have been trimmed using <strong>cutadapt</strong> as explained in the <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html">Quality control tutorial</a>.</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#taxonomic-profiling" id="markdown-toc-taxonomic-profiling">Taxonomic profiling</a></li>
  <li><a href="#background-on-data" id="markdown-toc-background-on-data">Background on data</a></li>
  <li><a href="#prepare-galaxy-and-data" id="markdown-toc-prepare-galaxy-and-data">Prepare Galaxy and data</a></li>
  <li><a href="#k-mer-based-taxonomic-assignment-with-kraken2" id="markdown-toc-k-mer-based-taxonomic-assignment-with-kraken2">k-mer based taxonomic assignment with Kraken2</a></li>
  <li><a href="#visualization-of-taxonomic-assignment" id="markdown-toc-visualization-of-taxonomic-assignment">Visualization of taxonomic assignment</a>    <ol>
      <li><a href="#visualisation-using-krona" id="markdown-toc-visualisation-using-krona">Visualisation using Krona</a></li>
      <li><a href="#visualization-using-pavian" id="markdown-toc-visualization-using-pavian">Visualization using Pavian</a></li>
    </ol>
  </li>
  <li><a href="#choosing-the-right-tool" id="markdown-toc-choosing-the-right-tool">Choosing the right tool</a></li>
  <li><a href="#marker-gene-based-approach-using-metaphlan" id="markdown-toc-marker-gene-based-approach-using-metaphlan">Marker gene based approach using MetaPhlAn</a></li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ol>

</blockquote>

<h1 id="prepare-galaxy-and-data">Prepare Galaxy and data</h1>

<p>Any analysis should get its own Galaxy history. So let’s start by creating a new one:</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Create a new history for this analysis</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a new history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>To create a new history simply click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel:</p>   <p><img src="/training-material/shared/images/history_create_new.svg" alt="UI for creating new history" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Rename the history</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Renaming a history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li>   <li>To cancel renaming, click the <i class="fas fa-undo" aria-hidden="true"></i><span class="visually-hidden">galaxy-undo</span> “Cancel” button</li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which can be the case if you are using an older version of Galaxy) do the following:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<p>Now, we need to import the data</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-import-datasets"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Import datasets</div>

  <ol>
    <li>
      <p>Import the following samples via link from <a href="https://zenodo.org/record/7871630">Zenodo</a> or Galaxy shared data libraries:</p>

      <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7871630/files/JC1A_R1.fastqsanger.gz
https://zenodo.org/record/7871630/files/JC1A_R2.fastqsanger.gz
https://zenodo.org/record/7871630/files/JP4D_R1.fastqsanger.gz
https://zenodo.org/record/7871630/files/JP4D_R2.fastqsanger.gz
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing via links</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-data-from-a-data-library"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-data-from-a-data-library" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing data from a data library</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>As an alternative to uploading the data from a URL or your computer, the files may also have been made available from a <em>shared data library</em>:</p>   <ol>   <li>Go into <strong>Data</strong> (top panel) then <strong>Data libraries</strong></li>   <li>Navigate to  the correct folder as indicated by your instructor.     <ul>       <li>On most Galaxies tutorial data will be provided in a folder named <strong>GTN - Material –&gt; Topic Name -&gt; Tutorial Name</strong>.</li>     </ul>   </li>   <li>Select the desired files</li>   <li>Click on <strong>Add to History</strong> <i class="fas fa-caret-down" aria-hidden="true"></i><span class="visually-hidden">galaxy-dropdown</span> near the top and select <strong>as Datasets</strong> from the dropdown menu</li>   <li>     <p>In the pop-up window, choose</p>     <ul>       <li><em>“Select history”</em>: the history you want to import the data to (or create a new one)</li>     </ul>   </li>   <li>Click on <strong>Import</strong></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Create a paired collection.</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-paired-collection"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-paired-collection" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a paired collection</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on <i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">galaxy-selector</span> <strong>Select Items</strong> at the top of the history panel <img src="/training-material/topics/galaxy-interface/images/historyItemControls.png" alt="Select Items button" /></li>   <li>Check all the datasets in your history you would like to include</li>   <li>     <p>Click <strong>n of N selected</strong> and choose <strong>Build List of Dataset Pairs</strong></p>   </li>   <li>Change the text of <em>unpaired forward</em> to a common selector for the forward reads</li>   <li>Change the text of <em>unpaired reverse</em> to a common selector for the reverse reads</li>   <li>Click <strong>Pair these datasets</strong> for each valid <em>forward</em> and <em>reverse</em> pair.</li>   <li>Enter a name for your collection</li>   <li>Click <strong>Create List</strong> to build your collection</li>   <li>Click on the checkmark icon at the top of your history again</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
  </ol>

</blockquote>

<h1 id="k-mer-based-taxonomic-assignment-with-kraken2">k-mer based taxonomic assignment with Kraken2</h1>

<p>Our input data is the DNA reads of microbes present at Cuatro Ciénegas.</p>

<p>To find out which microorganisms are present, we will compare the reads of the sample to a reference database, i.e. sequences of known microorganisms stored in a database, using <strong>Kraken2</strong> (<span class="citation"><a href="#wood2019improved">Wood <i>et al.</i> 2019</a></span>).</p>

<!--SNIPPET-->
<blockquote class="details">   <div class="box-title details-title" id="details-kraken2-and-the-k-mer-approach-for-taxonomy-classification"><button class="gtn-boxify-button details" type="button" aria-controls="details-kraken2-and-the-k-mer-approach-for-taxonomy-classification" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true"></i> <span>Details: Kraken2 and the k-mer approach for taxonomy classification</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>In the \(k\)-mer approach for taxonomy classification, we use a database containing DNA sequences of genomes whose taxonomy we already know. On a computer, the genome sequences are broken into short pieces of length \(k\) (called \(k\)-mers), usually 30bp.</p>   <p><strong>Kraken</strong> examines the \(k\)-mers within the query sequence, searches for them in the database, looks for where these are placed within the taxonomy tree inside the database, makes the classification with the most probable position, then maps \(k\)-mers to the lowest common ancestor (LCA) of all genomes known to contain the given \(k\)-mer.</p>   <p><img src="/training-material/topics/microbiome/faqs/images/kmers-kraken.jpg" alt="Kraken2" title="Kraken sequence classification algorithm. To classify a sequence, each k-mer in the sequence is mapped to the lowest common ancestor (LCA, i.e. the lowest node) of the genomes that contain that k-mer in the database. The taxa associated with the sequence's k-mers, as well as the taxa's ancestors, form a pruned subtree of the general taxonomy tree, which is used for classification. In the classification tree, each node has a weight equal to the number of k-mers in the sequence associated with the node's taxon. Each root-to-leaf (RTL) path in the classification tree is scored by adding all weights in the path, and the maximal RTL path in the classification tree is the classification path (nodes highlighted in yellow). The leaf of this classification path (the orange, leftmost leaf in the classification tree) is the classification used for the query sequence. Source: &lt;span class=&quot;citation&quot;&gt;&lt;a href=&quot;#Wood2014&quot;&gt;Wood and Salzberg 2014&lt;/a&gt;&lt;/span&gt;" /></p>   <p><strong>Kraken2</strong> uses a compact hash table, a probabilistic data structure that allows for faster queries and lower memory requirements. It applies a spaced seed mask of <em>s</em> spaces to the minimizer and calculates a compact hash code, which is then used as a search query in its compact hash table; the lowest common ancestor (LCA) taxon associated with the compact hash code is then assigned to the k-mer.</p>   <p>You can find more information about the <strong>Kraken2</strong> algorithm in the paper <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1891-0"><em>Improved metagenomic analysis with Kraken 2</em></a>.</p> </blockquote>
<p><!--END_SNIPPET--></p>

<p>For this tutorial, we will use the PlusPF database which contains the Standard (archaea, bacteria, viral, plasmid, human, UniVec_Core), protozoa and fungi data.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-what-is-in-the-pluspf-database"><button class="gtn-boxify-button details" type="button" aria-controls="details-what-is-in-the-pluspf-database" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: What is in the PlusPF database</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <table>
    <thead>
      <tr>
        <th>Database</th>
        <th>Origin</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Archaea</td>
        <td>RefSeq complete archaeal genomes/proteins</td>
      </tr>
      <tr>
        <td>Bacteria</td>
        <td>RefSeq complete bacterial genomes/proteins</td>
      </tr>
      <tr>
        <td>Plasmid</td>
        <td>RefSeq plasmid nucleotide/protein sequences</td>
      </tr>
      <tr>
        <td>Viral</td>
        <td>RefSeq complete viral genomes/proteins</td>
      </tr>
      <tr>
        <td>Human</td>
        <td>GRCh38 human genome/proteins</td>
      </tr>
      <tr>
        <td>Fungi</td>
        <td>RefSeq complete fungal genomes/proteins</td>
      </tr>
      <tr>
        <td>Plant</td>
        <td>RefSeq complete plant genomes/proteins</td>
      </tr>
      <tr>
        <td>Protozoa</td>
        <td>RefSeq complete protozoan genomes/proteins</td>
      </tr>
      <tr>
        <td>UniVec_Core</td>
        <td>A subset of UniVec, NCBI-supplied database of vector, adapter, linker, and primer sequences that may be contaminating sequencing projects and/or assemblies, chosen to minimize false positive hits to the vector database</td>
      </tr>
    </tbody>
  </table>

  <p>The databases have been prepared for Kraken2 by Ben Leagmead and <a href="https://benlangmead.github.io/aws-indexes/k2">details can found on his page</a>.</p>
</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-assign-taxonomic-labels-with-kraken2"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Assign taxonomic labels with Kraken2</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/kraken2/kraken2/2.1.1+galaxy1" title="Kraken2 tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Kraken2</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 2.1.1+galaxy1)</span> with the following parameters:
      <ul>
        <li><em>“Single or paired reads”</em>: <code class="language-plaintext highlighter-rouge">Paired Collection</code>
          <ul>
            <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Collection of paired reads”</em>: Input paired collection</li>
          </ul>
        </li>
        <li>
          <p><em>“Confidence”</em>: <code class="language-plaintext highlighter-rouge">0.1</code></p>

          <p>A confidence score of 0.1 means that at least 10% of the k-mers should match entries in the database. This value can be reduced if a less restrictive taxonomic assignation is desired.</p>
        </li>
        <li>In <em>“Create Report”</em>:
          <ul>
            <li><em>“Print a report with aggregrate counts/clade to file”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
          </ul>
        </li>
        <li><em>“Select a Kraken2 database”</em>: most recent <code class="language-plaintext highlighter-rouge">Prebuilt Refseq indexes: PlusPF</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<p><strong>Kraken2</strong> will create two outputs for each dataset</p>

<ul>
  <li>
    <p><strong>Classification</strong>: tabular files with one line for each sequence classified by Kraken and 5 columns:</p>

    <ol>
      <li><code class="language-plaintext highlighter-rouge">C</code>/<code class="language-plaintext highlighter-rouge">U</code>: a one letter indicating if the sequence classified or unclassified</li>
      <li>Sequence ID as in the input file</li>
      <li>NCBI taxonomy ID assigned to the sequence, or 0 if unclassified</li>
      <li>Length of sequence in bp (<code class="language-plaintext highlighter-rouge">read1|read2</code> for paired reads)</li>
      <li>
        <p>A space-delimited list indicating the lowest common ancestor (LCA) mapping of each k-mer in the sequence</p>

        <p>For example, <code class="language-plaintext highlighter-rouge">562:13 561:4 A:31 0:1 562:3</code> would indicate that:</p>
        <ol>
          <li>The first 13 k-mers mapped to taxonomy ID #562</li>
          <li>The next 4 k-mers mapped to taxonomy ID #561</li>
          <li>The next 31 k-mers contained an ambiguous nucleotide</li>
          <li>The next k-mer was not in the database</li>
          <li>The last 3 k-mers mapped to taxonomy ID #562</li>
        </ol>

        <p><code class="language-plaintext highlighter-rouge">|:|</code> indicates end of first read, start of second read for paired reads</p>
      </li>
    </ol>

    <p>For JC1A:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Column 1	Column 2	Column 3	Column 4	Column 5
 U 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:13417:1998 	0 	151|190 	A:18 0:14 2055:5 0:1 2220095:5 0:74 |:| 0:3 A:54 2:1 0:32 204455:1 2823043:5 0:60
 U 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:15782:2187 	0 	169|173 	0:101 37329:1 0:33 |:| 0:10 2751189:5 0:30 1883:2 0:39 2609255:5 0:48
 U 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:11745:2196 	0 	235|214 	0:173 2282523:5 2746321:2 0:21 |:| 0:65 2746321:2 2282523:5 0:108
 U 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:18358:2213 	0 	251|251 	0:35 281093:5 0:3 651822:5 0:145 106591:3 0:21 |:| 0:64 106591:3 0:145 651822:5
 U 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:14892:2226 	0 	68|59 	0:34 |:| 0:25
 U 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:18764:2247 	0 	146|146 	0:112 |:| 0:112
 C 	MISEQ-LAB244-W7:91:000000000-A5C7L:1:1101:12147:2252 	9606 	220|220 	9606:148 0:19 9606:19 |:| 9606:19 0:19 9606:148
</code></pre></div>    </div>

    <blockquote class="question">
      <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <p>For JC1A sample</p>
      <ol>
        <li>Is the first sequence in the file classified or unclassified?</li>
        <li>What is the taxonomy ID assigned to the first classified sequence?</li>
        <li>What is the corresponding taxon?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <ol>
          <li>classified</li>
          <li>9606, for the line 7</li>
          <li>9606 corresponds to Homo sapiens when looking at NCBI.</li>
        </ol>
      </blockquote>
    </blockquote>
  </li>
  <li>
    <p><strong>Report</strong>: tabular files with one line per taxon and 6 columns or fields</p>

    <ol>
      <li>Percentage of fragments covered by the clade rooted at this taxon</li>
      <li>Number of fragments covered by the clade rooted at this taxon</li>
      <li>Number of fragments assigned directly to this taxon</li>
      <li>A rank code, indicating
        <ul>
          <li>(U)nclassified</li>
          <li>(R)oot</li>
          <li>(D)omain</li>
          <li>(K)ingdom</li>
          <li>(P)hylum</li>
          <li>(C)lass</li>
          <li>(O)rder</li>
          <li>(F)amily</li>
          <li>(G)enus, or</li>
          <li>(S)pecies</li>
        </ul>

        <p>Taxa that are not at any of these 10 ranks have a rank code that is formed by using the rank code of the closest ancestor rank with a number indicating the distance from that rank. E.g., <code class="language-plaintext highlighter-rouge">G2</code> is a rank code indicating a taxon is between genus and species and the grandparent taxon is at the genus rank.</p>
      </li>
      <li>NCBI taxonomic ID number</li>
      <li>Indented scientific name</li>
    </ol>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Column 1	Column 2	Column 3	Column 4	Column 5	Column 6
 76.86 	105399 	105399 	U 	0 	unclassified
 23.14 	31740 	1197 	R 	1 	root
 22.20 	30448 	312 	R1 	131567 	cellular organisms
 12.58 	17254 	3767 	D 	2 	Bacteria
 8.77 	12027 	2867 	P 	1224 	Proteobacteria
 4.94 	6779 	3494 	C 	28211 	Alphaproteobacteria
 1.30 	1782 	1085 	O 	204455 	Rhodobacterales
 0.43 	593 	461 	F 	31989 	Rhodobacteraceae
 0.05 	74 	53 	G 	265 	Paracoccus
</code></pre></div>    </div>

    <blockquote class="question">
      <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <ol>
        <li>What are the percentage on unclassified for JC1A and JP4D?</li>
        <li>What are the kindgoms found for JC1A and JP4D?</li>
        <li>Where might the eukaryotic DNA come from?</li>
        <li>How is the diversity of Proteobacteria in JC1A and JP4D?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

        <ol>
          <li>78% for JC1A and 90% for JP4D</li>
          <li>Kindgoms:
            <ul>
              <li>JC1A: 13% Bacteria, 10% Eukaryota, 0.03% Virus</li>
              <li>JP4D: 10% Bacteria, 0.7% Eukaryota</li>
            </ul>
          </li>
          <li>It seems to be human contamination</li>
          <li>JC1A seems to have a big diversity of classes and species of Proteobacteria. JP4D seems more dominated by Aphaproteobacteria.</li>
        </ol>
      </blockquote>

    </blockquote>
  </li>
</ul>

<p>Getting an overview of the assignation is not straightforward with the <strong>Kraken2</strong> outputs directly. We can use visualisation tools for that.</p>

<p>A “simple and worthwile addition to Kraken for better abundance estimates” (<span class="citation"><a href="#Ye.2019">Ye <i>et al.</i> 2019</a></span>) is called <strong>Bracken</strong> (Bayesian Reestimation of Abundance after Classification with Kraken). Instead of only using proportions of classified reads, it takes a probabilistic approach to generate final abundance profiles. It works by re-distributing reads in the taxonomic tree: “Reads assigned to nodes above the species level are distributed down to the species nodes, while reads assigned at the strain level are re-distributed upward to their parent species” (<span class="citation"><a href="#Lu.2017">Lu <i>et al.</i> 2017</a></span>).</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-estimate-species-abundance-with-bracken"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Estimate species abundance with Bracken</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/bracken/est_abundance/2.7+galaxy1" title="Estimate Abundance at Taxonomic Level tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Estimate Abundance at Taxonomic Level</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 2.7+galaxy1)</span> with the following parameters:
      <ul>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Kraken report file”</em>: <strong>Report</strong> output of <strong>Kraken</strong></li>
        <li>
          <p><em>“Select a kmer distribution”</em>: <code class="language-plaintext highlighter-rouge">PlusPF</code>, same as for Kraken</p>

          <p>It is important to choose the same database that you also chose for Kraken2</p>
        </li>
        <li><em>“Level”</em>: <code class="language-plaintext highlighter-rouge">Species</code></li>
        <li><em>“Produce Kraken-Style Bracken report”</em>: <code class="language-plaintext highlighter-rouge">yes</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<h1 id="visualization-of-taxonomic-assignment">Visualization of taxonomic assignment</h1>

<p>Once we have assigned the corresponding taxa to each sequence, the next step is to properly visualize the data. There are several tools for that:</p>
<ul>
  <li><strong>Krona</strong> (<span class="citation"><a href="#Ondov.2011">Ondov <i>et al.</i> 2011</a></span>)</li>
  <li><strong>Phinch</strong> (<span class="citation"><a href="#Bik.2014">Bik 2014</a></span>)</li>
  <li><strong>Pavian</strong> (<span class="citation"><a href="#Breitwieser.2020">Breitwieser and Salzberg 2020</a></span>)</li>
</ul>

<h2 id="visualisation-using-krona">Visualisation using Krona</h2>

<p><strong>Krona</strong> creates an interactive HTML file allowing hierarchical data to be explored with zooming, multi-layered pie charts. With this tool, we can easily visualize the composition of the bacterial communities and compare how the populations of microorganisms are modified according to the conditions of the environment.</p>

<p>Kraken outputs can not be given directly to <strong>Krona</strong>, they first need to be converted.</p>

<p><strong>Krakentools</strong> (<span class="citation"><a href="#Lu.2017">Lu <i>et al.</i> 2017</a></span>) is a suite of tools to work on Kraken outputs. It include a tool designed to translate results of the Kraken metagenomic classifier to the full representation of NCBI taxonomy. The output of this tool can be directly visualized by the Krona tool.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-convert-kraken-report-file"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Convert Kraken report file</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/krakentools_kreport2krona/krakentools_kreport2krona/1.2+galaxy0" title="Krakentools: Convert kraken report file tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Krakentools: Convert kraken report file</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.2+galaxy0)</span> with the following parameters:
      <ul>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Kraken report file”</em>: <strong>Report</strong> collection of <strong>Kraken</strong></li>
      </ul>
    </li>
    <li>Inspect the generated output for JC1A</li>
  </ol>
</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question-2"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3868 	k__Bacteria
2867 	k__Bacteria 	p__Proteobacteria
3494 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria
1085 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales
461 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales 	f__Rhodobacteraceae
53 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales 	f__Rhodobacteraceae 	g__Paracoccus
10 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales 	f__Rhodobacteraceae 	g__Paracoccus 	s__Paracoccus_pantotrophus
6 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales 	f__Rhodobacteraceae 	g__Paracoccus 	s__Paracoccus_sanguinis
4 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales 	f__Rhodobacteraceae 	g__Paracoccus 	s__Paracoccus_sp._AK26
1 	k__Bacteria 	p__Proteobacteria 	c__Alphaproteobacteria 	o__Rhodobacterales 	f__Rhodobacteraceae 	g__Paracoccus 	s__Paracoccus_sp._MA
</code></pre></div>  </div>

  <ol>
    <li>What are the different columns?</li>
    <li>What are the lines?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>Column 1 seems to correspond to the number of fragments covered by a taxon, the columns after represent the different taxonomic level (from kingdom to species)</li>
      <li>A line is a taxon with its hierarchy and the number of reads assigned to is</li>
    </ol>
  </blockquote>

</blockquote>

<p>Let’s now run <strong>Krona</strong></p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-generate-krona-visualisation"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Generate Krona visualisation</div>
  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1+galaxy0" title="Krona pie chart tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Krona pie chart</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 2.7.1+galaxy0)</span> with the following parameters:
      <ul>
        <li><em>“Type of input data”</em>: <code class="language-plaintext highlighter-rouge">Tabular</code></li>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Input file”</em>: output of <strong>Krakentools</strong></li>
      </ul>
    </li>
    <li>Inspect the generated file</li>
  </ol>
</blockquote>

<iframe id="krona" src="krona-kraken.html" frameborder="0" width="100%" height="900px"> <a href="./images/krona-kraken.png" rel="noopener noreferrer"><img src="./images/krona-kraken.png" alt="Krona chart with multi-layered pie chart representing the community profile with in the center the higher taxonomy levels (i.e. domain) and on the exterior the more detailed ones (i.e. species). " width="1900" height="1869" loading="lazy" /></a> </iframe>

<blockquote class="question">
  <div class="box-title question-title" id="question-3"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>What are the percentage on unclassified for JC1A and JP4D?</li>
    <li>What are the kindgoms found for JC1A and JP4D?</li>
    <li>Where might the eukaryotic DNA come from?</li>
    <li>How is the diversity of Proteobacteria in JC1A and JP4D?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>78% for JC1A and 90% for JP4D</li>
      <li>Kindgoms:
        <ul>
          <li>JC1A: 13% Bacteria, 10% Eukaryota, 0.03% Virus</li>
          <li>JP4D: 10% Bacteria, 0.7% Eukaryota</li>
        </ul>
      </li>
      <li>It seems to be human contamination</li>
      <li>JC1A seems to have a big diversity of classes and species of Proteobacteria. JP4D seems more dominated by Aphaproteobacteria.</li>
    </ol>
  </blockquote>

</blockquote>

<h2 id="visualization-using-pavian">Visualization using Pavian</h2>

<p><strong>Pavian</strong> (pathogen visualization and more) (<span class="citation"><a href="#Breitwieser.2020">Breitwieser and Salzberg 2020</a></span>) is an interactive visualization tool for metagenomic data. It was developed for the clinical metagenomic problem to find a disease-causing pathogen in a patient sample, but it is useful to analyze and visualize any kind of metagenomics data.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-launch-pavian"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Launch Pavian</div>
  <ol>
    <li><span class="tool" data-tool="interactive_tool_pavian" title="Pavian tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Pavian</strong></span> with the following paramters:
      <ul>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Kraken and MetaPhlAn-style reports”</em>: <strong>Report</strong> collection of <strong>Kraken</strong></li>
      </ul>
    </li>
  </ol>

</blockquote>

<p><strong>Pavian</strong> runs a Galaxy Interactive tool. You can access it when it become orange.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-interact-with-pavian"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Interact with Pavian</div>

  <ol>
    <li>
      <p>Open <strong>Pavian</strong></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-open-interactive-tool"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-open-interactive-tool" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Open interactive tool</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Go to User &gt; Active InteractiveTools</li>   <li>Wait for the  to be running (Job Info)</li>   <li>Click on</li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>Import data
      <ol>
        <li>Click on <code class="language-plaintext highlighter-rouge">Use data on server</code></li>
        <li>Select both samples</li>
        <li>Click on <code class="language-plaintext highlighter-rouge">Read selected directories</code></li>
        <li>
          <p>Check you have a table in <code class="language-plaintext highlighter-rouge">Available sample sets</code> looks like</p>

          <table>
            <thead>
              <tr>
                <th>X</th>
                <th>FormatOK</th>
                <th>Include</th>
                <th>Name</th>
                <th>ReportFile</th>
                <th>ReportFilePath</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>X</td>
                <td>X</td>
                <td>JP4AD</td>
                <td>JP4AD</td>
                <td>/home/shiny//JP4AD</td>
              </tr>
              <tr>
                <td>2</td>
                <td>X</td>
                <td>X</td>
                <td>JC1A</td>
                <td>JC1A</td>
                <td>/home/shiny//JC1A</td>
              </tr>
            </tbody>
          </table>
        </li>
        <li>Click on <code class="language-plaintext highlighter-rouge">Save table</code></li>
      </ol>
    </li>
    <li>Click on <code class="language-plaintext highlighter-rouge">Results Overview</code> in the left panel</li>
  </ol>

</blockquote>

<p>This page shows the summary of the classifications in the selected sample set:</p>

<p><a href="./images/pavian-kraken-results-overview.png" rel="noopener noreferrer"><img src="./images/pavian-kraken-results-overview.png" alt="Screenshot of a table with 2 rows (JP4A and JC1A) and columns: Name, Number of raw reads, Classified reads, Chordate reads, Artificial reads, Unclassified reads, Microbial reads, Bacterial reads, Viral reads, Fungal reads, Protozoan reads. The cells have a barchart that shows the relation of the cell value to other cell values in the same category. " width="1225" height="148" loading="lazy" /></a></p>

<blockquote class="question">
  <div class="box-title question-title" id="question-4"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

  <ol>
    <li>Does both sample have same size?</li>
    <li>What are the percentage of classified reads for JC1A and JP4D?</li>
    <li>Are the percentage of bacterial reads similar?</li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-4"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-4" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>JP4D has much more reads than JC1A</li>
      <li>10.2% for JP4D and 23.1% for JC1A</li>
      <li>12.6% for JC1A and 9.44% for JP4D. So similar magnitude orders</li>
    </ol>
  </blockquote>

</blockquote>

<p>Let’s now inspect assignements to reads per sample.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-inspect-samples-with-pavian"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Inspect samples with Pavian</div>

  <ol>
    <li>Click on <code class="language-plaintext highlighter-rouge">Sample</code> in the left panel</li>
    <li>
      <p>Select <code class="language-plaintext highlighter-rouge">JC1A</code> in the <code class="language-plaintext highlighter-rouge">Select sample</code> drop-down on the top</p>

      <p>The first view gives a Sankey diagram for one sample:</p>

      <p><a href="./images/pavian-kraken-sankey-JC1A.png" rel="noopener noreferrer"><img src="./images/pavian-kraken-sankey-JC1A.png" alt="Sankey plot with taxonomy hierarchy from domain on the left to species on the right. " width="756" height="400" loading="lazy" /></a></p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-5"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <ol>
          <li>What is a Sankey diagram?</li>
          <li>What are the different set of values represented as the horizontal axis?</li>
        </ol>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-5"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-5" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

          <ol>
            <li>A sankey diagram is a visualization used to depict a flow from one set of values to another</li>
            <li>The taxonomy hierarchy from domain on the left to species on the right</li>
          </ol>
        </blockquote>

      </blockquote>
    </li>
    <li>Click on <code class="language-plaintext highlighter-rouge">Proteobacteria</code> in the Sankey plot</li>
    <li>
      <p>Inspect the created graph on the right</p>

      <p><a href="./images/pavian-kraken-proteobacteria.png" rel="noopener noreferrer"><img src="./images/pavian-kraken-proteobacteria.png" alt="Bar plot with the number of reads across all samples for Proteobacteria. JP4A bar is much higher than JC1A one. The turqoise bar shows the number of reads that are identified at the specific taxon; the orange bar shows the number of reads identified at children of the specified taxon." width="519" height="211" loading="lazy" /></a></p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-6"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <ol>
          <li>Are the number of reads assigned to Proteobacteria similar for both samples?</li>
          <li>Why?</li>
        </ol>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-6"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-6" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

          <ol>
            <li>JP4A has many more reads assigned to Proteobacteria than JC1A</li>
            <li>JP4A has many more reads initialls</li>
          </ol>
        </blockquote>

      </blockquote>
    </li>
  </ol>
</blockquote>

<p>We would like now to compare both samples.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-inspect-samples-with-pavian-1"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Inspect samples with Pavian</div>

  <ol>
    <li>Click on <code class="language-plaintext highlighter-rouge">Comparison</code> in the left panel</li>
    <li>Select <code class="language-plaintext highlighter-rouge">%</code>  and unclick <code class="language-plaintext highlighter-rouge">Reads</code> in the blue area drop-down on the top</li>
    <li>
      <p>Click on <code class="language-plaintext highlighter-rouge">Domain</code> green button</p>

      <p><a href="./images/pavian-kraken-comparison-domain.png" rel="noopener noreferrer"><img src="./images/pavian-kraken-comparison-domain.png" alt="Screenshot of a table with 4 rows (Bacteria, Eukaryota, Archaea, Viruses) and / columns (Name, Rank, TID, Max, JP4A, JC1A, Lineage). " width="1103" height="146" loading="lazy" /></a></p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-7"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <p>Is there similar proportion of Bacteria in both samples?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-7"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-7" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

          <p>JP4D has much higher proportion of Bacteria (&gt; 93%&gt;) than JC1A (57%), which contains quite a lot of Eukaryote</p>
        </blockquote>

      </blockquote>
    </li>
    <li>
      <p>Select <code class="language-plaintext highlighter-rouge">Homo sapiens</code> in the <code class="language-plaintext highlighter-rouge">Filter taxa</code> box below the green buttons</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-8"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <p>Is there similar proportion of Bacteria in both samples?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-8"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-8" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

          <p>After human filtering, both samples have similar proportion of Bacteria</p>
        </blockquote>

      </blockquote>
    </li>
    <li>
      <p>Click on <code class="language-plaintext highlighter-rouge">Class</code> green button</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-9"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

        <ol>
          <li>How are the diversities of classes in both samples?</li>
          <li>What could it biologically mean given that JC1A is a control and JP4D a sample from fertilized pond?</li>
        </ol>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-9"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-9" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

          <ol>
            <li>JP4D seems highly dominated by a Alphaproteobacteria class. JC1A has also a majority of Alphaproteobacteria, but also significant proportions of Betaproteobacteria, Gammaproteobacteria, Flavobacteria, Actinomycetia</li>
            <li>Alphaproteobacteria seems to have a survival advantage in the new environment. According to the authors this correlates with specific genomic traits that enable them to cope better with high nutrient availability.</li>
          </ol>
        </blockquote>

      </blockquote>
    </li>
  </ol>

</blockquote>

<p>Once you are done with Pavian, you should delete it in your history so the corresponding job is killed.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-visualize-the-taxonomical-classification-with-phinch"><button class="gtn-boxify-button details" type="button" aria-controls="details-visualize-the-taxonomical-classification-with-phinch" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Visualize the taxonomical classification with Phinch</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p><strong>Phinch</strong> (<span class="citation"><a href="#Bik.2014">Bik 2014</a></span>) is another tools to visualize large biological datasets like our taxonomic classification. Taxonomy Bar Charts, Bubble Charts, Sankey Diagrams, Donut Partitions and Attributes Column Chart can be generated using this tool.</p>

  <p>As a first step, we need to convert the Kraken output file into a kraken-biom file to make it accessible for Phinch. For this, we need to add a metadata file, provided on <a href="https://zenodo.org/record/7871630/files/metadata.tabular">Zenodo</a>.
When generating a metadata file for your own data, you can take this as an example and apply the <a href="http://qiime.org/documentation/file_formats.html">general guidelines</a>.</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-phinch"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Phinch</div>
    <ol>
      <li>
        <p>Import the metadata tabular from <a href="https://zenodo.org/record/7871630">Zenodo</a> or Galaxy shared data libraries:</p>

        <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/7871630/files/metadata.tabular
</code></pre></div>        </div>
      </li>
      <li>Use <span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/kraken_biom/kraken_biom/1.2.0+galaxy1" title="Kraken-biom tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Kraken-biom</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.2.0+galaxy1)</span> to convert Kraken2 report into the correct format for phinch with the following parameters.
        <ul>
          <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Input”</em>: <strong>Report</strong> output of <strong>Kraken2</strong></li>
          <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Sample Metadata file”</em>: Metadata tabular</li>
          <li><em>“Output format”</em>: <code class="language-plaintext highlighter-rouge">JSON</code></li>
        </ul>
      </li>
      <li><span class="tool" data-tool="interactive_tool_phinch" title="Phinch Visualisation tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Phinch Visualisation</strong></span> with the following paramters:
        <ul>
          <li><em>“Input”</em>: <code class="language-plaintext highlighter-rouge">Kraken-biom output file</code></li>
        </ul>
      </li>
    </ol>
  </blockquote>

  <p><strong>Phinch</strong> runs a Galaxy Interactive tool. You can access it when it become orange.</p>

  <blockquote class="notranslate hands_on">
    <div class="box-title hands-on-title" id="hands-on-interact-with-phinch"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Interact with Phinch</div>

    <ol>
      <li>
        <p>Open <strong>Phinch</strong></p>

        <!--SNIPPET-->
        <blockquote class="tip">   <div class="box-title tip-title" id="tip-open-interactive-tool-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-open-interactive-tool-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Open interactive tool</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Go to User &gt; Active InteractiveTools</li>   <li>Wait for the  to be running (Job Info)</li>   <li>Click on</li> </ol> </blockquote>
        <p><!--END_SNIPPET--></p>

        <p>The first pages shows an overview of your samples. Here, you have the possibility to further filter your data, for example by date or location, depending on which information you provided in your metadata file.</p>

        <blockquote class="question">
          <div class="box-title question-title" id="question-10"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

          <ol>
            <li>How many sequence reads do the samples contain?</li>
          </ol>

          <blockquote class="solution">
            <div class="box-title solution-title" id="solution-10"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-10" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

            <ol>
              <li>JC1A (Phinch name: 0) contains 56008 reads, while JP4D (Phinch name: 1) contains 242438 reads</li>
            </ol>
          </blockquote>
        </blockquote>
      </li>
      <li>
        <p>Click on <code class="language-plaintext highlighter-rouge">Proceed to gallery</code> to see an overview of all visualization options.</p>
      </li>
    </ol>
  </blockquote>

  <p>Let’s have a look at the <strong>taxonomy bar chart</strong>. Here, you can see the abundance of different taxa depicted in different colors in your samples. On top of the chart you can select which rank is supposed to be shown in the chart.  You can also change the display options to for example switch between value und percentage.</p>

  <blockquote class="question">
    <div class="box-title question-title" id="question-11"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <ol>
      <li>What information can you get from hovering over a sample?</li>
      <li>How many percent of the sample reads are bacteria and how many are eukaryota?</li>
    </ol>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-11"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-11" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

      <ol>
        <li>the taxon’s name and the taxonomy occurrence in the sample</li>
        <li>choose kingdom and hover over the bars to find “taxonomy occurence in this sample”:
          <ul>
            <li>Sample 0: 75,65 % bacteria; 24,51 % eukaryota</li>
            <li>Sample 1: 92,70 % bacteria; 6,87 % eukaryota</li>
          </ul>
        </li>
      </ol>
    </blockquote>
  </blockquote>

  <p>Let’s go back to the gallery and choose the <strong>bubble chart</strong>. Here, you can find the distribution of taxa across the whole dataset at the rank that you can choose above the chart. When hovering over the bubbles, you get additional information concerning the taxon.</p>

  <blockquote class="question">
    <div class="box-title question-title" id="question-12"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <ol>
      <li>Which is the most abundant Class?</li>
      <li>How many reads are found in both samples?</li>
    </ol>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-12"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-12" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

      <p>To order the bubbles according to their size you can choose the <code class="language-plaintext highlighter-rouge">list</code> option shown right next to the taxonomy level. Clicking on one bubble gives you the direct comparison of the distribution of this taxon in the different samples.</p>
      <ol>
        <li>The most abundant Class is Alphaproteobacteria</li>
        <li>With 18.114 reads in Sample 0 and 153.230 reads in sample 1</li>
      </ol>
    </blockquote>
  </blockquote>

  <p>Another displaying option is the <strong>Sankey diagram</strong>, that is depicting the abundance of taxonomies as a flow chart. Again, you can choose the taxonomy level that you want to show in your diagram. When clicking on one bar of the diagram, this part is enlarged for better view.</p>

  <p>The <strong>donut partition</strong> summarizes the microbial community according to non-numerical attributes. In the drop-down menu at the top right corner, you can switch between the different attributes provided in the metadata file. In our case, you can for example choose the ‘environmental medium’ to see the difference between sediment and water (It doesn’t really make a lot of sense in our very simple dataset, as this will show the same result as sorting them by sample 0 and 1, but if attributes change across different samples this might be an interesting visualization option). When clicking on one part of the donut you will also find the distribution of the taxon across the samples. On the right hand side you can additionally choose if you’d like to have dynamic y axis or prefer standard y axis to compare different donuts with each other.</p>

  <p>The <strong>attributes column chart</strong> summarizes the microbial community according to numerical attributes. In the drop-down menu at the top right corner, you can switch between the different attributes provided in the metadata file. In our case, you can for example choose the ‘geographic location’ to (again, it doesn’t really make a lot of sense in our very simple dataset, as this will show the same result as sorting them by sample 0 and 1, but if attributes change across different samples this might be an interesting visualization option).</p>

  <p>Once you are done with Phinch, you should delete it in your history so the corresponding job is killed.</p>
</blockquote>

<h1 id="choosing-the-right-tool">Choosing the right tool</h1>

<p>When it comes to taxonomic assignment while analyzing metagenomic data, <strong>Kraken2</strong> is not the only tool available. Several papers do benchmarking of different tools (<span class="citation"><a href="#Meyer.2022">Meyer <i>et al.</i> 2022</a></span>,<span class="citation"><a href="#Sczyrba.2017">Sczyrba <i>et al.</i> 2017</a></span>,<span class="citation"><a href="#Ye.2019">Ye <i>et al.</i> 2019</a></span>).</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-benchmarking-taxonomic-classification-tools"><button class="gtn-boxify-button details" type="button" aria-controls="details-benchmarking-taxonomic-classification-tools" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Benchmarking taxonomic classification tools</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>The benchmarking papers present different methods for comparing the available tools:</p>
  <ul>
    <li>The <strong>CAMI challenge</strong> is based on results of different labs that each used the CAMI dataset to perform their analysis on and send it back to the authors.</li>
    <li><span class="citation"><a href="#Ye.2019">Ye <i>et al.</i> 2019</a></span> performed all the analysis themselves.</li>
  </ul>

  <p>Additionally, the datasets used for both benchmarking approaches differ:</p>
  <ul>
    <li><strong>CAMI</strong>: only ~30%-40% of reads are simulated from known taxa while the rest of the reads are from novel taxa, plasmids or simulated evolved strains.</li>
    <li><span class="citation"><a href="#Ye.2019">Ye <i>et al.</i> 2019</a></span> used International Metagenomics and Microbiome Standards Alliance (IMMSA) datasets, wherein the taxa are described better.</li>
  </ul>

  <p>When benchmarking different classification tools, several metrics are used to compare their performance:</p>
  <ol>
    <li><strong>Precision</strong>: proportion of true positive species identified in the sample divided by number of total species identified by the method.</li>
    <li><strong>Recall</strong>: proportion of true positive species divided by the number of distinct species actually in the sample.</li>
    <li>Precision-recall curve: each point represents the precision and recall scores at a specific abundance threshold, the <strong>area under the precision-recall curve (AUPR)</strong></li>
    <li><strong>L2 distance</strong>: representation of abundance profiles → how accurately the abundance of each species or genera in the resulting classification reflects the abundance of each species in the original biological sample (“ground truth”)</li>
  </ol>

  <p>When it comes to taxonomic profiling, thus investigating the abundance of specific taxa, the biggest problem is the abundance bias. It is introduced during isolation of DNA (which might work for some organisms better then for others) and by PCR duplicates during PCR amplification.</p>
</blockquote>

<blockquote class="details">
  <div class="box-title details-title" id="details-profiling-tools"><button class="gtn-boxify-button details" type="button" aria-controls="details-profiling-tools" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Profiling tools</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>Profilers, which are tools that investigate relative abundances of taxa within a dataset, fall into three groups depending on their performance:</p>
  <ol>
    <li>Profilers, that correctly predict relative abundances</li>
    <li>Precise profilers (suitable, when many false positives would increase cost and effort in downstream analysis)</li>
    <li>Profilers with high recall (suitable for pathogen detection, when the failure of detecting an organism can have severe negative consequences)</li>
  </ol>

  <p>However, some characteristics are common to all profilers:</p>
  <ul>
    <li>Most profilers only perform well until the family level</li>
    <li>Drastic decrease in performance between family and genus level, while little change between order and family level</li>
    <li>Poorer performance of all profilers on CAMI datasets compared to International Metagenomics and Microbiome Standards Alliance (IMMSA)</li>
    <li>Fidelity of abundance estimates decreases notably when viruses and plasmids were present</li>
    <li>High numbers of false positive calls at low abundance</li>
    <li>Taxonomic profilers vs profiles from taxonomic binning:
Precision and recall of the taxonomic binners were comparable to that of the profilers;
abundance estimation at higher ranks was more problematic for the binners</li>
  </ul>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Tool</th>
      <th>Approach</th>
      <th>Available in Galaxy</th>
      <th>CAMI challenge</th>
      <th><span class="citation"><a href="#Ye.2019">Ye <i>et al.</i> 2019</a></span></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>mOTUs</td>
      <td> </td>
      <td>No</td>
      <td>Most memory efficient</td>
      <td> </td>
    </tr>
    <tr>
      <td>MetaPhlAn</td>
      <td>Marker genes</td>
      <td>Yes</td>
      <td> </td>
      <td>Recommended for low computational requirements (&lt; 2 Gb of memory)</td>
    </tr>
    <tr>
      <td>DUDes</td>
      <td> </td>
      <td>No</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>FOCUS</td>
      <td> </td>
      <td>No</td>
      <td>Fast, most memory efficient</td>
      <td> </td>
    </tr>
    <tr>
      <td>Bracken</td>
      <td>k-mer</td>
      <td>Yes</td>
      <td>Fast</td>
      <td> </td>
    </tr>
    <tr>
      <td>Kraken</td>
      <td>k-mer</td>
      <td>Yes</td>
      <td>Fastest; most memory efficient</td>
      <td>Good performance metrics; very fast on large numbers of samples; allow custom databases when high amounts of memory (&gt;100 Gb) are available</td>
    </tr>
  </tbody>
</table>

<h1 id="marker-gene-based-approach-using-metaphlan">Marker gene based approach using MetaPhlAn</h1>

<p>In this tutorial, we follow second approach using <strong>MetaPhlAn</strong> (<span class="citation"><a href="#truong2015metaphlan2">Truong <i>et al.</i> 2015</a></span>). MetaPhlAn is a computational tool for profiling the composition of microbial communities (Bacteria, Archaea and Eukaryotes) from metagenomic shotgun sequencing data (i.e. not 16S) at species-level. MetaPhlAn 4 relies on ~5.1M unique clade-specific marker genes identified from ~1M microbial genomes (~236,600 references (bacterial, archeal, viral and eukaryotic) and 771,500 metagenomic assembled genomes) spanning 26,970 species-level genome bins.</p>

<p>It allows:</p>
<ul>
  <li>unambiguous taxonomic assignments;</li>
  <li>accurate estimation of organismal relative abundance;</li>
  <li>species-level resolution for bacteria, archaea, eukaryotes and viruses;</li>
  <li>strain identification and tracking</li>
  <li>orders of magnitude speedups compared to existing methods.</li>
  <li>microbiota strain-level population genomics</li>
  <li>MetaPhlAn clade-abundance estimation</li>
</ul>

<p>The basic usage of MetaPhlAn consists in the identification of the clades (from phyla to species and strains in particular cases) present in the microbiota obtained from a microbiome sample and their relative abundance.</p>

<p><strong>MetaPhlAn</strong> in Galaxy can not directly take as input a paired collection but expect 2 collections: 1 with forward data and 1 with reverse. Before launching <strong>MetaPhlAn</strong>, we need to split our input paired collection.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-assign-taxonomic-labels-with-metaphlan"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Assign taxonomic labels with MetaPhlAn</div>

  <ol>
    <li><span class="tool" data-tool="__UNZIP_COLLECTION__" title="Unzip collection tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Unzip collection</strong></span> with the following parameters:
      <ul>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Paired input to unzip”</em>: Input paired collection</li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/metaphlan/metaphlan/4.0.6+galaxy1" title="MetaPhlAn tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>MetaPhlAn</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 4.0.6+galaxy1)</span> with the following parameters:
      <ul>
        <li>In <em>“Inputs”</em>
          <ul>
            <li><em>“Input(s)”</em>: <code class="language-plaintext highlighter-rouge">Fasta/FastQ file(s) with microbiota reads</code>
              <ul>
                <li><em>“Fasta/FastQ file(s) with microbiota reads”</em>: <code class="language-plaintext highlighter-rouge">Paired-end files</code>
                  <ul>
                    <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Forward paired-end Fasta/FastQ file with microbiota reads”</em>: output of <strong>Unzip collection</strong> with <strong>forward</strong> in the name</li>
                    <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Reverse paired-end Fasta/FastQ file with microbiota reads”</em>: output of <strong>Unzip collection</strong> with <strong>reverse</strong> in the name</li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>In <em>“Outputs”</em>:
          <ul>
            <li><em>“Output for Krona?”</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>5 files and a collection are generated by <strong>MetaPhlAn</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Predicted taxon relative abundances</code>: tabular files with the <strong>community profile</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> #SampleID 	Metaphlan_Analysis 		
 #clade_name 	NCBI_tax_id 	relative_abundance 	additional_species
 k__Bacteria 	2 	100.0 	
 k__Bacteria|p__Bacteroidetes 	2|976 	94.38814 	
 k__Bacteria|p__Proteobacteria 	2|1224 	5.61186 	
 k__Bacteria|p__Bacteroidetes|c__CFGB45935 	2|976| 	94.38814 	
 k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria 	2|1224|28211 	5.61186 	
 k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935 	2|976|| 	94.38814 	
 k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales 	2|1224|28211|204455 	5.61186 	
 k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935 	2|976||| 	94.38814 	
 k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae 	2|1224|28211|&gt; 204455|    31989 	5.61186 	
 k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935|g__GGB56609 	2|976|||| 	94.38814 	
 k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae|g__Phycocomes 	2| 1224|    28211|204455|31989|2873978 	5.61186 	
 k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935|g__GGB56609|s__GGB56609_SGB78025 	2| 976||||| 	94.    38814 	
 k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae|g__Phycocomes|     s__Phycocomes_zhengii 	2|1224|28211|204455|31989|2873978|2056810 	5.61186 	
 k__Bacteria|p__Bacteroidetes|c__CFGB45935|o__OFGB45935|f__FGB45935|g__GGB56609|s__GGB56609_SGB78025| t__SGB78025 	2|    976|||||| 	94.38814 	
 k__Bacteria|p__Proteobacteria|c__Alphaproteobacteria|o__Rhodobacterales|f__Rhodobacteraceae|g__Phycocomes|     s__Phycocomes_zhengii|t__SGB31485 	2|1224|28211|204455|31989|2873978|2056810| 	5.61186 	
</code></pre></div>    </div>

    <p>Each line contains 4 columns:</p>
    <ol>
      <li>the lineage with different taxonomic levels, from high level taxa (kingdom: <code class="language-plaintext highlighter-rouge">k__</code>) to more precise taxa</li>
      <li>the NCBI taxon ids of the lineage taxonomic level</li>
      <li>the relative abundance found for our sample for the lineage</li>
      <li>any additional species</li>
    </ol>

    <blockquote class="question">
      <div class="box-title question-title" id="question-13"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

      <ol>
        <li>Which kindgoms have been identified for JC1A?</li>
        <li>For JP4D?</li>
        <li>How is the diversity for JP4D compared to <strong>Kraken</strong> results?</li>
      </ol>

      <blockquote class="solution">
        <div class="box-title solution-title" id="solution-13"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-13" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
        <ol>
          <li>All reads have been unclassified so no kindgom identified</li>
          <li>Bacteria, no eukaryotes</li>
          <li>Diversity is really reduced for JP4D using <strong>MetaPhlAn</strong>, compared to the one identified with <strong>Kraken</strong></li>
        </ol>
      </blockquote>
    </blockquote>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">Predicted taxon relative abundances for Krona</code>: same information as the previous files but formatted for &gt; visualization using <strong>Krona</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Column 1	Column 2	Column 3	Column 4	Column 5	Column 6	Column 7	Column 8	Column 9	Column 10
 94.38814 		Bacteria 	Bacteroidetes 	CFGB45935 	OFGB45935 	FGB45935 	GGB56609 	GGB56609 SGB78025 	
 5.61186 		Bacteria 	Proteobacteria 	Alphaproteobacteria 	Rhodobacterales 	Rhodobacteraceae 	Phycocomes 	Phycocomes zhengii 	
 94.38814 		Bacteria 	Bacteroidetes 	CFGB45935 	OFGB45935 	FGB45935 	GGB56609 	GGB56609 SGB78025 	SGB78025
 5.61186 		Bacteria 	Proteobacteria 	Alphaproteobacteria 	Rhodobacterales 	Rhodobacteraceae 	Phycocomes 	Phycocomes zhengii 	SGB31485 
</code></pre></div>    </div>

    <p>Each line represent an identified taxons with 9 columns:</p>
    <ul>
      <li>Column 1: The percentage of reads assigned the taxon</li>
      <li>Column 2-9: The taxon description at the different taxonomic levels from Kindgom to more precise taxa</li>
    </ul>
  </li>
  <li>A <strong>collection</strong> with the same information as in the tabular file but splitted into different files, one per taxonomic level</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">BIOM file</code> with <strong>community profile</strong> in BIOM format, a common and standard format in microbiomics and used as the input for tools like mothur or Qiime.</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">Bowtie2 output</code> and <code class="language-plaintext highlighter-rouge">SAM file</code> with the results of the sequence mapping on the reference database</li>
</ul>

<p>Let’s now run <strong>Krona</strong> to visualize the communities</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-generate-krona-visualisation-1"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Generate Krona visualisation</div>
  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/crs4/taxonomy_krona_chart/taxonomy_krona_chart/2.7.1" title="Krona pie chart tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Krona pie chart</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 2.7.1)</span> with the following parameters:
      <ul>
        <li><em>“Type of input data”</em>: <code class="language-plaintext highlighter-rouge">tabular</code></li>
        <li><i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">param-collection</span> <em>“Input file”</em>: Krona output of <strong>Metaphlan</strong></li>
      </ul>
    </li>
    <li>Inspect the generated file</li>
  </ol>
</blockquote>

<p>As pointed before, the community looks a lot less diverse than with <strong>Kraken</strong>. This is probably due to the reference database, which is potentially not complete enough yet to identify all taxons. Or there are too few reads in the input data to cover enough marker genes. Indeed, no taxon has been identified for JC1A, which contains much less reads than JP4D. However, <strong>Kraken</strong> is also known to have high number of false positive. A benchmark dataset or mock community where the community DNA content is known would be required to correctly judge which tool provides the better taxonomic classification.</p>

<h1 id="conclusion">Conclusion</h1>

<p>In this tutorial, we look how to get the community profile from microbiome data. We apply <strong>Kraken2</strong> or <strong>MetaPhlAn</strong> to assign taxonomic labels to two microbiome sample datasets. We then visualize the results using <strong>Krona</strong>, <strong>Pavian</strong> and <strong>Phinch</strong> to analyze and compare the datasets. Finally, we discuss important facts when it comes to choosing the right tool for taxonomic assignment.å</p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                        <h3>You've Finished the Tutorial</h3>
                        <button id="tutorial-finish-button" class="btn btn-primary" onclick="tutorial_finish()">I finished this tutorial 👍</button>
                        <p style="display: none" id="tutorial-finish-text">Please also consider filling out the <a href="#gtn-feedback">Feedback Form</a> as well!</p>
                        <script>
                        function tutorial_finish() {
                          if(plausible !== undefined){
                            plausible('TutorialComplete', {callback: tutorial_finish_finish, props: {path: document.location.pathname}})
                          } else {
                            tutorial_finish_finish();
                          }
                        }
                        function tutorial_finish_finish() {
                          document.getElementById("tutorial-finish-button").innerText = 'Congrats! Thanks for letting us know! 🎉'
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-text").style.display = 'block'
                        }
                        </script>

                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>There are 3 different types of taxonomic assignment (genome, gene or k-mer based)</p>
</li>
                        
                        <li><p>Kraken or MetaPhlAn can be used in Galaxy for taxonomic assignment</p>
</li>
                        
                        <li><p>Visualization of community profiles can be done using Krona or Pavian</p>
</li>
                        
                        <li><p>The taxonomic classification tool to use depends on the data</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the  <a href="/training-material/topics/microbiome/faqs/">FAQ page for the Microbiome topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                
                <h1 data-toc-skip>Useful literature</h1>
                <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/microbiome#references">here</a>.</p>
                


                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="whipps1988mycoparasitism">Whipps, J. M., K. Lewis, and R. C. Cooke, 1988 <b>Mycoparasitism and plant disease control</b>. Fungi in biological control systems 1988: 161–187. <a href="https://www.jstor.org/stable/2434885">https://www.jstor.org/stable/2434885</a></li>
<li id="Ondov.2011">Ondov, B. D., N. H. Bergman, and A. M. Phillippy, 2011 <b>Interactive metagenomic visualization in a Web browser</b>. BMC Bioinformatics 12: 385. <a href="https://doi.org/10.1186/1471-2105-12-385">10.1186/1471-2105-12-385</a></li>
<li id="Bik.2014">Bik, H. M., 2014 <b>Phinch: An interactive, exploratory data visualization framework for –Omic datasets</b>. <a href="https://doi.org/10.1101/009944">10.1101/009944</a></li>
<li id="Wood2014">Wood, D. E., and S. L. Salzberg, 2014 <b>Kraken: ultrafast metagenomic sequence classification using exact alignments</b>. Genome Biology 15: R46. <a href="https://doi.org/10.1186/gb-2014-15-3-r46">10.1186/gb-2014-15-3-r46</a></li>
<li id="truong2015metaphlan2">Truong, D. T., E. A. Franzosa, T. L. Tickle, M. Scholz, G. Weingart <i>et al.</i>, 2015 <b>MetaPhlAn2 for enhanced metagenomic taxonomic profiling</b>. Nature methods 12: 902. <a href="https://doi.org/10.1038/nmeth.3589">10.1038/nmeth.3589</a></li>
<li id="Lu.2017">Lu, J., F. P. Breitwieser, P. Thielen, and S. L. Salzberg, 2017 <b>Bracken: estimating species abundance in metagenomics data</b>. PeerJ Computer Science 3: e104. <a href="https://doi.org/10.7717/peerj-cs.104">10.7717/peerj-cs.104</a></li>
<li id="Sczyrba.2017">Sczyrba, A., P. Hofmann, P. Belmann, D. Koslicki, S. Janssen <i>et al.</i>, 2017 <b>Critical Assessment of Metagenome Interpretation-a benchmark of metagenomics software</b>. Nature methods 14: 1063–1071. <a href="https://doi.org/10.1038/nmeth.4458">10.1038/nmeth.4458</a></li>
<li id="wood2019improved">Wood, D. E., J. Lu, and B. Langmead, 2019 <b>Improved metagenomic analysis with Kraken 2</b>. Genome biology 20: 1–13. <a href="https://doi.org/10.1186/s13059-019-1891-0">10.1186/s13059-019-1891-0</a></li>
<li id="Ye.2019">Ye, S. H., K. J. Siddle, D. J. Park, and P. C. Sabeti, 2019 <b>Benchmarking Metagenomics Tools for Taxonomic Classification</b>. Cell 178: 779–794. <a href="https://doi.org/10.1016/j.cell.2019.07.010">10.1016/j.cell.2019.07.010</a></li>
<li id="Breitwieser.2020">Breitwieser, F. P., and S. L. Salzberg, 2020 <b>Pavian: interactive analysis of metagenomics data for microbiome studies and pathogen identification</b>. Bioinformatics (Oxford, England) 36: 1303–1304. <a href="https://doi.org/10.1093/bioinformatics/btz715">10.1093/bioinformatics/btz715</a></li>
<li id="Okie.2020">Okie, J. G., A. T. Poret-Peterson, Z. M. Lee, A. Richter, L. D. Alcaraz <i>et al.</i>, 2020 <b>Genomic adaptations in information processing underpin trophic strategy in a whole-ecosystem nutrient enrichment experiment</b>. eLife 9: <a href="https://doi.org/10.7554/eLife.49816">10.7554/eLife.49816</a></li>
<li id="Meyer.2022">Meyer, F., A. Fritz, Z.-L. Deng, D. Koslicki, T. R. Lesker <i>et al.</i>, 2022 <b>Critical Assessment of Metagenome Interpretation: the second round of challenges</b>. Nature methods 19: 429–440. <a href="https://doi.org/10.1038/s41592-022-01431-4">10.1038/s41592-022-01431-4</a></li>
<li id="blanco2023extending">Blanco-Mı́guez Aitor, F. Beghini, F. Cumbo, L. J. McIver, K. N. Thompson <i>et al.</i>, 2023 <b>Extending and improving metagenomic taxonomic profiling with uncharacterized species using MetaPhlAn 4</b>. Nature Biotechnology 1–12. <a href="https://doi.org/10.1038/s41587-023-01688-w">10.1038/s41587-023-01688-w</a></li></ol>
                

                

                <h1 id="gtn-feedback">Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=microbiome/taxonomic-profiling"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=microbiome/taxonomic-profiling">Feedback Form</a></iframe>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Sophia Hampe, Bérénice Batut, Paul Zierep,  <b>Taxonomic Profiling and Visualization of Metagenomic Data (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/taxonomic-profiling/tutorial.html">https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/taxonomic-profiling/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{microbiome-taxonomic-profiling,
author = "Sophia Hampe and Bérénice Batut and Paul Zierep",
	title = "Taxonomic Profiling and Visualization of Metagenomic Data (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/microbiome/tutorials/taxonomic-profiling/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

		<h2 id="funding">Funding</h2>
		<p>These individuals or organisations provided funding support for the development of this resource</p>
                
                
<div class="d-flex flex-wrap">

	<a href="/training-material/hall-of-fame/gallantries/" class="funder-badge">
		
		<div class="avatar">
			
			<img class="funder-avatar" src="https://gallantries.github.io/assets/images/gallantries-logo.png" alt="Logo">
			
		</div>

		<div class="info">
			<div class="name">Gallantries</div>
			<div class="description">
			This project (2020-1-NL01-KA203-064717) is funded with the support of the Erasmus+ programme of the European Union. Their funding has supported a large number of tutorials within the GTN across a wide array of topics.



            
			</div>
		</div>
	</a>

</div>


                


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="details follow-up" id="admins-install-missing-tools">
                  <div id="admin-missing-tools" class="box-title">
                    <button type="button" aria-controls="admin-missing-tools" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Galaxy Administrators: Install the missing tools<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>


			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/microbiome/tutorials/taxonomic-profiling/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools:
- name: taxonomy_krona_chart
  owner: crs4
  revisions: 1334cb4c6b68
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: taxonomy_krona_chart
  owner: crs4
  revisions: e9005d1f3cfd
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: bracken
  owner: iuc
  revisions: 79450f7fd718
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: kraken2
  owner: iuc
  revisions: 20e2f64aa1fe
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: kraken_biom
  owner: iuc
  revisions: b582a159bb10
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: krakentools_kreport2krona
  owner: iuc
  revisions: 88d274322340
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: metaphlan
  owner: iuc
  revisions: 1a6cdf55390f
  tool_panel_section_label: Metagenomic Analysis
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
</code></pre></div>
                </blockquote>
		

		<blockquote class="details hide-when-printing" id="feedback-responses">
                  <div id="feedback-response-c" class="box-title">
                    <button type="button" aria-controls="feedback-response-c" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Feedback<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>

		   <p>
		   
		   <table class="charts-css bar show-labels" style="--labels-size: 8rem; overflow-y: hidden">
		   
			<tr>
				<th scope="row"><span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 1.0">4</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">3 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.25">1</td>
			</tr>
		   
		   </table>
		   </p>
		
        
        
		    
		    <b>August 2024</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: The accuracy of the tutorial is wonderful
					
				</li>
				
		    </ul>
		    
		    <b>July 2024</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Very helpful and clear. Thanks for the authros .
					
				</li>
				
		    </ul>
		    
		    <b>October 2023</b>
		    <ul>
				
				<li>
					<span class="sr-only">3 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: All steps are very clear and have a great explanation 
					<b>Disliked</b>: all the datasets used in this pipeline are very poor and incomplete and there are a lot of unclassified reads and taxa so really need to improve 
				</li>
				
		    </ul>
		    
		    <b>August 2023</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: the hands-on part works. It is simple and clear
					
				</li>
				
		    </ul>
		    
		    <b>May 2023</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: Using kraken for the first time in my scientific journey was a life changing experience
					<b>Disliked</b>: the tutorial is perfect for me
				</li>
				
		    </ul>
		    
        
		</blockquote>

		


		
		
		

                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					
					<li><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00395">gxy.io/GTN:T00395</a></li>
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/microbiome/tutorials/taxonomic-profiling/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/microbiome/tutorials/taxonomic-profiling/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/5fe39b6156174c5a8df581974ab4d5fff4897ccd">5fe39b6</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.20cf1f17.js'></script>

	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	
	

    </body>
</html>