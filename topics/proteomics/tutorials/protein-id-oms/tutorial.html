<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Galaxy Training!</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <link rel="stylesheet" href="/training-material/assets/css/font-awesome.css">
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />
    </head>
    <body>
        



<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/proteomics" title="Go back to list of tutorials">
                            <i class="fa fa-folder-o" aria-hidden="true"></i> Proteomics
                        </a>
                    </li>

                    
                        
                        
                        
                    

                    

                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://zenodo.org/record/546301" title="Links to data">
                            <i class="fa fa-files-o" aria-hidden="true"></i> Input Dataset
                        </a>
                    </li>
                    

                    
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/proteomics#references" title="References">
                            <i class="fa fa-book" aria-hidden="true"></i> Literature
                        </a>
                    </li>
                    

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="fa fa-life-ring" aria-hidden="true"></i> Help
    </a>
    <div class="dropdown-menu">
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Chat on Gitter">
            Gitter
        </a>
        <a class="dropdown-item" href="https://biostar.usegalaxy.org/" title="Ask on Biostars">
            Biostars
        </a>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/tutorials/protein-id-oms/tutorial.md">
                            <i class="fa fa-github" aria-hidden="true"></i> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <section class="tutorial">
        <h1>Peptide and Protein ID using OpenMS tools</h1>

        <blockquote class="overview">
            <h3>Overview</h3>

            <strong><i class="fa fa-question-circle" aria-hidden="true"></i> Questions</strong>
            <ul>
            
            <li>How to convert LC-MS/MS raw files?</li>
            
            <li>How to identify peptides?</li>
            
            <li>How to identify proteins?</li>
            
            <li>How to evaluate the results?</li>
            
            </ul>

            <strong><i class="fa fa-bullseye" aria-hidden="true"></i> Objectives</strong>
            <ul>
            
            <li>Protein identification from LC-MS/MS raw files.</li>
            
            </ul>

            
            <strong><i class="fa fa-check-circle" aria-hidden="true"></i> Requirements</strong>
            <ul>
            
                <li>
                    
                    <a href="/training-material/topics//introduction/">Galaxy introduction</a>
                    
                </li>
            
            
            </ul>
            

            <p><strong><i class="fa fa-hourglass-end" aria-hidden="true"></i> Time estimation:</strong> 45min</p>
        </blockquote>

        <h1 class="no_toc" id="introduction">Introduction</h1>

<p>Identifying the proteins contained in a sample is an important step in any proteomic experiment. However, in most settings, proteins are digested to peptides prior to LC-MS/MS analysis. In this so-called “bottom-up” procedure, only peptide masses are measured. Therefore, protein identification cannot be performed directly from raw data, but is a multi-step process:</p>

<ol>
  <li>Raw data preparations</li>
  <li>Peptide-to-Spectrum matching</li>
  <li>Peptide inference</li>
  <li>Protein inference</li>
</ol>

<p>A plethora of different software solutions exists for each step. In this tutorial, we will use <strong><em>msconvert</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>  for raw data conversion and tools from the <a href="https://openms.de">OpenMS software suite</a> for all other steps. We will use one peptide search engine at first and later on show how to expand the workflow for using multiple search engines. Protein inference will be performed with the Fido algorithm (<a href="https://www.ncbi.nlm.nih.gov/pubmed/20712337">Serang et al, JPR, (2010)</a>).
This tutorial covers peptide and protein <strong>identification</strong> only, but you may use the output of this tutorial for the <a href="/training-material/topics/proteomics/tutorials/protein-quant-sil/tutorial.html">tutorial on protein quantitation</a>.</p>

<p>For an alternative protein ID workflow using the <a href="https://compomics.com/">Compomics</a> tools <a href="https://compomics.github.io/projects/searchgui.html">SearchGUI</a> and <a href="https://compomics.github.io/projects/peptide-shaker.html">PeptideShaker</a>, please consult <a href="/training-material/topics/proteomics/tutorials/protein-id-sg-ps/tutorial.html">this tutorial</a>.
The latter tutorial does not allow to continue with the tutorial on protein quantitation.</p>

<h1 class="no_toc" id="input-data">Input data</h1>

<p>As an example dataset, we will use an LC-MS/MS analysis of HeLa cell lysate published
in <a href="https://www.ncbi.nlm.nih.gov/pubmed/24678044">Vaudel et al., 2014, Proteomics</a>. Detailed information
about the dataset can be found on <a href="https://www.ebi.ac.uk/pride/archive/projects/PXD000674">PRIDE</a>.
For step 2 we will use a validated human Uniprot FASTA database with appended decoys.</p>

<p>If you already completed the tutorial on <a href="/training-material/topics/proteomics/tutorials/database-handling/tutorial.html">Database Handling</a>
you can use the constructed database including decoys.
You can find a prepared database, as well as the input LC-MS/MS data in different file formats on <a href="https://zenodo.org/record/796184">Zenodo</a>.</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#preparing-raw-data" id="markdown-toc-preparing-raw-data">Preparing Raw Data</a></li>
  <li><a href="#peptide-identification" id="markdown-toc-peptide-identification">Peptide Identification</a></li>
  <li><a href="#peptide-fdr-filtering" id="markdown-toc-peptide-fdr-filtering">Peptide FDR filtering</a></li>
  <li><a href="#protein-inference" id="markdown-toc-protein-inference">Protein Inference</a></li>
  <li><a href="#analysis-of-contaminants" id="markdown-toc-analysis-of-contaminants">Analysis of Contaminants</a></li>
  <li><a href="#using-multiple-search-engines" id="markdown-toc-using-multiple-search-engines">Using multiple search engines</a></li>
  <li><a href="#premade-workflow" id="markdown-toc-premade-workflow">Premade Workflow</a></li>
  <li><a href="#further-reading" id="markdown-toc-further-reading">Further Reading</a></li>
</ol>

</blockquote>

<h1 id="preparing-raw-data">Preparing Raw Data</h1>

<p>Raw data conversion is the first step of any proteomic data analysis. The most common converter is MSConvert from the <a href="http://proteowizard.sourceforge.net/">ProteoWizard software suite</a>, the format to convert to is mzML.
Due to licensing reasons, MSConvert runs only on windows systems and will not work on most Galaxy servers.</p>

<p>Depending on your machine settings, raw data will be generated either in profile mode or centroid mode. For most peptide search engines, the MS2 data have to be converted to centroid mode, a process called “peak picking” or “centroiding”.
Machine vendors offer algorithms to extract peaks from profile raw data. Those are integrated in <strong><em>msconvert</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> and can be run in parallel to the mzML conversion.
However, the OpenMS tool <strong><em>PeakPickerHiRes</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> is reported to generate slightly better results (<a href="https://www.ncbi.nlm.nih.gov/pubmed/17094243">Lange et al., 2006, Pac Symp Biocomput</a>) and is therefore recommended for quantitative studies (<a href="https://www.ncbi.nlm.nih.gov/pubmed/19953549">Vaudel et al., 2010, Proteomics</a>).
If your data were generated on a low resolution mass spectrometer, use <strong><em>PeakPickerWavelet</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> instead.</p>

<blockquote>
  <h3 id="-hands-on-file-conversion-and-peak-picking"><i class="fa fa-pencil" aria-hidden="true"></i> Hands-On: File Conversion and Peak Picking</h3>

  <p>We provide the <a href="https://zenodo.org/record/796184">input data</a> in the original <code class="highlighter-rouge">raw</code> format and also already converted to <code class="highlighter-rouge">mzML</code>. If <strong><em>msconvert</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> does not run on your Galaxy instance, please download the preconverted <code class="highlighter-rouge">mzML</code> as an input.</p>

  <ol>
    <li>Create a new history for this Peptide and Protein ID exercise.</li>
    <li>Load the example dataset into your history from Zenodo: <a href="https://zenodo.org/record/892005/files/qExactive01819.raw">raw</a> <a href="https://zenodo.org/record/892005/files/qExactive01819_profile.mzml">mzML</a></li>
    <li>Rename the dataset to something meaningful.</li>
    <li>(<em>optional</em>) Run <strong><em>msconvert</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> on the test data to convert to the <code class="highlighter-rouge">mzML</code> format.</li>
    <li>Run <strong><em>PeakPickerHiRes</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> on the resulting file. Click <code class="highlighter-rouge">+ Insert param.algorithm_ms_levels</code> and change the entry to “2”. Thus, peak picking will only be performed on MS2 level.</li>
  </ol>

  <blockquote class="comment">
    <h3 id="-comment-local-use-of-msconvert"><i class="fa fa-commenting-o" aria-hidden="true"></i> Comment: Local Use of MSConvert</h3>
    <p>The vendor libraries used by MSConvert are only licensed for Windows systems and are therefore rarely implemented in Galaxy instances. If <strong><em>msconvert</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> is not available in your Galaxy instance, please install the software on a Windows computer and run the conversion locally. You can find a detailed description of the necessary steps <a href="http://genesis.ugent.be/files/costore/practicals/bioinformatics-for-proteomics/1-Peptide-and-Protein-Identification/1.2-Peak-List-Generation/1.2-Peak-List-Generation.pdf">here</a>. Afterwards, upload the resulting mzML file to your Galaxy history.</p>
  </blockquote>

  <blockquote class="comment">
    <h3 id="-comment-ms2-peak-picking-during-data-acquisition"><i class="fa fa-commenting-o" aria-hidden="true"></i> Comment: MS2 peak picking during data acquisition</h3>
    <p>MS2 peaks are often acquired in centroided mode in first place. The profile data are converted to centroided mode already during data acquisition, resulting in MS2-centroided <code class="highlighter-rouge">raw</code> files. If your MS2 data are already centroided, simply omit the peak picking step.</p>
  </blockquote>
</blockquote>

<h1 class="hands_on" id="peptide-identification">Peptide Identification</h1>
<p>MS/MS experiments identify peptides by isolating them and subsequently colliding them with a gas for fragmentation. This method generates a spectrum of peptide fragment masses for each isolated peptide - an MS2 spectrum.
To find out the peptide sequences, the MS2 spectrum is compared to a theoretical spectrum generated from a protein database. This step is called peptide-to-spectrum (also: spectrum-to-sequence) matching. Accordingly, a peptide that is successfully matched to a sequence is termed PSM (Peptide-Spectrum-Match). There can be multiple PSMs per peptide, if the peptide was fragmented several times.</p>

<p>Different peptide search engines have been developed to fulfill the matching procedure. Here, we will use the search engine <a href="https://www.ncbi.nlm.nih.gov/pubmed/14976030">X!Tandem</a>. OpenMS provides “adapters” (wrappers) for several other peptide search engines, like MSGF+ or OMSSA. You may replace the XTandemAdapter by another search engine of your choice.</p>

<blockquote class="hands_on">
  <h3 id="-hands-on-peptide-identification"><i class="fa fa-pencil" aria-hidden="true"></i> Hands-On: Peptide Identification</h3>

  <ol>
    <li>Copy the prepared protein database from the tutorial <a href="../database-handling/tutorial.html">Database Handling</a> into your current history by using the multiple history view or upload the ready-made database from this <a href="https://zenodo.org/record/892005/files/Human_database_including_decoys_%28cRAP_and_Mycoplasma_added%29.fasta">link</a>.</li>
    <li>Run the tool <strong><em>XTandemAdapter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with:
      <ul>
        <li>the MS2-centroided mzML as <strong>Input file containing MS2 spectra</strong> and</li>
        <li>the FASTA protein database as <strong>FASTA file or pro file</strong>.</li>
        <li>Click <code class="highlighter-rouge">+ Insert param_fixed_modifications</code> and choose <code class="highlighter-rouge">Carbamidomethyl (C)</code>.</li>
        <li>Click <code class="highlighter-rouge">+ Insert param_variable_modifications</code> and choose <code class="highlighter-rouge">Oxidation (M)</code>.</li>
      </ul>
    </li>
    <li>Run the tool <strong><em>FileInfo</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> on the XTandem output.</li>
  </ol>

  <blockquote class="comment">
    <h3 id="-comment-advanced-search-engine-parameters"><i class="fa fa-commenting-o" aria-hidden="true"></i> Comment: Advanced Search Engine Parameters</h3>
    <p>The OpenMS adapters do not always allow to set every option of the underlying search engine. If an option is missing, you may also run the search engine locally or by using a Galaxy wrapper. Afterwards, convert the search engine output to the OpenMS format <code class="highlighter-rouge">idXML</code> by running <strong><em>IDFileConverter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>.</p>

    <p>The search engine X!Tandem features some more advanced options than the ones reflected in the <strong><em>XTandemAdapter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>. If you need those advanced options, the <strong><em>XTandemAdapter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> allows for the optional input of a classic X!Tandem parameter file. Upload your parameter file to the history and use it as an input in the field <code class="highlighter-rouge">Default X!Tandem configuration file</code>. You may also set the option <code class="highlighter-rouge">-ignore_adapter_param</code> to <code class="highlighter-rouge">Yes</code> to overwrite all options set by the GUI.</p>
  </blockquote>
</blockquote>

<h1 id="peptide-fdr-filtering">Peptide FDR filtering</h1>
<p>The next step of peptide identification is to decide which PSMs will be used for protein inference. Measured MS2 spectra never perfectly fit the theoretical spectra. Therefore, peptide search engines calculate a score which indicates how well the measured MS2 spectrum was fitting the theoretical spectrum. How do we decide which PSMs are likely true and which are false?</p>

<p>In proteomics, this decision is typically done by calculating false discovery rates (FDRs). Remember that the database we were using for peptide-to-spectrum matching consisted not only of true proteins, but also the same number of “fake entries”, the so-called decoys. Those decoys can now be used to estimate the number of false identifications in the list of PSMs.
The calculation is based on a simple assumption: for every decoy protein identified with a given score, we expect one false positive with at least the same score.
The false discovery rate is therefore defined as the number of false discoveries (decoy hits) divided by the number of false and correct discoveries (both target and decoy hits) at a given score threshold.</p>

<p>To calculate FDRs, we first have to annotate the identified peptides to determine which of them are decoys. This is done with the tool <strong><em>PeptideIndexer</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>. Additionally, we will calculate peptide posterior error probabilities (PEPs), because they are needed for the protein inference algorithm used by OpenMS. We will then filter for 1 % FDR and set the score back to PEP.</p>

<blockquote class="hands_on">
  <h3 id="-hands-on-peptide-fdr-filtering"><i class="fa fa-pencil" aria-hidden="true"></i> Hands-On: Peptide FDR filtering</h3>

  <ol>
    <li>Run <strong><em>IDPosteriorErrorProbability</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li><code class="highlighter-rouge">-prob_correct</code> set to <code class="highlighter-rouge">Yes</code>.</li>
      </ul>
    </li>
    <li>Run <strong><em>PeptideIndexer</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li>the FASTA protein database as <strong>Input sequence database in FASTA format</strong>, and</li>
        <li><strong>Specificity of the enzyme</strong> set to <code class="highlighter-rouge">none</code>.</li>
      </ul>
    </li>
    <li>Run <strong><em>FalseDiscoveryRate</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li><strong>Perform FDR calculation on protein level</strong> set to <code class="highlighter-rouge">false</code>,</li>
        <li><strong>Filter PSMs based on q-value</strong> set to <code class="highlighter-rouge">0.01</code>, and</li>
        <li><code class="highlighter-rouge">-add_decoy_peptides</code> set to <code class="highlighter-rouge">Yes</code>.</li>
      </ul>
    </li>
    <li>Run <strong><em>IDScoreSwitcher</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li><strong>Name of the meta value to use as the new score</strong> set to “Posterior Probability_score”, and</li>
        <li>**Orientation of the new score<code class="highlighter-rouge">** set to </code>higher_better`.</li>
      </ul>
    </li>
    <li>Run <strong><em>FileInfo</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> to get basic information about the identified peptides.</li>
  </ol>

  <blockquote class="question">
    <h3 id="-questions"><i class="fa fa-question-circle" aria-hidden="true"></i> Questions:</h3>
    <ol>
      <li>How many peptides were identified?</li>
      <li>How many peptides with oxidized methionine were identified?</li>
    </ol>

    <details>
 <summary>Click to view answers</summary>
  <ol type="1">
    <li> You should have identified 2,616 unique stripped peptides.</li>
    <li> 503 peptides contain an oxidized methionine (MeO).</li>
  </ol>
 </details>
  </blockquote>
</blockquote>

<h1 id="protein-inference">Protein Inference</h1>
<p>In bottom-up proteomics, it is necessary to combine the identified peptides to proteins. This is not a trivial task, as proteins are redundant to some degree. Thus, not every peptide can be assigned to only one protein.
The OpenMS suite implemented the <a href="https://www.ncbi.nlm.nih.gov/pubmed/20712337">Fido</a> algorithm for protein inference. Fido uses a Bayesian probabilistic model to group and score proteins based on peptide-spectrum matches.</p>

<blockquote class="hands_on">
  <h3 id="-hands-on-protein-inference"><i class="fa fa-pencil" aria-hidden="true"></i> Hands-On: Protein inference</h3>

  <ol>
    <li>Run <strong><em>FidoAdapter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>. Set <code class="highlighter-rouge">-greedy_group_resolution</code> = <code class="highlighter-rouge">Yes</code>.</li>
    <li>Run <strong><em>FalseDiscoveryRate</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>. Set the option <strong><code class="highlighter-rouge">Perform FDR calculation on PSM level</code></strong> to <code class="highlighter-rouge">false</code>.</li>
    <li>Run <strong><em>IDFilter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>. Set<code class="highlighter-rouge">-prot</code> to <code class="highlighter-rouge">0.01</code>.</li>
    <li>Run <strong><em>FileInfo</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> to get basic information about the identified proteins.</li>
  </ol>

  <blockquote class="comment">
    <h3 id="-comment-greedy-group-resolution"><i class="fa fa-commenting-o" aria-hidden="true"></i> Comment: “Greedy” Group Resolution</h3>
    <p>Protein groups are reported, when an identified peptide maps to multiple proteins in the used database <a href="https://www.ncbi.nlm.nih.gov/pubmed/16009968">Nesvizhskii and Aebersold (2005)</a>. Some peptides may map to different protein groups and can therefore not be used for protein quantitation. The option <code class="highlighter-rouge">-greedy_group_resolution</code> solves this problem by assigning peptides only to the one most probable protein group, thus enabling to quantify proteins based not only on unique, but also on shared peptides. This usually leads to a much higher number of quantified proteins. However it will introduce noise in the FCs when a peptide was indeed shared by different proteins and the quantity of this peptide was a weighted sum of contributions. The greedy group resolution is similar to Occam’s razor.</p>
  </blockquote>
</blockquote>

<h1 id="analysis-of-contaminants">Analysis of Contaminants</h1>
<p>The FASTA database used for the peptide to spectrum matching contained some entries that were not expected to stem from the HeLa cell lysate, but are common contaminations in LC-MS/MS samples. The main reason to add those is to avoid false assignment of contaminant spectra to other proteins.
It also enables you to check for contaminations in your samples.</p>

<p><strong>CAVE:</strong> When analyzing human samples, many proteins that are common contaminants may also stem from the sample. Therefore, human contaminants do not have to be excluded from further analysis, but you should keep in mind that the source of these proteins is unclear.</p>

<blockquote class="hands_on">
  <h3 id="-hands-on-analysis-of-contaminants"><i class="fa fa-pencil" aria-hidden="true"></i> Hands-On: Analysis of Contaminants</h3>

  <ol>
    <li>Run <strong><em>TextExporter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> to convert the idXML output to a human-readable tabular file.</li>
    <li>Run <strong><em>Select</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> to select all lines <strong>Matching</strong> the pattern “CONTAMINANT”.</li>
    <li>Run <strong><em>Select</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> to select all lines that <strong>NOT Matching</strong> the pattern “HUMAN”.</li>
    <li>Remove all bovine and mycoplasma proteins from your list by running <strong><em>Select</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>. Select only those lines <strong>NOT Matching</strong> match the pattern “HUMAN”.</li>
  </ol>

  <blockquote class="question">
    <h3 id="-questions-1"><i class="fa fa-question-circle" aria-hidden="true"></i> Questions</h3>
    <ol>
      <li>Which contaminants did you identify? Where do these contaminations likely come from?</li>
      <li>What other sources of contaminants exist?</li>
      <li>How many mycoplasma proteins did you identify? Does this mean that the analyzed HeLa cells were infected with mycoplasma?</li>
      <li>How many false positives do we expect in our list?</li>
    </ol>

    <details>
 <summary>Click to view answers</summary>
  <ol type="1">
    <li> TRY_BOVIN is bovine trypsin. It was used to degrade the proteins to peptides. ALBU_BOVIN is bovine serum albumin. It is added to cell culture medium in high amounts. Also, five human proteins are listed, these are commonly introduced during sample preparation. As we were analyzing a human sample, it is not neccessary to remove these proteins, as they may as well originate from the HeLa cells.</li>
    <li> Contaminants often stem from the experimenter, these are typically keratins or other high-abundant human proteins. Basically any protein present in the room of the mass spectrometer might get into the ion source, if it is airborne. As an example, sheep keratins are sometimes found in proteomic samples, stemming from clothing made of sheep wool.</li>
    <li> One protein stemming from *Acholeplasma laidlawii* (ACHLI) was identified. If you again filter the protein list for "ACHLI", you will see that it was identified by a single peptide. Thus, it is likely a false positive and does not indicate contamination.</li>
    <li> As we were allowing for a false discovery rate of 1 %, we would expect 12 false positive proteins in our list.</li>
  </ol>
 </details>
  </blockquote>
</blockquote>

<h1 id="using-multiple-search-engines">Using multiple search engines</h1>

<p>It is generally recommended to use more than one peptide search engine and use the combined results for peptide inference (<a href="https://www.ncbi.nlm.nih.gov/pubmed/23720762">Shteynberg et al., 2013, Mol. Cell. Proteomics</a>).
By comparing results of multiple search engines, you may improve the <em>sensitivity</em> (when accepting peptides that were found by only one of the engines), the <em>specificity</em> (when accepting only peptides that were found by all of the search engines) or <em>both</em> (when using n&gt;2 search engines and accept peptides found by a fraction of the (e.g. n-1) search engines).</p>

<p>Here, we will use the OpenMS tool <a href="http://ftp.mi.fu-berlin.de/pub/OpenMS/release-documentation/html/TOPP_ConsensusID.html">ConsensusID</a> to combine the search engine results.</p>

<blockquote class="hands_on">
  <h3 id="-hands-on-multiple-search-engines"><i class="fa fa-pencil" aria-hidden="true"></i> Hands-On: Multiple search engines</h3>

  <ol>
    <li>Run <strong><em>MSGFPlusAdapter</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li>the MS2-centroided mzML as <strong>Input file</strong> and</li>
        <li>the FASTA protein database as <strong>Protein sequence database</strong>.</li>
        <li><strong>Precursor monoisotopic mass tolerance</strong> set to <code class="highlighter-rouge">10.0</code>.</li>
        <li><strong>Instrument that generated the data</strong> set to <code class="highlighter-rouge">Q_Exactive</code>.</li>
        <li>Click <code class="highlighter-rouge">+ Insert param_fixed_modifications</code> and choose <code class="highlighter-rouge">Carbamidomethyl (C)</code>.</li>
        <li>Click <code class="highlighter-rouge">+ Insert param_variable_modifications</code> and choose <code class="highlighter-rouge">Oxidation (M)</code>.</li>
      </ul>
    </li>
    <li>Run the tool <strong><em>FileInfo</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> on the MSGFPlusAdapter output.</li>
    <li>Run <strong><em>IDPosteriorErrorProbability</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li><code class="highlighter-rouge">-prob_correct</code> set to <code class="highlighter-rouge">No</code>.</li>
      </ul>
    </li>
    <li>Run <strong><em>IDMerger</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with two <strong>Input files […]</strong>:
      <ul>
        <li>the output of <strong>IDScoreSwitcher</strong> based on <strong>XTandemAdapter</strong></li>
        <li>the output of <strong>IDScoreSwitcher</strong> based on <strong>MSGFPlusAdapter</strong></li>
      </ul>
    </li>
    <li>Run <strong><em>ConsensusID</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i>.</li>
    <li>Run <strong><em>PeptideIndexer</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li>the FASTA protein database as <strong>Input sequence database in FASTA format</strong>, and</li>
        <li><strong>Specificity of the enzyme</strong> set to <code class="highlighter-rouge">none</code>.</li>
      </ul>
    </li>
    <li>Run <strong><em>FalseDiscoveryRate</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li><strong>Perform FDR calculation on protein level</strong> set to <code class="highlighter-rouge">false</code>,</li>
        <li><strong>Filter PSMs based on q-value</strong> set to <code class="highlighter-rouge">0.01</code>, and</li>
        <li><code class="highlighter-rouge">-add_decoy_peptides</code> set to <code class="highlighter-rouge">Yes</code>.</li>
      </ul>
    </li>
    <li>Run <strong><em>IDScoreSwitcher</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> with
      <ul>
        <li><strong>Name of the meta value to use as the new score</strong> set to “Posterior Error Probability_score”,</li>
        <li>**Orientation of the new score<code class="highlighter-rouge">** set to </code>lower_better`, and</li>
        <li><strong>Name to use as the type of the new score</strong> set to “Posterior Error Probability”.</li>
      </ul>
    </li>
    <li>Run <strong><em>FileInfo</em></strong> <i class="fa fa-wrench" aria-hidden="true"></i> to get basic information about the identified peptides.</li>
    <li>Proceed with the protein inference as described <a href="#protein-inference">above</a></li>
  </ol>

  <blockquote class="question">
    <h3 id="-questions-2"><i class="fa fa-question-circle" aria-hidden="true"></i> Questions:</h3>
    <ol>
      <li>How many PSMs could be matched with XTandem and MSGFPlus alone? How many peptides were identified?</li>
      <li>How many PSMs could be matched after combining the results with ConsensusID? How many peptides were identified?</li>
    </ol>

    <details>
 <summary>Click to view answers</summary>
  <ol type="1">
    <li> After FDR-filtering, XTandem matched 3,552 PSMs (2,616 unique peptides) and MSGFPlus matched 4,292 PSMs (2,991 peptides).</li>
    <li> Combining the results with ConsensusID leads to matching of 4,299 PSMs (3,041 unique peptides).</li>
  </ol>
 </details>
  </blockquote>
</blockquote>

<h1 id="premade-workflow">Premade Workflow</h1>

<p>A premade workflow for this tutorial can be found <a href="workflows/workflow.ga">here</a>.</p>

<p>A premade workflow using the search engines XTandem and MSGF+ can be found <a href="workflows/workflow_two-search-engines.ga">here</a>.</p>

<h1 id="further-reading">Further Reading</h1>

<ul>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/16009968">Protein inference</a></li>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/20712337">Fido publication</a></li>
  <li><a href="https://www.ncbi.nlm.nih.gov/pubmed/27498275">Evaluation of protein inference algorithms</a></li>
</ul>


        
        <blockquote class="key_points">
            <h3><i class="fa fa-key" aria-hidden="true"></i> Key points</h3>

            <ul>
                
                <li>LC-MS/MS raw files have to be converted to mzML before using GalaxyP on most GalaxyP servers.</li>
                
                <li>OpenMS provides many tools for proteomic analysis and guarantees compatibility by using open file formats.</li>
                
                <li>OpenMS provides several thirdparty search engines and Fido for protein inference.</li>
                
            </ul>
        </blockquote>
        

        
        <h1>Useful literature</h1>
        <p>Useful information regarding this type of analysis with descriptions and paper references for the tools used in this tutorial, and literature for this analysis techniques and interpretations can be found <a href="/training-material/topics/proteomics#references">here</a>.</p>
        

        <h3><i class="fa fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!</h3>

        <hr>

        <blockquote class="overview">
            <h3><i class="fa fa-comments-o" aria-hidden="true"></i> Feedback</h3>
            Please take a moment and provide your feedback on this tutorial. Your feedback will help guide and improve future revisions to this tutorial.
            <a href="https://tinyurl.com/GTNfeedback">Feedback Form</a>
        </blockquote>
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Florian Christoph Sigloch, Björn Grüning)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/tutorials/protein-id-oms/tutorial.md">GitHub</a>.
        </p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
</html>
