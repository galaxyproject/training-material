<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Proteogenomics 1: Database Creation</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="Training material for proteomics workflows in Galaxy" />
        <meta property="og:title" content="Galaxy Training: Proteogenomics 1: Database Creation" />
        <meta property="og:description" content="Training material for proteomics workflows in Galaxy" />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        











<!-- Gitter -->


<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/proteomics" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">topic</span> Proteomics
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Language Selector">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Language
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fproteomics%2Ftutorials%2Fproteogenomics-dbcreation%2Ftutorial.html&edit-text=&act=url" title="">
                                Fran√ßais
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fproteomics%2Ftutorials%2Fproteogenomics-dbcreation%2Ftutorial.html&edit-text=&act=url" title="">
                                Êó•Êú¨Ë™û
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fproteomics%2Ftutorials%2Fproteogenomics-dbcreation%2Ftutorial.html&edit-text=&act=url" title="">
                                Espa√±ol
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fproteomics%2Ftutorials%2Fproteogenomics-dbcreation%2Ftutorial.html&edit-text=&act=url" title="">
                                Portugu√™s
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fproteomics%2Ftutorials%2Fproteogenomics-dbcreation%2Ftutorial.html&edit-text=&act=url" title="">
                                ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fproteomics%2Ftutorials%2Fproteogenomics-dbcreation%2Ftutorial.html&edit-text=&act=url" title="">
                                And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>

        <div class="dropdown-item">
            <div>
                Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> üéÉ
                </label>
            </div>

        </div>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/proteomics/tutorials/proteogenomics-dbcreation/tutorial.md">
                            <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Proteogenomics 1: Database Creation",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "https://github.com/galaxyproject/training-material/blob/master/LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Proteomics",
    "description": "Training material for proteomics workflows in Galaxy",
    "url": "https://training.galaxyproject.org//training-material/topics/proteomics/"
  },
  "courseCode": "proteomics / proteogenomics-dbcreation / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Proteogenomics 1: Database Creation' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/proteomics/tutorials/proteogenomics-dbcreation/tutorial.html",
  "timeRequired": "PT30M",
  "description": "The questions this  addresses are:\n - How to create a customized Protein Database from RNAseq data?\n\n\\nThe objectives are:\n - Generating a customized Protein sequence database with variants, indels, splice junctions and known sequences.\n\n",
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Subina Mehta"
    },
    {
      "@type": "Person",
      "name": "Timothy J. Griffin"
    },
    {
      "@type": "Person",
      "name": "Pratik Jagtap"
    },
    {
      "@type": "Person",
      "name": "Ray Sajulga"
    },
    {
      "@type": "Person",
      "name": "James Johnson"
    },
    {
      "@type": "Person",
      "name": "Praveen Kumar"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Subina Mehta"
    },
    {
      "@type": "Person",
      "name": "Timothy J. Griffin"
    },
    {
      "@type": "Person",
      "name": "Pratik Jagtap"
    },
    {
      "@type": "Person",
      "name": "Ray Sajulga"
    },
    {
      "@type": "Person",
      "name": "James Johnson"
    },
    {
      "@type": "Person",
      "name": "Praveen Kumar"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Proteomics",
      "description": "Training material for proteomics workflows in Galaxy",
      "url": "https://training.galaxyproject.org//training-material/topics/proteomics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0121",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0121",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0121"
    }
  ],
  "skillLevel": "Intermediate"
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>Proteogenomics 1: Database Creation</h1>
        

        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame/subinamehta/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/subinamehta" alt="Subina Mehta">Subina Mehta</a>, <a href="/training-material/hall-of-fame/timothygriffin/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/timothygriffin" alt="Timothy J. Griffin">Timothy J. Griffin</a>, <a href="/training-material/hall-of-fame/pratikdjagtap/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/pratikdjagtap" alt="Pratik Jagtap">Pratik Jagtap</a>, <a href="/training-material/hall-of-fame/jraysajulga/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/jraysajulga" alt="Ray Sajulga">Ray Sajulga</a>, <a href="/training-material/hall-of-fame/jj-umn/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/jj-umn" alt="James Johnson">James Johnson</a>, <a href="/training-material/hall-of-fame/pravs3683/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/pravs3683" alt="Praveen Kumar">Praveen Kumar</a>

</div>

        <blockquote class="overview">
            <h3>Overview</h3>
            <strong><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li><p>How to create a customized Protein Database from RNAseq data?</p>
</li>
            
            </ul>

            <strong><i class="fas fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li><p>Generating a customized Protein sequence database with variants, indels, splice junctions and known sequences.</p>
</li>
            
            </ul>

            
            <strong><i class="fas fa-check-circle" aria-hidden="true"></i><span class="visually-hidden">requirements</span> Requirements</strong>
            <ul>
            
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

            
            </ul>
            

            
            <p><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 30 minutes</p>
            

            
            <p><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> Level: </strong>
             Intermediate 
<span class="level intermediate" title="Intermediate Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span>
</span>

</p>
            

            
            

            
            <p id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials</strong></p>
            <ul>
                <div class="supporting_material">
                

                
                    <li class="btn btn-default supporting_material">
<a class="topic-icon" href="https://doi.org/10.5281/zenodo.1489208">
    <i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">zenodo_link</span> Datasets
</a>

</li>
                

                
                    <li class="btn btn-default supporting_material">
    <a class="topic-icon" href="/training-material/topics/proteomics/tutorials/proteogenomics-dbcreation/workflows/" title="Workflows" alt="Proteogenomics 1: Database Creation workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i><span class="visually-hidden">workflow</span> Workflows
    </a>

</li>
                

                

                
                    <li class="btn btn-default supporting_material">

    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span> Available on these Galaxies
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    </ul>


</li>
                
                </div>
            </ul>
            

            <p><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last modification:</strong> Jan 6, 2021 </p>
        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <h1 class="no_toc" id="introduction">Introduction</h1>

<p><strong>Proteogenomics</strong> involves the use of mass spectrometry (MS) based proteomics data against genomics and transcriptomics data to identify peptides and to understand protein-level evidence of gene <span class="notranslate">expression</span>. In the first section of the tutorial, we will create a protein database (FASTA) using <span class="notranslate">RNA</span>-sequencing files (FASTQ) and then perform sequence database searching using the resulting FASTA file with the MS data to identify peptides corresponding to novel proteoforms. Then, we will assign the genomic coordinates and annotations for these identified peptides and visualize the data for its spectral quality and genomic localization</p>

<p><img src="../../images/potential_novel_publication.png" alt="Novel Peptides" /></p>

<p>Proteogenomics integrates <strong><span class="notranslate">RNA</span>-Seq</strong> data for generating customized protein sequence databases with mass spectrometry-based proteomics data, which are matched to these databases to identify protein sequence variants. (Cancer Res. (2017); 77(21):e43-e46. doi: <a target="_blank" href="https://doi.org/10.1158/0008-5472.CAN-17-0331">10.1158/0008-5472.CAN-17-0331</a>).</p>

<p><img src="../../images/workflow_objective1.png" alt="Proteogenomics" /></p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will cover:</p>
<ol id="markdown-toc">
  <li><a href="#data-upload" id="markdown-toc-data-upload">Data upload</a></li>
  <li><a href="#aligning-fastq-files-to-the-human-genome" id="markdown-toc-aligning-fastq-files-to-the-human-genome">Aligning FASTQ files to the human genome</a></li>
  <li><a href="#variant-analysis" id="markdown-toc-variant-analysis">Variant Analysis</a>    <ol>
      <li><a href="#variant-calling" id="markdown-toc-variant-calling">Variant Calling</a></li>
      <li><a href="#variant-annotation-and-genome-mapping" id="markdown-toc-variant-annotation-and-genome-mapping">Variant annotation and Genome <span class="notranslate">Mapping</span></a></li>
    </ol>
  </li>
  <li><a href="#transcript-assembly" id="markdown-toc-transcript-assembly">Transcript Assembly</a>    <ol>
      <li><a href="#rna-seq-to-transcripts" id="markdown-toc-rna-seq-to-transcripts"><span class="notranslate">RNA</span>-seq to transcripts</a></li>
      <li><a href="#evaluate-the-assembly-with-annotated-transcripts" id="markdown-toc-evaluate-the-assembly-with-annotated-transcripts">Evaluate the assembly with annotated transcripts</a></li>
      <li><a href="#translate-transcripts" id="markdown-toc-translate-transcripts">Translate transcripts</a></li>
    </ol>
  </li>
  <li><a href="#creating-fasta-databases" id="markdown-toc-creating-fasta-databases">Creating FASTA Databases</a>    <ol>
      <li><a href="#genomic-mapping-database" id="markdown-toc-genomic-mapping-database">Genomic <span class="notranslate">mapping</span> database</a></li>
      <li><a href="#variant-annotations-database" id="markdown-toc-variant-annotations-database">Variant Annotations database</a></li>
    </ol>
  </li>
</ol>

</blockquote>

<h1 class="no_toc" id="overview">Overview</h1>

<p>This tutorial focuses on creating a <strong>FASTA</strong> database generated from <span class="notranslate">RNA</span>-seq data. There are two outputs from this <span class="notranslate">workflow</span>: (1) a <strong>sequence database</strong> consisting of variants and known reference sequences and (2) <span class="notranslate">mapping</span> files containing <strong>genomic</strong> and <strong>variant</strong> <span class="notranslate">mapping</span> data.</p>

<p><img src="../../images/database_creation.png" alt="Database creation" /></p>

<p>The first part of the tutorial deals with creating the FASTA file containing sequences with single amino acid variants (SAVs), insertions and deletions (indels). The second part of the <span class="notranslate">workflow</span> helps in creating a FASTA file with transcript assemblies (splicing variants).</p>

<h1 id="data-upload">Data upload</h1>

<p>In this tutorial, protein and the total <span class="notranslate">RNA</span> sample was obtained from the early development of B-cells from mice. It was obtained at two developmental stages of B-cells: <em>Ebf1</em> -/- pre-pro-B and <em>Rag2</em> -/- pro-B. Please refer to the original study  <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4276347/">Heydarian, M. et al.</a>for details.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-data-upload-and-organization"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: data upload and organization</h3>

  <ol>
    <li>
      <p>Create a new history and name it something meaningful (e.g. <em>Proteogenomics DB creation</em>)</p>

      <blockquote class="tip">

        <h3 id="tip-tip-creating-a-new-history"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Creating a new history</h3>

        <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel</p>

        <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>
        <ol>
          <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>
          <li>Select the option <strong>Create New</strong> from the menu</li>
        </ol>
      </blockquote>
    </li>
    <li>Import the FASTQ file and the GTF file from Zenodo <a href="https://doi.org/10.5281/zenodo.1489208"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1489208.svg" alt="DOI" /></a>
      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/1489208/files/FASTQ_ProB_22LIST.fastqsanger
https://zenodo.org/record/1489208/files/Mus_musculus.GRCm38.86.gtf
</code></pre></div>      </div>

      <blockquote class="tip">

        <h3 id="tip-tip-importing-data-via-links"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Importing data via links</h3>

        <ul>
          <li>Copy the link location</li>
          <li>
            <p>Open the <span class="notranslate">Galaxy</span> Upload Manager (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> on the top-right of the tool panel)</p>
          </li>
          <li>Select <strong>Paste/Fetch Data</strong></li>
          <li>
            <p>Paste the link into the text field</p>
          </li>
          <li>
            <p>Press <strong>Start</strong></p>
          </li>
          <li><strong>Close</strong> the window</li>
        </ul>

        <p>By default, <span class="notranslate">Galaxy</span> uses the URL as the name, so rename the files with a more useful name.</p>

      </blockquote>
    </li>
    <li>Rename the datasets with more descriptive names (strip off the url prefixes)
      <blockquote class="tip">

        <h3 id="tip-tip-renaming-a-dataset"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Renaming a dataset</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, change the <strong>Name</strong> field</li>
          <li>Click the <strong>Save</strong> button</li>
        </ul>
      </blockquote>
    </li>
    <li>Make sure that the file <code class="language-plaintext highlighter-rouge">FASTQ_ProB_22List.fastqsanger</code>
      <blockquote class="tip">

        <h3 id="tip-tip-changing-the-datatype"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing the datatype</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, click on the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>
          <li>Select <code class="language-plaintext highlighter-rouge">fastqsanger</code></li>
          <li>Click the <strong>Change datatype</strong> button</li>
        </ul>
      </blockquote>
    </li>
    <li>Make sure the Database/Build (dbkey) is set to <code class="language-plaintext highlighter-rouge">Mouse.Dec 2011 (GRCm38/mm10)(mm10)</code>
      <blockquote class="tip">

        <h3 id="tip-tip-changing-databasebuild-dbkey"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing Database/Build (dbkey)</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, change the <strong>Database/Build</strong> field</li>
          <li>Select your desired database key from the dropdown list: <code class="language-plaintext highlighter-rouge">Mouse.Dec 2011 (GRCm38/mm10)(mm10)</code></li>
          <li>Click the <strong>Save</strong> button</li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<h1 id="aligning-fastq-files-to-the-human-genome">Aligning FASTQ files to the human genome</h1>

<p>The first tool in the <span class="notranslate">workflow</span> is the <a href="http://ccb.jhu.edu/software/hisat"><strong>HISAT2</strong></a> alignment tool. It maps next-generation sequence (NGS) <span class="notranslate">reads</span> to the reference genome. This tool requires an <span class="notranslate">RNA</span>-seq file (.FASTQ) and a reference genome file in Gene transfer format (GTF). This .gtf file is obtained from the Ensembl database. When successful, this tool outputs a .bam file (binary version of a SAM: <strong>S</strong>equence <strong>A</strong>lignment/<strong>M</strong>ap).</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-alignment-with-hisat2"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Alignment with HISAT2</h3>

  <ol>
    <li><strong>HISAT2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSource for the reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">Use a built-in genome</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSelect a reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">mm10</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSingle-end or paired-end <span class="notranslate">reads</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">Single end</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput FASTQ files‚Äù</em>: <code class="language-plaintext highlighter-rouge">FASTQ_ProB_22LIST.fastqsanger</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSpecify strand information‚Äù</em>: <code class="language-plaintext highlighter-rouge">Unstranded</code></li>
      </ul>
    </li>
    <li>Inspect <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> the resulting files</li>
    <li>Rename the output to <code class="language-plaintext highlighter-rouge">HISAT_Output.BAM</code></li>
  </ol>

  <blockquote class="comment">
    <h3 id="comment-note-on-strandedness"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Note on strandedness</h3>
    <p>Note that if your <span class="notranslate">reads</span> are from a stranded library, you need to choose the appropriate
setting for ‚ÄúSpecify strand information‚Äù mentioned above. For single-end <span class="notranslate">reads</span>, use <code class="language-plaintext highlighter-rouge">F</code> or <code class="language-plaintext highlighter-rouge">R</code>.
<code class="language-plaintext highlighter-rouge">F</code> means that a read corresponds to a forward transcript. <code class="language-plaintext highlighter-rouge">R</code> means that a read corresponds to the reverse
complemented counterpart of a transcript.</p>

    <p>For paired-end <span class="notranslate">reads</span>, use either <code class="language-plaintext highlighter-rouge">FR</code> or <code class="language-plaintext highlighter-rouge">RF</code>. With this
option being used, every read alignment will have an XS attribute tag: <code class="language-plaintext highlighter-rouge">+</code> means a read
belongs to a transcript on the positive <code class="language-plaintext highlighter-rouge">+</code> strand of the genome. <code class="language-plaintext highlighter-rouge">-</code> means a read belongs to a
transcript on the negative <code class="language-plaintext highlighter-rouge">-</code> strand of the genome. (TopHat has a similar option, <code class="language-plaintext highlighter-rouge">--library--type</code> option,
where fr - first strand corresponds to R and RF; fr - second strand corresponds to F and FR.)</p>
  </blockquote>

</blockquote>

<h1 id="variant-analysis">Variant Analysis</h1>

<h2 id="variant-calling">Variant Calling</h2>

<p><a href="https://github.com/ekg/freebayes">FreeBayes</a> is a Bayesian genetic variant detector designed to find small polymorphisms, specifically SNPs (single-nucleotide polymorphisms), indels (insertions and deletions), MNPs (multi-nucleotide polymorphisms), and complex events (composite insertion and substitution events) smaller than the length of a short-read sequencing alignment.</p>

<p><img src="../../images/variant_calling.png" alt="Variant calling" /></p>

<p>Provided with some BAM dataset(s) and a reference sequence, FreeBayes will generate
a VCF dataset describing SNPs, indels, and complex variants in samples in the input
alignments. By default, FreeBayes will consider variants supported by at least two observations
in a single sample (<code class="language-plaintext highlighter-rouge">-C</code>) and also by at least 20% of the <span class="notranslate">reads</span> from a single sample (<code class="language-plaintext highlighter-rouge">-F</code>). These
settings are suitable for low to high depth sequencing in haploid and diploid samples, but
users working with polyploid or pooled samples may adjust them depending on the characteristics
of their sequencing data.</p>

<p>FreeBayes is capable of calling variant haplotypes shorter than a read length where multiple
polymorphisms segregate on the same read. The maximum distance between polymorphisms phased in
this way is determined by the <code class="language-plaintext highlighter-rouge">--max-complex-gap</code>, which defaults to 3bp. In practice, this can
comfortably be set to half the read length. Ploidy may be set to any level (<code class="language-plaintext highlighter-rouge">-p</code>), but by default
all samples are assumed to be diploid. FreeBayes can model per-sample and per-region variation
in copy-number (<code class="language-plaintext highlighter-rouge">-A</code>) using a copy-number variation map.</p>

<p>FreeBayes can act as a frequency-based pooled caller and can describe variants and haplotypes in
terms of observation frequency rather than called genotypes. To do so, use ‚Äìpooled-continuous
and set input filters to a suitable level. Allele observation counts will be described by AO
and RO fields in the VCF output.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-variant-calling-with-freebayes"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Variant Calling with FreeBayes</h3>

  <ol>
    <li><strong>FreeBayes</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúChoose the source for the reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">Locally cached file</code>
          <ul>
            <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúRun in batch mode?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Run Individually</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span>  <em>‚ÄúBAM dataset:</em>: <code class="language-plaintext highlighter-rouge">HISAT_Output.BAM</code></li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span>  <em>‚ÄúUsing reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">mm10</code></li>
          </ul>
        </li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúLimit variant calling to a set of regions?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Do not Limit</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúChoose parameter selection level‚Äù</em>: <code class="language-plaintext highlighter-rouge">Simple diploid calling</code></li>
      </ul>
    </li>
    <li>Inspect <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> the resulting files.</li>
  </ol>

  <p>Note: FreeBayes may take some time‚Ä¶be patient!!!!</p>
</blockquote>

<blockquote class="comment">
  <h3 id="comment-freebayes-options"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> FreeBayes options</h3>

  <p><span class="notranslate">Galaxy</span> allows five levels of control over FreeBayes options, provided by the Choose
   parameter selection level menu option. These are:</p>
  <ol>
    <li>
      <p>Simple diploid calling: The simplest possible FreeBayes application. Equivalent to using
   FreeBayes with only a BAM input and no other parameter options.</p>
    </li>
    <li>
      <p>Simple diploid calling with filtering and coverage: Same as #1 plus two additional options:
    (1) <code class="language-plaintext highlighter-rouge">-0</code> (standard filters: <code class="language-plaintext highlighter-rouge">--min-<span class="notranslate">mapping</span>-quality 30 --min-base-quality 20 --min-supporting-allele
    -qsum 0 --genotype-variant-threshold 0</code>) and (2) <code class="language-plaintext highlighter-rouge">--min-coverage</code>.</p>
    </li>
    <li>
      <p>Frequency-based pooled calling: This is equivalent to using FreeBayes with the following
   options: <code class="language-plaintext highlighter-rouge">--haplotype-length 0 --min-alte<span class="notranslate">rna</span>te-count 1 --min-alte<span class="notranslate">rna</span>te-fraction 0 --pooled
   -continuous  --report- monomorphic</code>. This is the best choice for calling variants in mixtures
   such as viral, bacterial, or organellar genomes.</p>
    </li>
    <li>
      <p>Frequency-based pooled calling with filtering and coverage: Same as #3 but adds <code class="language-plaintext highlighter-rouge">-0</code> and
   <code class="language-plaintext highlighter-rouge">--min-coverage</code> like in #2.</p>
    </li>
  </ol>

  <p>Complete list of all options: Gives you full control by exposing all FreeBayes options as <span class="notranslate">Galaxy</span> parameters.</p>
</blockquote>

<h2 id="variant-annotation-and-genome-mapping">Variant annotation and Genome <span class="notranslate">Mapping</span></h2>

<p><a href="http://dx.doi.org/10.1093/bioinformatics/btt543">CustomProDB</a> generates custom protein FASTA sequences files from exosome or transcriptome data. Once Freebayes creates the .vcf file, CustomProDB uses this file to generate a custom protein FASTA file from the transcriptome data. For this tool, we use Ensembl 89 mmusculus (GRm38.p5) (dbsnp142) as the genome annotation. We create three FASTA files from CustomProDB: (1) a variant FASTA file for short indels, (2) a Single Amino acid Variant (SAV) FASTA file, an SQLite database file (genome <span class="notranslate">mapping</span> and variant <span class="notranslate">mapping</span>) for <span class="notranslate">mapping</span> proteins to a genome and (3) an RData file for variant protein coding sequences.
The reference protein set can be filtered by transcript <span class="notranslate">expression</span> level (RPKM calculated from a BAM file), and variant protein forms can be predicted based on variant calls (SNPs and indels reported in a VCF file).</p>

<p>Annotations CustomProDB depends on a set of annotation files (in RData format) to
create reference and variant protein sequences. <span class="notranslate">Galaxy</span> administrators can use the CustomProDB
data manager to create these annotations to make them available for users.</p>

<p><img src="../../images/CustomProDB.png" alt="customproDB" /></p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-generate-protein-fastas-from-exosome-or-transcriptome-data"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Generate protein FASTAs from exosome or transcriptome data</h3>

  <ol>
    <li><strong>CustomProDB</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span>  <em>‚ÄúWill you select a genome annotation from your history or use a built-in annotation?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Use built in genome annotation</code>
          <ul>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span>  <em>‚ÄúUsing reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">Ensemble 89 mmusculus (GRm38.p5) (dbsnp142)</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúBAM file‚Äù</em>: <code class="language-plaintext highlighter-rouge">HISAT_Output.BAM</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúVCF file‚Äù</em>: <code class="language-plaintext highlighter-rouge">Freebayes.vcf</code></li>
            <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúAnnotate SNPs with rsid from dbSNP‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
            <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúAnnotate somatic SNPs from COSMIC (human only)‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          </ul>
        </li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúTranscript <span class="notranslate">Expression</span> Cutoff (RPKM)‚Äù</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
        <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúCreate a variant FASTA for short insertions and deletions‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúCreate SQLite files for <span class="notranslate">mapping</span> proteins to genome and summarizing variant proteins‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúCreate RData file of variant protein coding sequences‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li>Inspect <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> the resulting files</li>
  </ol>
</blockquote>

<p>Three FASTA files are generated through the CustomProDB tool:</p>
<ul>
  <li>a variant FASTA file for short indels,</li>
  <li>a Single Amino acid Variant (SAV) FASTA file</li>
  <li>an Sqlite file (genome <span class="notranslate">mapping</span> and variant <span class="notranslate">mapping</span>)</li>
</ul>

<p>for <span class="notranslate">mapping</span> proteins to genome and an RData file for variant protein coding sequences.
Similar to the genomic <span class="notranslate">mapping</span>, a variant <span class="notranslate">mapping</span> file is also generated from CustomProDB.
This SQLite file is also converted to tabular format and made SearchGUI-compatible. This
variant annotation file will be used to visualize the variants in the Multi-omics Visualization
Platform (in-house visualization platform developed by <span class="notranslate">Galaxy</span>-P senior developers).</p>

<h1 id="transcript-assembly">Transcript Assembly</h1>

<h2 id="rna-seq-to-transcripts"><span class="notranslate">RNA</span>-seq to transcripts</h2>

<p><a href="http://ccb.jhu.edu/software/stringtie/">StringTie</a> is a fast and highly efficient assembler of <span class="notranslate">RNA</span>-Seq alignments into potential transcripts. It uses a network flow algorithm as well as an optional <em>de novo</em> assembly step to assemble and quantitate full-length transcripts representing multiple splice variants for each gene locus.</p>

<p>Its input can include not only the alignments of raw <span class="notranslate">reads</span> used by other transcript assemblers, but also alignments of longer sequences that have been assembled from those <span class="notranslate">reads</span>. To identify differentially expressed genes between experiments, StringTie‚Äôs output can be processed by specialized software like Ballgown, Cuffdiff or other programs (DESeq2, edgeR, etc.).</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-transcript-assembly-with-stringtie"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Transcript assembly with StringTie</h3>

  <ol>
    <li><strong>StringTie</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput mapped <span class="notranslate">reads</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">FASTQ_ProB_22LIST.BAM</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSpecify strand information‚Äù</em>: <code class="language-plaintext highlighter-rouge">Unstranded</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúUse a reference file to guide assembly?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Use Reference GTF/GFF3</code>
          <ul>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúReference file‚Äù</em>: <code class="language-plaintext highlighter-rouge">Use file from History</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGTF/GFF3 dataset to guide assembly‚Äù</em>: <code class="language-plaintext highlighter-rouge">Mus_musculus.GRCm38.86.gtf</code></li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúUse Reference transcripts only?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúOutput files for differential <span class="notranslate">expression</span>?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No additional output</code></li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúOutput coverage file?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          </ul>
        </li>
      </ul>
    </li>
    <li>Inspect <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> the resulting files.</li>
    <li>Rename the output to <code class="language-plaintext highlighter-rouge">Stringtie_outut.gtf</code>
      <blockquote class="tip">

        <h3 id="tip-tip-renaming-a-dataset-1"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Renaming a dataset</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, change the <strong>Name</strong> field</li>
          <li>Click the <strong>Save</strong> button</li>
        </ul>
      </blockquote>
    </li>
    <li>Make sure the datatype is <code class="language-plaintext highlighter-rouge">gtf</code>
      <blockquote class="tip">

        <h3 id="tip-tip-changing-the-datatype-1"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Changing the datatype</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, click on the <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-chart-select-data</span> <strong>Datatypes</strong> tab on the top</li>
          <li>Select ``</li>
          <li>Click the <strong>Change datatype</strong> button</li>
        </ul>
      </blockquote>
    </li>
  </ol>

</blockquote>

<p>StringTie accepts a BAM (or SAM) file of paired-end <span class="notranslate">RNA</span>-seq <span class="notranslate">reads</span>, which must be
sorted by genomic location (coordinate position). This file contains spliced read alignments
and can be produced directly by programs such as HISAT2. We recommend using HISAT2 as it is a
fast and accurate alignment program. Every spliced read alignment (i.e. an alignment across
at least one junction) in the input BAM file must contain the tag XS to indicate the genomic
strand that produced the <span class="notranslate">RNA</span> from which the read was sequenced. Alignments produced by HISAT2
(when run with the <code class="language-plaintext highlighter-rouge">--dta</code> option) already include this tag, but if you use a different read mapper
you should check that this XS tag is included for spliced alignments.</p>

<blockquote class="details">
  <h3 id="details-note-about-parameter-settings"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> Note about parameter settings</h3>
  <p>Be sure to run HISAT2 with the <code class="language-plaintext highlighter-rouge">--dta</code> option for alignment (under ‚ÄòSpliced alignment options‚Äô),
for the best results.</p>

  <p>Also note that if your <span class="notranslate">reads</span> are from a stranded library, you need to choose the appropriate
setting for ‚ÄòSpecify strand information‚Äô above. As, if Forward (FR) is selected, StringTie will
assume the <span class="notranslate">reads</span> are from a <code class="language-plaintext highlighter-rouge">--fr</code> library, while if Reverse (RF) is selected, StringTie will
assume the <span class="notranslate">reads</span> are from a <code class="language-plaintext highlighter-rouge">--rf</code> library, otherwise it is assumed that the <span class="notranslate">reads</span> are from an
unstranded library (the widely-used, although now deprecated, TopHat had a similar <code class="language-plaintext highlighter-rouge">--library-type</code>
option, where fr-firststrand corresponded to RF and fr-secondstrand corresponded to FR).
If you don‚Äôt know whether your <span class="notranslate">reads</span> are from a stranded library or not, you could use the
tool ‚ÄòRSeQC Infer Experiment‚Äô to try to determine.</p>

  <p>As an option, a reference annotation file in GTF/GFF3 format can be provided to StringTie. In
this case, StringTie will prefer to use these ‚Äúknown‚Äù genes from the annotation file, and for
the ones that are expressed it will compute coverage, TPM and FPKM values. It will also produce
additional transcripts to account for <span class="notranslate">RNA</span>-seq data that aren‚Äôt covered by (or explained by) the
annotation. Note that if option <code class="language-plaintext highlighter-rouge">-e</code> is not used, the reference transcripts need to be fully covered
by <span class="notranslate">reads</span> in order to be included in StringTie‚Äôs output. In that case, other transcripts assembled
from the data by StringTie and not present in the reference file will be printed as well.</p>

  <p>We highly recommend that you provide annotation if you are analyzing a genome that is well
annotated, such as human, mouse, or other model organisms.</p>
</blockquote>

<h2 id="evaluate-the-assembly-with-annotated-transcripts">Evaluate the assembly with annotated transcripts</h2>

<p><a href="https://ccb.jhu.edu/software/stringtie/gffcompare.shtml">GffCompare</a> compares and evaluates the accuracy of <span class="notranslate">RNA</span>-Seq transcript assemblers (Cufflinks, Stringtie). * collapse (merge) duplicate transcripts from multiple GTF/GFF3 files (e.g. resulted from assembly of different samples) * classify transcripts from one or multiple GTF/GFF3 files as they relate to reference transcripts provided in a annotation file (also in GTF/GFF3 format)</p>

<p>The original form of this program is also distributed as part of the Cufflinks suite, under the name <a href="http://cole-trapnell-lab.github.io/cufflinks/cuffcompare/">CuffCompare</a>. Most of the options and parameters of CuffCompare are supported by GffCompare, while new features will likely be added to GffCompare in the future.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-compare-assembled-transcripts-against-a-reference-annotation"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: compare assembled transcripts against a reference annotation</h3>

  <ol>
    <li><strong>GffCompare</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGTF inputs for comparison‚Äù</em><code class="language-plaintext highlighter-rouge">Stringtie_outut.gtf</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúUse Reference Annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">yes</code>
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúReference Annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">Mus_musculus.GRCm38.86.gtf</code></li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúIgnore reference transcripts that are not overlapped by any input transfrags‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúIgnore input transcripts that are not overlapped by any reference transcripts‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
          </ul>
        </li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúUse Sequence Data‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚Äúdiscard (ignore) single-exon transcripts‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúMax. Distance for assessing exon accuracy‚Äù</em>: <code class="language-plaintext highlighter-rouge">100</code></li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúMax distance for transcript grouping‚Äù</em>: <code class="language-plaintext highlighter-rouge">100</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚Äúdiscard intron-redundant transfrags sharing 5‚Äô‚Äú</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<blockquote class="details">
  <h3 id="details-gffcompare-vs-cuffcompare"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> GffCompare vs CuffCompare</h3>
  <p>A notable difference between GffCompare and CuffCompare is that when a single query GTF/GFF file is
given as input along with a reference annotation (<code class="language-plaintext highlighter-rouge">-r</code> option), GFFCompare switches into ‚Äúannotation mode‚Äù
and it generates a <code class="language-plaintext highlighter-rouge">.annotated.gtf</code> file instead of the <code class="language-plaintext highlighter-rouge">.merged.gtf</code> produced by CuffCompare with the same
parameters. This file has the same general format as CuffCompare‚Äôs .merged.gtf file (with ‚Äúclass
codes‚Äù assigned to transcripts as per their relationship with the matching/overlapping reference,
transcript) but the original transcript IDs are preserved, so GffCompare can thus be used as a
simple way of annotating a set of transcripts.</p>

  <p>Another important difference is that the input transcripts are no longer discarded when they
are found to be ‚Äúintron redundant‚Äù, i.e. contained within other, longer isoforms. CuffCompare
had the <code class="language-plaintext highlighter-rouge">-G</code> option to prevent collapsing of such intron redundant isoforms into their longer
‚Äúcontainers‚Äù, but GffCompare has made this the default mode of operation (hence the <code class="language-plaintext highlighter-rouge">-G</code> option is
no longer needed and is simply ignored when given).</p>

</blockquote>

<h2 id="translate-transcripts">Translate transcripts</h2>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-translate-transcripts-to-protein-sequence"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Translate transcripts to protein sequence</h3>

  <p>First, we must convert the GffCompare annotated GTF file to <span class="notranslate">BED</span> format.</p>

  <ol>
    <li><strong>Convert gffCompare annotated GTF to <span class="notranslate">BED</span></strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGTF annotated by gffCompare‚Äù</em>: <code class="language-plaintext highlighter-rouge">output from gff compare</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚Äúfilter GffCompare class_codes to convert‚Äù</em>:</li>
      </ul>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">j : Potentially novel isoform (fragment): at least one splice junction is shared with a reference transcript</code></li>
        <li><code class="language-plaintext highlighter-rouge">e : Single exon transfrag overlapping a reference exon and at least 10 bp of a reference intron, indicating a possible   pre-m<span class="notranslate">RNA</span> fragment.</code></li>
        <li><code class="language-plaintext highlighter-rouge">i : A transfrag falling entirely within a reference intron</code></li>
        <li><code class="language-plaintext highlighter-rouge">p : Possible polymerase run-on fragment (within 2Kbases of a reference transcript)</code></li>
        <li><code class="language-plaintext highlighter-rouge">u : Unknown, intergenic transcript</code></li>
      </ul>

      <p>Next, we translate transcripts from the input <span class="notranslate">BED</span> file into protein sequences.</p>
    </li>
    <li><strong>Translate <span class="notranslate">BED</span> transcripts c<span class="notranslate">DNA</span> in 3frames or CDS</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúA <span class="notranslate">BED</span> file with 12 columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">Convert GffCompare-annotated GTF to <span class="notranslate">BED</span></code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSource for Genomic Sequence Data‚Äù</em>: <code class="language-plaintext highlighter-rouge">Locally cached File</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSelect reference 2bit file‚Äù</em>: <code class="language-plaintext highlighter-rouge">mm10</code></li>
      </ul>

      <p>Finally, we convert a <span class="notranslate">BED</span> format file of the proteins from a proteomics search database into a tabular format for the Multiomics Visualization Platform (MVP).</p>
    </li>
    <li><strong><span class="notranslate">bed</span> to protein map</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúA <span class="notranslate">BED</span> file with 12 columns, thickStart and thickEnd define protein coding region‚Äù</em>: <code class="language-plaintext highlighter-rouge">Translate c<span class="notranslate">DNA</span>_minus_CDS</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<blockquote class="comment">
  <h3 id="comment-note-on-data-formats"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Note on data formats</h3>
  <ul>
    <li>The tabular output can be converted to a sqlite database using the Query_Tabular tool.</li>
    <li>The sqlite table should be named: feature_cds_map.</li>
    <li>The names for the columns should be: name, chrom, start, end, strand, cds_start, cds_end</li>
    <li>This SQL query will return the genomic location for a peptide sequence in a protein
(multiply the amino acid position by 3 for the cds location)</li>
  </ul>
</blockquote>

<h1 id="creating-fasta-databases">Creating FASTA Databases</h1>

<p>In this section we will perform the following tasks:</p>
<ul>
  <li>The <strong>Protein Database Downloader</strong> tool is used to download the FASTA database from UniProt and cRAP (<strong>c</strong>ommon <strong>R</strong>epository of <strong>A</strong>dventitious <strong>P</strong>roteins) database containing known/reference mouse proteins. For the purpose of this tutorial, we will use the <code class="language-plaintext highlighter-rouge">Reference_5000_uniprot_cRAP.fasta</code> file as this database.</li>
  <li>The <strong>FASTA Merge Files and Filter Unique Sequences</strong> tool is used to merge the databases obtained from CustomProDB and ‚ÄúTranslate <span class="notranslate">BED</span>‚Äù tool
along with the UniProt and cRAP databases.</li>
  <li>The <strong>Regex Text Manipulation</strong> tool is used to manipulate the FASTA file to make it SearchGUI-compatible.</li>
</ul>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li><strong>FASTA Merge Files and Filter Unique Sequences</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúRun in batch mode?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Merge individual FASTAs (output collection if input is collection)</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúInput FASTA File(s)‚Äù</em> : <code class="language-plaintext highlighter-rouge">Input Custom ProDB Fasta File output</code>
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1.HISAT_Output.rpkm
 2.HISAT_Output.snv
 3.HISAT_Output.indel
</code></pre></div>          </div>
        </li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúHow are sequences judged to be unique?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Accession and Sequence</code></li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúAccession Parsing Regular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">^&gt;([^ |]+).*$</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<blockquote class="comment">
  <h3 id="comment-tool-parameters-explained"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Tool parameters explained</h3>
  <p>This tool concatenates FASTA database files together.</p>
  <ul>
    <li>If the uniqueness criterion is ‚ÄúAccession and Sequence‚Äù, only the first appearence of each unique sequence will appear in the output. Otherwise, duplicate sequences are allowed, but only the first appearance of each accession will appear in the output.</li>
    <li>The default accession parser will treat everything in the header before the first space as the accession.</li>
    <li>Rename it as <strong>CustomProDB Merged Fasta</strong></li>
  </ul>
</blockquote>

<p><img src="../../images/Fasta_sequence.png" alt="Fasta sequence" /></p>

<p>For visualization purposes we also use the concatenate tool to concatenate the genomic <span class="notranslate">mapping</span> with the protein <span class="notranslate">mapping</span> dataset. This output will be used for visualization in MVP to view the genomic coordinates of the variant peptide.</p>

<p>An SQLite database containing the genomic <span class="notranslate">mapping</span> SQLite, variant annotation and information from the protein <span class="notranslate">mapping</span> file is concatenated to form a single genomic <span class="notranslate">mapping</span> SQLite database later used as an input for the ‚ÄòPeptide Genomic Coordinate‚Äô tool. For that we need to follow the steps below:</p>

<h2 id="genomic-mapping-database">Genomic <span class="notranslate">mapping</span> database</h2>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-create-database-for-genomic-mapping"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Create Database for genomic <span class="notranslate">mapping</span></h3>

  <ol>
    <li><strong>SQLite to tabular for SQL query</strong> <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSQLite Database‚Äù</em>: <code class="language-plaintext highlighter-rouge">genomic_<span class="notranslate">mapping</span>.sqlite</code> from CustomProDB</li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúQuery‚Äù</em>:
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  SELECT pro_name, chr_name, cds_chr_start - 1, cds_chr_end,strand,cds_start - 1, cds_end
  FROM genomic_<span class="notranslate">mapping</span>
  ORDER BY pro_name, cds_start, cds_end
</code></pre></div>          </div>
        </li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúOmit column headers from tabular output‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
      </ul>
    </li>
    <li>Rename output to <code class="language-plaintext highlighter-rouge">genomic_<span class="notranslate">mapping</span>_sqlite</code>
      <blockquote class="tip">

        <h3 id="tip-tip-renaming-a-dataset-2"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Renaming a dataset</h3>
        <ul>
          <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>
          <li>In the central panel, change the <strong>Name</strong> field</li>
          <li>Click the <strong>Save</strong> button</li>
        </ul>
      </blockquote>

      <p>The output is further processed so that the results are compatible with the Multiomics Visualization Platform.</p>
    </li>
    <li><strong>Column Regex Find And Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSelect cells from‚Äù</em>: <code class="language-plaintext highlighter-rouge">genomic_<span class="notranslate">mapping</span>_sqlite' (tabular)</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúUsing‚Äù</em>: <code class="language-plaintext highlighter-rouge">column 1</code></li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Check</strong>
          <ul>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúFind Regex‚Äù</em> : <code class="language-plaintext highlighter-rouge">^(ENS[^_]+_\d+:)([ACGTacgt]+)&gt;([ACGTacgt]+)\s*</code></li>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúReplacement‚Äù</em>: <code class="language-plaintext highlighter-rouge">\1\2_\3</code></li>
          </ul>
        </li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Check</strong>
          <ul>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúFind Regex‚Äù</em>:  <code class="language-plaintext highlighter-rouge">,([A-Z]\d+[A-Z])\s*</code></li>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúReplacement‚Äù</em>: <code class="language-plaintext highlighter-rouge">.\1</code></li>
          </ul>
        </li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Check</strong>
          <ul>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúFind Regex‚Äù</em>: <code class="language-plaintext highlighter-rouge">^(ENS[^ |]*)\s*</code></li>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúReplacement‚Äù</em>: <code class="language-plaintext highlighter-rouge">\1</code></li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <p>Rename the output to <code class="language-plaintext highlighter-rouge">SAV_INDEL</code></p>

      <p>This tool goes line by line through the specified input file and if the text in the selected column matches a specified regular <span class="notranslate">expression</span> pattern, it replaces the text with the specified replacement.</p>

      <p>Next, we will concatenate the output from this tool with the ‚Äú<span class="notranslate">Bed</span> to protein map‚Äù output.</p>
    </li>
    <li><strong>Concatenate multiple datasets</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúConcatenate Datasets‚Äù</em>: Select the output from the previous tool named as <code class="language-plaintext highlighter-rouge">SAV_INDEL</code> and the output from the ‚Äú<span class="notranslate">bed</span> to protein map‚Äù tool and concatenate the tool.</li>
      </ul>

      <p>Output will be the ‚ÄúGenomic_Protein_map‚Äù rename it as that</p>

      <p>Now, we load this tabular datasets into an SQLite database.</p>
    </li>
    <li><strong>Query Tabular using SQLite</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Database Table</strong>
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTabular Dataset for Table‚Äù</em>: <code class="language-plaintext highlighter-rouge">Genomic_Protein_map</code></li>
            <li>Section <strong>Table Options</strong>:
              <ul>
                <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúSpecify Name for Table‚Äù</em>: <code class="language-plaintext highlighter-rouge">feature_cds_map</code></li>
                <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúSpecify Column Names (comma-separated list)‚Äù</em>: <code class="language-plaintext highlighter-rouge">name,chrom,start,end,strand,cds_start,cds_end</code></li>
                <li><em>‚ÄúOnly load the columns you have named into database‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
                <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Table Index</strong>:
                  <ul>
                    <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúThis is a unique index‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
                    <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúIndex on columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">name,cds_start,cds_end</code></li>
                  </ul>
                </li>
                <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSave the sqlite database in your history‚Äù</em>:<code class="language-plaintext highlighter-rouge">Yes</code></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <p>Rename the output as <strong>‚Äúgenomic_<span class="notranslate">mapping</span>_sqlite‚Äù</strong></p>

      <p><img src="../../images/genomic_mapping_file.png" alt="genomic mapping" /></p>
    </li>
  </ol>

</blockquote>

<h2 id="variant-annotations-database">Variant Annotations database</h2>

<p>We will repeat the process for the variant annotations</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-create-database-for-variant-annotations"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Create database for variant annotations</h3>

  <ol>
    <li><strong>SQLite to tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSQLite Database‚Äù</em>: <code class="language-plaintext highlighter-rouge">variant_annotations.sqlite</code> from CustomProDB</li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúQuery‚Äù</em>:
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT var_pro_name,pro_name,cigar,annotation
FROM variant_annotation
</code></pre></div>          </div>
        </li>
      </ul>

      <p>We will subject the output to text manipulation so that the results are compatible with the Multiomics Visualization Platform.</p>
    </li>
    <li><strong>Column Regex Find And Replace</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSelect cells from‚Äù</em>: <code class="language-plaintext highlighter-rouge">variant_annotations_sqlite' (tabular)</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúUsing:‚Äù</em> <code class="language-plaintext highlighter-rouge">column 1</code></li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Check</strong>
          <ul>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúFind Regex‚Äù</em>: <code class="language-plaintext highlighter-rouge">^(ENS[^_]+_\d+:)([ACGTacgt]+)&gt;([ACGTacgt]+)\s*</code></li>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúReplacement‚Äù</em>: <code class="language-plaintext highlighter-rouge">\1\2_\3</code></li>
          </ul>
        </li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Check</strong>:
          <ul>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúFind Regex‚Äù</em>: <code class="language-plaintext highlighter-rouge">,([A-Z]\d+[A-Z])\s*</code></li>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúReplacement‚Äù</em>: <code class="language-plaintext highlighter-rouge">.\1</code></li>
          </ul>
        </li>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Check</strong>:
          <ul>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúFind Regex‚Äù</em>: <code class="language-plaintext highlighter-rouge">^(ENS[^ |]*)\s*</code></li>
            <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúReplacement‚Äù</em>:  <code class="language-plaintext highlighter-rouge">\1</code></li>
          </ul>
        </li>
      </ul>

      <p>Next, we will load this tabular dataset into an SQLite database.</p>
    </li>
    <li><strong>Query Tabular</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Database Table</strong>
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTabular Dataset for Table‚Äù</em>: <code class="language-plaintext highlighter-rouge">variant_annotation</code></li>
            <li>Section <strong>Table Options</strong>:
              <ul>
                <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúSpecify Name for Table‚Äù</em>: <code class="language-plaintext highlighter-rouge">variant_annotation</code></li>
                <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúSpecify Column Names (comma-separated list)‚Äù</em>: <code class="language-plaintext highlighter-rouge">name,reference,cigar,annotation</code></li>
                <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúOnly load the columns you have named into database‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
              </ul>
            </li>
            <li><i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <strong>Insert Table Index</strong>
              <ul>
                <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúThis is a unique index‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
                <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúIndex on columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">name,cigar</code></li>
              </ul>
            </li>
            <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúSave the sqlite database in your history‚Äù</em>:<code class="language-plaintext highlighter-rouge">Yes</code></li>
          </ul>
        </li>
      </ul>
    </li>
    <li>Rename the output as <strong>‚ÄúVariant_annotation_sqlitedb‚Äù</strong></li>
  </ol>

</blockquote>

<p>These SQLite databases, which contain the genomic <span class="notranslate">mapping</span> SQLite and variant
annotation information from the protein <span class="notranslate">mapping</span> file, will be utilized
by MVP to visualize the genomic loci of any variant peptides.</p>

<p><img src="../../images/viewing_SNP_Variant_IGV.png" alt="SNP variant" /></p>

<p>Finally, we can create a database which can be used to search Mass spectrometry (raw/mgf) files to identify peptides that match to this database.</p>

<p>To do so:</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-1"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li><strong>FASTA Merge Files and Filter Unique Sequences</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><i class="far fa-check-square" aria-hidden="true"></i><span class="visually-hidden">param-check</span> <em>‚ÄúRun in batch mode?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Merge individual FASTAs (output collection if input is collection)</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúInput FASTA File(s)‚Äù</em> : <code class="language-plaintext highlighter-rouge">Input Custom ProDB Merged Fasta File output</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúInput FASTA File(s)‚Äù</em> : <code class="language-plaintext highlighter-rouge">Input Translate <span class="notranslate">BED</span> transcripts Fasta output</code></li>
        <li><i class="far fa-copy" aria-hidden="true"></i><span class="visually-hidden">param-files</span> <em>‚ÄúInput FASTA File(s)‚Äù</em> : <code class="language-plaintext highlighter-rouge">Input Reference_5000_uniprot_cRAP.fasta</code></li>
        <li><i class="fas fa-filter" aria-hidden="true"></i><span class="visually-hidden">param-select</span> <em>‚ÄúHow are sequences judged to be unique?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Accession and Sequence</code></li>
        <li><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">param-text</span> <em>‚ÄúAccession Parsing Regular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">^&gt;([^ |]+).*$</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<blockquote class="comment">
  <h3 id="comment-tool-parameters-explained-1"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Tool parameters explained</h3>
  <p>This tool concatenates FASTA database files together.</p>
  <ul>
    <li>If the uniqueness criterion is ‚ÄúAccession and Sequence‚Äù, only the first appearence of each unique sequence will appear in the output. Otherwise, duplicate sequences are allowed, but only the first appearance of each accession will appear in the output.</li>
    <li>The default accession parser will treat everything in the header before the first space as the accession.</li>
    <li>All the tools mentioned in this tutorial are subjected to change when the tool version is upgraded .</li>
  </ul>
</blockquote>



                    
                    <blockquote class="key_points">
                        <h3><i class="fas fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>
                        <ul>
                            
                            <li><p>Generating variant protein database</p>
</li>
                            
                            <li><p>Generating genomic and variant mapping files for visualization</p>
</li>
                            
                        </ul>
                    </blockquote>
                    

                    
                    <h1 data-toc-skip>Useful literature</h1>
                    <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/proteomics#references">here</a>.</p>
                    

                    

                    <h1>Feedback</h1>
                    <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">how it went</a>.</p>

                    <div id="feedback-button">
                        <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                    </div>
                    <div id="feedback-form">
                    </div>
                    <script type="text/javascript">
                        (function (window, document) {
                            function onDocumentReady(fn) {
                                if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                    fn();
                                } else {
                                    document.addEventListener('DOMContentLoaded', fn);
                                }
                            }

                            onDocumentReady(function () {
                                $("#feedback-button").click(function(evt){
                                    var e = $(evt.target)
                                    e.hide();

                                    $("#feedback-form").html(`
                                        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Proteogenomics 1: Database Creation (Proteomics)">Loading...</iframe>
                                    `)
                                })
                            });
                        })(window, document);
                    </script>



                    <h1>Citing this Tutorial</h1>
                    <p>
                        <ol>
                            <li id="citation-text">Subina Mehta, Timothy J. Griffin, Pratik Jagtap, Ray Sajulga, James Johnson, Praveen Kumar, 2021 <b>Proteogenomics 1: Database Creation (Galaxy Training Materials)</b>. <a href="/training-material/topics/proteomics/tutorials/proteogenomics-dbcreation/tutorial.html">/training-material/topics/proteomics/tutorials/proteogenomics-dbcreation/tutorial.html</a> Online; accessed TODAY
                            </li>
                            <li>
                            Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                            </li>
                        </ol>
                    </p>


                    <blockquote class="details">
                      <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                      <p style="display: none;">

                    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{proteomics-proteogenomics-dbcreation,
    author = "Subina Mehta and Timothy J. Griffin and Pratik Jagtap and Ray Sajulga and James Johnson and Praveen Kumar",
    title = "Proteogenomics 1: Database Creation (Galaxy Training Materials)",
    year = "2021",
    month = "01",
    day = "06"
    url = "\url{/training-material/topics/proteomics/tutorials/proteogenomics-dbcreation/tutorial.html}",
    note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
        doi = {10.1016/j.cels.2018.05.012},
        url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
        year = 2018,
        month = {jun},
        publisher = {Elsevier {BV}},
        volume = {6},
        number = {6},
        pages = {752--758.e1},
        author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and Bj√∂rn Gr√ºning},
        title = {Community-Driven Data Analysis Training for Biology},
        journal = {Cell Systems}
}</code>
                    </pre></div></div>
                    </p>
                    </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                </div>
            </div>
        </div>

        <h3><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        
        <blockquote class="agenda follow-up">
            <strong class="follow-up"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Do you want to extend your knowledge? Follow one of our recommended follow-up trainings:</strong>
            <ul>
                
    <li>
    
        
        
        <a href="/training-material/topics/proteomics">Proteomics</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Proteogenomics 3: Novel peptide analysis:
                            
                            
                                
                                     <a href="/training-material/topics/proteomics/tutorials/proteogenomics-novel-peptide-analysis/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

            </ul>
        </blockquote>
        
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Subina Mehta, Timothy J. Griffin, Pratik Jagtap, Ray Sajulga, James Johnson, Praveen Kumar)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/proteomics/tutorials/proteogenomics-dbcreation/tutorial.md">GitHub</a>.
        </p>
        <p>
    The content of the tutorials and website is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
