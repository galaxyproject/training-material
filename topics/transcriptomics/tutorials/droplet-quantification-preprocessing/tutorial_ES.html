<!doctype html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas utilizando Alevin</title>
        
            <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml" />

        
        
        
        
        
        <meta name="description" content="Training material for all kinds of transcriptomics analysis." />
        <meta property="og:title" content="Galaxy Training: Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN..." />
        <meta property="og:description" content="Training material for all kinds of transcriptomics analysis." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/transcriptomics" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Transcriptomics
                        </a>
                        
                    </li>
                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="/training-material/topics/transcriptomics/faqs/" title="Check our FAQs for the Transcriptomics topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        
        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        
            <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Translate this page
            </div>

            <div id="lang-selector">
                
                  <strong>Curated Translations</strong>
                  
                      
                          
                          <a class="btn btn-info" href="/training-material/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial.html">
                            English
                          </a>
                      
                  
                
                <strong>Automatic Translations</strong>

<a class="btn btn-info" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html&edit-text=&act=url">
                Fran√ßais
                </a>
                
<a class="btn btn-info" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html&edit-text=&act=url">
                Êó•Êú¨Ë™û
                </a>
                
<a class="btn btn-info" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html&edit-text=&act=url">
                Espa√±ol
                </a>
                
<a class="btn btn-info" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html&edit-text=&act=url">
                Portugu√™s
                </a>
                
<a class="btn btn-info" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html&edit-text=&act=url">
                ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                </a>
                
                <a class="btn btn-info" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html&edit-text=&act=url" title="">
                And more!
                </a>
            </div>
        </div>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="progress" class="btn btn-secondary">
                    <input type="radio" name="options" id="progress" autocomplete="off">üè≥Ô∏è‚Äçüåà
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> üéÉ
                </label>
                <label data-value="straya" class="btn btn-secondary">
                    <input type="radio" name="options" id="downunder" autocomplete="off"> üá¶üá∫
                </label>
            </div>

        </div>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            
            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2021-10-01/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html" title="Version 2021-10-01">2021-10-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2021-09-01/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html" title="Version 2021-09-01">2021-09-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2021-08-01/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html" title="Version 2021-08-01">2021-08-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/" title="Older Versions">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        <div class="container main-content" role="main">
        











<!-- Gitter -->




<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/galaxy-single-cell'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<script type="application/ld+json">
    


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "1970-01-01 00:33:41 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas utilizando Alevin",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Transcriptomics",
    "description": "Training material for all kinds of transcriptomics analysis.",
    "url": "https://training.galaxyproject.org//training-material/topics/transcriptomics/"
  },
  "description": "",
  "inLanguage": {
    "@type": "Language",
    "name": null,
    "alternateName": "es"
  },
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/quality-control/slides.html",
      "name": "Quality Control",
      "description": "Slides for 'Quality Control' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html",
      "name": "Quality Control",
      "description": "Hands-on for 'Quality Control' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/quality-control/slides.html",
      "name": "Quality Control",
      "description": "Slides for 'Quality Control' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/mapping/slides.html",
      "name": "Mapping",
      "description": "Slides for 'Mapping' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html",
      "name": "Mapping",
      "description": "Hands-on for 'Mapping' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/sequence-analysis/tutorials/mapping/slides.html",
      "name": "Mapping",
      "description": "Slides for 'Mapping' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/transcriptomics/tutorials/scrna-intro/slides.html",
      "name": "An introduction to scRNA-seq data analysis",
      "description": "Slides for 'An introduction to scRNA-seq data analysis' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/transcriptomics/tutorials/scrna-intro/slides.html",
      "name": "An introduction to scRNA-seq data analysis",
      "description": "Slides for 'An introduction to scRNA-seq data analysis' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/transcriptomics/tutorials/scrna-umis/tutorial.html",
      "name": "Understanding Barcodes",
      "description": "Hands-on for 'Understanding Barcodes' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Wendi Bacon"
    },
    {
      "@type": "Person",
      "name": "Jonathan Manning"
    },
    {
      "@type": "Person",
      "name": "Patricia Carvajal L√≥pez"
    },
    {
      "@type": "Person",
      "name": "Alejandra Escobar-Zepeda"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Wendi Bacon"
    },
    {
      "@type": "Person",
      "name": "Jonathan Manning"
    },
    {
      "@type": "Person",
      "name": "Patricia Carvajal L√≥pez"
    },
    {
      "@type": "Person",
      "name": "Alejandra Escobar-Zepeda"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Transcriptomics",
      "description": "Training material for all kinds of transcriptomics analysis.",
      "url": "https://training.galaxyproject.org//training-material/topics/transcriptomics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3308",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3308",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3308"
    }
  ],
  "skillLevel": "Advanced"
}
</script>

<section class="tutorial topic-transcriptomics">
    <h1 data-toc-skip>Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas utilizando Alevin</h1>
    

    <div class="contributors-line">Autores: <a href="/training-material/hall-of-fame/nomadscientist/" class="contributor-badge contributor-nomadscientist"><img src="https://avatars.githubusercontent.com/nomadscientist?s=27" alt="Avatar">Wendi Bacon</a><a href="/training-material/hall-of-fame/pinin4fjords/" class="contributor-badge contributor-pinin4fjords"><img src="https://avatars.githubusercontent.com/pinin4fjords?s=27" alt="Avatar">Jonathan Manning</a><a href="/training-material/hall-of-fame/pclo/" class="contributor-badge contributor-pclo"><img src="https://avatars.githubusercontent.com/pclo?s=27" alt="Avatar">Patricia Carvajal L√≥pez</a><a href="/training-material/hall-of-fame/ales-ibt/" class="contributor-badge contributor-ales-ibt"><img src="https://avatars.githubusercontent.com/ales-ibt?s=27" alt="Avatar">Alejandra Escobar-Zepeda</a></div>

    <blockquote class="overview">
        <h3>Descripci√≥n General</h3>
        
        <img alt="Creative Commons License" class="float-right" style="border-width:0; display: inline-block; margin:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" aria-hidden="true" />
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Preguntas:</strong>
        <ul>
        
        <li><p>Tengo algunos archivos FASTQ de secuenciaci√≥n de ARN de c√©lulas √∫nicas los cuales quiero analizar. ¬øPor d√≥nde empiezo?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objetivos: </strong>
        <ul>
        
        <li><p>Repetir la generaci√≥n de una matriz para datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas obtenidos a partir de t√©cnicas de goteo</p>
</li>
        
        <li><p>Aplicar combinaci√≥n de datos y edici√≥n de metadatos en dise√±os experimentales espec√≠ficos</p>
</li>
        
        <li><p>Interpretar gr√°ficos de control de calidad (QC) para poder tomar decisiones fundamentadas en umbrales de c√©lula</p>
</li>
        
        <li><p>Encontrar informaci√≥n relevante en archivos GTF que est√© asociada a las particularidades del estudio e incluirla en los metadatos de la matriz de datos</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requisitos:</strong>
        <ul>
        
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

    <li>
    
        
        
        <a href="/training-material/topics/sequence-analysis">Sequence analysis</a>
        
            <ul>
                
                    
                        
                    
                        
                            
                            <li> Quality Control:
                            
                                <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                
                    
                        
                            
                            <li> Mapping:
                            
                                <a href="/training-material/topics/sequence-analysis/tutorials/mapping/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

        
    <li>
    
        
        
        <a href="/training-material/topics/transcriptomics">Transcriptomics</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> An introduction to scRNA-seq data analysis:
                            
                                <a href="/training-material/topics/transcriptomics/tutorials/scrna-intro/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Understanding Barcodes:
                            
                            
                                
                                     <a href="/training-material/topics/transcriptomics/tutorials/scrna-umis/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Duraci√≥n estimada:</strong> 3 horas</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Nivel: </strong>
        


 Avanzado <span class="visually-hidden">Advanced</span>
<span class="level advanced" title="Advanced Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        
        

        
        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Materiales de apoyo:</strong></div>
        <ul class="supporting_material">
            
                <li class="btn btn-default supporting_material"><a href="/training-material/topics/transcriptomics/slides/introduction.html" title="Topic Overview slides">
                    <i class="fab fa-slideshare" aria-hidden="true"></i> Topic Overview slides
                </a></li>
            

            
                <li class="btn btn-default supporting_material">


<a class="topic-icon" href="https://zenodo.org/record/4574153">
    <i class="far fa-copy" aria-hidden="true"></i> Conjuntos de datos
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="topic-icon" href="/training-material/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/workflows/" title="Workflows" alt="Generating a single cell matrix using Alevin workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i> Flujos de trabajos
    </a>

</li>
            

            

            

            
            
            

            
                <li class="btn btn-default supporting_material">


    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span> Disponible en estas instancias de Galaxy 
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics/transcriptomics/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://humancellatlas.usegalaxy.eu/" title="Human Cell Atlas">
            Human Cell Atlas
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    </ul>


</li>
            
        </ul>
        

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> √öltima modificaci√≥n:</strong> Oct 11, 2021 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> Licencia:</strong>
            
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">GTN Framework tiene licencia del MIT</a>
            
            <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">GTN Framework tiene licencia del MIT</a>
        </div>
    </blockquote>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                

                <h1 class="no_toc" id="introduction">Introduction</h1>

<!-- This is a comment. -->

<p>Este tutorial te ayudar√° a pasar de datos crudos de secuenciaci√≥n en archivos FASTQ a una matriz de datos en formato AnnData donde cada c√©lula es una fila y cada gen es una columna. Pero, ¬øQu√© es una matriz de datos y cu√°l es el formato AnnData? Lo averiguaremos a su debido tiempo. Enfatizamos que este es el primer paso para procesar datos de secuenciaci√≥n de c√©lulas √∫nicas para poder realizar su an√°lisis.</p>

<p>De momento, en tus archivos de secuenciaci√≥n tienes un mont√≥n de cadenas del tipo <code class="language-plaintext highlighter-rouge">ATGGGCTT</code>, etc. y lo que necesitas saber es cu√°ntas c√©lulas tienes y qu√© genes aparecen en ellas. En la segunda parte de este tutorial abordaremos la combinaci√≥n de archivos FASTQ y el c√≥mo a√±adir metadatos (por ejemplo, SEXO o GENOTIPO) para an√°lisis posteriores. Estos son los pasos que requieren m√°s recursos computacionales en los an√°lisis de c√©lulas √∫nicas, ya que partimos de cientos de millones de lecturas, cada una de ellas con cuatro l√≠neas de texto. Posteriormente, en el an√°lisis, estos datos se convertir√°n en simples conteos de genes, por ejemplo ‚ÄòLa c√©lula A tiene 4 GAPDHs‚Äô (‚ÄòCell A has 4 GAPDHs‚Äô), que es mucho m√°s sencillo de almacenar.</p>

<p>Debido a la enorme cantidad de datos, hemos reducido la resoluci√≥n de los archivos FASTQ para poder acelerar el an√°lisis. Una vez que hemos aclarado este punto, todav√≠a tienes que mapear enormes cantidades de lecturas al inmenso genoma murino, as√≠ que ¬°ve por una taza de caf√© y prep√°rate para iniciar el an√°lisis!</p>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>En este tutorial abordaremos:</p>

<ol id="markdown-toc">
  <li><a href="#generar-una-matriz" id="markdown-toc-generar-una-matriz">Generar una matriz</a>    <ol>
      <li><a href="#obtener-datos" id="markdown-toc-obtener-datos">Obtener datos</a></li>
      <li><a href="#generar-un-mapa-de-correspondencia-de-transcritos-a-genes" id="markdown-toc-generar-un-mapa-de-correspondencia-de-transcritos-a-genes">Generar un mapa de correspondencia de transcritos a genes</a></li>
      <li><a href="#generar-el-√≠ndice-de-un-transcriptoma-y-cuantificar" id="markdown-toc-generar-el-√≠ndice-de-un-transcriptoma-y-cuantificar">Generar el √≠ndice de un transcriptoma y cuantificar</a></li>
    </ol>
  </li>
  <li><a href="#control-de-calidad-b√°sico" id="markdown-toc-control-de-calidad-b√°sico">Control de calidad b√°sico</a>    <ol>
      <li><a href="#generar-una-matriz-sin-procesamiento-en-un-formato-utilizable" id="markdown-toc-generar-una-matriz-sin-procesamiento-en-un-formato-utilizable">Generar una matriz sin procesamiento en un formato utilizable</a></li>
      <li><a href="#a√±adir-metadatos-de-genes" id="markdown-toc-a√±adir-metadatos-de-genes">A√±adir metadatos de genes</a></li>
    </ol>
  </li>
  <li><a href="#emptydrops" id="markdown-toc-emptydrops">emptyDrops</a></li>
  <li><a href="#combinar-archivos-fastq" id="markdown-toc-combinar-archivos-fastq">Combinar archivos FASTQ</a>    <ol>
      <li><a href="#datos" id="markdown-toc-datos">Datos</a></li>
      <li><a href="#concatenaci√≥n-de-objetos" id="markdown-toc-concatenaci√≥n-de-objetos">Concatenaci√≥n de objetos</a></li>
    </ol>
  </li>
  <li><a href="#a√±adir-el-lote-de-metadatos-batch-metadata" id="markdown-toc-a√±adir-el-lote-de-metadatos-batch-metadata">A√±adir el lote de metadatos (batch metadata)</a></li>
  <li><a href="#lecturas-mitocondriales" id="markdown-toc-lecturas-mitocondriales">Lecturas mitocondriales</a></li>
  <li><a href="#extraer-datos-de-secuenciaci√≥n-de-arn-de-c√©lulas-√∫nicas-desde-bases-de-datos-p√∫blicas" id="markdown-toc-extraer-datos-de-secuenciaci√≥n-de-arn-de-c√©lulas-√∫nicas-desde-bases-de-datos-p√∫blicas">Extraer datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas desde bases de datos p√∫blicas</a></li>
</ol>

</blockquote>

<h1 id="generar-una-matriz">Generar una matriz</h1>

<p>En esta secci√≥n te mostraremos los principios de la fase inicial del an√°lisis de Secuenciaci√≥n de ARN de c√©lulas √∫nicas, que se basa en generar mediciones de expresi√≥n en una matriz. Por simplicidad, nos referiremos a este an√°lisis por sus siglas en ingl√©s sc<span class="notranslate">RNA</span>-Seq (<span class="notranslate">single-cell</span> <span class="notranslate">RNA</span>-Seq). Nos concentramos en la metodolog√≠a basada en goteo (en lugar de las metodolog√≠as basadas en placas), ya que es el proceso con m√°s diferencias con respecto a los enfoques convencionales desarrollados para secuenciaci√≥n de ARN general.</p>

<p>Los datos provenientes de metodolog√≠as de goteo est√°n constituidos por tres componentes: c√≥digos de barras, identificadores √∫nicos moleculares (Unique molecular Identifier, o UMIs por sus siglas en ingl√©s) y lecturas de ADN codificante (proveniente de ADN complementario o c<span class="notranslate">DNA</span>). Para poder generar cuantificaciones a nivel celula necesitaremos:</p>

<ul>
  <li>Procesar los c√≥digos de barras, identificar cu√°les corresponden a c√©lulas ‚Äòreales‚Äô, cu√°les son meros artefactos, y posiblemente corregir c√≥digos de barras que pudiesen ser producto de errores de secuenciaci√≥n por medio de comparaciones con secuencias de mayor frecuencia.</li>
  <li>Mapear secuencias biol√≥gicas a su genoma o transcriptoma de referencia.</li>
  <li>Eliminar duplicados usando UMIs.</li>
</ul>

<p>Este sol√≠a ser un proceso complejo que involucraba m√∫ltiples algoritmos, o que se realizaba con m√©todos dedicados a tecnolog√≠as espec√≠ficas (como la herramienta ‚ÄòCellranger‚Äô para 10X); pero ahora el proceso es m√°s simple gracias al surgimiento de otros m√©todos. En el momento de seleccionar una metodolog√≠a para tu proyecto podr√≠as considerar las siguientes herramientas:</p>

<ul>
  <li><a href="https://github.com/alexdobin/STAR">STARsolo</a> - una variante del popular m√©todo de alineamiento de genoma ‚ÄòSTAR‚Äô que es espec√≠fica para el an√°lisis de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas basados en t√©cnicas de goteos (dsc<span class="notranslate">RNA</span>-Seq). Produce resultados muy cercanos a los de Cellranger (que a su vez utiliza STAR en parte de sus procesos).</li>
  <li><a href="https://www.kallistobus.tools/">Kallisto/ bustools</a> - desarrollado por los creadores del m√©todo de cuantificaci√≥n de transcriptoma, Kallisto.</li>
  <li><a href="https://salmon.readthedocs.io/en/latest/alevin.html">Alevin</a> - otro m√©todo de an√°lisis de transcriptoma desarrollado por los autores de la herramienta ‚ÄòSalmon‚Äô.</li>
</ul>

<p>Utilizaremos Alevin <span class="citation"><a href="#article-Alevin">Srivastava <i>et al.</i> 2019</a></span> con prop√≥sitos demostrativos, sin embargo no avalamos ning√∫n m√©todo en particular.</p>

<blockquote class="comment">
  <h3 id="comment-comentario"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Comentario</h3>
  <ul>
    <li>Notas sobre la traducci√≥n y uso de t√©rminos t√©cnicos
En este tutorial manejaremos algunos t√©rminos en el idioma original ya que simplificar√° la b√∫squeda posterior de informaci√≥n sobre el tema. Estas notas aparecer√°n en este tipo de recuadros y los t√©rminos estar√°n listados con la vi√±eta ‚Äú‚Ä¢‚Äù.</li>
    <li>sc<span class="notranslate">RNA</span>-Seq,	secuenciaci√≥n de ARN de c√©lulas √∫nicas</li>
    <li>dsc<span class="notranslate">RNA</span>-Sea, secuenciaci√≥n de ARN de c√©lulas √∫nicas</li>
    <li>basados en t√©cnicas de goteos</li>
    <li><span class="notranslate">RNA</span>-Seq,	Secuenciaci√≥n de ARN</li>
    <li>UMIs,		Identificadores √∫nicos moleculares</li>
  </ul>
</blockquote>

<h2 id="obtener-datos">Obtener datos</h2>

<p>Hemos puesto a tu disposici√≥n un conjunto de datos de muestra para que practiques con ellos. Estos datos son un subconjunto de lecturas de datos provenientes de ratones con restricci√≥n de crecimiento fetal <span class="citation"><a href="#Bacon2018">Bacon <i>et al.</i> 2018</a></span> (ver <a href="https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/results/tsne">aqu√≠</a> el estudio de c√©lulas √∫nicas disponible en la base de datos ‚Äò<span class="notranslate">Expression</span> Atlas‚Äô y <a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6945/">aqu√≠</a> la remisi√≥n del proyecto a la plataforma ArrayExpress).</p>

<p>Utilizamos la tecnolog√≠a Drop-seq para este estudio. Sin embargo, el an√°lisis que abordaremos en este tutorial es casi id√©ntico al que se realiza al utilizar la tecnolog√≠a 10x. Estos datos no han sido curados meticulosamente, los datos del tutorial son algo ca√≥ticos ya que provienen de un experimento real. Necesitan filtrado urgentemente ya que contienen ARNs que le agregan ruido de fondo, sin embargo, te dar√°n la oportunidad de practicar un an√°lisis como si fuera el tuyo propio.</p>

<p>Puedes descargar las lecturas de muestra y su anotaci√≥n asociada desde el repositorio Zenodo. Tambi√©n puedes importar <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/input---pre-processing-with-alevin">este historial de ejemplo</a>. ¬øC√≥mo bajamos la resoluci√≥n de estos archivos FASTQ? ¬°Descubre aqu√≠ <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-1---how-to-downsample">la historia</a> de c√≥mo se llev√≥ esto a cabo!
Adicionalmente, necesitar√°s un transcriptoma (en formato FASTA) contra el cual podr√°s mapear tus lecturas, as√≠ como la informaci√≥n g√©nica de cada transcrito (en un archivo tipo GTF). Adicionalmente, estos archivos est√°n disponibles en el historial anteriormente mencionado, al igual que en los enlaces de Zenodo mostrados en la parte inferior de este p√°rrafo, as√≠ que puede que tarden un buen rato en importarse. Puedes acceder a <a href="https://www.ensembl.org/info/data/ftp/index.html">Ensembl si deseas bajar datos</a> para tu especie de inter√©s.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-cargar-datos---parte-1"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Cargar datos - Parte 1</h3>

  <ol>
    <li>Crear un historial nuevo para este tutorial</li>
    <li>
      <p>Importar la tabla de dise√±o experimental, las lecturas de secuenciaci√≥n 1 y 2, y los archivos GTF y fasta desde <a href="https://zenodo.org/record/4574153">Zenodo</a></p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/4574153/files/Experimental_Design.tabular
https://zenodo.org/record/4574153/files/Mus_musculus.GRCm38.100.gtf.gff
https://zenodo.org/record/4574153/files/Mus_musculus.GRCm38.c<span class="notranslate">dna</span>.all.fa.fasta
https://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k.fastq
https://zenodo.org/record/4574153/files/SLX-7632.TAAGGCGA.N701.s_1.r_2.fq-400k.fastq
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-consejo-importaci√≥n-por-medio-de-enlaces"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Consejo: Importaci√≥n por medio de enlaces</h3>  <ul>  <li>Copia los enlaces</li>  <li>    <p>Abre el manejador de carga de datos de <span class="notranslate">Galaxy</span> (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> en la parte superior derecha del panel de herramientas)</p>  </li>  <li>Selecciona ‚ÄòPegar/Traer datos‚Äô <strong>Paste/Fetch Data</strong></li>  <li>    <p>Copia los enlaces en el campo de textos</p>  </li>  <li>    <p>Presiona ‚ÄòIniciar‚Äô <strong>Start</strong></p>  </li>  <li>    <p><strong>Close</strong> Cierra la ventana.</p>  </li>  <li><span class="notranslate">Galaxy</span> utiliza los URLs como nombres de forma predeterminada , as√≠ que los tendr√°s que cambiar a algunos que sean m√°s √∫tiles o informativos.the window</li></ul></blockquote>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de los conjuntos de datos</li>
  </ol>

</blockquote>

<blockquote class="question">
  <h3 id="question-preguntas"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Preguntas</h3>

  <p>Dale un vistazo a los archivos que ahora est√°n en tu historial.</p>
  <ol>
    <li>¬øCu√°l de los archivos FASTQ crees que contiene las secuencias de los c√≥digos de barras?</li>
    <li>Dada la metodolog√≠a qu√≠mica que implica este estudio, ¬øtienen las lecturas de c√≥digos de barras/UMIs la longitud correcta?</li>
    <li>¬øA que se refiere el t√©rmino ‚ÄòN701‚Äô?</li>
  </ol>

  <blockquote class="solution">
    <h3 id="solution-soluciones"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluciones</h3>

    <ol>
      <li>La lectura 1 (SLX-7632.TAAGGCGA.N701.s_1.r_1.fq-400k)  contiene el c√≥digo de barras de la c√©lula y el UMI ya que es significativamente m√°s corta (¬°solo 20pb!), en comparaci√≥n con r_2 que es la lectura m√°s larga de transcrito. Cambiaremos de nombre a estos archivos y los llamaremos N701-Read1 y N701-Read2 para hacer m√°s claro el an√°lisis.</li>
      <li>Puedes ver que la lectura 1 solo tiene 20pb de longitud, ya que el c√≥digo de barras de Drop-Seq es de 12pb de longitud y el UMI de 8pb. ¬°Esto es correcto! Pero ten precauci√≥n, la tecnolog√≠a 10x Chromiun (y muchas otras) cambian sus reactivos (y longitudes de cebadores y adaptadores) con el paso del tiempo. En particular, ten esto en cuenta cuando accedas a datos p√∫blicos, verifica y asegurate de que est√©s utilizando los n√∫meros correctos.</li>
      <li>El t√©rmino ‚ÄòN701‚Äô se refiere al √≠ndice de la lectura. Esta muestra se tom√≥ junto con otras seis, cada una de ellas se denot√≥ con un √≠ndice Nextera (N70X). Posteriormente, esto te proporcionar√° informaci√≥n del lote del que provienen. Observa el archivo ‚ÄòDiseno experimental‚Äô (‚ÄòExperimental design‚Äô), notar√°s que la muestra N701 proviene del timo de neonato macho tipo normal (‚Äòwild-type‚Äô).</li>
    </ol>
  </blockquote>
</blockquote>

<h2 id="generar-un-mapa-de-correspondencia-de-transcritos-a-genes">Generar un mapa de correspondencia de transcritos a genes</h2>

<p>En el an√°lisis de Secuenciaci√≥n de ARN de c√©lulas √∫nicas tomamos por defecto la cuantificaci√≥n a nivel g√©nico, en lugar de a nivel transcrito. Esto significa que los niveles de expresi√≥n de una mol√©cula de ARN con splicing alte<span class="notranslate">rna</span>tivo son combinados con el prop√≥sito de generar valores a nivel g√©nico. Las t√©cnicas de sc<span class="notranslate">RNA</span>-Seq basadas en goteo solo muestrean un extremo de cada transcrito, por tanto carecen de cobertura completa de mol√©culas, la cual es requerida para poder cuantificar con exactitud las diversas isoformas de los transcritos.</p>

<p>Para poder generar las cuantificaciones a nivel g√©nico con base en la cuantificaci√≥n de transcriptoma, la herramienta Alevin y otras similares requieren de la conversi√≥n entre identificadores de transcritos e identificadores de genes. Podemos derivar una conversi√≥n transcritos-genes a partir de anotaciones g√©nicas disponibles en plataformas de recursos gen√≥micos como Ensembl. Los transcritos en este tipo de listas necesitan coincidir con los que usaremos posteriormente para construir un √≠ndice binario de transcriptoma. Si est√°s utilizando controles tipo ‚Äòspike-in‚Äô necesitar√°s a√±adirlos al transcriptoma y al mapeo de transcritos a genes.</p>

<p>Notar√°s en tus datos de ejemplo que la anotaci√≥n de referencia murina se obtuvo en formato GTF desde Ensembl. Esta anotaci√≥n contiene genes, exones, transcritos y todo tipo de informaci√≥n adicional de las secuencias. Utilizaremos esta informaci√≥n para generar el mapeo de correspondencia transcrito/genes. Esto lo haremos por medio del traspaso de informaci√≥n a una herramienta que extrae exclusivamente los identificadores de transcrito que necesitamos.</p>

<blockquote class="comment">
  <h3 id="comment-comentario-1"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Comentario</h3>
  <p>Nota sobre la traducci√≥n y uso de t√©rminos t√©cnicos</p>
  <ul>
    <li>Spike-in,	transcrito de ARN de cantidad y secuencia conocida utilizado para calibrar mediciones en ensayos de hibridaci√≥n de ARN. Nos referiremos a este control con su nombre en el idioma ingl√©s ya que su traducci√≥n no es utilizada com√∫nmente.</li>
  </ul>
</blockquote>

<blockquote class="question">
  <h3 id="question-preguntas-1"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Preguntas</h3>

  <p>¬øCu√°l de los ‚Äòatributos‚Äô en la √∫ltima columna de los archivos GTF contiene los identificadores de transcrito y de gen?</p>

  <blockquote class="tip">
    <h3 id="tip-una-peque√±a-pista"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Una peque√±a pista</h3>

    <p>El archivo est√° organizado de tal modo que la √∫ltima columna (con el nombre ‚ÄòGroup‚Äô en el encabezado) contiene una gran cantidad de informaci√≥n: attribute1 ‚Äúinformaci√≥n asociada con el atributo1‚Äù;attribute2 ‚Äúinformaci√≥n asociada con el atributo 2‚Äù etc.</p>
  </blockquote>

  <blockquote class="solution">
    <h3 id="solution-soluci√≥n"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n</h3>
    <p>A gene_id y transcript_id les sigue ‚Äúensembl gene_id‚Äù y ‚Äúensembl transcript_id‚Äù</p>
  </blockquote>
</blockquote>

<p>Ahora es el momento de analizar el archivo GTF utilizando el paquete de R <a href="https://bioconductor.org/packages/release/bioc/html/rtracklayer.html">rtracklayer</a>. Este an√°lisis proporcionar√° una tabla de conversi√≥n con un listado de identificadores de transcritos y sus genes correspondientes para hacer conteos. Adicionalmente, ya que generaremos nuestro propio √≠ndice binario (m√°s sobre esto en secciones posteriores), tambi√©n necesitaremos proporcionar nuestro archivo FASTA para que pueda ser filtrado y que al final solo contenga la informaci√≥n del transcriptoma que est√° contenida en el archivo GTF.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-generar-un-archivo-fasta-filtrado-y-un-mapa-de-correspondencia-de-transcritos-a-genes"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Generar un archivo FASTA filtrado y un mapa de correspondencia de transcritos a genes</h3>

  <ol>
    <li>Ejecutar la herramienta GTF2GeneList <span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+galaxy6" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+galaxy6"><strong>GTF2GeneList</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+<span class="notranslate">galaxy</span>6</span></span>  utilizando los siguiente par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúEnsembl GTF file‚Äù</em>: <code class="language-plaintext highlighter-rouge">GTF file in the history</code> <i class="fas fa-columns" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-history</span></li>
        <li><em>‚ÄúFeature type for which to derive annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">transcript</code> (Tus secuencias provienen de secuenciaci√≥n de transcriptoma, por tanto este es tu punto inicial)</li>
        <li><em>‚ÄúField to place first in output table‚Äù</em>: <code class="language-plaintext highlighter-rouge">transcript_id</code> (Esto da acceso a la columna que identificaste en la parte anterior)</li>
        <li><em>‚ÄúSuppress header line in output?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code> (La siguiente herramienta (Alevin) no toma encabezados)</li>
        <li><em>‚ÄúComma-separated list of field names to extract from the GTF (default: use all fields)‚Äù</em>: <code class="language-plaintext highlighter-rouge">transcript_id,gene_id</code> (Esto hace que la primera columna sea transpript_id, y la segunda sea gene_id. Por tanto, tu clave puede convertir transcritos a genes)</li>
        <li><em>‚ÄúAppend version to transcript identifiers?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code> (Por lo general el archivo FASTA de Ensembl contiene esta informaci√≥n, y ya que necesitaremos que el transcriptoma en formato FASTA y la informaci√≥n de genes del archivo GTF trabajen en conjunto, necesitaremos a√±adir la informaci√≥n de uno al final del otro)</li>
        <li><em>‚ÄúFlag mitochondrial features?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><em>‚ÄúFilter a FASTA-format c<span class="notranslate">DNA</span> file to match annotations?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFASTA-format c<span class="notranslate">DNA</span>/transcript file‚Äù</em>: <code class="language-plaintext highlighter-rouge">FASTA file in your history</code> <i class="fas fa-columns" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-history</span></li>
        <li><em>‚ÄúAnnotation field to match with sequences‚Äù</em>: <code class="language-plaintext highlighter-rouge">transcript_id</code></li>
      </ul>
    </li>
    <li>
      <p>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la tabla de anotaci√≥n a <code class="language-plaintext highlighter-rouge">Map</code></p>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> del archivo FASTA filtrado - no comprimido a <code class="language-plaintext highlighter-rouge">Filtered FASTA</code></li>
  </ol>
</blockquote>

<h2 id="generar-el-√≠ndice-de-un-transcriptoma-y-cuantificar">Generar el √≠ndice de un transcriptoma y cuantificar</h2>

<p>Alevin reduce a un solo proceso los pasos requeridos para realizar dsc<span class="notranslate">RNA</span>-Seq. Dichas herramientas requieren comparar las secuencias de tu muestra a una referencia que contenga todas las secuencias probables de transcritos (un ‚Äòtranscriptoma). Esto contendr√° las secuencias biol√≥gicas de los transcritos conocidos en una especie determinada, y quiz√°s tambi√©n contendr√° secuencias t√©cnicas como ‚Äòspike ins‚Äô.</p>

<blockquote class="details">
  <h3 id="details-c√≥mo-trabaja-alevin"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> ¬øC√≥mo trabaja Alevin?</h3>

  <p>Alevin necesita convertir las secuencias de texto contenidas dentro del formato FASTA a algo con lo que pueda realizar b√∫squedas r√°pidamente dentro del transcriptoma, ese ‚Äòalgo‚Äô es un archivo llamado ‚Äò√≠ndice‚Äô (‚Äòindex‚Äô). El √≠ndice es un archivo binario (un tipo de archivos optimizados para el uso de ordenadores y que no es legible ‚Äòpor humanos‚Äô), pero permite que Alevin realice b√∫squedas r√°pidas. El √≠ndice puede variar entre experimentos debido al tipo de secuencias t√©cnicas y biol√≥gicas que necesitamos incluir en √©l, y ya que frecuentemente queremos utilizar las referencias m√°s actualizadas, ya sea que provengan de Ensembl o NCBI, a menudo pudi√©semos terminar reconstruyendo los √≠ndices. El generar estos √≠ndices requiere mucho tiempo. √âchale un vistazo al archivo FASTA no comprimido para que veas c√≥mo es la estructura inicial.</p>

</blockquote>

<p>Ahora tenemos:</p>

<ul>
  <li>Lecturas de c√≥digos de barras/UMIs</li>
  <li>Lecturas de c<span class="notranslate">DNA</span></li>
  <li>Mapeo de correspondencias de transcritos a genes</li>
  <li>Archivo FASTA filtrado</li>
</ul>

<p>Ahora podemos ejecutar Alevin. Esta herramienta no aparecer√° en las b√∫squedas dentro de algunas de las instancias p√∫blicas. Si esto sucede, haz click sobre la pesta√±a <span class="notranslate">Single Cell</span> en la parte izquierda de la pantalla y despl√°zate hacia abajo hasta encontrar la herramienta Alevin. Consejo: Si haces click sobre las herramientas (tools) dentro de la opci√≥n ‚Äòtutorial‚Äô de <span class="notranslate">Galaxy</span> siempre tendr√°s la versi√≥n correcta de la herramienta. En este caso: <span class="notranslate">Galaxy</span> Version 1.3.0+<span class="notranslate">galaxy</span>2 - debe ser la versi√≥n por defecto; si no lo es, haz click sobre ‚ÄòVersiones‚Äô (‚ÄòVersions‚Äô) y escoge dicha versi√≥n.</p>

<figure id="figure-1"><img src="../../images/wab-tutorial-in-galaxy.png" alt="Tutorial option in Galaxy. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 1:</span> La opci√≥n de tutorial est√° situada en la parte superior derecha de <span class="notranslate">Galaxy</span></figcaption></figure>

<figure id="figure-2"><img src="../../images/wab-tutorial-option-filler.png" alt="Accessing tools in the tutorial option within Galaxy. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 2:</span> Haz click sobre la herramienta en el tutorial de <span class="notranslate">Galaxy</span></figcaption></figure>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-practica-ejecutando-alevin"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Practica: Ejecutando Alevin</h3>

  <ol>
    <li>
      <p><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+galaxy2"><strong>Alevin</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+<span class="notranslate">galaxy</span>2</span></span></p>

      <blockquote class="question">
        <h3 id="question-preguntas-2"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Preguntas</h3>

        <p>Intenta dar valores a los par√°metros de Alevin utilizando lo que sabes por el momento.</p>

        <blockquote class="tip">
          <h3 id="tip-tip-sobre-la-direccionalidad-de-las-cadenas-de-rna-strandness"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Tip: Sobre la direccionalidad de las cadenas de <span class="notranslate">RNA</span> (Strandness)</h3>

          <p>La documentaci√≥n sobre ‚ÄòTipos de bibliotecas de fragmentos‚Äô (‚ÄòFragment Library Types‚Äò) de de la herramienta salm√≥n, el ejecutar el comando de Alevin (<a href="https://salmon.readthedocs.io/en/latest/library_type.html]">salmon.readthedocs.io/en/latest/library_type.html</a> y <a href="https://salmon.readthedocs.io/en/latest/alevin.html">salmon.readthedocs.io/en/latest/alevin.html</a>) nos ser√°n de ayuda en este caso; aunque ten en cuenta que la imagen ah√≠ se dibuja con el ARN 5‚Äô en la parte superior, mientras que en este protocolo de sc<span class="notranslate">RNA</span>-Seq el segmento polyA es capturado por su extremo 3‚Äô, y, por lo tanto, efectivamente la hebra inferior o inversa.)</p>
        </blockquote>

        <blockquote class="solution">
          <h3 id="solution-soluci√≥n-valores-de-los-par√°metros"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n: valores de los par√°metros</h3>
          <ul>
            <li><em>‚ÄúSelect a reference transcriptome from your history or use a built-in index?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Use one from the history</code>
              <ul>
                <li>Vas a generar el √≠ndice binario utilizando tu archivo FASTA filtrado</li>
              </ul>
            </li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTranscripts FASTA file‚Äù</em>: <code class="language-plaintext highlighter-rouge">Filtered FASTA</code></li>
            <li><em>‚ÄúSingle or paired-end <span class="notranslate">reads</span>?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Paired-end</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúfile1‚Äù</em>: <code class="language-plaintext highlighter-rouge">N701-Read1</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúfile2‚Äù</em>: <code class="language-plaintext highlighter-rouge">N701-Read2</code></li>
            <li><em>‚ÄúRelative orientation of <span class="notranslate">reads</span> within a pair‚Äù</em>: <code class="language-plaintext highlighter-rouge">Mates are oriented towards each other (IR)</code></li>
            <li><em>‚ÄúSpecify the strandedness of the <span class="notranslate">reads</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">read comes from the reverse strand (SR)</code></li>
            <li><em>‚ÄúProtocol‚Äù</em>: <code class="language-plaintext highlighter-rouge">DropSeq <span class="notranslate">Single Cell</span> protocol</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTranscript to gene map file‚Äù</em>: <code class="language-plaintext highlighter-rouge">Map</code></li>
            <li><em>‚ÄúRetrieve all output files‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
            <li>In <em>‚ÄúOptional commands‚Äù</em>:
              <ul>
                <li><em>‚ÄúdumpFeatures‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
                <li><em>‚ÄúdumpMTX‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
              </ul>
            </li>
          </ul>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<blockquote class="comment">
  <h3 id="comment-comentario-2"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Comentario</h3>
  <p>Notas sobre la traducci√≥n de algunos de los valores de los par√°metros:
En este tutorial manejaremos algunos t√©rminos en el idioma original ya que simplificar√° la b√∫squeda posterior de informaci√≥n sobre el tema. Estas notas aparecer√°n en estos recuadros y los t√©rminos estar√°n listados con la vi√±eta ‚Äú‚Ä¢‚Äù.</p>
  <ul>
    <li>‚ÄúSelect a reference transcriptome from your history or use a built-in index?‚Äù: Use one from the history</li>
    <li>
      <ul>
        <li>‚Äú¬øSeleccionar un transcriptoma de referencia desde tu historial o utilizar un √≠ndice pre-integrado?‚Äù: <code class="language-plaintext highlighter-rouge">Utilizar uno del historial</code></li>
      </ul>
    </li>
    <li>‚ÄúTranscripts FASTA file‚Äù: <code class="language-plaintext highlighter-rouge">Filtered FASTA</code></li>
    <li>
      <ul>
        <li>‚ÄúArchivo FASTA de transcritos‚Äù: <code class="language-plaintext highlighter-rouge">FASTA filtrado</code></li>
      </ul>
    </li>
    <li>‚ÄúSingle or paired-end <span class="notranslate">reads</span>?‚Äù: <code class="language-plaintext highlighter-rouge">Paired-end</code></li>
    <li>
      <ul>
        <li>‚Äú¬øLecturas single-end o paired-end?‚Äù: <code class="language-plaintext highlighter-rouge">Paired-end</code></li>
      </ul>
    </li>
    <li>‚ÄúRelative orientation of <span class="notranslate">reads</span> within a pair‚Äù: <code class="language-plaintext highlighter-rouge">Mates are oriented towards each other (IR)</code>`</li>
    <li>
      <ul>
        <li>‚ÄúOrientaci√≥n relativa de las lecturas dentro de un par‚Äù: <code class="language-plaintext highlighter-rouge">Las lecturas pares est√°n orientadas unas hacia las otras (IR)</code>`</li>
      </ul>
    </li>
    <li>‚ÄúSpecify the strandedness of the <span class="notranslate">reads</span>‚Äù: <code class="language-plaintext highlighter-rouge">read comes from the reverse strand (SR)</code>`</li>
    <li>
      <ul>
        <li>‚ÄúEspecificar la direccionalidad de las lecturas‚Äù: <code class="language-plaintext highlighter-rouge">las lecturas provienen de las cadenas inversas (SR)</code>`</li>
      </ul>
    </li>
    <li>‚ÄúRetrieve all output files‚Äù: <code class="language-plaintext highlighter-rouge">Yes</code></li>
    <li>
      <ul>
        <li>‚ÄúRecobrar todos los archivos de salida‚Äù: <code class="language-plaintext highlighter-rouge">S√≠</code>`</li>
      </ul>
    </li>
  </ul>
</blockquote>

<blockquote class="comment">
  <h3 id="comment-qu√©-sucede-si-estoy-procesando-una-muestra-10x"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> ¬øQu√© sucede si estoy procesando una muestra 10x??</h3>

  <p>En Alevin, ‚ÄúProtocol‚Äù (Protocolo) es el par√°metro principal que debe cambiarse para una muestra 10X Chromium. Simplemente selecciona los reactivos correspondientes a la qu√≠mica de 10x en lugar de Drop-seq.</p>
</blockquote>

<p>Esta herramienta tomar√° algo de tiempo para ejecutarse. Alevin produce muchos archivos de salida, no utilizaremos todos estos archivos. Puedes consultar la <a href="https://salmon.readthedocs.io/en/latest/alevin.html">documentaci√≥n de Alevin</a> si deseas saber m√°s sobre estos archivos, sin embargo, los archivos que m√°s nos interesan son:</p>

<ul>
  <li>La matriz generada (quants_mat.mtx.gz - el conteo de genes y c√©lulas)</li>
  <li>Los identificadores de fila <code class="language-plaintext highlighter-rouge">cell/ barcode</code> (quants_mat_rows.txt), y</li>
  <li>Las etiquetas en la columna <code class="language-plaintext highlighter-rouge">gene</code> (quants_mat_cols.txt).</li>
</ul>

<p>Este es el formato ‚Äúmatrix market‚Äù (MTX).</p>

<blockquote class="question">
  <h3 id="question-preguntas-3"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Preguntas</h3>

  <p>Echa un vistazo a los diversos archivos generados despu√©s de ejecutar Alevin. ¬øPuedes localizar las siguientes dos cosas?‚Ä¶</p>
  <ol>
    <li>¬øCu√°l es la tasa de mapeo?</li>
    <li>¬øCu√°ntas c√©lulas est√°n presentes en la matriz de salida?</li>
  </ol>

  <blockquote class="solution">
    <h3 id="solution-soluci√≥n-1"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n</h3>

    <ol>
      <li>Inspecciona <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> el archivo <i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> meta_info.json. Puedes ver que la tasa de mapeo es un insignificante <code class="language-plaintext highlighter-rouge">24.75%</code>. Esta tasa es terrible. ¬øPor qu√© sucede esto? Recuerda que este archivo fue submuestreado, siendo espec√≠ficos, solo tomamos las √∫ltimas 400,000 lecturas del archivo FASTQ. La tasa general de mapeo del archivo es de alrededor del 50%, que sigue siendo una tasa muy baja, pero en general se pueden esperar tasas de mapeos ligeramente menores para muestras que fueron procesadas durante los inicios de las t√©cnicas Drop-Seq y la secuenciaci√≥n de ARN de c√©lulas √∫nicas. Actualmente las muestras procesadas con la t√©cnica 10x son mucho mejores. Despu√©s de todo, los datos que estamos utilizando son reales, no son datos de prueba.</li>
      <li>Inspecciona <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> el archivo <i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> ‚Äòquants_mat_rows.txt‚Äô, y podr√°s ver que contiene <code class="language-plaintext highlighter-rouge">2163</code> l√≠neas. Las filas hacen referencia a las c√©lulas en la matriz de correspondencia de c√©lulas a genes. Seg√∫n esta estimaci√≥n (aproximada), tu muestra contiene 2163 c√©lulas.</li>
    </ol>

  </blockquote>

</blockquote>

<blockquote class="warning">
  <h3 id="warning-precaucion-de-aqu√≠-en-adelante-selecciona-la-entrada-apropiada"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i><span class="visually-hidden">warning</span> ¬°Precaucion!: De aqu√≠ en adelante selecciona la entrada apropiada.</h3>
  <p>Asegurate de usar el archivo <strong>quants_mat.mtx.gz</strong>, NO EL ARCHIVO <em>quants_tier.mtx.gz</em>.</p>
</blockquote>

<p><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Felicidades - ¬°has generado una matriz de expresi√≥n! Podr√≠amos terminar en este punto, pero es necesario verificar la calidad de los datos, y una de las cosas que podemos hacer es visualizar un gr√°fico de rangos de los c√≥digos de barras.</p>

<h1 id="control-de-calidad-b√°sico">Control de calidad b√°sico</h1>

<p>La pregunta que buscamos contestar aqu√≠ es: ‚ÄúEn su mayor√≠a, ¬øtenemos una sola c√©lula por gota?‚Äù. Este es el principal objetivo, pero no es del todo sencillo obtener exactamente una sola c√©lula por cada gota. En algunas ocasiones casi ninguna c√©lula logra depositarse en las gotas, en otras ocasiones tenemos demasiadas c√©lulas por gota. Cuando menos deber√≠amos poder distinguir f√°cilmente las gotas que contienen c√©lulas de las que no las contienen.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-generar-un-gr√°fico-inicial-de-control-de-calidad-qc"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Generar un gr√°fico inicial de control de calidad (QC)</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2"><strong>Droplet barcode rank plot</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+<span class="notranslate">galaxy</span>2</span></span>  Gr√°fico de rangos de c√≥digos de barras obtenido por t√©cnicas de goteo (Droplet barcode rank plot) con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúInput MTX-format matrix?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúA two-column tab-delimited file, with barcodes in the first column and frequencies in the second‚Äù</em>: <code class="language-plaintext highlighter-rouge">raw_cb_frequencies.txt</code></li>
        <li><em>‚ÄúLabel to place in plot title‚Äù</em>: <code class="language-plaintext highlighter-rouge">Barcode rank plot (raw barcode frequencies)</code></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> a la imagen de salida <code class="language-plaintext highlighter-rouge">Barcode Plot - raw barcode frequencies</code></li>
  </ol>
</blockquote>

<figure id="figure-3"><img src="../../images/wab-raw_barcodes-400k.png" alt="raw droplet barcode plots-400k. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 3:</span> Subconjunto de datos crudos, 400k cadenas</figcaption></figure>

<p>La imagen aqu√≠ generada (4000k) no es muy informativa - pero ten en cuenta que tan solo est√°s manejando una fracci√≥n de las lecturas. Si procesas la muestra completa (que involucra los mismos pasos mencionados en la parte superior, pero que tardar√≠a mucho m√°s tiempo) obtendr√°s la imagen siguiente.</p>

<figure id="figure-4"><img src="../../images/wab-raw_barcodes-total.png" alt="raw droplet barcode plots-total. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 4:</span> Muestra completa - 32,579,453 lecturas - datos crudos</figcaption></figure>

<p>Esta es la formulaci√≥n del gr√°fico de c√≥digo de barras que basamos en una <a href="https://github.com/COMBINE-lab/salmon/issues/362#issuecomment-490160480">discusi√≥n</a> que entablamos con miembros de la comunidad cient√≠fica. Los gr√°ficos de l√≠neas suaves de la izquierda son los principales; estos gr√°ficos muestran, clasificados de los m√°s bajos a los m√°s altos, los conteos de UMIs para c√≥digos de barras individuales. Esperamos una fuerte ca√≠da entre las gotas que contienen c√©lulas y las gotas vac√≠as o que solo contienen restos celulares. Este no es un conjunto de datos ideal, as√≠ que en perspectiva, en un mundo ideal un conjunto de datos muy limpio proveniente de procesados 10x, los datos se asemejar√≠an un poco m√°s a la siguiente imagen del atlas de pulm√≥n (ver <a href="https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6653/results/tsne">aqu√≠</a> el estudio del Atlas de Expresi√≥n de C√©lulas √önicas y la remisi√≥n del proyecto <a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-6653/">aqu√≠</a>).</p>

<figure id="figure-5"><img src="../../images/wab-lung-atlas-barcodes-raw.png" alt="raw droplet barcode plots - lung atlas. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 5:</span> Datos ‚Äòbonitos‚Äô - crudos</figcaption></figure>

<p>En este gr√°fico puedes ver m√°s claramente una flexi√≥n tipo ‚Äúrodilla‚Äù, mostrando el corte entre las gotas vac√≠as y las gotas que contienen c√©lulas.</p>

<p>A la derecha encontramos los gr√°ficos de densidad de la primera, y los umbrales generados ya sea utilizando <a href="https://bioconductor.org/packages/release/bioc/html/DropletUtils.html">dropletUtils</a> o por medio del m√©todo descrito en la discusi√≥n que se mencion√≥ con anterioridad (en la parte superior). Podremos utilizar cualquiera de estos umbrales para seleccionar c√©lulas, asumiendo que cualquier medici√≥n con conteos menores es una c√©lula v√°lida. Alevin hace algo similar por defecto, y podemos aprender algo de esto graficando √∫nicamente los c√≥digos de barras que retiene Alevin.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-obtener-el-gr√°fico-de-c√≥digo-de-barras-de-alevin"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Obtener el gr√°fico de c√≥digo de barras de Alevin</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+galaxy2"><strong>Droplet barcode rank plot</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/droplet_barcode_plot/_dropletBarcodePlot/1.6.1+<span class="notranslate">galaxy</span>2</span></span>  Genera el gr√°fico de c√≥digo de barras basado en goteos utilizando los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúInput MTX-format matrix?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúMatrix-market format matrix file, with cells by column (overrides ‚Äìbarcode-frequencies if supplied)‚Äù</em>: <code class="language-plaintext highlighter-rouge">quants_mat.mtx</code></li>
        <li><em>‚ÄúFor use with ‚Äìmtx-matrix: force interpretation of matrix to assume cells are by row, rather than by column (default)‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúLabel to place in plot title‚Äù</em>: <code class="language-plaintext highlighter-rouge">Barcode rank plot (Alevin-processed)</code></li>
        <li><em>‚ÄúNumber of bins used in barcode count frequency distribution‚Äù</em>: <code class="language-plaintext highlighter-rouge">50</code></li>
        <li><em>‚ÄúAbove-baseline multiplier to calculate roryk threshold‚Äù</em>: <code class="language-plaintext highlighter-rouge">1.5</code></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la imagen de salida <code class="language-plaintext highlighter-rouge">Barcode Plot - Alevin processed barcodes</code></li>
  </ol>
</blockquote>

<figure id="figure-6"><img src="../../images/wab-alevin-barcodes-400k.png" alt="raw droplet barcode plots - 400k. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 6:</span> 400k sub-muestreo - Alevin procesado</figcaption></figure>

<p>Y la muestra completa se ve como la siguiente figura:</p>

<figure id="figure-7"><img src="../../images/wab-alevin-barcodes-total.png" alt="raw droplet barcode plots - total. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 7:</span> Muestra total - 32,579,453 lecturas - Alevin procesado</figcaption></figure>

<p>Y concluyendo, he aqu√≠ el gr√°fico del atlas de pulm√≥n.</p>

<figure id="figure-8"><img src="../../images/wab-alevin-barcodes-lung.png" alt="raw droplet barcode plots - total. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 8:</span> Datos bonitos - Alevin procesado</figcaption></figure>

<p>Debes ver una ca√≠da casi vertical de la curva, que es donde Alevin trunc√≥ la distribuci√≥n (despu√©s de haber excluido muchos c√≥digos de barra celulares que tuvieron &lt;10 UMI, Alevin posteriormente selecciona un umbral bas√°ndose en la curva y elimina los c√≥digos de barras con menos UMIs)</p>

<p>Este m√©todo de ‚Äòdetecci√≥n intensa‚Äô funciona relativamente bien en experimentos con caracter√≠sticas relativamente sencillas. Pero algunas poblaciones presentan dificultades (¬°como en nuestra muestra!). Por ejemplo, si nos basamos √∫nicamente en los conteos de c√≥digos de barras, puede ocurrir que subpoblaciones de c√©lulas peque√±as no se puedan distinguir de las gotas vac√≠as. Algunas bibliotecas producen m√∫ltiples flexiones tipo ‚Äúrodilla‚Äù para m√∫ltiples subpoblaciones. El m√©todo <a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-019-1662-y">emptyDrops</a> se ha convertido en una forma popular de lidiar con este problema. EmptyDrops retiene los c√≥digos de barras con conteos altos, pero tambi√©n a√±ade los c√≥digos de barras que pueden ser estad√≠sticamente diferenciados de los perfiles ambientales, incluso si los conteos totales son similares. Para que podamos ejecutar emptyDrops (o cualquier herramienta de tu elecci√≥n que logre aplicar umbrales biol√≥gicamente relevantes), primero necesitamos volver a ejecutar Alevin, pero previniendo que este aplique sus propios umbrales, ya que no son los √≥ptimos.</p>

<p>Para poder utilizar emptyDrops de manera efectiva, necesitamos regresar y volver a ejecutar Alevin previniendo que aplique sus propios umbrales. Haz click sobre el icono de ‚Äòvolver a ejecutar‚Äô en cualquier salida de Alevin dentro de tu historial ya que casi todos los par√°metros son los mismos que antes, con la excepci√≥n de que necesitas cambiar los valores siguientes:</p>

<h2 id="generar-una-matriz-sin-procesamiento-en-un-formato-utilizable">Generar una matriz sin procesamiento en un formato utilizable</h2>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-prevenir-que-alevin-utilice-sus-propios-umbrales"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Prevenir que Alevin utilice sus propios umbrales</h3>
  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+galaxy2"><strong>Alevin</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/alevin/alevin/1.3.0+<span class="notranslate">galaxy</span>2</span></span>  (Haz clic sobre la √∫ltima salida de Alevin para volver a ejecutar)
      <ul>
        <li><em>‚ÄúOptional commands‚Äù</em></li>
        <li><em>‚ÄúkeepCBFraction‚Äù</em>: ‚Äò1‚Äô - por ejemplo conservarlos todos</li>
        <li><em>‚ÄúfreqThreshold‚Äù</em>: ‚Äò3‚Äô - Esto solo eliminar√° los c√≥digos de barras celulares que tengan una frecuencia menor de 3, un criterio bajo de aceptaci√≥n, pero es una forma √∫til de evitar procesar un monton de c√≥digos de barras que es casi seguro que estan vac√≠os.</li>
      </ul>
    </li>
  </ol>

  <!--SNIPPET-->
  <blockquote class="tip">  <h3 data-toc-skip="" id="-consejo-para-volver-a-ejecutar-una-herramienta"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Consejo: Para volver a ejecutar una herramienta</h3>  <ol>  <li><strong>Expande</strong> uno de los conjuntos de datos de la salida de la herramienta haciendo clic sobre √©l</li>  <li><strong>Selecciona</strong> volver a ejecutar <i class="fas fa-sync-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-refresh</span> de la herramienta</li></ol>  <p>Esto es de utilidad si quieres volver a correr la herramienta variando ligeramente los valores de los par√°metros, o si deseas verificar la configuraci√≥n de par√°metros que utilizaste.</p></blockquote>
</blockquote>

<blockquote class="question">
  <h3 id="question-pregunta"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Pregunta</h3>

  <p>¬øCu√°ntas c√©lulas hay ahora en la salida?</p>

  <blockquote class="solution">
    <h3 id="solution-soluci√≥n-2"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n</h3>

    <ol>
      <li>¬°Ahora hay <code class="language-plaintext highlighter-rouge">22539</code> c√©lulas en quants_mat_rows! Muchas m√°s que las <code class="language-plaintext highlighter-rouge">2163</code> que Alevin filtr√≥. ¬°Esto necesita ser filtrado en serio con emptyDrops!</li>
    </ol>

  </blockquote>

</blockquote>

<p>Alevin da salida a un formato MTX, el cual puede ser la entrada del paquete dropletUtils y procesarse en emptyDrops. Desafortunadamente la matriz tiene una orientaci√≥n equivocada. La matriz no puede ser procesada por herramientas cuya entrada son archivos como los que produce el software 10X. Necesitamos ‚Äòtransformar‚Äô la matriz de tal forma que las c√©lulas esten en columnas y los genes en filas.</p>

<blockquote class="warning">
  <h3 id="warning-precaucion"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i><span class="visually-hidden">warning</span> ¬°Precaucion!</h3>
  <p>¬°No mezcles los archivos de distintas ejecuciones de Alevin! Utiliza la √∫ltima ejecuci√≥n, la cual tiene los n√∫meros m√°s altos en el historial.</p>
</blockquote>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-transformaci√≥n-de-la-matriz"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Transformaci√≥n de la matriz</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/salmon_kallisto_mtx_to_10x/_salmon_kallisto_mtx_to_10x/0.0.1+galaxy5" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/salmon_kallisto_mtx_to_10x/_salmon_kallisto_mtx_to_10x/0.0.1+galaxy5"><strong>salmonKallistoMtxTo10x</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/salmon_kallisto_mtx_to_10x/_salmon_kallisto_mtx_to_10x/0.0.1+<span class="notranslate">galaxy</span>5</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äú.mtx-format matrix‚Äù</em>: <code class="language-plaintext highlighter-rouge">quants_mat.mtx.gz</code> (la salida de la herramienta <strong>Alevin</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>)</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTab-delimited genes file‚Äù</em>: <code class="language-plaintext highlighter-rouge">quants_mat_cols.txt</code> (la salida de la herramienta <strong>Alevin</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>)</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTab-delimited barcodes file‚Äù</em>: <code class="language-plaintext highlighter-rouge">quants_mat_rows.txt</code> (la salida de la herramienta <strong>Alevin</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>)</li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de ‚ÄòsalmonKallistoMtxTo10x‚Ä¶.:genes‚Äô a <code class="language-plaintext highlighter-rouge">Gene table</code></li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de ‚ÄòsalmonKallistoMtxTo10x‚Ä¶.:barcodes‚Äô a <code class="language-plaintext highlighter-rouge">Barcode table</code></li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de ‚ÄòsalmonKallistoMtxTo10x‚Ä¶.:matrix‚Äô a <code class="language-plaintext highlighter-rouge">Matrix table</code></li>
  </ol>
</blockquote>

<p>La salida es una matriz que contendr√° la orientaci√≥n correcta para poder ser utilizada por las herramientas en el an√°lisis subsecuente. Sin embargo, nuestra matriz se ve un poco dispersa, por ejemplo, haz clic en <code class="language-plaintext highlighter-rouge">Gene table</code>. No se t√∫, pero a m√≠ me costar√≠a entablar una buena discusi√≥n biol√≥gica utilizando √∫nicamente los gene_ids de Ensembl. Lo que en realidad me gustar√≠a es tener informaci√≥n m√°s ‚Äòhumanamente entendible‚Äô, como la del tipo ‚ÄòGAPDH‚Äô o con otro tipo de acr√≥nimos de genes; tambi√©n me gustar√≠a tener informaci√≥n sobre genes mitocondriales para poder evaluar si mis c√©lulas est√°n bajo alg√∫n tipo de estr√©s o no. Con el objetivo de preparar nuestros datos para meterlos a emptyDrops, vamos a combinar esta informaci√≥n y depositarla en un objeto; ahora es m√°s sencillo a√±adir dicha informaci√≥n.</p>

<h2 id="a√±adir-metadatos-de-genes">A√±adir metadatos de genes</h2>

<blockquote class="question">
  <h3 id="question-pregunta-1"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Pregunta</h3>

  <p>¬øD√≥nde podemos encontrar esta informaci√≥n sobre los genes?</p>

  <blockquote class="solution">
    <h3 id="solution-soluci√≥n-3"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n</h3>

    <p>Dentro de un archivo GTF, nuestro viejo amigo.</p>

  </blockquote>

</blockquote>

<blockquote class="question">
  <h3 id="question-pregunta-2"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Pregunta</h3>

  <p>¬øCual de los ‚Äòatributos‚Äô dentro de la √∫ltima columna del archivo contiene el acr√≥nimo de los genes?</p>

  <blockquote class="solution">
    <h3 id="solution-soluci√≥n-4"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n</h3>

    <p>gene_name</p>

  </blockquote>

</blockquote>

<p>Ahora vamos a volver a ejecutar la herramienta que extrae informaci√≥n contenida dentro de nuestro archivo GTF.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-generar-informaci√≥n-de-genes"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Generar informaci√≥n de genes</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+galaxy6" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+galaxy6"><strong>GTF2GeneList</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/gtf2gene_list/_ensembl_gtf2gene_list/1.42.1+<span class="notranslate">galaxy</span>6</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúFeature type for which to derive annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">gene</code></li>
        <li><em>‚ÄúField to place first in output table‚Äù</em>: <code class="language-plaintext highlighter-rouge">gene_id</code></li>
        <li><em>‚ÄúSuppress header line in output?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúComma-separated list of field names to extract from the GTF (default: use all fields)‚Äù</em>: <code class="language-plaintext highlighter-rouge">gene_id,gene_name,mito</code></li>
        <li><em>‚ÄúAppend version to transcript identifiers?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúFlag mitochondrial features?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code> - nota, esto va a rellenar autom√°ticamente campos con un mont√≥n de genes asociados a la mitocondria (que se encontraron en el archivo GTF). ¬°Esto es bueno!</li>
        <li><em>‚ÄúFilter a FASTA-format c<span class="notranslate">DNA</span> file to match annotations?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code> - - no lo necesitamos, ¬°hemos terminado con nuestro archivo FASTA!</li>
      </ul>
    </li>
    <li>Verifica que el archivo de salida sea del tipo <code class="language-plaintext highlighter-rouge">tabular</code>. Si no lo es, cambia el tipo de archivo haciendo click sobre ‚ÄòEditar atributos‚Äô<i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> que est√° en el historial del conjunto de datos (como si estuvieras cambiando el nombre al archivo). Despu√©s haz click sobre <code class="language-plaintext highlighter-rouge">Datatypes</code> y teclea <code class="language-plaintext highlighter-rouge">tabular</code>. Haz clic sobre <code class="language-plaintext highlighter-rouge">Change datatype</code>.)</li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la tabla de anotaci√≥n a <code class="language-plaintext highlighter-rouge">Gene Information</code></li>
  </ol>
</blockquote>

<p>Inspecciona <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> el objeto <strong>Gene Information</strong> del historial. Ahora has incluido un nuevo campo para gene_id, esto incluye el nombre de los genes y una columna para informaci√≥n mitocondrial (false = not mitochondrial, true = mitochondrial). Necesitamos a√±adir esta informaci√≥n a la tabla de salida ‚ÄòGene table‚Äô proveniente de la herramienta salmonKallistoMtxto10x. Sin embargo, necesitamos mantener la tabla ‚ÄòGene table‚Äô en el mismo orden, ya que se hace referencia a ella en las filas de la tabla ‚ÄòMatrix table‚Äô.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-combinar-la-tabla-de-genes-mtx-con-la-informaci√≥n-de-los-genes"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Combinar la tabla de genes MTX con la informaci√≥n de los genes</h3>

  <ol>
    <li><span class="tool" data-tool="join1" title="Tested with join1"><strong>Join two Datasets</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: join1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúJoin‚Äù</em>: <code class="language-plaintext highlighter-rouge">Gene Table</code></li>
        <li><em>‚ÄúUsing column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
        <li><em>‚Äúwith‚Äù</em>: <code class="language-plaintext highlighter-rouge">Gene Information</code></li>
        <li><em>‚Äúand column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 1</code></li>
        <li><em>‚ÄúKeep lines of first input that do not join with second input‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúKeep lines of first input that are incomplete‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
        <li><em>‚ÄúFill empty columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><em>‚ÄúKeep the header lines‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
      </ul>

      <p>Si inspeccionas <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> el objeto, ver√°s que hemos unido estas tablas y que ahora tiene algunos pocos gene_id repetidos. Eliminemos estas repeticiones manteniendo a su vez el orden original de la tabla ‚ÄòGene Table‚Äô.</p>
    </li>
    <li><span class="tool" data-tool="Cut1" title="Tested with Cut1"><strong>Cut columns from a table</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Cut1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúCut columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">c1,c4,c5</code></li>
        <li><em>‚ÄúDelimited by‚Äù</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li><em>‚ÄúFrom‚Äù</em>: la salida de la herramienta <strong>Join two Datasets</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida a <code class="language-plaintext highlighter-rouge">Annotated Gene Table</code></li>
  </ol>
</blockquote>

<p>Inspecciona <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> tu tabla <code class="language-plaintext highlighter-rouge">Annotated Gene Table</code>. ¬°Esto es m√°s parecido a lo que buscamos! Tenemos <code class="language-plaintext highlighter-rouge">gene_id</code>, <code class="language-plaintext highlighter-rouge">gene_name</code>, y <code class="language-plaintext highlighter-rouge">mito</code>. ¬°Ahora regresemos a nuestro trayecto inicial con rumbo hacia emptyDrops y su forma sofisticada de utilizar umbrales para detectar gotas vac√≠as!</p>

<h1 id="emptydrops">emptyDrops</h1>

<p>La herramienta emptyDrops <span class="citation"><a href="#article-emptyDrops">Lun <i>et al.</i> 2019</a></span> trabaja con un tipo espec√≠fico de objeto R llamado SingleCellExperiment. Necesitamos convertir nuestros archivos transformados MTX a este tipo de objetos, esto lo haremos utilizando la herramienta Read10x de DropletUtils:</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-convertir-al-formato-singlecellexperiment"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Convertir al formato SingleCellExperiment</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.3+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.3+galaxy2"><strong>DropletUtils Read10x</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_read_10x/dropletutils_read_10x/1.0.3+<span class="notranslate">galaxy</span>2</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äú<span class="notranslate">Expression</span> matrix in sparse matrix format (.mtx)‚Äù</em>: <code class="language-plaintext highlighter-rouge">Matrix table</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGene Table‚Äù</em>: <code class="language-plaintext highlighter-rouge">Annotated Gene Table</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúBarcode/cell table‚Äù</em>: <code class="language-plaintext highlighter-rouge">Barcode table</code></li>
        <li><em>‚ÄúShould metadata file be added?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de salida: <code class="language-plaintext highlighter-rouge">SCE Object</code></li>
  </ol>
</blockquote>

<p>¬°Fant√°stico! Ya hemos convertido la matriz en el objeto que ocupamos, siendo m√°s espec√≠ficos, la hemos convertido al formato SingleCellExperiment, ¬°Ahora podemos ejecutar emptyDrops! Pero primero deshag√°monos de esas gotas que no contienen c√©lulas.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-pr√°ctica-emptydrops"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Pr√°ctica: emptyDrops</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+galaxy1"><strong>DropletUtils emptyDrops</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+<span class="notranslate">galaxy</span>1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSingleCellExperiment rdata object‚Äù</em>: <code class="language-plaintext highlighter-rouge">SCE Object</code></li>
        <li><em>‚ÄúShould barcodes estimated to have no cells be removed from the output object?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li>
      <p>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida de <code class="language-plaintext highlighter-rouge">serialised SingleCellExperiment</code> a <code class="language-plaintext highlighter-rouge">Stringent-Object</code></p>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de <code class="language-plaintext highlighter-rouge">tabular output</code> a <code class="language-plaintext highlighter-rouge">Stringent-Tabular Output</code></li>
  </ol>
</blockquote>

<blockquote class="question">
  <h3 id="question-pregunta-3"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Pregunta</h3>

  <p>¬øCu√°ntos c√≥digos de barras de c√©lulas quedan despu√©s de procesar emptyDrops? ¬øPor qu√© ser√° esto?</p>

  <blockquote class="tip">
    <h3 id="tip-pista"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden">tip</span> Pista</h3>
    <p>Si haces clic sobre el <code class="language-plaintext highlighter-rouge">Stringent-Object</code> en el historial <i class="fas fa-columns" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-history</span>, el texto de la ventana dice <code class="language-plaintext highlighter-rouge">22 barcodes</code> o algo similar.  ¬øPor qu√© es tan bajo?
Toma en consideraci√≥n, ¬øEs este un conjunto de datos completo?</p>
  </blockquote>

  <blockquote class="solution">
    <h3 id="solution-soluci√≥n-5"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluci√≥n</h3>

    <p>Recuerda que este conjunto de datos est√° submestreado. Si observas detenidamente los par√°metros de emptyDrops, ver√°s que la herramienta estableci√≥ un umbral m√≠nimo de 100 UMI. Analizando los gr√°ficos de c√≥digos de barras mostrados en este tutorial, para la muestra de 400k lecturas, ver√°s que este umbral es demasiado riguroso para la muestra submuestreada. Saliendo de dudas, este umbral m√≠nimo dar√≠a como resultado <code class="language-plaintext highlighter-rouge">3011</code> c√≥digos de barras para la muestra total.</p>

  </blockquote>

</blockquote>

<p>Ejecutemos de nuevo y cambiemos par√°metros; volvamos a ejecutar la herramienta con un umbral m√≠nimo m√°s laxo.</p>

<blockquote class="details">
  <h3 id="details-est√°s-trabajando-en-equipo-hora-de-tomar-decisiones"><i class="fas fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> ¬øEst√°s trabajando en equipo? ¬°Hora de tomar decisiones!</h3>
  <p>Si est√°is trabajando en equipo en este punto ten√©is la oportunidad de tomar diversas rutas, la primera utilizando un control y el resto variando n√∫meros para que pod√°is comparar resultados a lo largo de los tutoriales.</p>
  <ul>
    <li>Variable: <strong>UMI count lower bound</strong></li>
    <li>Control:  <code class="language-plaintext highlighter-rouge">5</code></li>
    <li>Todos los dem√°s: Tomad en consideraci√≥n los gr√°ficos de rangos de c√≥digos de barras y seleccionad diversos l√≠mites inferiores.</li>
  </ul>
</blockquote>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-emptydrops---intentemoslo-de-nuevo"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: emptyDrops - ¬°Intentemoslo de nuevo!</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+galaxy1"><strong>DropletUtils emptyDrops</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/dropletutils_empty_drops/dropletutils_empty_drops/1.0.3+<span class="notranslate">galaxy</span>1</span></span>  con los siguiente par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSingleCellExperiment rdata object‚Äù</em>: <code class="language-plaintext highlighter-rouge">SCE Object</code></li>
        <li><em>‚ÄúUMI count lower bound‚Äù</em>: <code class="language-plaintext highlighter-rouge">5</code> - aqu√≠ puedes usar diversos valores y ver que sucede</li>
        <li><em>‚ÄúShould barcodes estimated to have no cells be removed from the output object?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code></li>
      </ul>
    </li>
    <li>
      <p>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida <code class="language-plaintext highlighter-rouge">serialised SingleCellExperiment</code> a <code class="language-plaintext highlighter-rouge">&lt;pon tu n√∫mero aqu√≠&gt;UMI-Object</code></p>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida <code class="language-plaintext highlighter-rouge">tabular output</code> a <code class="language-plaintext highlighter-rouge">&lt;pon tu n√∫mero aqu√≠&gt;UMI-Tabular Output</code></li>
  </ol>
</blockquote>

<p>¬°En este punto debes tener <code class="language-plaintext highlighter-rouge">111</code> c√≥digos de barras! Ahora tienes una matriz de expresi√≥n anotada y lista para los procesos y an√°lisis subsecuentes, ¬°Bien hecho! Sin embargo, en los siguientes tutoriales nos vincularemos al uso de una herramienta llamada Scanpy. Por tanto, necesitar√°s convertir este objeto SingleCellExperiment a un formato llamado <code class="language-plaintext highlighter-rouge">annData</code>, el cual es una variante de un archivo que utiliza un formato llamado <code class="language-plaintext highlighter-rouge">hdf5</code>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-pr√°ctica-conversi√≥n-al-formato-anndata"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Pr√°ctica: Conversi√≥n al formato AnnData</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+galaxy1"><strong>SCEasy convert</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/sceasy_convert/sceasy_convert/0.0.5+<span class="notranslate">galaxy</span>1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúDirection of conversion‚Äù</em>: <code class="language-plaintext highlighter-rouge">SingleCellExperiment to AnnData</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput object in SingleCellExperiment RDS format‚Äù</em>: <code class="language-plaintext highlighter-rouge">&lt;pon tu n√∫mero aqu√≠&gt;UMI-Object</code></li>
        <li><em>‚ÄúName of the assay to be transferred as main layer‚Äù</em>: <code class="language-plaintext highlighter-rouge">counts</code></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida a <code class="language-plaintext highlighter-rouge">N701-400k-AnnData</code></li>
  </ol>

</blockquote>

<p><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> ¬°Felicidades! Tu objeto est√° listo para el pipeline de Scanpy. Ahora puedes verificar tu trabajo compar√°ndolo con el mostrado en este <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-1---answer-key">historial de ejemplo</a>.</p>

<p>Sin embargo, quiz√° quieras combinar este objeto con otros parecidos a √©l. Por ejemplo, es posible que hayas procesado 5 muestras, y que hayas empezado a partir de 10 archivos FASTQ‚Ä¶</p>

<h1 id="combinar-archivos-fastq">Combinar archivos FASTQ</h1>

<p>Esta muestra es una de siete iniciales. Entonces, puedes utilizar un <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/w/pre-processing-with-alevin---part-1-imported-from-uploaded-file">flujo de trabajo</a> para procesar los otros <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/alevin-tutorial---all-samples---400k">12 archivos FASTQ submuestreados</a>. Nota que, por desgracia, la muestra submuestreada N705 contiene mayormente lecturas chatarra; por tanto, emptyDrops no funciona. Debido a esto, yo la proces√© con Alevin. Por supuesto, la muestra completa funciona bien con emptyDrops. Va a tomar un buen rato el procesado de todas estas muestras, as√≠ que mientras tanto ve por uno, o varios cafecitos‚Ä¶ O a√∫n mejor, <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---input-generation">yo ya proces√© las muestras</a>, y las deposit√© en un <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---input">nuevo historial</a> para que lo puedas importar y empezar con un historial limpio. Alte<span class="notranslate">rna</span>tivamente, puedes obtener estos datos desde el repositorio Zenodo.</p>

<h2 id="datos">Datos</h2>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-cargar-datos---combinar-archivos"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Cargar datos - Combinar archivos</h3>

  <ol>
    <li>Crear un historial huevo para este tutorial (si es que no est√°s importando el historial mencionado en la parte superior)</li>
    <li>
      <p>Importar los diversos archivos AnnData y la tabla de dise√±o experimental
 desde <a href="https://zenodo.org/record/4574153#.YD56YS-l2uU">Zenodo</a></p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/4574153/files/Experimental_Design.tabular
https://zenodo.org/record/4574153/files/N701-400k-AnnData.h5ad
https://zenodo.org/record/4574153/files/N702-400k-AnnData.h5ad
https://zenodo.org/record/4574153/files/N703-400k-AnnData.h5ad
https://zenodo.org/record/4574153/files/N704-400k-AnnData.h5ad
https://zenodo.org/record/4574153/files/N705-400k-AnnData.h5ad
https://zenodo.org/record/4574153/files/N706-400k-AnnData.h5ad
https://zenodo.org/record/4574153/files/N707-400k-AnnData.h5ad
</code></pre></div>      </div>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-consejo-importaci√≥n-por-medio-de-enlaces"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Consejo: Importaci√≥n por medio de enlaces</h3>  <ul>  <li>Copia los enlaces</li>  <li>    <p>Abre el manejador de carga de datos de <span class="notranslate">Galaxy</span> (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-upload</span> en la parte superior derecha del panel de herramientas)</p>  </li>  <li>Selecciona ‚ÄòPegar/Traer datos‚Äô <strong>Paste/Fetch Data</strong></li>  <li>    <p>Copia los enlaces en el campo de textos</p>  </li>  <li>    <p>Presiona ‚ÄòIniciar‚Äô <strong>Start</strong></p>  </li>  <li>    <p><strong>Close</strong> Cierra la ventana.</p>  </li>  <li><span class="notranslate">Galaxy</span> utiliza los URLs como nombres de forma predeterminada , as√≠ que los tendr√°s que cambiar a algunos que sean m√°s √∫tiles o informativos.the window</li></ul></blockquote>
    </li>
    <li>Cambiar de nombre al conjunto de datos</li>
    <li>
      <p>Verifica que el tipo de datos sea <code class="language-plaintext highlighter-rouge">h5ad</code> de lo contrario ¬°Necesitar√°s cambiar cada tipo de datos al formato <code class="language-plaintext highlighter-rouge">h5ad</code>!</p>

      <!--SNIPPET-->
      <blockquote class="tip">  <h3 data-toc-skip="" id="-consejo-cambiar-el-tipo-de-datos"><i class="far fa-lightbulb" aria-hidden="true"></i><span class="visually-hidden"></span> Consejo: Cambiar el tipo de datos</h3>  <ul>  <li>Selecciona sobre el <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> <strong>icono del l√°piz</strong> para editar los atributos del conjunto de datos</li>  <li>Selecciona en la pesta√±a <i class="fas fa-database" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-chart-select-data</span> <strong>Datatypes</strong> en la parte superior del panel central</li>  <li>Selecciona <code class="language-plaintext highlighter-rouge">datatypes</code></li>  <li>Da clic en el bot√≥n <strong>Change datatype</strong></li></ul></blockquote>
    </li>
  </ol>

</blockquote>

<p>Inspecciona <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> el archivo de texto <code class="language-plaintext highlighter-rouge">Experimental Design</code>. Este muestra c√≥mo cada <code class="language-plaintext highlighter-rouge">N70X</code>  corresponde a una muestra, y si dicha muestra proviene de un macho o hembra. Estos ser√°n metadatos importantes para agregar a nuestra muestra, los cuales a√±adiremos de forma similar a la forma en que a√±adiste los metadatos <code class="language-plaintext highlighter-rouge">gene_name</code> y <code class="language-plaintext highlighter-rouge">mito</code> en secciones anteriores.</p>

<h2 id="concatenaci√≥n-de-objetos">Concatenaci√≥n de objetos</h2>
<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-concatenaci√≥n-de-objetos-anndata"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Concatenaci√≥n de objetos AnnData</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0"><strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+<span class="notranslate">galaxy</span>0</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix‚Äù</em>: <code class="language-plaintext highlighter-rouge">N701-400k-AnnData</code></li>
        <li><em>‚ÄúFunction to manipulate the object‚Äù</em>: ‚ÄòConcatenate along the observations axis‚Äô</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix to add‚Äù</em>: ‚ÄòSelect all the other matrix files from bottom to top‚Äô</li>
        <li><em>‚ÄúJoin method‚Äù</em>: <code class="language-plaintext highlighter-rouge">Intersection of variables</code></li>
        <li><em>‚ÄúKey to add the batch annotation to obs‚Äù</em>: <code class="language-plaintext highlighter-rouge">batch</code></li>
        <li><em>‚ÄúSeparator to join the existing index names with the batch category‚Äù</em>: <code class="language-plaintext highlighter-rouge">-</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>¬°Demos un vistazo a lo que hemos hecho! Desafortunadamente, los objetos AnnData son bastante complicados, as√≠ que aqu√≠ el icono del ojo <i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-eye</span> no nos ser√° de mucha ayuda. En lugar de esto, de aqu√≠ en adelante vamos a utilizar una herramienta para visualizar nuestro objeto.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-inspecci√≥n-de-objetos-anndata"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Inspecci√≥n de objetos AnnData</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0"><strong>Inspect AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+<span class="notranslate">galaxy</span>0</span></span>  con los siguiente par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix‚Äù</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li><em>‚ÄúWhat to inspect?‚Äù</em>: <code class="language-plaintext highlighter-rouge">General information about the object</code></li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0"><strong>Inspect AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+<span class="notranslate">galaxy</span>0</span></span>   con los siguiente par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix‚Äù</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li><em>‚ÄúWhat to inspect?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Key-indexed observations annotation (obs)</code></li>
      </ul>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy0"><strong>Inspect AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+<span class="notranslate">galaxy</span>0</span></span>   con los siguiente par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix‚Äù</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li><em>‚ÄúWhat to inspect?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Key-indexed annotation of variables/features (var)</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>Ya hemos visualizado las tres salidas de <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> <strong>Inspect AnnData</strong>.</p>

<blockquote class="question">
  <h3 id="question-preguntas-4"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Preguntas</h3>

  <ol>
    <li>¬øCu√°ntas c√©lulas tienes ahora?</li>
    <li>¬øD√≥nde est√° almacenada la informaci√≥n del lote (<code class="language-plaintext highlighter-rouge">batch</code>)?</li>
  </ol>

  <blockquote class="solution">
    <h3 id="solution-soluciones-1"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Soluciones</h3>

    <ol>
      <li>Si verificas la salida <strong>General information</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>, podr√°s ver que ahora tienes <code class="language-plaintext highlighter-rouge">4079 c√©lulas</code>, ya que la matriz ahora tiene 4079 c√©lulas y 35,734 genes. Tambi√©n puedes observar esto en los tama√±os de los archivos <strong>obs</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> (c√©lulas) and <strong>var</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> (genes).</li>
      <li>En la anotaci√≥n de observaciones indexadas por clave <strong>Key-indexed observations annotation (obs)</strong>. Las diferentes versiones de la herramienta ‚ÄòManipulate‚Äô colocar√°n las columnas del lote (<code class="language-plaintext highlighter-rouge">batch</code>) en diferentes ubicaciones. La versi√≥n de la herramienta utilizada en este curso asigna a la novena columna (<code class="language-plaintext highlighter-rouge">9</code>) en la posici√≥n de m√°s a la derecha, la cual determina el ‚Äòlote‚Äô (<code class="language-plaintext highlighter-rouge">batch</code>). Lote (batch) se refiere al orden en que se agregaron las matrices. Los archivos se agregan desde la parte inferior del historial hacia arriba, ¬°As√≠ que ten cuidado en c√≥mo configuras tus historiales al ejecutar esto!</li>
    </ol>
  </blockquote>

</blockquote>

<h1 id="a√±adir-el-lote-de-metadatos-batch-metadata">A√±adir el lote de metadatos (batch metadata)</h1>

<p>Configura el historial de ejemplo con los √≠ndices m√°s antiguos en la parte inferior.</p>

<figure id="figure-9"><img src="../../images/wab-history-files-ascending.png" alt="Ordered history. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 9:</span> Nota como N701 es el m√°s bajo, en orden ascendente al N707</figcaption></figure>

<p>Por tanto, cuando se concatenan, el lote (<code class="language-plaintext highlighter-rouge">batch</code>) aparece de la siguiente manera:</p>

<table>
  <thead>
    <tr>
      <th>Index</th>
      <th>Batch</th>
      <th>Genotype</th>
      <th>Sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>N701</td>
      <td>0</td>
      <td>wildtype</td>
      <td>male</td>
    </tr>
    <tr>
      <td>N702</td>
      <td>1</td>
      <td>knockout</td>
      <td>male</td>
    </tr>
    <tr>
      <td>N703</td>
      <td>2</td>
      <td>knockout</td>
      <td>female</td>
    </tr>
    <tr>
      <td>N704</td>
      <td>3</td>
      <td>wildtype</td>
      <td>male</td>
    </tr>
    <tr>
      <td>N705</td>
      <td>4</td>
      <td>wildtype</td>
      <td>male</td>
    </tr>
    <tr>
      <td>N706</td>
      <td>5</td>
      <td>wildtype</td>
      <td>male</td>
    </tr>
    <tr>
      <td>N707</td>
      <td>6</td>
      <td>knockout</td>
      <td>male</td>
    </tr>
  </tbody>
</table>

<p>Puede ser que los √≠ndices no se hayan importado en orden si utilizaste Zenodo para importar tus archivos (por ejemplo, N701 a N707, ascendentes). En ese caso necesitar√°s manipular de forma apropiada los par√°metros de las siguientes herramientas para etiquetar tus lotes correctamente.</p>

<p>Los dos metadatos m√°s cr√≠ticos en este experimento son <code class="language-plaintext highlighter-rouge">sex</code> y <code class="language-plaintext highlighter-rouge">genotype</code>. Posteriormente, vamos a colorear nuestros gr√°ficos de c√©lulas seg√∫n los valores de estos par√°metros, as√≠ que vamos a a√±adirlos ya.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-etiquetas-de-sexo"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Etiquetas de sexo</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3"><strong>Replace Text in a specific column</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile to process‚Äù</em>: la salida de la herramienta <strong>Inspect AnnData: Key-indexed observations annotation (obs)</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>)</li>
        <li>
          <p><em>‚Äú1. Replacement‚Äù</em></p>

          <ul>
            <li><em>‚Äúin column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 9</code> - or whichever column <code class="language-plaintext highlighter-rouge">batch</code> is in</li>
            <li><em>‚ÄúFind pattern‚Äù</em>: <code class="language-plaintext highlighter-rouge">0|1|3|4|5|6</code></li>
            <li><em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">male</code></li>
          </ul>
        </li>
        <li><strong>+ Insert Replacement</strong></li>
        <li>
          <p><em>‚Äú2. Replacement‚Äù</em></p>

          <ul>
            <li><em>‚Äúin column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 9</code></li>
            <li><em>‚ÄúFind pattern‚Äù</em>: <code class="language-plaintext highlighter-rouge">2</code></li>
            <li><em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">female</code></li>
          </ul>
        </li>
        <li><strong>+ Insert Replacement</strong></li>
        <li>
          <p><em>‚Äú3. Replacement‚Äù</em></p>

          <ul>
            <li><em>‚Äúin column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 9</code></li>
            <li><em>‚ÄúFind pattern‚Äù</em>: <code class="language-plaintext highlighter-rouge">batch</code></li>
            <li><em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">sex</code></li>
          </ul>
        </li>
      </ul>

      <p>Ahora queremos √∫nicamente la columna que contiene la informaci√≥n de sexo -  al final agregaremos esto en la anotaci√≥n celular del objeto AnnData</p>
    </li>
    <li><span class="tool" data-tool="Cut1" title="Tested with Cut1"><strong>Cut columns from a table</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Cut1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúCut columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">c9</code></li>
        <li><em>‚ÄúDelimited by‚Äù</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li>% icon param-file %} <em>‚ÄúFrom‚Äù</em>: la salida de la herramienta <strong>Replace text</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida a <code class="language-plaintext highlighter-rouge">Sex metadata</code></li>
  </ol>
</blockquote>

<p>Estuvo divertido, ahora hag√°moslo de nuevo pero para el genotipo.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-etiquetas-de-genotipo"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Etiquetas de genotipo</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3" title="Tested with toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3"><strong>Replace Text in a specific column</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_column/1.1.3</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFile to process‚Äù</em>: la salida de la herramienta <strong>Inspect AnnData: Key-indexed observations annotation (obs)</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li>
          <p><em>‚Äú1. Replacement‚Äù</em></p>

          <ul>
            <li><em>‚Äúin column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 9</code></li>
            <li><em>‚ÄúFind pattern‚Äù</em>: <code class="language-plaintext highlighter-rouge">0|3|4|5</code></li>
            <li><em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">wildtype</code></li>
          </ul>
        </li>
        <li><strong>+ Insert Replacement</strong></li>
        <li>
          <p><em>‚Äú2. Replacement‚Äù</em></p>

          <ul>
            <li><em>‚Äúin column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 9</code></li>
            <li><em>‚ÄúFind pattern‚Äù</em>: <code class="language-plaintext highlighter-rouge">1|2|6</code></li>
            <li><em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">knockout</code></li>
          </ul>
        </li>
        <li><strong>+ Insert Replacement</strong></li>
        <li>
          <p><em>‚Äú3. Replacement‚Äù</em></p>

          <ul>
            <li><em>‚Äúin column‚Äù</em>: <code class="language-plaintext highlighter-rouge">Column: 9</code></li>
            <li><em>‚ÄúFind pattern‚Äù</em>: <code class="language-plaintext highlighter-rouge">batch</code></li>
            <li><em>‚ÄúReplace with‚Äù</em>: <code class="language-plaintext highlighter-rouge">genotype</code></li>
          </ul>
        </li>
      </ul>

      <p>Ahora queremos √∫nicamente la columna que contiene la informaci√≥n de genotipo -  al final agregaremos esto en la anotaci√≥n celular del objeto AnnData.</p>
    </li>
    <li><span class="tool" data-tool="Cut1" title="Tested with Cut1"><strong>Cut columns from a table</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Cut1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúCut columns‚Äù</em>: <code class="language-plaintext highlighter-rouge">c9</code></li>
        <li><em>‚ÄúDelimited by‚Äù</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFrom‚Äù</em>: la salida de la herramienta <strong>Replace text</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida a <code class="language-plaintext highlighter-rouge">Genotype metadata</code></li>
  </ol>
</blockquote>

<p>Es posible que desees hacer esto con distintos tipos de metadatos - qu√© laboratorios manejaron las muestras, en qu√© d√≠a se procesaron, etc. Una vez que hayas agregado todas tus columnas de metadatos, podemos entonces adherirlas unas a otras antes de conectarlas al objeto AnnData.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-combinar-las-columnas-de-metadatos"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Combinar las columnas de metadatos</h3>

  <ol>
    <li><span class="tool" data-tool="Paste1" title="Tested with Paste1"><strong>Paste two files side by side</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: Paste1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúPaste‚Äù</em>: <code class="language-plaintext highlighter-rouge">Genotype metadata</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚Äúand‚Äù</em>: <code class="language-plaintext highlighter-rouge">Sex metadata</code></li>
        <li><em>‚ÄúDelimit by‚Äù</em>: <code class="language-plaintext highlighter-rouge">Tab</code></li>
      </ul>
    </li>
    <li>Cambiar el nombre <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden"><span class="notranslate">galaxy</span>-pencil</span> de la salida a <code class="language-plaintext highlighter-rouge">Cell Metadata</code></li>
  </ol>
</blockquote>

<p>¬°Agr√©galo al objeto AnnData!</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-a√±adir-los-metadatos-al-objeto-anndata"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: A√±adir los metadatos al objeto AnnData</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0"><strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+<span class="notranslate">galaxy</span>0</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix‚Äù</em>: la salida de la herramienta <strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li><em>‚ÄúFunction to manipulate the object‚Äù</em>: <code class="language-plaintext highlighter-rouge">Add new annotation(s) for observations or variables</code></li>
        <li><em>‚ÄúWhat to annotate?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Observations (obs)</code>`</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTable with new annotations‚Äù</em>: <code class="language-plaintext highlighter-rouge">Cell Metadata</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>¬°Perfecto! Ahora puedes ejecutar <strong>Inspect AnnData</strong> para verificaci√≥n, pero primero limpiemos un poco m√°s este objeto. Ser√≠a mucho mejor si ‚Äúlote‚Äù (<code class="language-plaintext highlighter-rouge">batch</code>) significara algo, en lugar de ‚Äúel orden en el que la herramienta ‚ÄòManipulate AnnData‚Äô agreg√≥ mis conjuntos de datos‚Äù.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica--etiquetado-de-lotes"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica:  Etiquetado de lotes</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+galaxy0"><strong>Manipulate AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/iuc/anndata_manipulate/anndata_manipulate/0.7.5+<span class="notranslate">galaxy</span>0</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAnnotated data matrix‚Äù</em>: la salida de la herramienta <strong>Manipulate AnnData - Add new annotations</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li><em>‚ÄúFunction to manipulate the object‚Äù</em>: <code class="language-plaintext highlighter-rouge">Rename categories of annotation</code></li>
        <li><em>‚ÄúKey for observations or variables annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">batch</code></li>
        <li><em>‚ÄúComma-separated list of new categories‚Äù</em>: <code class="language-plaintext highlighter-rouge">N701,N702,N703,N704,N705,N706,N707</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>¬°Ya casi llegamos a donde queremos! Sin embargo, mientras que nos hemos enfocado en los metadatos de nuestras c√©lulas (muestra, lote, genotipo, etc.) para etiquetar las ‚Äòobservaciones‚Äô en nuestro objeto‚Ä¶</p>

<h1 id="lecturas-mitocondriales">Lecturas mitocondriales</h1>

<p>¬øRecuerdas cuando mencionamos mitocondrias en los inicios de este tutorial? Y en muestras de c√©lulas √∫nicas, ¬øC√≥mo de frecuente el ARN mitocondrial es un indicador de estr√©s durante la disociaci√≥n? Probablemente deber√≠amos hacer algo con nuestra columna de verdadero/falso (true/false) en la anotaci√≥n de genes, la cual nos provee informaci√≥n sobre las c√©lulas. Ya sea que hayas combinado los archivos FASTQ o que est√©s analizando solo un archivo necesitar√°s hacer esto (salt√°ndose as√≠ las secciones 4 y 5).</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-calculando-el-arn-mitocondrial-en-las-c√©lulas"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Calculando el ARN mitocondrial en las c√©lulas</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/0.0.3+galaxy1" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/0.0.3+galaxy1"><strong>AnnData Operations</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/anndata_ops/anndata_ops/0.0.3+<span class="notranslate">galaxy</span>1</span></span>  con los siguientes par√°metros:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput object in hdf5 AnnData format‚Äù</em>: la salida de la herramienta <strong>Manipulate AnnData - Rename categories</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span></li>
        <li><em>‚ÄúFormat of output object‚Äù</em>: <code class="language-plaintext highlighter-rouge">AnnData format</code></li>
        <li><em>‚ÄúCopy AnnData to .raw‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
        <li><em>‚ÄúGene symbols field in AnnData‚Äù</em>: <code class="language-plaintext highlighter-rouge">NA.</code></li>
        <li><em>‚ÄúFlag genes that start with these names‚Äù</em>: <code class="language-plaintext highlighter-rouge">Insert Flag genes that start with these names</code></li>
        <li><em>‚ÄúStarts with‚Äù</em>: <code class="language-plaintext highlighter-rouge">True</code></li>
        <li><em>‚ÄúVar name‚Äù</em>: <code class="language-plaintext highlighter-rouge">mito</code></li>
        <li><em>‚ÄúNumber of top genes‚Äù</em>: <code class="language-plaintext highlighter-rouge">50</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> ¬°Bien hecho! Te sugiero encarecidamente que juegues un poco e inspecciones tu objeto <strong>Inspect AnnData</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> final preprocesado de AnnData (<code class="language-plaintext highlighter-rouge">Pre-processed object</code>) para que puedas ver la gran cantidad de informaci√≥n que ha sido agregada. ¬°Ya est√° todo listo para continuar con el filtrado! Sin embargo, hay un truco que puede ahorrarte tiempo en el futuro‚Ä¶</p>

<h1 id="extraer-datos-de-secuenciaci√≥n-de-arn-de-c√©lulas-√∫nicas-desde-bases-de-datos-p√∫blicas">Extraer datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas desde bases de datos p√∫blicas</h1>

<p>Si te interesa analizar datos de acceso p√∫blico, particularmente del <a href="https://www.ebi.ac.uk/gxa/sc/home"><span class="notranslate">Single Cell</span> <span class="notranslate">Expression</span> Atlas</a>, quiz√° te interese la herramienta <span class="citation"><a href="#Moreno2020.04.08.032698">Moreno <i>et al.</i> 2020</a></span>, la cual m√°s bien reduce estos pasos en uno. <a href="https://www.ebi.ac.uk/gxa/sc/experiments/E-MTAB-6945/downloads">Aqu√≠</a>  puedes encontrar el conjunto de datos para este tutorial, el cual tiene el n√∫mero de identificaci√≥n de experimento <code class="language-plaintext highlighter-rouge">E-MTAB-6945</code>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-pr√°ctica-obtener-datos-de-el-atlas-de-expresi√≥n-de-c√©lulas-√∫nicas"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Pr√°ctica: Obtener datos de el Atlas de Expresi√≥n de C√©lulas √önicas</h3>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+galaxy2" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+galaxy2"><strong>EBI SCXA Data Retrieval</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/retrieve_scxa/retrieve_scxa/v0.0.2+<span class="notranslate">galaxy</span>2</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚ÄúSC-Atlas experiment accession‚Äù</em>: <code class="language-plaintext highlighter-rouge">E-MTAB-6945</code></li>
        <li><em>‚ÄúChoose the type of matrix to download‚Äù</em>: <code class="language-plaintext highlighter-rouge">Raw filtered counts</code></li>
      </ul>

      <p>Ahora necesitamos transformar estos datos en un objeto tipo AnnData</p>
    </li>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.6.0+galaxy0" title="Tested with toolshed.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.6.0+galaxy0"><strong>Scanpy Read10x</strong> <i class="fas fa-wrench" aria-hidden="true"></i><i aria-hidden="true" class="fas fa-cog"></i><span class="visually-hidden">Tool: <span class="notranslate">toolshed</span>.g2.bx.psu.edu/repos/ebi-gxa/scanpy_read_10x/scanpy_read_10x/1.6.0+<span class="notranslate">galaxy</span>0</span></span>  con los siguientes par√°metros:
      <ul>
        <li><em>‚Äú<span class="notranslate">Expression</span> matrix in sparse matrix format (.mtx)‚Äù</em>: <code class="language-plaintext highlighter-rouge">EBI SCXA Data Retrieval on E-MTAB-6945 matrix.mtx (Raw filtered counts)</code></li>
        <li><em>‚ÄúGene table‚Äù</em>:  <code class="language-plaintext highlighter-rouge">EBI SCXA Data Retrieval on E-MTAB-6945 genes.tsv (Raw filtered counts)</code></li>
        <li><em>‚ÄúBarcode/cell table‚Äù</em>: <code class="language-plaintext highlighter-rouge">EBI SCXA Data Retrieval on E-MTAB-6945 barcodes.tsv (Raw filtered counts)</code></li>
        <li><em>‚ÄúCell metadata table‚Äù</em>: <code class="language-plaintext highlighter-rouge">EBI SCXA Data Retrieval on E-MTAB-6945 exp_design.tsv</code></li>
      </ul>
    </li>
  </ol>
</blockquote>

<p>Es importante tener en cuenta que esta matriz es procesada de cierto modo por medio del pipeline SCXA, que es muy similar a este tutorial, y que contiene todos y cada uno de los metadatos proporcionados por su pipeline, as√≠ como sus autores (por ejemplo, m√°s anotaciones celulares o de genes).</p>

<h1 class="no_toc" id="conclusion">Conclusion</h1>

<figure id="figure-10"><img src="../../images/wab-alevin-part1workflow.png" alt="Workflow Part 1. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 10:</span> Flujo de trabajo - Pasos 1-3</figcaption></figure>

<figure id="figure-11"><img src="../../images/wab-alevin-part2workflow.png" alt="Workflow Part 2. " loading="lazy" /><figcaption><span class="figcaption-prefix">Figura 11:</span> Flujo de trabajo - Pasos 4-6</figcaption></figure>

<p>¬°Has llegado al final de esta sesi√≥n! Quiz√° te interese echarle un vistazo a un <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---answer-key-1">ejemplo de un historial</a> y a la <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/w/pre-processing-with-alevin---part-2">Parte 2 del flujo de trabajo</a>. Nota que seg√∫n la forma en que ejecutes el flujo de trabajo este requerir√° que cambies la columna (<code class="language-plaintext highlighter-rouge">column</code>) que contiene el lote de metadatos. <a href="https://humancellatlas.usegalaxy.eu/u/wendi.bacon.training/h/pre-processing-with-alevin---part-2---total-anndata-example">Aqu√≠</a> puedes encontrar el objeto final que contiene todas las lecturas.</p>

<p>Hemos:</p>

<ul>
  <li>Tomado lecturas crudas, anotaciones y los archivos de entrada necesarios para cuantificaci√≥n.</li>
  <li>Ejecutado Alevin con dos distintas configuraciones de par√°metros, ambas permitiendo que la herramienta tome sus propias decisiones sobre qu√© es lo que constituyen las gotas vac√≠as y, hemos aplicado emptyDrops en su lugar.</li>
  <li>Desplegado gr√°ficos de rangos de c√≥digos de barras para valorar de manera r√°pida las se√±ales presentes en los conjuntos de datos generados por t√©cnicas de goteo.</li>
  <li>Aplicado las conversiones necesarias para pasar estos datos a los procesos subsecuentes.</li>
  <li>Obtenido datos con an√°lisis parciales desde el <span class="notranslate">Single Cell</span> <span class="notranslate">Expression</span> Atlas.</li>
</ul>

<p>¬°√önete a nuestro canal de Gitter de secuenciaci√≥n de ARN de c√©lulas √∫nicas para tomar parte en discusiones con cient√≠ficos con ideas afines a las tuyas! <a href="https://gitter.im/Galaxy-Training-Network/galaxy-single-cell?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge"><img src="https://badges.gitter.im/Galaxy-Training-Network/galaxy-single-cell.svg" alt="Gitter. " loading="lazy" /></a></p>


                
                <blockquote class="key_points">
                    <h3><i class="fas fa-key" aria-hidden="true"></i> Puntos clave</h3>
                    <ul>
                        
                        <li><p>Partiendo de archivos FASTQ crear un objeto AnnData que sea accesible con scanpy, incluir metadatos relevantes sobre c√©lulas y genes</p>
</li>
                        
                        <li><p>Combinar m√∫ltiples muestras y etiquetar seg√∫n el dise√±o del estudio</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Preguntas frecuentes</h1>
                Have questions about this tutorial? Check out the  <a href="/training-material/topics/transcriptomics/faqs/">FAQ page for the Transcriptomics topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                
                <h1 data-toc-skip>Useful literature</h1>
                <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/transcriptomics#references">here</a>.</p>
                

                
                <h1 id="bibliography">Referencias</h1>
                <ol class="bibliography"><li id="Bacon2018">Bacon, W. A., R. S. Hamilton, Z. Yu, J. Kieckbusch, D. Hawkes <i>et al.</i>, 2018 <b>Single-Cell Analysis Identifies Thymic Maturation Delay in Growth-Restricted Neonatal Mice</b>. Frontiers in Immunology 9: <a href="https://doi.org/10.3389/fimmu.2018.02523">10.3389/fimmu.2018.02523</a></li>
<li id="article-emptyDrops">Lun, A., S. Riesenfeld, T. Andrews, T. Dao, T. Gomes <i>et al.</i>, 2019 <b>EmptyDrops: Distinguishing cells from empty droplets in droplet-based single-cell RNA sequencing data</b>. Genome Biology 20: 63. <a href="https://doi.org/10.1186/s13059-019-1662-y">10.1186/s13059-019-1662-y</a></li>
<li id="article-Alevin">Srivastava, A., L. Malik, T. Smith, I. Sudbery, and R. Patro, 2019 <b>Alevin efficiently estimates accurate gene abundances from dscRNA-seq data</b>. Genome Biology 20: <a href="https://doi.org/10.1186/s13059-019-1670-y">10.1186/s13059-019-1670-y</a></li>
<li id="Moreno2020.04.08.032698">Moreno, P., N. Huang, J. R. Manning, S. Mohammed, A. Solovyev <i>et al.</i>, 2020 <b>User-friendly, scalable tools and workflows for single-cell analysis</b>. bioRxiv. <a href="https://doi.org/10.1101/2020.04.08.032698">10.1101/2020.04.08.032698</a> <a href="https://www.biorxiv.org/content/early/2020/04/09/2020.04.08.032698">https://www.biorxiv.org/content/early/2020/04/09/2020.04.08.032698</a></li></ol>
                

                

                <h1>Retroalimentaci√≥n</h1>
                <p class="text-muted">¬øUtilizaste este material como instructor? <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">Cu√©ntanos tu experiencia</a>.</p>

                <div id="feedback-button">
                    <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                </div>
                <div id="feedback-form">
                </div>
                <script type="text/javascript">
                    (function (window, document) {
                        function onDocumentReady(fn) {
                            if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                fn();
                            } else {
                                document.addEventListener('DOMContentLoaded', fn);
                            }
                        }

                        onDocumentReady(function () {
                            $("#feedback-button").click(function(evt){
                                var e = $(evt.target)
                                e.hide();

                                $("#feedback-form").html(`
                                    <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas utilizando Alevin (Transcriptomics)">Loading...</iframe>
                                `)
                            })
                        });
                    })(window, document);
                </script>



                <h1>C√≥mo citar este tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">Wendi Bacon, Jonathan Manning, Patricia Carvajal L√≥pez, Alejandra Escobar-Zepeda, 2021 <b>Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas utilizando Alevin (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html">https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>


                <blockquote class="details">
                  <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                  <p style="display: none;">

                <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{transcriptomics-droplet-quantification-preprocessing,
author = "Wendi Bacon and Jonathan Manning and Patricia Carvajal L√≥pez and Alejandra Escobar-Zepeda",
title = "Generaci√≥n de una matriz de datos de secuenciaci√≥n de ARN de c√©lulas √∫nicas utilizando Alevin (Galaxy Training Materials)",
year = "2021",
month = "10",
day = "11"
url = "\url{https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/droplet-quantification-preprocessing/tutorial_ES.html}",
note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
    doi = {10.1016/j.cels.2018.05.012},
    url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
    year = 2018,
    month = {jun},
    publisher = {Elsevier {BV}},
    volume = {6},
    number = {6},
    pages = {752--758.e1},
    author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and Bj√∂rn Gr√ºning},
    title = {Community-Driven Data Analysis Training for Biology},
    journal = {Cell Systems}
}</code>
                </pre></div></div>
                </p>
                </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                <h3><i class="far fa-thumbs-up" aria-hidden="true"></i> ¬°Felicitaciones! ¬°Completaste con √©xito este tutorial!</h3>

                

                

            </div>
        </div>
    </div>
</section>
<br/>
<br/>
<br/>

        </div>
        
    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
