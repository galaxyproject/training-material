<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>De novo transcriptome reconstruction with RNA-Seq</title>
        
            <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <link rel="stylesheet" href="/training-material/assets/fontawesome/css/all.css">
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html">
        <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="De novo transcriptome reconstruction with RNA-Seq">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2022-11-28 11:01:03 +0000">
<meta name="DC.creator" content="Mallory Freeberg">
<meta name="DC.creator" content="Mo Heydarian">

        
        
        
        
        <meta name="description" content="Training material for all kinds of transcriptomics analysis.">
        <meta property="og:site_name" content="Galaxy Training Network">
        <meta property="og:title" content="Galaxy Training: De novo transcriptome reconstruction with RNA-Seq">
        <meta property="og:description" content="Training material for all kinds of transcriptomics analysis.">
        
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png">

        
        <script type="application/ld+json">
            


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "2022-11-28 11:01:03 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "De novo transcriptome reconstruction with RNA-Seq",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "identifier": "https://github.com/galaxyproject/training-material",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Transcriptomics",
    "description": "Training material for all kinds of transcriptomics analysis.",
    "url": "https://training.galaxyproject.org/training-material/topics/transcriptomics/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'De novo transcriptome reconstruction with RNA-Seq' tutorial",
  "url": "https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html",
  "timeRequired": "PT6H",
  "keywords": "transcriptomics",
  "description": "The questions this  addresses are:\n - What genes are differentially expressed between G1E cells and megakaryocytes?\n - How can we generate a transcriptome de novo from RNA sequencing data?\n\n\nThe objectives are:\n - Analysis of RNA sequencing data using a reference genome\n - Reconstruction of transcripts without reference transcriptome (de novo)\n - Analysis of differentially expressed genes\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html",
      "name": "Quality Control",
      "description": "Slides for 'Quality Control' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html",
      "name": "Quality Control",
      "description": "Hands-on for 'Quality Control' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/mapping/slides.html",
      "name": "Mapping",
      "description": "Slides for 'Mapping' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html",
      "name": "Mapping",
      "description": "Hands-on for 'Mapping' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Transcriptomics",
      "description": "Training material for all kinds of transcriptomics analysis.",
      "url": "https://training.galaxyproject.org/training-material/topics/transcriptomics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3308",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3308",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3308"
    }
  ]
}
        </script>
        
    </head>
    <body data-spy="scroll" data-target="#toc">
        <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/transcriptomics" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Transcriptomics
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        <a class="dropdown-item" href="/training-material/topics/transcriptomics/faqs/" title="Check our FAQs for the Transcriptomics topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        
        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/transcriptomics/tutorials/de-novo/tutorial.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                    <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                    <button class="btn" data-theme="default">Default</button>
                    <button class="btn" data-theme="night">Night</button>
                    <button class="btn" data-theme="midnight">Midnight</button>
                    <button class="btn" data-theme="rainbow">Rainbow</button>
                    <button class="btn" data-theme="blm">‚úäüèø</button>
                    <button class="btn" data-theme="progress" >üè≥Ô∏è‚Äçüåà</button>
                    <button class="btn" data-theme="halloween">üéÉ</button>
                    <button class="btn" data-theme="straya">üá¶üá∫</button>
            </div>

        </div>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2023-04-01/topics/transcriptomics/tutorials/de-novo/tutorial.html" title="Version 2023-04-01">2023-04-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2023-03-01/topics/transcriptomics/tutorials/de-novo/tutorial.html" title="Version 2023-03-01">2023-03-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2023-02-01/topics/transcriptomics/tutorials/de-novo/tutorial.html" title="Version 2023-02-01">2023-02-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/" title="Older Versions">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        











<!-- Gitter -->




<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/Lobby'
  };
</script>


<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<script type="application/ld+json">
    


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "dateModified": "2022-11-28 11:01:03 +0000",
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "De novo transcriptome reconstruction with RNA-Seq",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "identifier": "https://github.com/galaxyproject/training-material",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Transcriptomics",
    "description": "Training material for all kinds of transcriptomics analysis.",
    "url": "https://training.galaxyproject.org/training-material/topics/transcriptomics/"
  },
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'De novo transcriptome reconstruction with RNA-Seq' tutorial",
  "url": "https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html",
  "timeRequired": "PT6H",
  "keywords": "transcriptomics",
  "description": "The questions this  addresses are:\n - What genes are differentially expressed between G1E cells and megakaryocytes?\n - How can we generate a transcriptome de novo from RNA sequencing data?\n\n\nThe objectives are:\n - Analysis of RNA sequencing data using a reference genome\n - Reconstruction of transcripts without reference transcriptome (de novo)\n - Analysis of differentially expressed genes\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html",
      "name": "Quality Control",
      "description": "Slides for 'Quality Control' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html",
      "name": "Quality Control",
      "description": "Hands-on for 'Quality Control' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/mapping/slides.html",
      "name": "Mapping",
      "description": "Slides for 'Mapping' tutorial",
      "learningResourceType": "slides",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html",
      "name": "Mapping",
      "description": "Hands-on for 'Mapping' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Transcriptomics",
      "description": "Training material for all kinds of transcriptomics analysis.",
      "url": "https://training.galaxyproject.org/training-material/topics/transcriptomics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3308",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3308",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3308"
    }
  ]
}
</script>

<article class="tutorial topic-transcriptomics">
    <h1 data-toc-skip>De novo transcriptome reconstruction with RNA-Seq</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/malloryfreeberg/" class="contributor-badge contributor-malloryfreeberg"><img src="https://avatars.githubusercontent.com/malloryfreeberg?s=27" alt="Avatar">Mallory Freeberg</a><a href="/training-material/hall-of-fame/moheydarian/" class="contributor-badge contributor-moheydarian"><img src="https://avatars.githubusercontent.com/moheydarian?s=27" alt="Avatar">Mo Heydarian</a>
		</td>
	</tr>
	


	

	
	<tr>
		<td><abbr title="These people edited the text, either for spelling and grammar, flow, GTN-fit, or other similar editing categories">Editor(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/jxtx/" class="contributor-badge contributor-jxtx"><img src="https://avatars.githubusercontent.com/jxtx?s=27" alt="Avatar">James Taylor</a></td>
	</tr>
	

	

	

	
</table>


	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>What genes are differentially expressed between G1E cells and megakaryocytes?</p>
</li>
        
        <li><p>How can we generate a transcriptome de novo from RNA sequencing data?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Analysis of RNA sequencing data using a reference genome</p>
</li>
        
        <li><p>Reconstruction of transcripts without reference transcriptome (de novo)</p>
</li>
        
        <li><p>Analysis of differentially expressed genes</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    <li>
    
        
        
        <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        
    
    </li>

    <li>
    
        
        
        <a href="/training-material/topics/sequence-analysis">Sequence analysis</a>
        
            <ul>
                
                    
                        
                    
                        
                            
                            <li> Quality Control:
                            
                                <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/sequence-analysis/tutorials/quality-control/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                
                    
                        
                            
                            <li> Mapping:
                            
                                <a href="/training-material/topics/sequence-analysis/tutorials/mapping/slides.html"><i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides</a>
                                
                            
                            
                                
                                    - <a href="/training-material/topics/sequence-analysis/tutorials/mapping/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

        
        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 6 hours</div>
        

        

        
        

        
        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/254485#.WKODmRIrKRu">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/transcriptomics/tutorials/de-novo/workflows/" title="De novo transcriptome reconstruction with RNA-Seq workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            
            
            
                <li class="btn btn-default supporting_material">    <a class="topic-icon" href="/training-material/topics/transcriptomics/tutorials/de-novo/faqs/" title="Frequently Asked Questions">
        <i class="far fa-question-circle" aria-hidden="true"></i> FAQs
    </a>
</li>
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            













  
<!-- GTN Video Library true -->
  
<li class="btn btn-default supporting_material">
  
    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Latest recordings of this tutorial in the GTN Video Library">
        <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span>&nbsp;Recordings
    </a>
    <ul class="dropdown-menu">
        
        

        
        
        

        <li>
            <a class="dropdown-item" href="https://gallantries.github.io/video-library/videos/transcriptomics/de-novo/tutorial" title="View GTN Video Library for this Tutorial">
                <i class="fas fa-video" aria-hidden="true"></i><span class="visually-hidden">video</span> Tutorial (February 2021)
            </a>
        </li>
        
        
        
        
    </ul>
  
</li>
  
   



            
                <li class="btn btn-default supporting_material">


    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/main/topics/transcriptomics/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://clipseq.usegalaxy.eu/" title="CLIP-Explorer">
            CLIP-Explorer
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://africa.usegalaxy.eu/" title="Galaxy Africa">
            Galaxy Africa
        </a>
        
    
        
        <a class="dropdown-item" href="https://india.usegalaxy.eu/" title="Galaxy India">
            Galaxy India
        </a>
        
    
        
    
        
        <a class="dropdown-item" href="https://test.galaxyproject.org/" title="Galaxy Test">
            Galaxy Test
        </a>
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://galaxy.genouest.org" title="Galaxy@GenOuest">
            Galaxy@GenOuest
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://humancellatlas.usegalaxy.eu/" title="Human Cell Atlas">
            Human Cell Atlas
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://plants.usegalaxy.eu/" title="Plant Anaylsis Workbench">
            Plant Anaylsis Workbench
        </a>
        
    
        
    
        
    
        
        <a class="dropdown-item" href="https://singlecell.usegalaxy.eu/" title="Single Cell Omics workbench">
            Single Cell Omics workbench
        </a>
        
    
        
        <a class="dropdown-item" href="https://streetscience.usegalaxy.eu/" title="Street Science">
            Street Science
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.be/" title="UseGalaxy.be">
            UseGalaxy.be
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.eu" title="UseGalaxy.eu">
            UseGalaxy.eu
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.fr/" title="UseGalaxy.fr">
            UseGalaxy.fr
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.no/" title="UseGalaxy.no">
            UseGalaxy.no
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.org" title="UseGalaxy.org (Main)">
            UseGalaxy.org (Main)
        </a>
        
    
        
        <a class="dropdown-item" href="https://usegalaxy.org.au" title="UseGalaxy.org.au">
            UseGalaxy.org.au
        </a>
        
    
        
    
        
    
        
    
        
    
    </ul>


</li>
            
        </ul>
        

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Nov 28, 2022 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
            
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Tutorial Content is licensed under Creative Commons Attribution 4.0 International License</a>
            
            <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">The GTN Framework is licensed under MIT</a>
        </div>
    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <h1 id="introduction">Introduction</h1>

<p>The data provided here are part of a Galaxy tutorial that analyzes RNA-seq data from a study published by <em>Wu et al.</em> in 2014 <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4248312/">DOI:10.1101/gr.164830.113</a>. The goal of this study was to investigate ‚Äúthe dynamics of occupancy and the role in gene regulation of the transcription factor Tal1, a critical regulator of hematopoiesis, at multiple stages of hematopoietic differentiation.‚Äù To this end, RNA-seq libraries were constructed from multiple mouse cell types including G1E - a GATA-null immortalized cell line derived from targeted disruption of GATA-1 in mouse embryonic stem cells - and megakaryocytes. This RNA-seq data was used to determine differential gene expression between G1E and megakaryocytes and later correlated with Tal1 occupancy. This dataset (GEO Accession: GSE51338) consists of biological replicate, paired-end, poly(A) selected RNA-seq libraries. Because of the long processing time for the large original files, we have downsampled the original raw data files to include only reads that align to chromosome 19 and a subset of interesting genomic loci identified by Wu <em>et al</em>.</p>

<h1 id="analysis-strategy">Analysis strategy</h1>

<p>The goal of this exercise is to identify what transcripts are present in the G1E and megakaryocyte cellular states and which transcripts are differentially expressed between the two states. We will use a <em>de novo</em> transcript reconstruction strategy to infer transcript structures from the mapped reads in the absence of the actual annotated transcript structures. This will allow us to identify novel transcripts and novel isoforms of known transcripts, as well as identify differentially expressed transcripts.</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will deal with:</p>

<ol id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#analysis-strategy" id="markdown-toc-analysis-strategy">Analysis strategy</a>    <ol>
      <li><a href="#data-upload" id="markdown-toc-data-upload">Data upload</a></li>
      <li><a href="#quality-control" id="markdown-toc-quality-control">Quality control</a></li>
    </ol>
  </li>
  <li><a href="#mapping" id="markdown-toc-mapping">Mapping</a></li>
  <li><a href="#de-novo-transcript-reconstruction" id="markdown-toc-de-novo-transcript-reconstruction">De novo transcript reconstruction</a></li>
  <li><a href="#transcriptome-assembly" id="markdown-toc-transcriptome-assembly">Transcriptome assembly</a></li>
  <li><a href="#analysis-of-the-differential-gene-expression" id="markdown-toc-analysis-of-the-differential-gene-expression">Analysis of the differential gene expression</a>    <ol>
      <li><a href="#count-the-number-of-reads-per-transcript" id="markdown-toc-count-the-number-of-reads-per-transcript">Count the number of reads per transcript</a></li>
      <li><a href="#perform-differential-gene-expression-testing" id="markdown-toc-perform-differential-gene-expression-testing">Perform differential gene expression testing</a></li>
    </ol>
  </li>
  <li><a href="#visualization" id="markdown-toc-visualization">Visualization</a></li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ol>

</blockquote>

<h2 id="data-upload">Data upload</h2>

<p>Due to the large size of this dataset, we have downsampled it to only include reads mapping to chromosome 19 and certain loci with relevance to hematopoeisis. This data is available at <a href="https://zenodo.org/record/583140#.WSW3NhPyub8"><code class="language-plaintext highlighter-rouge">Zenodo</code></a>, where you can find the forward and reverse reads corresponding to replicate RNA-seq libraries from G1E and megakaryocyte cells and an annotation file of RefSeq transcripts we will use to generate our transcriptome database.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-data-upload"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Data upload</div>

  <ol>
    <li>
      <p>Create a new history for this RNA-seq exercise</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Creating a new history<span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel.</p>   <p>If the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> is missing:</p>   <ol>   <li>Click on the <i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> icon (<strong>History options</strong>) on the top of the history panel</li>   <li>Select the option <strong>Create New</strong> from the menu</li> </ol> </blockquote>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Renaming a history<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is ‚ÄúUnnamed history‚Äù)</li>   <li>Type the new name</li>   <li>Click on <strong>Save</strong></li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name</li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
    </li>
    <li>Open the data upload manager (Get Data -&gt; Upload file)</li>
    <li>Copy and paste the links for the reads and annotation file</li>
    <li>Select <strong>Paste/Fetch Data</strong></li>
    <li>Paste the link(s) into the text field</li>
    <li>Change the datatype of the read files to <strong>fastqsanger</strong></li>
    <li>Change the datatype of the annotation file to <strong>gtf</strong> and assign the Genome as <strong>mm10</strong></li>
    <li>Press <strong>Start</strong></li>
    <li>
      <p>Rename the files in your history to retain just the necessary information (<em>e.g.</em> ‚ÄúG1E R1 forward reads‚Äù)</p>
    </li>
    <li>
      <p>Import the data from <a href="https://zenodo.org/record/583140">Zenodo</a> <a href="https://zenodo.org/record/583140"><img src="https://zenodo.org/badge/DOI/10.123/GTNdenovoRNAseq.svg" alt="DOI. " loading="lazy" /></a></p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/583140/files/G1E_rep1_forward_read_%28SRR549355_1%29
https://zenodo.org/record/583140/files/G1E_rep1_reverse_read_%28SRR549355_2%29
https://zenodo.org/record/583140/files/G1E_rep2_forward_read_%28SRR549356_1%29
https://zenodo.org/record/583140/files/G1E_rep2_reverse_read_%28SRR549356_2%29
https://zenodo.org/record/583140/files/Megakaryocyte_rep1_forward_read_%28SRR549357_1%29
https://zenodo.org/record/583140/files/Megakaryocyte_rep1_reverse_read_%28SRR549357_2%29
https://zenodo.org/record/583140/files/Megakaryocyte_rep2_forward_read_%28SRR549358_1%29
https://zenodo.org/record/583140/files/Megakaryocyte_rep2_reverse_read_%28SRR549358_2%29
https://zenodo.org/record/583140/files/RefSeq_reference_GTF_%28DSv2%29
</code></pre></div>      </div>

      <p>You will need to fetch the link to the annotation file yourself ;)</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> Tip: Importing via links<span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Open the Galaxy Upload Manager (<i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> on the top-right of the tool panel)</p>   </li>   <li>Select <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link into the text field</p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
    </li>
  </ol>

</blockquote>

<h2 id="quality-control">Quality control</h2>

<p>For quality control, we use similar tools as described in <a href="/training-material/topics/sequence-analysis/">NGS-QC tutorial</a>: <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FastQC</a> and <a href="http://www.usadellab.org/cms/?page=trimmomatic">Trimmomatic</a>.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-quality-control"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Quality control</div>

  <ol>
    <li>
      <p><strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">FastQC</code> on the forward and reverse read files to assess the quality of the reads.</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true"></i> Question</div>

        <ol>
          <li>What is the read length?</li>
          <li>Is there anything interesting about the quality of the base calls based on the position in the reads?</li>
        </ol>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true"></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <ol>
            <li>The read length is 99 bp</li>
            <li>The quality of base calls declines throughout a sequencing run.</li>
          </ol>
        </blockquote>
      </blockquote>
    </li>
    <li>
      <p><strong>Trimmomatic</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Trim off the low quality bases from the ends of the reads to increase mapping efficiency. Run <code class="language-plaintext highlighter-rouge">Trimmomatic</code> on each pair of forward and reverse reads with the following settings:</p>

      <ul>
        <li><em>‚ÄúSingle-end or paired-end reads?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Paired-end (two separate input files)</code>
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput FASTQ file (R1/first of pair)‚Äù</em>: <code class="language-plaintext highlighter-rouge">G1E_rep1 forward read</code></li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúInput FASTQ file (R2/second of pair)‚Äù</em>: <code class="language-plaintext highlighter-rouge">G1E_rep1 reverse read</code></li>
          </ul>
        </li>
        <li><em>‚ÄúPerform initial ILLUMINACLIP step?‚Äù</em>: <code class="language-plaintext highlighter-rouge">No</code></li>
      </ul>
    </li>
    <li>
      <p><strong>FastQC</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Re-run <code class="language-plaintext highlighter-rouge">FastQC</code> on trimmed reads and inspect the differences.</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true"></i> Question</div>

        <ol>
          <li>What is the read length?</li>
          <li>Is there anything interesting about the quality of the base calls based on the position in the reads?</li>
        </ol>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true"></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <ol>
            <li>The read lengths range from 1 to 99 bp after trimming</li>
            <li>The average quality of base calls does not drop off as sharply at the 3‚Äô ends of reads.</li>
          </ol>
        </blockquote>
      </blockquote>
      <p><img src="../../images/transcriptomics_images/BeforeAndAfterTrimming.png" alt="Before and after trimming comparison. " loading="lazy" /></p>
    </li>
    <li>
      <p><strong>Trimmomatic</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">Trimmomatic</code> on the remaining forward/reverse read pairs with the same parameters.</p>
    </li>
  </ol>

</blockquote>

<p>Now that we have trimmed our reads and are fortunate that there is a reference genome assembly for mouse, we will align our trimmed reads to the genome.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment</div>

  <p>Instead of running a single tool multiple times on all your data, would you rather run a single tool on multiple datasets at once? Check out the <a href="https://galaxyproject.org/tutorials/collections/">dataset collections</a> feature of Galaxy!</p>
</blockquote>

<h1 id="mapping">Mapping</h1>

<p>To make sense of the reads, their positions within mouse genome must be determined. This process is known as aligning or ‚Äòmapping‚Äô the reads to the reference genome.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-1"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment</div>

  <p>Do you want to learn more about the principles behind mapping? Follow our <a href="/training-material/topics/sequence-analysis/">training</a></p>
</blockquote>

<p>In the case of a eukaryotic transcriptome, most reads originate from processed mRNAs lacking introns. Therefore, they cannot be simply mapped back to the genome as we normally do for reads derived from DNA sequences. Instead, the reads must be separated into two categories:</p>

<ul>
  <li>Reads contained within mature exons - these align perfectly to the reference genome</li>
  <li>Reads that span splice junctions in the mature mRNA - these align with gaps to the reference genome</li>
</ul>

<p>Spliced mappers have been developed to efficiently map transcript-derived reads against genomes. <a href="https://ccb.jhu.edu/software/hisat2/index.shtml"><code class="language-plaintext highlighter-rouge">HISAT</code></a> is an accurate and fast tool for mapping spliced reads to a genome. Another popular spliced aligner is <a href="https://ccb.jhu.edu/software/tophat/index.shtml"><code class="language-plaintext highlighter-rouge">TopHat</code></a>, but we will be using <code class="language-plaintext highlighter-rouge">HISAT</code> in this tutorial.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-2"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment</div>
  <p>As it is sometimes quite difficult to determine which settings correspond to those of other programs, the following table might be helpful to identify the library type:</p>

  <table>
    <thead>
      <tr>
        <th>Library type</th>
        <th><strong>Infer Experiment</strong></th>
        <th><strong>TopHat</strong></th>
        <th><strong>HISAT</strong></th>
        <th><strong>htseq-count</strong></th>
        <th><strong>featureCounts</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>PE</td>
        <td>1++,1‚Äì,2+-,2-+</td>
        <td>FR Second Strand</td>
        <td>FR</td>
        <td>yes</td>
        <td>1</td>
      </tr>
      <tr>
        <td>PE</td>
        <td>1+-,1-+,2++,2‚Äì</td>
        <td>FR First Strand</td>
        <td>RF</td>
        <td>reverse</td>
        <td>2</td>
      </tr>
      <tr>
        <td>SE</td>
        <td>++,‚Äì</td>
        <td>FR Second Strand</td>
        <td>F</td>
        <td>yes</td>
        <td>1</td>
      </tr>
      <tr>
        <td>SE</td>
        <td>+-,-+</td>
        <td>FR First Strand</td>
        <td>R</td>
        <td>reverse</td>
        <td>2</td>
      </tr>
      <tr>
        <td>SE,PE</td>
        <td>undecided</td>
        <td>FR Unstranded</td>
        <td>default</td>
        <td>no</td>
        <td>0</td>
      </tr>
    </tbody>
  </table>

</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-spliced-mapping"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Spliced mapping</div>

  <ol>
    <li><strong>HISAT2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">HISAT2</code> on one forward/reverse read pair and modify the following settings:
      <ul>
        <li><em>‚ÄúSource for the reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">Use a built-in genome</code>
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSelect a reference genome‚Äù</em>: <code class="language-plaintext highlighter-rouge">Mouse (Mus Musculus): mm10</code></li>
          </ul>
        </li>
        <li><em>‚ÄúSingle-end or paired-end reads?‚Äù</em>: <code class="language-plaintext highlighter-rouge">Paired-end</code>
          <ul>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFASTA/Q file #1‚Äù</em>: Trimmomatic on G1E_rep1 forward read (R1 paired)</li>
            <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúFASTA/Q file #2‚Äù</em>: Trimmomatic on G1E_rep1 reverse read (R2 paired)</li>
            <li><em>‚ÄúSpecify strand information‚Äù</em>: <code class="language-plaintext highlighter-rouge">Forward(FR)</code></li>
          </ul>
        </li>
        <li><em>‚ÄúAdvanced options‚Äù</em>
          <ul>
            <li><em>‚ÄúSpliced alignment options‚Äù</em>
              <ul>
                <li><em>‚ÄúPenalty for non-canonical splice sites‚Äù</em>: ‚Äò3‚Äô</li>
                <li><em>‚ÄúPenalty function for long introns with canonical splice sites‚Äù</em>: ‚ÄòConstant [f(x) = B]‚Äô‚Äô</li>
                <li><em>‚ÄúConstant term (B)‚Äù</em>: ‚Äò0.0‚Äô</li>
                <li><em>‚ÄúPenalty function for long introns with non-canonical splice sites‚Äù</em>: ‚ÄòConstant [f(x) = B]‚Äô‚Äô</li>
                <li><em>‚ÄúTranscriptome assembly reporting‚Äù</em>: ‚ÄòReport alignments tailored for transcript assemblers including StringTie‚Äô</li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><strong>HISAT2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">HISAT2</code> on the remaining forward/reverse read pairs with the same parameters.</li>
  </ol>

</blockquote>

<h1 id="de-novo-transcript-reconstruction">De novo transcript reconstruction</h1>
<p>Now that we have mapped our reads to the mouse genome with <code class="language-plaintext highlighter-rouge">HISAT</code>, we want to determine transcript structures that are represented by the aligned reads. This is called <em>de novo</em> transcriptome reconstruction. This unbiased approach permits the comprehensive identification of all transcripts present in a sample, including annotated genes, novel isoforms of annotated genes, and novel genes. While common gene/transcript databases are quite large, they are not comprehensive, and the <em>de novo</em> transcriptome reconstruction approach ensures complete transcriptome(s) identification from the experimental samples. The leading tool for transcript reconstruction is <code class="language-plaintext highlighter-rouge">Stringtie</code>. Here, we will use <code class="language-plaintext highlighter-rouge">Stringtie</code> to predict transcript structures based on the reads aligned by <code class="language-plaintext highlighter-rouge">HISAT</code>.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-transcriptome-reconstruction"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Transcriptome reconstruction</div>

  <ol>
    <li><strong>Stringtie</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">Stringtie</code> on the <code class="language-plaintext highlighter-rouge">HISAT2</code> alignments using the default parameters.
      <ul>
        <li>Use batch mode to run all four samples from one tool form.</li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúSpecify strand information‚Äù</em>: <code class="language-plaintext highlighter-rouge">Forward (FR)</code></li>
      </ul>
    </li>
  </ol>

</blockquote>

<h1 id="transcriptome-assembly">Transcriptome assembly</h1>

<p>We just generated four transcriptomes with <code class="language-plaintext highlighter-rouge">Stringtie</code> representing each of the four RNA-seq libraries we are analyzing. Since these were generated in the absence of a reference transcriptome, and we ultimately would like to know what transcript structure corresponds to which annotated transcript (if any), we have to make a <strong>transcriptome database</strong>. We will use the tool <code class="language-plaintext highlighter-rouge">Stringtie - Merge</code> to combine redundant transcript structures across the four samples and the RefSeq reference. Once we have merged our transcript structures, we will use <code class="language-plaintext highlighter-rouge">GFFcompare</code> to annotate the transcripts of our newly created transcriptome so we know the relationship of each transcript to the RefSeq reference.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-transcriptome-assembly"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Transcriptome assembly</div>

  <ol>
    <li><strong>Stringtie-merge</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">Stringtie-merge</code> on the <code class="language-plaintext highlighter-rouge">Stringtie</code> assembled transcripts along with the RefSeq annotation file we imported earlier.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúTranscripts‚Äù</em>: <code class="language-plaintext highlighter-rouge">all four </code>Stringtie<code class="language-plaintext highlighter-rouge"> assemblies</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúReference annotation to include in the merging‚Äù</em>: <code class="language-plaintext highlighter-rouge">RefSeq_reference_GTF</code></li>
      </ul>
    </li>
    <li><strong>GFFCompare</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">GFFCompare</code> on the <code class="language-plaintext highlighter-rouge">Stringtie-merge</code> generated transcriptome along with the RefSeq annotation file.
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGTF inputs for comparison‚Äù</em>: <code class="language-plaintext highlighter-rouge">output of Stringtie-merge</code></li>
        <li><em>‚ÄúUse Reference Annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code>
          <ul>
            <li><em>‚ÄúChoose the source for the reference annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">History</code>
              <ul>
                <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúReference Annotation‚Äù</em>: <code class="language-plaintext highlighter-rouge">RefSeq_reference_GTF</code></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><em>‚ÄúUse Sequence Data‚Äù</em>: <code class="language-plaintext highlighter-rouge">Yes</code>
          <ul>
            <li><em>‚ÄúChoose the source for the reference list‚Äù</em>: <code class="language-plaintext highlighter-rouge">Locally cached</code>
              <ul>
                <li><em>‚ÄúUsing reference genome‚Äù</em>: ‚ÄòMouse (Mus Musculus): mm10‚Äô</li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>

</blockquote>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-note-transcript-categorization-used-by-gffcompare"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment: Note: Transcript categorization used by `GFFcompare`</div>

  <table>
    <thead>
      <tr>
        <th style="text-align: center"><strong>Class code</strong></th>
        <th style="text-align: left"><strong>Transcript category</strong></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="text-align: center">=</td>
        <td style="text-align: left">Annotated in reference</td>
      </tr>
      <tr>
        <td style="text-align: center">j</td>
        <td style="text-align: left">Novel isoform of reference</td>
      </tr>
      <tr>
        <td style="text-align: center">u</td>
        <td style="text-align: left">Intergenic</td>
      </tr>
      <tr>
        <td style="text-align: center">x</td>
        <td style="text-align: left">Anti-sense</td>
      </tr>
      <tr>
        <td style="text-align: center">r</td>
        <td style="text-align: left">Repetitive</td>
      </tr>
      <tr>
        <td style="text-align: center">c</td>
        <td style="text-align: left">Contained in exon of reference</td>
      </tr>
      <tr>
        <td style="text-align: center">s</td>
        <td style="text-align: left">Anti-sense spliced intronic</td>
      </tr>
      <tr>
        <td style="text-align: center">e</td>
        <td style="text-align: left">Single exon transfrag overlapping a reference exon and at least 10 bp of a reference intron, indicating a possible pre-mRNA fragment.</td>
      </tr>
      <tr>
        <td style="text-align: center">i</td>
        <td style="text-align: left">A transfrag falling entirely within a reference intron</td>
      </tr>
      <tr>
        <td style="text-align: center">o</td>
        <td style="text-align: left">Generic exonic overlap with a reference transcript</td>
      </tr>
      <tr>
        <td style="text-align: center">p</td>
        <td style="text-align: left">Possible polymerase run-on fragment (within 2Kbases of a reference transcript)</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h1 id="analysis-of-the-differential-gene-expression">Analysis of the differential gene expression</h1>

<p>We just generated a transriptome database that represents the transcripts present in the G1E and megakaryocytes samples. This database provides the location of our transcripts with non-redundant identifiers, as well as information regarding the origin of the transcript.</p>

<p>We now want to identify which transcripts are differentially expressed between the G1E and megakaryocyte cellular states. To do this we will implement a counting approach using <code class="language-plaintext highlighter-rouge">FeatureCounts</code> to count reads per transcript. Then we will provide this information to <code class="language-plaintext highlighter-rouge">DESeq2</code> to generate normalized transcript counts (abundance estimates) and significance testing for differential expression.</p>

<h2 id="count-the-number-of-reads-per-transcript">Count the number of reads per transcript</h2>

<p>To compare the abundance of transcripts between different cellular states, the first essential step is to quantify the number of reads per transcript. <a href="http://bioinf.wehi.edu.au/featureCounts/"><code class="language-plaintext highlighter-rouge">FeatureCounts</code></a> is one of the most popular tools for counting reads in genomic features. In our case, we‚Äôll be using <code class="language-plaintext highlighter-rouge">FeatureCounts</code> to count reads aligning in exons of our <code class="language-plaintext highlighter-rouge">GFFCompare</code> generated transcriptome database.</p>

<p>The recommended mode is ‚Äúunion‚Äù, which counts overlaps even if a read only shares parts of its sequence with a genomic feature and disregards reads that overlap more than one feature.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-counting-the-number-of-reads-per-transcript"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Counting the number of reads per transcript</div>

  <ol>
    <li>
      <p><strong>FeatureCounts</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">FeatureCounts</code> on the aligned reads (<code class="language-plaintext highlighter-rouge">HISAT2</code> output) using the <code class="language-plaintext highlighter-rouge">GFFCompare</code> transcriptome database as the annotation file.</p>

      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúAlignment file‚Äù</em>: <code class="language-plaintext highlighter-rouge">four HISAT2 aligned read files</code></li>
        <li><em>‚ÄúSpecify strand information‚Äù</em>: <code class="language-plaintext highlighter-rouge">Stranded (Forward)</code></li>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúGene annotation file‚Äù</em>: <code class="language-plaintext highlighter-rouge">in your history</code>
          <ul>
            <li><em>‚ÄúGene annotation file‚Äù</em>: <code class="language-plaintext highlighter-rouge">the annotated transcripts GTF file output by GFFCompare</code></li>
          </ul>
        </li>
        <li><em>‚ÄúOptions for paired-end reads‚Äù</em>
          <ul>
            <li><em>‚ÄúCount fragments instead of reads‚Äù</em>: <code class="language-plaintext highlighter-rouge">Enabled; fragments (or templates) wil be counted instead of reads</code></li>
          </ul>
        </li>
        <li><em>‚ÄúAdvanced options‚Äù</em>
          <ul>
            <li><em>‚ÄúGFF gene identifier‚Äù</em>: <code class="language-plaintext highlighter-rouge">transcript_id</code></li>
          </ul>
        </li>
      </ul>
    </li>
  </ol>

</blockquote>

<h2 id="perform-differential-gene-expression-testing">Perform differential gene expression testing</h2>

<p>Transcript expression is estimated from read counts, and attempts are made to correct for variability in measurements using replicates. This is absolutely essential to obtaining accurate results. We recommend having at least two biological replicates.</p>

<p><a href="https://bioconductor.org/packages/release/bioc/html/DESeq2.html"><code class="language-plaintext highlighter-rouge">DESeq2</code></a> is a great tool for differential gene expression analysis. It accepts read counts produced by <code class="language-plaintext highlighter-rouge">FeatureCounts</code> and applies size factor normalization:</p>

<ul>
  <li>Computation for each gene of the geometric mean of read counts across all samples</li>
  <li>Division of every gene count by the geometric mean</li>
  <li>Use of the median of these ratios as sample‚Äôs size factor for normalization</li>
</ul>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on</div>

  <ol>
    <li><strong>DESeq2</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">DESeq2</code> with the following parameters:
      <ul>
        <li><em>‚Äú1: Factor‚Äù</em>
          <ul>
            <li><em>‚Äú1: Factor level‚Äù</em>: <code class="language-plaintext highlighter-rouge">G1E</code>
              <ul>
                <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúCounts file(s)‚Äù</em>: <code class="language-plaintext highlighter-rouge">featureCount files corresponding to the two G1E replicates</code></li>
              </ul>
            </li>
            <li><em>‚Äú2: Factor level‚Äù</em>: <code class="language-plaintext highlighter-rouge">Mega</code>
              <ul>
                <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>‚ÄúCounts file(s)‚Äù</em>: <code class="language-plaintext highlighter-rouge">featureCount files corresponding to the two Mega replicates</code></li>
              </ul>
            </li>
          </ul>

          <blockquote class="comment">
            <div class="box-title comment-title" id="comment-3"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment</div>

            <p>You can select several files by holding down the CTRL (or COMMAND) key and clicking on the desired files</p>
          </blockquote>
        </li>
        <li><em>‚ÄúVisualising the analysis results‚Äù</em>: Yes</li>
        <li><em>‚ÄúOutput normalized counts table‚Äù</em>: Yes</li>
      </ul>
    </li>
  </ol>

</blockquote>

<p>The first output of <code class="language-plaintext highlighter-rouge">DESeq2</code> is a tabular file. The columns are:</p>

<ol>
  <li>Gene identifiers</li>
  <li>Mean normalized counts, averaged over all samples from both conditions</li>
  <li>Logarithm (base 2) of the fold change (the values correspond to up- or downregulation relative to the condition listed as Factor level 1)</li>
  <li>Standard error estimate for the log2 fold change estimate</li>
  <li><a href="http://data.princeton.edu/wws509/notes/c2s3.html">Wald</a> statistic</li>
  <li><em>p</em>-value for the statistical significance of this change</li>
  <li><em>p</em>-value adjusted for multiple testing with the Benjamini-Hochberg procedure which controls false discovery rate (<a href="http://www.biostathandbook.com/multiplecomparisons.html">FDR</a>)</li>
</ol>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-1"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on</div>

  <ol>
    <li>
      <p><strong>Filter</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">Filter</code> to extract genes with a significant change in gene expression (adjusted <em>p</em>-value less than 0.05) between treated and untreated samples</p>

      <blockquote class="question">
        <div class="box-title question-title" id="question-2"><i class="far fa-question-circle" aria-hidden="true"></i> Question</div>

        <p>How many transcripts have a significant change in expression between these conditions?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true"></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <p>To filter, use ‚Äúc7&lt;0.05‚Äù. And we get 249 transcripts with a significant change in gene expression between the G1E and megakaryocyte cellular states.</p>
        </blockquote>
      </blockquote>
    </li>
    <li>
      <p><strong>Filter</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Determine how many transcripts are up or down regulated in the G1E state.</p>

      <blockquote class="comment">
        <div class="box-title comment-title" id="comment-4"><i class="far fa-comment-dots" aria-hidden="true"></i> Comment</div>
        <p>Rename your datasets for the downstream analyses</p>
      </blockquote>

      <blockquote class="question">
        <div class="box-title question-title" id="question-3"><i class="far fa-question-circle" aria-hidden="true"></i> Question</div>

        <p>Are there more upregulated or downregulated genes in the treated samples?</p>

        <blockquote class="solution">
          <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true"></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
          <p>To obtain the up-regulated genes in the G1E state, we filter the previously generated file (with the significant change in transcript expression) with the expression ‚Äúc3&gt;0‚Äù (the log2 fold changes must be greater than 0). We obtain 102  genes (40.9% of the genes with a significant change in gene expression). For the down-regulated genes in the G1E state, we did the inverse and we find 149 transcripts (59% of the genes with a significant change in transcript expression).</p>
        </blockquote>
      </blockquote>
    </li>
  </ol>
</blockquote>

<p>In addition to the list of genes, <code class="language-plaintext highlighter-rouge">DESeq2</code> outputs a graphical summary of the results, useful to evaluate the quality of the experiment:</p>

<ol>
  <li>
    <p>Histogram of <em>p</em>-values for all tests</p>

    <p><img src="/training-material/topics/transcriptomics/images/transcriptomics_images/Deseq2_histogram3.png" alt="DESeq2 histogram. " loading="lazy" /></p>
  </li>
  <li>
    <p><a href="https://en.wikipedia.org/wiki/MA_plot">MA plot</a>: global view of the relationship between the expression change of conditions (log ratios, M), the average expression strength of the genes (average mean, A), and the ability of the algorithm to detect differential gene expression. The genes that passed the significance threshold (adjusted p-value &lt; 0.1) are colored in red.</p>

    <p><img src="/training-material/topics/transcriptomics/images/transcriptomics_images/Deseq2_MAplot3.png" alt="MA plot. " loading="lazy" /></p>
  </li>
  <li>
    <p>Principal Component Analysis (<a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a>) and the first two axes</p>

    <p><img src="/training-material/topics/transcriptomics/images/transcriptomics_images/Deseq2_PCA3.png" alt="Principal component analysis output. " loading="lazy" /></p>

    <p>Each replicate is plotted as an individual data point. This type of plot is useful for visualizing the overall effect of experimental covariates and batch effects.</p>
  </li>
  <li>
    <p>Heatmap of sample-to-sample distance matrix: overview over similarities and dissimilarities between samples</p>

    <p><img src="/training-material/topics/transcriptomics/images/transcriptomics_images/Deseq2_heatmap3.png" alt="Heatmap of sample-to-sample distance matrix. " loading="lazy" /></p>
  </li>
  <li>
    <p>Dispersion estimates: gene-wise estimates (black), the fitted values (red), and the final maximum a posteriori estimates used in testing (blue)</p>

    <p><img src="/training-material/topics/transcriptomics/images/transcriptomics_images/Deseq2_dispersion3.png" alt="Dispersion estimates. " loading="lazy" /></p>

    <p>This dispersion plot is typical, with the final estimates shrunk from the gene-wise estimates towards the fitted estimates. Some gene-wise estimates are flagged as outliers and not shrunk towards the fitted value. The amount of shrinkage can be more or less than seen here, depending on the sample size, the number of coefficients, the row mean and the variability of the gene-wise estimates.</p>
  </li>
</ol>

<p>For more information about <code class="language-plaintext highlighter-rouge">DESeq2</code> and its outputs, you can have a look at <a href="https://www.bioconductor.org/packages/release/bioc/manuals/DESeq2/man/DESeq2.pdf"><code class="language-plaintext highlighter-rouge">DESeq2</code> documentation</a>.</p>

<h1 id="visualization">Visualization</h1>
<p>Now that we have a list of transcript expression levels and their differential expression levels, it is time to visually inspect our transcript structures and the reads they were predicted from. It is a good practice to visually inspect (and present) loci with transcripts of interest. Fortunately, there is a built-in genome browser in Galaxy, <strong>Trackster</strong>, that make this task simple (and even fun!).</p>

<p>In this last section, we will convert our aligned read data from BAM format to bigWig format to simplify observing where our stranded RNA-seq data aligned to. We‚Äôll then initiate a session on Trackster, load it with our data, and visually inspect our interesting loci.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-converting-aligned-read-files-to-bigwig-format"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Converting aligned read files to bigWig format</div>

  <ol>
    <li><strong>bamCoverage</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Run <code class="language-plaintext highlighter-rouge">bamCoverage</code> on all four aligned read files (<code class="language-plaintext highlighter-rouge">HISAT2</code> output) with the following parameters:
      <ul>
        <li><em>‚ÄúBin size in bases‚Äù</em>: ‚Äò1‚Äô</li>
        <li><em>‚ÄúEffective genome size‚Äù</em>: ‚Äòmm9 (2150570000)‚Äô‚Äô</li>
        <li><em>‚ÄúAdvanced options‚Äù</em>
          <ul>
            <li><em>‚ÄúOnly include reads originating from fragments from the forward or reverse strand‚Äù</em>: ‚Äòforward‚Äô</li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      <p><strong>Rename</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Rename the outputs to reflect the origin of the reads and that they represent the reads mapping to the PLUS strand.</p>
    </li>
    <li><strong>bamCoverage</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Repeat Step 1 except changing the following parameter:
      <ul>
        <li><em>‚ÄúOnly include reads originating from fragments from the forward or reverse strand‚Äù</em>: ‚Äòreverse‚Äô</li>
      </ul>
    </li>
    <li><strong>Rename</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Rename the outputs to reflect the origin of the reads and that they represent the reads mapping to the MINUS strand.</li>
  </ol>
</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-trackster-based-visualization"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Trackster based visualization</div>

  <ol>
    <li><strong>Viz</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: On the center console at the top of the Galaxy interface, choose ‚Äú Visualization‚Äù -&gt; ‚ÄúNew track browser‚Äù
      <ul>
        <li>Name your visualization someting descriptive under ‚ÄúBrowser name:‚Äù</li>
        <li>Choose ‚ÄúMouse Dec. 2011 (GRCm38/mm10) (mm10)‚Äù as the ‚ÄúReference genome build (dbkey)</li>
        <li>Click ‚ÄúCreate‚Äù to initiate your Trackster session
<img src="../../images/transcriptomics_images/Trackster_opening_window.png" alt="Trackster opening window. " loading="lazy" /></li>
      </ul>
    </li>
    <li><strong>Viz</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Click ‚ÄúAdd datasets to visualization‚Äù
      <ul>
        <li>Select the ‚ÄúRefSeq GTF mm10‚Äù file</li>
        <li>Select the output files from <code class="language-plaintext highlighter-rouge">Stringtie</code></li>
        <li>Select the output file from <code class="language-plaintext highlighter-rouge">GFFCompare</code></li>
        <li>Select the output files from <code class="language-plaintext highlighter-rouge">bamCoverage</code></li>
      </ul>
    </li>
    <li>
      <p><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Using the grey labels on the left side of each track, drag and arrange the track order to your preference.</p>
    </li>
    <li><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Hover over the grey label on the left side of the ‚ÄúRefSeq GTF mm10‚Äù track and click the ‚ÄúEdit settings‚Äù icon.
      <ul>
        <li>Adjust the block color to blue (#0000ff) and antisense strand color to red (#ff0000)</li>
      </ul>
    </li>
    <li>
      <p><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Repeat the previous step on the output files from <code class="language-plaintext highlighter-rouge">StringTie</code> and <code class="language-plaintext highlighter-rouge">GFFCompare</code>.</p>
    </li>
    <li><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Hover over the grey label on the left side of the ‚ÄúG1E R1 plus‚Äù track and click the ‚ÄúEdit settings‚Äù icon.
      <ul>
        <li>Adjust the color to blue (#0000ff)</li>
      </ul>
    </li>
    <li>
      <p><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Repeat the previous step on the other three bigWig files representing the plus strand.</p>
    </li>
    <li><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Hover over the grey label on the left side of the ‚ÄúG1E R1 minus‚Äù track and click the ‚ÄúEdit settings‚Äù icon.
      <ul>
        <li>Adjust the color to red (#ff0000)</li>
      </ul>
    </li>
    <li>
      <p><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Repeat the previous step on the other three bigWig files representing the minus strand.</p>
    </li>
    <li><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Adjust the track height of the bigWig files to be consistent for each set of plus strand and minus strand tracks.
<img src="../../images/transcriptomics_images/Hoxb13_locus_screenshot.png" alt="Adjusting the track height. " loading="lazy" /></li>
    <li><i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>: Direct Trackster to the coordinates: chr11:96191452-96206029, what do you see?</li>
  </ol>

  <blockquote class="question">
    <div class="box-title question-title" id="question-4"><i class="far fa-question-circle" aria-hidden="true"></i> Question</div>
    <p>what do you see?</p>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-4"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-4" aria-expanded="true"><i class="far fa-eye" aria-hidden="true"></i> Solution<span class="fold-unfold fa fa-minus-square"></span></button></div>
      <ol>
        <li>There are two clusters of transcripts that are exclusively expressed in the G1E background</li>
        <li>The left-most transcript is the Hoxb13 transcript</li>
        <li>The center cluster of transcripts are not present in the RefSeq annotation and are determined by <code class="language-plaintext highlighter-rouge">GFFCompare</code> to be ‚Äúu‚Äù and ‚Äúx‚Äù</li>
      </ol>
    </blockquote>
  </blockquote>

</blockquote>

<h1 id="conclusion">Conclusion</h1>

<p>In this tutorial, we have analyzed RNA sequencing data to extract useful information, such as which genes are expressed in the G1E and megakaryocyte cellular states and which of these genes are differentially expressed between the two cellular states. In addition, we identified unannotated genes that are expressed in a cell-state dependent manner and at a locus with relevance to differentiation and development. To identify these transcripts, we analyzed RNA sequence datasets using a de novo transcriptome reconstruction RNA-seq data analysis approach. This approach can be summed up with the following scheme:</p>

<p><img src="../../images/transcriptomics_images/schematic_for_RNAseq_de_novo_tutorial.png" alt="RNAseq de novo tutorial workflow. " loading="lazy" /></p>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>De novo transcriptome reconstruction is the ideal approach for identifying differentially expressed known and novel transcripts.</p>
</li>
                        
                        <li><p>Differential gene expression testing is improved with the use of replicate experiments and deep sequence coverage.</p>
</li>
                        
                        <li><p>Visualizing data on a genome browser is a great way to display interesting patterns of differential expression.</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the <a href="faqs/">tutorial FAQ page</a> or the  <a href="/training-material/topics/transcriptomics/faqs/">FAQ page for the Transcriptomics topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                
                <h1 data-toc-skip>Useful literature</h1>
                <p>Further information, including links to documentation and original publications, regarding the tools, analysis techniques and the interpretation of results described in this tutorial can be found <a href="/training-material/topics/transcriptomics#references">here</a>.</p>
                


                

                

                <h1>Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=De novo transcriptome reconstruction with RNA-Seq (Transcriptomics)" alt="Feedback form link">
                    <img src="/training-material/shared/images/feedback.png" alt="Preview of the google form" />
                </a>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Mallory Freeberg, Mo Heydarian,  <b>De novo transcriptome reconstruction with RNA-Seq (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html">https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{transcriptomics-de-novo,
author = "Mallory Freeberg and Mo Heydarian",
title = "De novo transcriptome reconstruction with RNA-Seq (Galaxy Training Materials)",
year = "",
month = "",
day = ""
url = "\url{https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/de-novo/tutorial.html}",
note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine F√∂ll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Bj√∂rn Gr√ºning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

                
                

                


<script>
// update the date on load, or leave fallback of 'today'
var d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                
                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        
        <script src="/training-material/assets/js/jquery.slim.min.js"></script>
        <script src="/training-material/assets/js/popper.min.js"></script>
        <script src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
        <script src="/training-material/assets/js/details-element-polyfill.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="/training-material/assets/js/bootstrap-toc.min.js"></script>
        <script src="/training-material/assets/js/main.js"></script>
        <script src="/training-material/assets/js/clipboard.min.js"></script>
        <script>
        var snippets=document.querySelectorAll('div.highlight');
        [].forEach.call(snippets,function(snippet){
            snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet tabindex="0"><i class="fa fa-copy"></i>&nbsp;Copy</button>');
        });

        var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
            target:function(trigger){return trigger.nextElementSibling;
        }});
        </script>
        

        <script type="text/javascript">
            if(window.location.hostname === "galaxyproject.github.io") {
                // Redirect
                var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
                $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

                window.setTimeout(function(){
                    window.location.href = redirect;
                }, 5000)

            }
        </script>
    </body>
</html>
