<!doctype html>
<html lang="es">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Una introducci√≥n al an√°lisis de datos scRNA-seq</title>
        
            <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

        
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml" />

        
        
        
        
        
        <meta name="description" content="Training material for all kinds of transcriptomics analysis." />
        <meta property="og:title" content="Galaxy Training: Una introducci√≥n al an√°lisis de datos scRNA-seq" />
        <meta property="og:description" content="Training material for all kinds of transcriptomics analysis." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/hall-of-fame" title="Hall of Fame">
                           <i class="fas fa-users" aria-hidden="true"></i><span class="visually-hidden">hall-of-fame</span> Contributors
                        </a>

                        
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Languages">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Languages
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            
                              <strong class="dropdown-header">Curated Translations</strong>
                              
                                  
                                      
                                      <a class="dropdown-item" href="/training-material/topics/transcriptomics/tutorials/scrna-intro/slides-plain.html">
                                        English
                                      </a>
                                  
                              
                            
                              <strong class="dropdown-header">Automatic Translations</strong>
            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html&edit-text=&act=url">
                            Fran√ßais
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html&edit-text=&act=url">
                            Êó•Êú¨Ë™û
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html&edit-text=&act=url">
                            Espa√±ol
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html&edit-text=&act=url">
                            Portugu√™s
                            </a>
                            
            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html&edit-text=&act=url">
                            ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html&edit-text=&act=url" title="">
                            And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <!-- disable Tess for now
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>
        -->

        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="/training-material/topics/transcriptomics/faqs/" title="Check our FAQs for the Transcriptomics topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Gitter
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Extras">
        <i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">galaxy-star</span> Extras
    </a>
    <div class="dropdown-menu dropdown-menu-right">

        
        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.md" title="Edit on GitHub">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
        </a>

        <a class="dropdown-item" href="/training-material/stats.html" title="Show view statistics about this repository">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html" title="Show view statistics of this page">
            <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page Metrics
        </a>

        
            <a class="dropdown-item" href="/training-material/feedback.html" title="Show feedback statistics about this repository">
                <i class="fas fa-chart-bar" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="progress" class="btn btn-secondary">
                    <input type="radio" name="options" id="progress" autocomplete="off">üè≥Ô∏è‚Äçüåà
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> üéÉ
                </label>
                <label data-value="straya" class="btn btn-secondary">
                    <input type="radio" name="options" id="downunder" autocomplete="off"> üá¶üá∫
                </label>
            </div>

        </div>

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            
            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2022-01-01/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html" title="Version 2022-01-01">2022-01-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2021-12-01/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html" title="Version 2021-12-01">2021-12-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/2021-11-01/topics/transcriptomics/tutorials/scrna-intro/slides-plain_ES.html" title="Version 2021-11-01">2021-11-01</a>
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/" title="Older Versions">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        <div class="container main-content" role="main">
        <section class="tutorial">
	<a href="https://github.com/galaxyproject/training-material/blob/main//topics/transcriptomics/tutorials/scrna-intro/slides_ES.html">View markdown source on GitHub</a>
	<h1>Una introducci√≥n al an√°lisis de datos scRNA-seq</h1>
		<h2>Contributors</h2>
		
<a href="/training-material/hall-of-fame/mtekman/" class="contributor-badge contributor-mtekman"><img src="https://avatars.githubusercontent.com/mtekman?s=27" alt="Avatar">Mehmet Tekman</a>

 
<a href="/training-material/hall-of-fame/ales-ibt/" class="contributor-badge contributor-ales-ibt"><img src="https://avatars.githubusercontent.com/ales-ibt?s=27" alt="Avatar">Alejandra Escobar-Zepeda</a>

 
<a href="/training-material/hall-of-fame/IrelCM/" class="contributor-badge contributor-IrelCM"><img src="https://avatars.githubusercontent.com/IrelCM?s=27" alt="Avatar">Irelka Colina</a>



		
		<h2>Questions</h2>
		<ul>
		
		<li><p>¬øC√≥mo se comparan las muestras?</p>
</li>
		
		<li><p>¬øC√≥mo son capturadas las c√©lulas?</p>
</li>
		
		<li><p>¬øCu√°l  es la diferencia entre los m√©todos Bulk RNA-seq y scRNA-seq?</p>
</li>
		
		<li><p>¬øPor qu√© es importante clusterizar datos?</p>
</li>
		
		</ul>
		

		
		<h2>Objectives</h2>
		<ul>
		
		<li><p>Entender las dificultades en la secuenciaci√≥n y en la amplificaci√≥n del scRNA-seq y c√≥mo superarlas.</p>
</li>
		
		<li><p>Conocer los tipos de variaci√≥n en un an√°lisis y c√≥mo controlarlos.</p>
</li>
		
		<li><p>Comprender qu√© es la reducci√≥n de dimensiones y c√≥mo se puede realizar.</p>
</li>
		
		<li><p>Familiarizarse con las principales t√©cnicas de clusterizaci√≥n de datos y cu√°ndo usarlas.</p>
</li>
		
		</ul>
		

		

		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last modification:</strong> Dec 7, 2021 </div>

	<hr />


	<h1 id="single-cell-rna-seq">Single-cell RNA-seq</h1>

<p>Una introducci√≥n al an√°lisis de datos scRNA-seq</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Hola a todos y bienvenidos al taller de an√°lisis single cell RNA-seq de Galaxy</li>
  <li>
    <h2 id="aqu√≠-les-ense√±aremos-algunos-de-los-conceptos-b√°sicos-del-an√°lisis-de-datos-single-cell">Aqu√≠ les ense√±aremos algunos de los conceptos b√°sicos del an√°lisis de datos single cell.</h2>
  </li>
</ul>

<h2 id="rna-seq-conjunto">RNA-seq conjunto</h2>

<p>.pull-left[<img src="../../images/scrna-intro/rna_cells_bulkrez.svg" alt="Se muestran dos manchas etiquetadas como tejido A y tejido B, a la derecha se muestra la expresi√≥n promedio de los genes A, B y X por tejido. " loading="lazy" />]</p>

<p>.pull-right[
.reduce90[
.center[<em>Resumen</em>]</p>

<p>| | |
|-:|:-|
| Resoluci√≥n| Tejido entero |
| Se√±al | Expresi√≥n g√©nica promedio por tejido |
| Expresi√≥n diferencial | Diferencia entre la expresi√≥n g√©nica promedio entre los tejidos |
]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Vamos a comenzar con las diferencias entre Bulk RNA-seq y single cell RNA-seq data.</li>
  <li>Con el m√©todo Bulk RNA-seq observamos la expresi√≥n promedio de cada gen detectado en cada uno de los tejidos.</li>
  <li>Debido al n√∫mero de mol√©culas de ARN que est√°n siendo consideradas, la profundidad de la secuenciaci√≥n y la fuerza del an√°lisis son razonablemente altas.</li>
  <li>La expresi√≥n diferencial se mide entonces como la expresi√≥n relativa de un gen dado entre un tejido y otro.</li>
</ul>

<hr />

<h2 id="single-cell-rna-seq-1">Single Cell RNA-Seq</h2>

<p>.pull-left[<img src="../../images/scrna-intro/rna_cells_singlerez.svg" alt="Se muestran grupos de c√©lulas rojas y azules que se asemejan a las manchas de tejido de la diapositiva anterior. Los gr√°ficos de la derecha muestran la expresi√≥n de los genes A, B, X por c√©lula en lugar de por tejido." loading="lazy" />]</p>

<p>.pull-right[
.reduce90[
.center[<em>Resumen</em>]</p>

<p>| | |
|-:|:-|
| Resoluci√≥n | C√©lulas individuales dentro de los tejido |
| Se√±al | Expresi√≥n individual de un gen por cada c√©lula |
| Expresi√≥n Diferencial | Algunas c√©lulas expresan de la misma manera el mismo grupo de genes; comparando un grupo de c√©lulas contra otro |
]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Con el an√°lisis single cell, la etapa de medir la expresi√≥n promedio de un tejido se aleja.</li>
  <li>Y se dirige espec√≠ficamente hacia la expresi√≥n g√©nica de cada c√©lula en esos tejidos.</li>
  <li>Aqu√≠ ya no comparamos tejido contra tejido, sino c√©lula contra c√©lula.</li>
  <li>Cada c√©lula tiene un perfil gen√©tico asignado que describe la abundancia relativa de los genes que se le han detectado.</li>
  <li>Muchas c√©lulas comparten el mismo perfil gen√©tico, donde idealmente un perfil gen√©tico describe un tipo de c√©lula.</li>
  <li>A veces se necesita comparar conjuntos de datos de c√©lulas individuales entre tejidos, y se observa que muchas c√©lulas de los diferentes tejidos comparten el mismo tipo de c√©lulas.</li>
  <li>Por ejemplo, observe los perfiles gen√©ticos p√∫rpura y verde que est√°n presentes en ambos tejidos.</li>
</ul>

<hr />

<h1 id="from-bulk-rna-to-single-cell-rna">From Bulk RNA to Single Cell RNA</h1>

<p>.image-50[<img src="../../images/scrna-intro/rna_cells_bulk2single.svg" alt="Los tejidos A y B de la primera diapositiva se muestran como colecciones de c√©lulas de la segunda diapositiva." loading="lazy" />]</p>

<p>.reduce90[</p>
<ul>
  <li>Para cuantificar el ARN a nivel de las c√©lulas individuales:
    <ul>
      <li>Nuevos m√©todos de preparaci√≥n de librer√≠as</li>
      <li>Nuevos m√©todos de secuenciaci√≥n</li>
      <li>Nuevos m√©todos de control de calidad</li>
      <li>Nuevos m√©todos de an√°lisis
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Nuevas tecnolog√≠as implican nuevos m√©todos y t√©cnicas para aprovechar las  caracter√≠sticas nuevas que estas traen consigo.</li>
  <li>Los datos single-cell RNA-seq requieren diferentes medios de preparaci√≥n de librer√≠as, secuenciaci√≥n, control de calidad y an√°lisis</li>
</ul>

<hr />

<h1 id="captura-celular-y-replicados">Captura Celular y Replicados</h1>

<p>.center[<em>¬øC√≥mo preparamos las muestras para la secuenciaci√≥n?</em>]</p>

<p><span>Speaker Notes</span>
Por ejemplo, ¬øC√≥mo se capturan y secuencian las c√©lulas?</p>

<p>‚Äì</p>

<p>.pull-left[
.reduce90[</p>

<p><strong>Bulk RNA-seq</strong></p>

<ol>
  <li>Corta finamente una parte el tejido</li>
  <li>Agrega la enzima para degradar la pared celular</li>
  <li>Enjuaga el ADN / ARN no deseado</li>
  <li>Realiza la secuenciaci√≥n del material restante (Perform sequencing on leftover goop
)</li>
</ol>

<p>]
]</p>

<p><span>Speaker Notes</span>
En el an√°lisis bulk RNA-seq, el proceso incluye tomar una muestra, remover las mol√©culas no deseadas y secuenciar todo lo dem√°s.</p>

<p>‚Äì</p>

<p>.pull-left[
.reduce90[</p>

<p><strong>Single-cell RNA-seq</strong></p>

<ol>
  <li>Corta finamente una parte el tejido</li>
  <li>Descomponer el tejido en c√©lulas</li>
  <li>Aislar cada c√©lula
    <ul>
      <li>Agrega la enzima para degradar la pared celular</li>
      <li>Realizar el ‚Äúbarcoding‚Äù</li>
    </ul>
  </li>
  <li>Realizar la secuenciaci√≥n en un grupo com√∫n</li>
</ol>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Para el an√°lisis single cell, el proceso es muy similar, excepto que cada muestra es una c√©lula.</li>
  <li>Y por lo tanto, debe ser secuenciado separadamente de las otras c√©lulas.</li>
  <li>Una vez aisladas, se agregan c√≥digos de barra √∫nicos a cada c√©lula y luego se secuencian.</li>
</ul>

<p>‚Äì</p>

<p><strong>Replicados Biol√≥gicos</strong></p>

<p>.center[
.reduce90[</p>

<p>|  |  |
|‚Äî‚Äî‚Äì:|:‚Äî‚Äî‚Äî‚Äì|
| <strong>Bulk RNA-seq</strong> | Cada corte del tejido es una muestra, puede tomar otro corte |
| <strong>Single-cell RNA-seq</strong> | Cada c√©lula es una muestra, no puede tener un replicado porque es √∫nica |
]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>El nivel de resoluci√≥n en single-cell es al nivel de la c√©lula y cada c√©lula es √∫nica.</li>
  <li>Por lo tanto, el concepto de replicado biol√≥gico no es exactamente el mismo que en el bulk RNA-seq.</li>
</ul>

<hr />

<h1 id="captura--clasificaci√≥n">Captura / Clasificaci√≥n:</h1>

<p><em>¬øC√≥mo se a√≠slan las c√©lulas?</em></p>

<p><span>Speaker Notes</span>
La separaci√≥n de las c√©lulas puede llevarse a cabo de diferentes maneras.</p>

<p>‚Äì</p>

<p>.pull-right[.image-90[<img src="../../images/scrna-intro/mouthpipette.jpg" alt="Imagen en blanco y negro de una mujer en el laboratorio usando la boca para pipetear c√©lulas de un tubo de ensayo a otro." loading="lazy" />]]</p>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Pipeteo manual:
    <ul>
      <li>Usa un tubo fino de vidrio para succionar las c√©lulas</li>
      <li>Mant√©n la presi√≥n en el tubo</li>
      <li>Transporta el material a un nuevo entorno</li>
      <li>Libera la presi√≥n del tubo
]
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span>
Un m√©todo es el pipeteo manual, donde el laboratorista succiona cada c√©lula usando un tubo largo y fino.</p>

<p>‚Äì</p>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Repetir 1000 veces hasta aislar 1000 c√©lulas
    <ul>
      <li>Propenso a errores
]
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span>
Pueden hacer esto cientos de veces para aislar cientos de c√©lulas, pero es propenso a errores yy a menudo se a√≠slan varias c√©lulas juntas.</p>

<p>‚Äì</p>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Pipeteo autom√°tico:
    <ul>
      <li>Citometr√≠a de flujo
]
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span>
Otro m√©todo es la citometr√≠a de flujo, en el que se reduce el error humano como componente de esta etapa.</p>

<hr />

<h1 id="captura--clasificaci√≥n-citometr√≠a-de-flujo">Captura / Clasificaci√≥n: Citometr√≠a de Flujo</h1>

<p>.pull-right[<img src="../../images/scrna-intro/opticssystem.png" alt="Caricatura de un sistema de flujo con dos l√°seres apuntando a un lente que dirige el rayo de luz para incidir en el flujo de c√©lulas. La luz pasa por filtros y detectores √≥pticos para medir la cantidad de luz reflejada mediante un detector acoplado a un sistema electr√≥nico." loading="lazy" />]</p>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Las c√©lulas fluyen en un l√≠quido a lo largo de un tubo estrecho.
    <ul>
      <li>La estrechez permite el paso de las c√©lulas una por una.</li>
      <li>El fluido es suficiente para permitir el alto rendimiento.
]
]</li>
    </ul>
  </li>
</ul>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Cada c√©lula es examinada con un l√°ser para verificar sus propiedades:
    <ul>
      <li>Tama√±o y tipo de c√©lula
        <ul>
          <li>Dispersi√≥n frontal y Dispersi√≥n lateral</li>
        </ul>
      </li>
      <li>Tipo de c√©lula designada seg√∫n la fluorescencia
        <ul>
          <li>Marcadores de superficie celular (CDs)</li>
          <li>Designaci√≥n gracias a la fluorescencia
]
]</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Separaci√≥n de una c√©lula en su propio entorno de secuenciaci√≥n.
]
]</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La citometr√≠a de flujo hace flotar las c√©lulas en un ba√±o l√≠quido poco profundo y las hace desplazarse a lo largo de un canal estrecho, lo justo solo para que pase una c√©lula a trav√©s.</li>
  <li>Las c√©lulas pueden ser examinadas seg√∫n sus propiedades, tales como la dispersi√≥n de la luz y la designaci√≥n gracias a la fluorescencia.</li>
  <li>De esta manera las c√©lulas pueden ser marcadas y separadas.</li>
</ul>

<hr />

<h1 id="captura--clasificaci√≥n-tama√±o-y-tipo">Captura / Clasificaci√≥n: Tama√±o y Tipo</h1>

<p>.pull-right[
  <img src="../../images/scrna-intro/opticssystem.png" alt="Misma caricatura mostrada anteriormente. " loading="lazy" />
]</p>

<p>.pull-left[
<em>Dispersi√≥n √ìptica</em></p>
<ul>
  <li>Ratio del tama√±o de la c√©lula: Longitud de onda</li>
  <li>Si el Tama√±o de la c√©lula &lt; a la longitud de la onda (~400nm)
    <ul>
      <li>Dispersi√≥n de baja intensidad y de alta inconsistencia</li>
    </ul>
  </li>
  <li>Medido en t√©rminos:
    <ul>
      <li>Dispersi√≥n frontal (FSC, por sus siglas en ingl√©s: Forward Scatter)</li>
      <li>Dispersi√≥n lateral (SSC, por sus siglas en ingl√©s: Side Scatter)</li>
    </ul>
  </li>
</ul>

<p>]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Las propiedades de la dispersi√≥n √≥ptica pueden ser usadas para confirmar el tama√±o y la consistencia de la c√©lula, donde las c√©lulas m√°s peque√±as que la longitud de la onda del l√°ser producen bajas intensidades y patrones de dispersi√≥n m√°s inconsistentes.</li>
  <li>Existen dos principales tipos de dispersi√≥n √≥ptica: la frontal o delantera y la lateral.</li>
</ul>

<hr />

<h1 id="captura--clasificaci√≥n-tama√±o-y-tipo-1">Captura / Clasificaci√≥n: Tama√±o y Tipo</h1>

<p>.pull-left[
.reduce90[</p>
<ul>
  <li>Dispersi√≥n Frontal (FSC)*
    <ul>
      <li>Mide a lo largo de la trayectoria del l√°ser</li>
      <li>Intensidad FSC es proporcional al di√°metro de la c√©lula</li>
      <li>Buen indicador para distinguir entre las c√©lulas inmunitarias.
]
]</li>
    </ul>
  </li>
</ul>

<p>.image-75[.pull-right[<img src="../../images/scrna-intro/FlowJo_Layouts__01-Mar-2017.jpg" alt="Mismo diagrama de dispersi√≥n, pero ahora los monocitos y granulocitos se muestran como zonas coloreadas." loading="lazy" />]]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La dispersi√≥n frontal se alinea con el l√°ser principal y mide el di√°metro de las c√©lulas, que es ideal para distinguirlas por su tama√±o.</li>
  <li>Por ejemplo, como se ve en el eje X de la imagen, los monocitos, que son t√≠picamente m√°s grandes que los linfocitos.</li>
</ul>

<p>‚Äì</p>

<p>.pull-left[
.reduce90[
<br /></p>

<p><em>Dispersion Lateral (SSC)</em></p>
<ul>
  <li>Mide 90¬∞ con respecto al l√°ser, a lo largo del trayecto de las c√©lulas</li>
  <li>Mide intensidades mucho m√°s d√©biles que FSC</li>
  <li>Refracci√≥n/reflexi√≥n es proporcional a la granulometr√≠a de la c√©lula
]
]</li>
</ul>

<p>.image-75[.pull-right[<img src="../../images/scrna-intro/Granulocytes_vs_Monocytes_scatter.jpg" alt="Mismo diagrama de dispersi√≥n, pero ahora los monocitos y granulocitos se muestran como zonas coloreadas." loading="lazy" />]]</p>

<p><span>Speaker Notes</span>
La dispersi√≥n lateral es perpendicular al l√°ser principal y mide la granularidad de la c√©lula, ideal para distinguir las que tienen estructuras internas menos definidas, por ejemplo como los granulocitos que se observan en el eje Y de la imagen.</p>

<hr />

<h1 id="captura--clasificaci√≥n-facs">Captura / Clasificaci√≥n: FACS</h1>

<p>.pull-left[
<img src="../../images/scrna-intro/CD8vsCD3.png" alt="Diagrama de dispersi√≥n dividido en cuatro regiones mostrando CD4+/- y CD8+/-. " loading="lazy" />
.footnote[.reduce70[Image from BD Biosciences]]
]</p>

<p>.pull-right[
.reduce90[
<em>Fluorescence-Activated Cell Sorting (FACS)</em></p>
<ul>
  <li>Marcadores de la superficie de la c√©lulas
    <ul>
      <li>Marcadores fluorescentes para cada c√©lula</li>
    </ul>
  </li>
  <li>Positivo y Negativo
    <ul>
      <li>Si la c√©lula es activada para ese CD o no</li>
    </ul>
  </li>
  <li>Traza diferentes marcadores CD contra los otros
*Aisla poblaciones celulares</li>
  <li>Puede establecer umbrales de activaci√≥n para aislar el an√°lisis en un subconjunto enriquecido de c√©lulas</li>
</ul>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Las c√©lulas tambi√©n pueden seleccionarse y caracterizarse por sus marcadores de superficie celular mediante FACS.</li>
  <li>Al representar gr√°ficamente diferentes intensidades de marcadores de superficie entre s√≠, las c√©lulas pueden separarse, seleccionarse y etiquetarse en funci√≥n de estas propiedades fluorescentes.</li>
</ul>

<hr />

<h1 id="barcoding-cells">Barcoding Cells</h1>

<p>.center[<img src="../../images/scrna-intro/scrna_pbb_barcodes_add.svg" alt="Grupos de GGG y TCT se agregan a dos c√©lulas diferentes para etiquetarlas." loading="lazy" />]</p>

<p>.footnote[Agregar un c√≥digo de barras √∫nico a cada transcrito en la c√©lula]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Una vez aisladas, las c√©lulas pueden tener un c√≥digo de barras.</li>
  <li>Los c√≥digos de barras son secuencias √∫nicas que se agregan a cada mol√©cula de ARN.</li>
  <li>No son exclusivos de la mol√©cula, sino exclusivos de la c√©lula, de modo que dos mol√©culas de ARN ser√°n marcadas con el mismo c√≥digo de barras de la c√©lula, en caso de que existan en la misma c√©lula.</li>
  <li>Las mol√©culas de ARN de diferentes c√©lulas tendr√°n diferentes c√≥digos de barras.</li>
</ul>

<hr />

<h1 id="barcoding-cells-1">Barcoding Cells</h1>

<p>.footnote[Coloque las c√©lulas en la placa de secuenciaci√≥n]</p>

<p>.pull-left[<img src="../../images/scrna-intro/scrna_pbb_barcodes_overview.svg" alt="Las c√©lulas con c√≥digos de barras se colocan en placas con pozos individuales seg√∫n su c√≥digo de barras." loading="lazy" />]</p>

<p>.pull-right[
.reduce90[</p>
<ul>
  <li>
    <p>De un conjunto de muchos <em>muchos</em> tejidos / c√©lulas de muestras diferentes:</p>

    <ul>
      <li>Los c√≥digos de barras de la c√©lula nos dicen de qu√© c√©lula proviene el transcrito</li>
      <li>Los UMI (Unique Molecular Identifier / Identificador Molecular √önico) pueden decirnos cu√°nto se amplifi√≥ la transcripci√≥n, compar√°ndola con otras transcripciones del mismo gen con la misma etiqueta UMI
.
]
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span>
Una vez que las mol√©culas de ARN han sido etiquetadas con los c√≥digos de barras de las c√©lulas, pueden ser amplificadas, ya sea por separado o agrupadas, donde los productos amplificados comparten los mismos c√≥digos de barras de c√©lulas que sus contrapartes originales.</p>

<hr />

<h3 id="problemas-de-secuenciaci√≥n-amplificaci√≥n">Problemas de secuenciaci√≥n: Amplificaci√≥n</h3>

<p>.center[.image-75[<img src="../../images/scrna-intro/amplification_errors.svg" alt="Caricatura de una c√©lula donde se muestran dos transcritos representados con una hebra roja y una azul. La hebra roja se amplifica bien mientras que la azul no." loading="lazy" />]]</p>

<p>.reduce90[</p>
<ul>
  <li>Polymerase Chain Reaction (PCR) / Reacci√≥n en cadena de la polimerasa
    <ul>
      <li>Toma un solo fragmento y lo duplica</li>
      <li>Funciona bien cuando hay suficientes fragmentos en el grupo</li>
    </ul>
  </li>
  <li>Baja cobertura
    <ul>
      <li>Cuando los fragmentos en el grupo de secuenciaci√≥n son bajos, muchos se perder√°n</li>
      <li>Puede conducir la amplificaci√≥n en un solo sentido
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La PCR amplifica los productos g√©nicos para hacerlos  detectables m√°s f√°cilmente durante la secuenciaci√≥n.</li>
  <li>Cuando hay una gran cantidad de producto g√©nico para amplificar, como es el caso del  bulk RNA-seq, la PCR funciona bastante bien para amplificar todos los productos de una manera razonablemente bien representada.</li>
  <li>Sin embargo, en el caso de los productos single-cell, la cantidad a amplificar es muy peque√±a y muchas lecturas √∫nicas pueden perderse durante esta fase, mientras que otras pueden estar sobre-amplificadas, como se muestra en las transcripciones azul y roja del ejemplo.</li>
</ul>

<hr />

<h3 id="problemas-de-secuenciaci√≥n-amp--umis">Problemas de secuenciaci√≥n: Amp. + UMIs</h3>

<p>.pull-left[<img src="../../images/scrna-intro/scrna_amplif_errors_umis.svg" alt="La misma caricatura, pero ahora las hebras rojas y azules est√°n etiquetadas con adaptadores rosas y grises. Ambas hebras rojo y azul se amplifican pero a diferentes velocidades." loading="lazy" />]</p>

<p>.pull-right[
.reduce90[</p>
<ul>
  <li>
    <p>¬øCu√°ntas transcritos rojos hay en la c√©lula?</p>
  </li>
  <li>
    <p>¬øDespu√©s de la amplificaci√≥n por PCR?</p>
  </li>
  <li>
    <p>¬øQu√© hacen las peque√±as etiquetas de colores al comienzo de cada transcripci√≥n?</p>
  </li>
  <li>
    <p>Identificadores moleculares √∫nicos (UMI)</p>
  </li>
  <li>
    <p>Agregado para ayudar a mitigar el sesgo de la amplificaci√≥n.
]
]</p>
  </li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Para protegernos contra este tipo de sesgo de amplificaci√≥n, podemos agregar un elemento aleatorio al c√≥digo de barras.</li>
  <li>Estos c√≥digos de barras aleatorios, conocidos como UMI, etiquetan √∫nicamente las transcripciones de modo que es probable que dos transcripciones del mismo gen tengan diferentes c√≥digos de barras aleatorios.</li>
</ul>

<hr />

<h3 id="problemas-de-secuenciaci√≥n-amp--umis-1">Problemas de secuenciaci√≥n: Amp. + UMIs</h3>

<p>.pull-left[<img src="../../images/scrna-intro/scrna_amplif_errors_umis.svg" alt="La misma caricatura, con las hebras rojas y azules que se amplifican a diferentes velocidades." loading="lazy" />]</p>

<p>.pull-right[</p>

<p>.center[Cuantificaci√≥n de fragmentos</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">¬†</th>
      <th style="text-align: center">Reads</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right"><strong>Rojo</strong></td>
      <td style="text-align: center">6</td>
    </tr>
    <tr>
      <td style="text-align: right"><strong>Azul</strong></td>
      <td style="text-align: center">3</td>
    </tr>
  </tbody>
</table>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Consideremos el ejemplo de la izquierda: tenemos 2 transcritos rojos y 2 transcripciones azules dentro de la celda, que despu√©s de la amplificaci√≥n equivalen a 6 transcripciones rojas y 3 transcripciones azules.</li>
  <li>Si tuvi√©ramos que comparar la expresi√≥n diferencial de los genes contenidos en las transcripciones rojas y azules, con solo mirar los fragmentos amplificados, llegar√≠amos a la falsa conclusi√≥n de que las transcripciones rojas se expresan dos veces m√°s que las azules.</li>
</ul>

<p>‚Äì</p>

<p>.pull-left[</p>

<p>.center[Agrupaci√≥n de fragmentos de acuerdo con los genes y UMI</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">¬†</th>
      <th style="text-align: center"><strong>UMIs</strong></th>
      <th style="text-align: center"><strong>Reads</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right"><strong>Rojo</strong></td>
      <td style="text-align: center">Rosa</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: right">¬†</td>
      <td style="text-align: center">Cyan</td>
      <td style="text-align: center">4</td>
    </tr>
    <tr>
      <td style="text-align: right"><strong>Azul</strong></td>
      <td style="text-align: center">Rosa</td>
      <td style="text-align: center">1</td>
    </tr>
    <tr>
      <td style="text-align: right">¬†</td>
      <td style="text-align: center">Verde</td>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<p>]
]</p>

<p>.pull-right[</p>

<p>.center[Cuantificaci√≥n los fragmentos desduplicados (√∫nicos)</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">¬†</th>
      <th style="text-align: center"><strong>UMIs (Grouped)</strong></th>
      <th style="text-align: center"><strong># UMIs</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right"><strong>Rojo</strong></td>
      <td style="text-align: center">{Rosa, Cyan}</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: right"><strong>Azul</strong></td>
      <td style="text-align: center">{Rosa, Verde}</td>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<p>]
]</p>

<p><span>Speaker Notes</span>
Sin embargo, si agrupamos los fragmentos por sus UMIs, y luego contamos solo el n√∫mero de los UMIs √∫nicos por transcripci√≥n, eliminando la duplicaci√≥n de los fragmentos que comparten la misma transcripci√≥n y UMIs, llegamos a 2 fragmentos rojas y 2 lecturas azules que representan mejor el verdadero n√∫mero de transcritos.</p>

<hr />

<h3 id="problemas-de-secuenciaci√≥n-umis-√∫nicos">Problemas de secuenciaci√≥n: ¬øUMIs √∫nicos?</h3>

<p>.pull-left[<img src="../../images/scrna-intro/scrna_amplif_errors_umis.svg" alt="La misma caricatura, con las hebras rojas y azules que se amplifican a diferentes velocidades." loading="lazy" />]
.pull-right[</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">¬†</th>
      <th style="text-align: center"><strong>UMIs</strong></th>
      <th style="text-align: center"><strong>#Fragmentos</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right"><strong>Rojo</strong></td>
      <td style="text-align: center">{Rosa, Cyan}</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: right"><strong>Azul</strong></td>
      <td style="text-align: center">{Rosa, Verde}</td>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<p>.reduce90[</p>
<ul>
  <li>El rosa aparece dos veces en genes diferentes.</li>
  <li>¬øEn qu√© contexto son √∫nicos los UMI?
]</li>
</ul>

<p>]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Los UMI son relativamente aleatorios, pero no lo son verdaderamente.</li>
  <li>Observe que el UMI rosa aparece dos veces: una en la transcripci√≥n azul y otra en la transcripci√≥n roja.</li>
</ul>

<p>‚Äì</p>

<p><br /></p>

<p>.reduce90[</p>
<ul>
  <li>
    <p>¬øPuede cada transcripci√≥n en una c√©lula tener su propio UMI?</p>
  </li>
  <li>¬øN√∫mero de transcripciones de ARNm en una c√©lula?
    <ul>
      <li>~ 10‚Åµ to 10‚Å∂ en una c√©lula de mam√≠fero.</li>
    </ul>
  </li>
  <li>Requiere un m√≠nimo de c√≥digos de barras de longitud <em>N</em>, donde 4·¥∫ = 10‚Åµ
]</li>
</ul>

<p><span>Speaker Notes</span>
Esto se debe a que a menudo hay m√°s transcripciones que UMI disponibles, que dependen de la cantidad de transcripciones en una c√©lula y de la longitud del c√≥digo de barras.</p>

<hr />

<h1 id="problemas-de-secuenciaci√≥n-umis-√∫nicos-1">Problemas de secuenciaci√≥n: ¬øUMIs √∫nicos?</h1>

<p>.center[C√≥digos de barras de longitud <em>N</em> Con Distancia de Edici√≥n <em>B</em>:]</p>

<p>.pull-left[</p>

<p>.center[<em>N = 5</em> y <em>B = 1</em>]</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AAAAA AAAAC AAAAG AAAAT AAACA ¬∑¬∑¬∑¬∑
CCCCC CCCCA CCCCG CCCCT CCCAC ¬∑¬∑¬∑¬∑
              ¬∑
              ¬∑
              ¬∑
</code></pre></div></div>

<p>.center[<em>4‚Åµ = 1024</em> c√≥digos de barras]</p>

<p>]</p>

<p>.pull-right[</p>

<p>.center[<em>N = 5</em> y <em>B = 2</em>]</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AAAAA AAACC AAAGG AAATT AACCA ¬∑¬∑¬∑¬∑
CCCCC CCCAA CCCGG CCCTT CCCAA ¬∑¬∑¬∑¬∑
              ¬∑
              ¬∑
              ¬∑
</code></pre></div></div>

<p>.center[<em>4‚Åµ‚Åª¬π = 512</em> c√≥digos de barras]</p>

<p>]</p>

<p>.footnote[</p>

<p>Las Distancias de Edici√≥n  protegen contra ** errores de secuenciaci√≥n**.</p>

<p>]</p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>Considere un conjunto de c√≥digos de barras de longitud 5 con una distancia de edici√≥n de 1 entre c√≥digos de barras adyacentes y otro conjunto con una distancia de edici√≥n de 2.</li>
  <li>El primero no es robusto contra los errores de secuenciaci√≥n comunes de 1 par de bases, pero el segundo solo permite la mitad del n√∫mero de c√≥digos de barras.</li>
  <li>Esta compensaci√≥n entre la cantidad de c√≥digos de barras disponibles y la protecci√≥n contra errores de secuenciaci√≥n es fundamental en el dise√±o de c√≥digos de barras de c√©lulas y UMI.</li>
</ul>

<hr />

<h1 id="problemas-de-secuenciaci√≥n-umis-√∫nicos-2">Problemas de secuenciaci√≥n: ¬øUMIs √∫nicos?</h1>

<p>.pull-left[<img src="../../images/scrna-intro/scrna_amplif_errors_umis.svg" alt="La misma caricatura, con las hebras rojas y azules que se amplifican a diferentes velocidades." loading="lazy" />]
.pull-right[</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">¬†</th>
      <th style="text-align: center"><strong>UMIs</strong></th>
      <th style="text-align: center"><strong># Fragmentos</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right"><strong>Rojo</strong></td>
      <td style="text-align: center">{Rosa, Cyan}</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: right"><strong>Azul</strong></td>
      <td style="text-align: center">{Rosa, Verde}</td>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<p>.reduce90[</p>
<ul>
  <li>El rosa aparece dos veces en diferentes genes</li>
  <li>¬øEn qu√© contexto son los UMIs √∫nicos?</li>
</ul>

<p><br />
<br /></p>

<p>]</p>

<p>]</p>

<p>.reduce90[
<em>¬øEn qu√© contexto son los UMIs √∫nicos?</em></p>
<ul>
  <li>UMIs son ‚Äúsal aleatoria‚Äù
    <ul>
      <li>‚ÄòSuficientemente √∫nico‚Äô a nivel de transcripci√≥n</li>
    </ul>
  </li>
  <li>Deseamos contar solo las transcripciones
    <ul>
      <li>Deduplicaci√≥n de UMI a nivel de transcritos</li>
      <li>Buena estimaci√≥n de la verdadera abundancia de las transcripciones
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span>
En el contexto de la amplificaci√≥n, las UMI no necesitan ser √∫nicas, solo necesitan ser lo suficientemente aleatorias para deduplicar las transcripciones a fin de dar una estimaci√≥n m√°s precisa del n√∫mero de transcripciones dentro de una celda.</p>

<hr />

<h1 id="c√≥digos-de-barra-de-las-c√©lulas-y-los-umis-recap">C√≥digos de Barra de las C√©lulas y los UMIs (Recap)</h1>

<p>Para cada c√©lula:</p>

<ol>
  <li>Agrega el c√≥digo de barras a la c√©lula
![Se agregan grupos de GGG y TCT a dos c√©lulas diferentes para etiquetarlas.]](../../images/scrna-intro/scrna_pbb_barcodes_add.svg)</li>
</ol>

<p><span>Speaker Notes</span>
As√≠ que recapitulemos lo que hemos aprendido: primero, cada c√©lula tiene un c√≥digo de barras celular que a su vez es agregado a cada mol√©cula de ARN en cada c√©lula.</p>

<hr />

<h1 id="c√≥digos-de-barra-de-las-c√©lulas-y-los-umis-recap-1">C√≥digos de Barra de las C√©lulas y los UMIs (Recap)</h1>

<p>Para cada c√©lula:</p>

<ol>
  <li>Agrega el c√≥digo de barras celular</li>
  <li>Agrega los UMIs a la c√©lulas que ya tienen el c√≥digo de barra celular
<img src="../../images/scrna-intro/scrna_umi_add.svg" alt="Se muestran mezclas aleatorias de c√≥digos de barras de tres letras. Adem√°s de las c√©lulas mostradas en la caricatura anterior donde las lecturas estaban etiquetadas con GGG en una c√©lula y TCT en la otra, ahora todas tienen prefijos aleatorios antes del GGG y TCT." loading="lazy" /></li>
</ol>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Luego agregamos los UMI aleatorios a todas las transcripciones, que etiquetan a√∫n m√°s las mol√©culas.</li>
  <li>Luego se pueden utilizar para deduplicar las transcripciones despu√©s de la amplificaci√≥n.</li>
  <li>Despu√©s de la amplificaci√≥n, debemos realizar algunos controles de calidad.</li>
</ul>

<hr />

<h1 id="control-de-calidad-qc-superando-el-ruido-de-fondo">Control de calidad (QC): Superando el ruido de fondo</h1>

<p>.center[<img src="../../images/scrna-intro/raceid_libsize.svg" alt="Una matriz de genes 1, 2, 3 y c√©lulas por columna se convierte en dos matrices, una con recuentos de genes detectados por c√©lula y otra con recuentos de c√©lulas detectadas por gen." loading="lazy" />]</p>

<ul>
  <li>El n√∫mero de caracter√≠sticas por c√©lula y el tama√±o de la biblioteca deben seguir una curva normal</li>
  <li>El filtrado de Min-Max ayuda a cortar las colas gruesas de la distribuci√≥n</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Una forma de hacerlo es establecer umbrales en los l√≠mites de detecci√≥n de genes y c√©lulas.</li>
  <li>Considera un an√°lisis en el que est√°n involucrados solo 3 genes (G1, G2 y G3) y 5 c√©lulas (A, B, C, D y E).</li>
  <li>La primera fila de la tabla superior define el tama√±o de la biblioteca, que es el n√∫mero total de ARN mensajeros en todos los genes de cada c√©lula.</li>
  <li>Las filas siguientes son los umbrales de detecci√≥n de genes, que muestran cu√°ntos genes se detectan en cada c√©lula para genes superiores a las cantidades umbral de 0 a 4.</li>
  <li>Vemos que incluso un umbral de m√°s de 3 transcritos detectados en una c√©lula determinada todav√≠a mantiene 3 c√©lulas en el an√°lisis: B, C y E. En la tabla inferior, se representa lo contrario, con el n√∫mero total de transcritos en todas las c√©lulas para cada gen.</li>
  <li>Al establecer umbrales de detecci√≥n, podemos ver cu√°ntas c√©lulas describe el gen para ese umbral.</li>
  <li>En ambos casos, podemos ver que si establecemos los umbrales demasiado bajos, corremos el riesgo de mantener genes o c√©lulas de baja calidad, pero si establecemos los umbrales de detectabilidad demasiado altos, corremos el riesgo de perder demasiados.</li>
</ul>

<hr />

<h1 id="normalizaci√≥n-bulk-vs-single-cell">Normalizaci√≥n: Bulk vs Single-Cell</h1>

<p>.pull-left[</p>

<p><em>Bulk RNA-seq</em>: Alta Cobertura</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">¬†</th>
      <th style="text-align: right">T1</th>
      <th style="text-align: right">T2</th>
      <th>T3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>GenA</strong></td>
      <td style="text-align: right">100</td>
      <td style="text-align: right">80</td>
      <td>40</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>GenB</strong></td>
      <td style="text-align: right">45</td>
      <td style="text-align: right">30</td>
      <td>40</td>
    </tr>
  </tbody>
</table>

<p>.reduce70[* La expresi√≥n gen√©tica media es alta]</p>

<p><br /></p>

<p><em>scRNA-seq</em>: Muy baja profundidad de secuenciaci√≥n</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">¬†</th>
      <th style="text-align: right">C1</th>
      <th style="text-align: right">C2</th>
      <th style="text-align: right">C3</th>
      <th style="text-align: right">C4</th>
      <th style="text-align: right">C5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>GenA</strong></td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>GenB</strong></td>
      <td style="text-align: right">2</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">15</td>
      <td style="text-align: right">0</td>
      <td style="text-align: right">0</td>
    </tr>
  </tbody>
</table>

<p>.reduce70[* La expresi√≥n gen√©tica media es cero]</p>

<p>]</p>

<p>.pull-right[</p>

<p><strong>¬øPor qu√© esto es un problema?</strong></p>

<p>.center[
\(R(s,g) = \frac{X\_{sg}}{(\prod\_{s} X\_{s})^{\frac{1}{n}}}\)</p>

\[DESeq(s,g) = \frac{X\_{sg}}{Med(R\_{s})}\]

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Sin embargo, el filtrado puede ser un lujo, ya que muchos conjuntos de datos de single-cell RNA-seq tienen normalmente una profundidad de secuenciaci√≥n baja en comparaci√≥n con bulk RNA-seq.</li>
  <li>Durante el proceso de normalizaci√≥n, las muestras se escalan entre s√≠ para hacerlas m√°s comparables.</li>
  <li>Esto se realiza normalmente mediante el uso de valores medianos. Por ejemplo, para la normalizaci√≥n DE-Seq, se toma el recuento de la media geom√©trica de una c√©lula y cada valor de gen en esa c√©lula se divide por √©l y por el valor mediano de todas las medias geom√©tricas de todas las c√©lulas.</li>
  <li>Si la mediana de la expresi√≥n g√©nica es alta, este m√©todo de normalizaci√≥n funciona bastante bien.</li>
</ul>

<p>‚Äì</p>

<p>.pull-right[
¬°No se puede dividir entre cero!
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Pero si la mediana de la expresi√≥n g√©nica es cero, como suele ocurrir con los datos de una sola c√©lula, entonces tenemos el problema de dividir entre cero.</li>
  <li>Existen m√©todos para sortear estos recuentos de cero.</li>
</ul>

<hr />

<h1 id="normalizaci√≥n-m√©todo-scran">Normalizaci√≥n: m√©todo SCRAN</h1>

<p>.footnote[.small[<a href="https://doi.org/10.1186/s13059-016-0947-7"><em>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</em>, Lun et al., 2016</a>]]
.pull-left[<img src="../../images/scrna-intro/scran_pooling_left.svg" alt="Las burbujas azules y rojas se mezclan, luego se separan en dos grupos y a continuaci√≥n se organizan alrededor de un c√≠rculo, el rojo va de peque√±o a grande alrededor de la mitad derecha y el azul de peque√±o a grande alrededor de la izquierda. La parte inferior del c√≠rculo tiene la etiqueta 6 y la parte superior tiene la etiqueta 12." loading="lazy" />]</p>

<p>.pull-right[
.reduce90[</p>
<ol>
  <li>
    <p>Calcula el tama√±o de la biblioteca de todas las c√©lulas.</p>
  </li>
  <li>
    <p>Calcula el tama√±o de la biblioteca de una c√©lula de pseudo referencia (promedio)</p>
  </li>
  <li>
    <p>Separa los tama√±os impares (rojo) y los tama√±os pares (azul) en dos grupos</p>
  </li>
  <li>
    <p>Ordena cada grupo por tama√±o de biblioteca y lo coloca en lados opuestos de un ‚Äúanillo‚Äù
]
]</p>
  </li>
</ol>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Uno de estos m√©todos es SCRAN, que funciona creando grupos superpuestos de c√©lulas, de modo que cualquier c√©lula individual se describe por c√©lulas de tama√±os de biblioteca similares.</li>
  <li>El m√©todo implica dividir todas las c√©lulas en un grupo par e impar por el tama√±o de su biblioteca, y organizarlas en una estructura de anillo donde las c√©lulas vecinas en el anillo tienen tama√±os similares.</li>
</ul>

<hr />

<h1 id="normalizaci√≥n-m√©todo-scran-1">Normalizaci√≥n: m√©todo SCRAN</h1>

<p>.footnote[.small[<a href="https://doi.org/10.1186/s13059-016-0947-7"><em>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</em>, Lun et al., 2016</a>]]</p>

<p>.pull-right[<img src="../../images/scrna-intro/scran_pooling_right.svg" alt="El mismo gr√°fico final con c√≠rculos azules y rojos de tama√±o creciente con una flecha apuntando a una gran cantidad de f√≥rmulas que se superponen." loading="lazy" />]</p>

<p>.pull-left[
.reduce90[</p>
<ol>
  <li>
    <p>Define grupos superpuestos de c√©lulas adyacentes de tama√±o <em>k</em></p>
  </li>
  <li>Para cada grupo
    <ol>
      <li>Suma los tama√±os de biblioteca de todas las c√©lulas dentro del grupo</li>
      <li>Obtiene un factor de tama√±o dividiendo por la c√©lula de referencia</li>
    </ol>
  </li>
  <li>Para cada c√©lula
    <ol>
      <li>Encuentra los grupos a los que pertenece</li>
      <li>Construye un modelo lineal usando estos factores de tama√±o</li>
      <li>Estima el factor de tama√±o de la c√©lula en dicho modelo lineal</li>
    </ol>
  </li>
</ol>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Se definen grupos superpuestos de tama√±o fijo, lo que da como resultado que cada c√©lula sea definida por m√∫ltiples grupos.</li>
  <li>Un modelo lineal para esa c√©lula puede entonces ser construido por los grupos en los que se encuentra, y los factores de normalizaci√≥n para todas las c√©lulas se pueden determinar de esta manera.</li>
</ul>

<hr />

<h1 id="normalizaci√≥n-m√©todo-scran-2">Normalizaci√≥n: m√©todo SCRAN</h1>

<p>.footnote[.small[<a href="https://doi.org/10.1186/s13059-016-0947-7"><em>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</em>, Lun et al., 2016</a>]]</p>

<p>.center[<img src="../../images/scrna-intro/scran_pooling.svg" alt="Las dos figuras anteriores integradas en una sola." loading="lazy" />]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Con este m√©todo, el problema de baja cobertura se soluciona convirtiendo las c√©lulas con tama√±os de biblioteca bajos en componentes √∫tiles de un factor de tama√±o que se puede aplicar a c√©lulas similares.</li>
  <li>Estos m√©todos de normalizaci√≥n novedosos eran algo com√∫n hace unos a√±os, pero a medida que las tecnolog√≠as de secuenciaci√≥n han mejorado, el problema de muchos recuentos de cero en la matriz se vuelve menos importante y los factores de tama√±o de normalizaci√≥n se pueden derivar utilizando bulk RNA-seq una vez m√°s.</li>
</ul>

<hr />

<h1 id="variaci√≥n-deseada-vs-no-deseada">Variaci√≥n deseada vs no deseada</h1>

<p>.pull-right[<img src="../../images/scrna-intro/variance.svg" alt="Tres gr√°ficos de l√≠neas superpuestas mapean la contribuci√≥n de la varianza a la densidad. Se muestra que en los genes N con m√°s cambio aumenta la densidad a medida que la contribuci√≥n de la varianza aumenta, mientras que los genes por c√©lula, el n√∫mero de transcritos y la fuente del lote disminuyen." loading="lazy" />]</p>

<p>.pull-left[
.reduce90[
<em>Variaci√≥n deseada</em></p>
<ul>
  <li>
    <p>Expresi√≥n de los genes con valores m√°s altos de expresi√≥n diferencial</p>
  </li>
  <li>
    <p>Variaci√≥n no deseada *</p>
    <ul>
      <li>‚ÄúFactores de confusi√≥n‚Äù</li>
      <li>Variaci√≥n t√©cnica
        <ul>
          <li>Fuente de lote</li>
          <li>Tama√±o de la biblioteca</li>
        </ul>
      </li>
      <li>Variaci√≥n biol√≥gica
        <ul>
          <li>Ruido celular intr√≠nseco</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Otros factores que debemos tener en cuenta durante un an√°lisis de single-cell RNA-seq son los factores no deseados que pueden confundir el an√°lisis.</li>
  <li>Lo ideal ser√≠a que los perfiles gen√©ticos que separan los diferentes tipos de c√©lulas est√©n impulsados por la varianza biol√≥gica.</li>
  <li>Sin embargo, existen variables de confusi√≥n tanto de fuentes t√©cnicas como biol√≥gicas que no son √∫tiles para el an√°lisis pero contribuyen a la varianza.</li>
</ul>

<hr />

<h1 id="variables-de-confusi√≥n-biol√≥gicas">Variables de confusi√≥n: Biol√≥gicas</h1>

<p>.center[<img src="../../images/scrna-intro/raceid_cellcycle.svg" alt="La caricatura de la izquierda muestra un signo de interrogaci√≥n con flechas que apuntan a un resultado vac√≠o y a los transcritos generados. A la derecha est√°n las fases del ciclo celular y diferentes cantidades de transcritos sintetizados en cada fase." loading="lazy" />]</p>

<p>.pull-left[
.reduce90[
.center[<em>Transcripci√≥n en r√°fagas (‚ÄúTranscription bursting‚Äù)</em>]</p>
<ul>
  <li>La transcripci√≥n no es continua, ocurre en ‚Äúr√°fagas‚Äù</li>
  <li>Fen√≥meno oculto en bulk RNA-seq
]
]</li>
</ul>

<p>.pull-right[
.reduce90[
.center[<em>Ciclo Celular</em>]</p>
<ul>
  <li>C√©lulas del mismo tipo tienen el doble de ARNm en la fase M que en la fase G1
]
]</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La varianza de confusi√≥n biol√≥gica aparece en dos formas: transcripci√≥n en r√°fagas y variaci√≥n del ciclo celular.</li>
  <li>La transcripci√≥n en r√°fagas es un fen√≥meno que ocurre en c√©lulas en las que la transcripci√≥n ocurre en estados discretos de activo e inactivo, donde el intervalo entre estos estados es dif√≠cil de modelar.</li>
  <li>En bulk RNA-seq, este fen√≥meno es imperceptible ya que los efectos se promedian en muchas c√©lulas. Pero en experimentos de single-cell, dos c√©lulas del mismo tipo pueden exhibir diferentes perfiles gen√©ticos simplemente porque una c√©lula est√° transcribiendo activamente y la otra no.</li>
  <li>Esto no es algo que podamos controlar en el an√°lisis, pero es algo que debemos tener en cuenta al comprender el ruido en el agrupamiento de c√©lulas.</li>
  <li>La variaci√≥n del ciclo celular, por otro lado, es un proceso mucho mejor entendido, donde la cantidad de ARN en una c√©lula es aproximadamente el doble que la de una c√©lula del mismo tipo debido a que una se encuentra en la fase G1 temprana y la otra en la fase M durante el ciclo celular.</li>
  <li>Hay genes que se sabe que covar√≠an con el ciclo celular, por lo que al hacer una regresi√≥n del efecto de estos genes, podemos controlar el ciclo celular.</li>
</ul>

<hr />

<h1 id="variables-de-confusi√≥n-t√©cnicas">Variables de confusi√≥n: T√©cnicas</h1>

<p>.center[<img src="../../images/scrna-intro/raceid_technical_variation.svg" alt="La variaci√≥n del tama√±o de la biblioteca apunta a dos c√©lulas con transcritos rojos y azules en n√∫meros id√©nticos. Sin embargo, durante la amplificaci√≥n, en una c√©lula se produce un n√∫mero de copias distinto al esperado mientras que en la otra se elimina por completo uno de los transcritos." loading="lazy" />]</p>

<p>.pull-left[
.reduce90[
<em>Sesgo de Amplificaci√≥n</em></p>
<ul>
  <li>Diferentes transcritos se amplifican m√°s que otros</li>
  <li>Mitigaci√≥n v√≠a UMIs
]
]</li>
</ul>

<p>.pull-left[
.reduce90[
<em>Eventos de marginaci√≥n</em></p>
<ul>
  <li>Algunos genes no se detectan falsamente en las c√©lulas</li>
  <li>Mitigaci√≥n v√≠a mejores m√©todos de captura y normalizaci√≥n
]
]</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La varianza de confusi√≥n t√©cnica aparece en tres formas: sesgo de amplificaci√≥n, eventos de marginaci√≥n y variaci√≥n del tama√±o de la biblioteca.</li>
  <li>El sesgo de amplificaci√≥n puede mitigarse mediante UMI como se demostr√≥ anteriormente.</li>
  <li>Los eventos de marginaci√≥n dan lugar a los ceros predominantes en las matrices de recuento, y su efecto se puede reducir utilizando t√©cnicas de normalizaci√≥n inteligentes como el m√©todo de agrupaci√≥n mostrado anteriormente, as√≠ como utilizando mejores m√©todos de secuenciaci√≥n.</li>
</ul>

<hr />

<h1 id="variables-de-confusi√≥n-t√©cnicas-1">Variables de confusi√≥n: T√©cnicas</h1>

<p>.center[<img src="../../images/scrna-intro/raceid_technical_variation.svg" alt="La variaci√≥n del tama√±o de la biblioteca apunta a dos c√©lulas con transcritos rojos y azules en n√∫meros id√©nticos. Sin embargo, durante la amplificaci√≥n, en una c√©lula se produce un n√∫mero de copias distinto al esperado mientras que en la otra se elimina por completo uno de los transcritos." loading="lazy" />]</p>

<p><em>Variaci√≥n del tama√±o de la biblioteca</em></p>
<ul>
  <li>Las c√©lulas tienen diferentes tasas de transcripci√≥n y captura</li>
  <li>Mitigaci√≥n v√≠a normalizaci√≥n</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La variaci√≥n del tama√±o de la biblioteca surge por una variedad de razones, pero es la fuente principal de variaci√≥n dentro de un an√°lisis.</li>
  <li>Al igual que en bulk RNA-seq, esto se reduce con buenos m√©todos de normalizaci√≥n.</li>
</ul>

<hr />

<h1 id="relaciones-entre-c√©lulas">Relaciones entre C√©lulas</h1>

<p>Considera:</p>
<ul>
  <li>1,000s de C√©lulas</li>
  <li>10,000s de Genes</li>
  <li>10k dimensiones en el conjunto de datos, con 1k observaciones</li>
</ul>

<p>Objetivo:</p>
<ul>
  <li>Encontrar grupos de c√©lulas en un subconjunto de estos genes</li>
</ul>

<p>Nota:</p>
<ul>
  <li>Algunas c√©lulas pueden tener una expresi√≥n muy similar en un gen y una expresi√≥n muy diferente en todos los dem√°s</li>
  <li>¬øC√≥mo representamos esto?</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Una vez que hemos eliminado los factores de confusi√≥n no deseados del an√°lisis, tenemos el problema de cuantificar las relaciones entre las c√©lulas.</li>
  <li>Desde el punto de vista del an√°lisis de datos, tratamos a cada c√©lula como una observaci√≥n y a cada gen como una variable.</li>
  <li>Para genomas grandes, esto significa conjuntos de datos de dimensiones extremadamente altas. Las c√©lulas existen como puntos en este espacio de alta dimensi√≥n muy escasamente poblado, lo que dificulta ver las agrupaciones naturales.</li>
  <li>El espacio de alta dimensi√≥n se puede reducir mucho simplemente filtrando los genes que no parecen expresarse diferencialmente en todas las c√©lulas.</li>
  <li>Sin embargo, para encontrar las relaciones entre c√©lulas, necesitamos definir las distancias entre ellas.</li>
</ul>

<hr />

<h1 id="matriz-de-distancias">Matriz de Distancias</h1>

<p><img src="../../images/scrna-intro/raceid_distance.svg" alt="Se muestra una matriz de recuento de genes para cada c√©lula en un espacio N-dimensional con cada gen representando los diferentes ejes. Con base en la f√≥rmula de distancia para 3 dimensiones, se obtiene la tabla final de la matriz de conteos con las distancias entre cada una de las c√©lulas basada en su conteo de genes." loading="lazy" /></p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Una matriz de distancias hace exactamente esto, definir la distancia entre dos c√©lulas cualesquiera mediante un solo valor de puntuaci√≥n.</li>
  <li>Aqu√≠ usamos la distancia euclidiana en un conjunto de datos tridimensional de 3 genes (G1, G2 y G3) y 3 c√©lulas (R, P y V).</li>
  <li>La distancia entre dos c√©lulas cualesquiera se puede calcular como la suma de los cuadrados de la diferencia en los valores de los genes.</li>
  <li>Observa c√≥mo la matriz de distancias es sim√©trica a lo largo de la diagonal, lo que confirma que, por ejemplo, la distancia de las celdas R a V es la distancia de V a R como se espera.</li>
</ul>

<hr />

<h1 id="relaci√≥n-de-las-c√©lulas-knn">Relaci√≥n de las c√©lulas: KNN</h1>

<p><img src="../../images/scrna-intro/scrna_knn.svg" alt="Se muestra una gr√°fica de distancias entre c√©lulas a trav√©s de tres genes con la etiqueta ‚Äòhigh dimensional dataset of cells‚Äô. Esto produce una matriz de distancias sim√©trica y luego a trav√©s de KNN con k = 2, se genera una matriz no sim√©trica, y se traza nuevamente en el espacio dimensional de genes para mostrar las conexiones entre las c√©lulas." loading="lazy" /></p>

<ul>
  <li>Ejecutar <em>K-nearest neighbours</em> para conectar v√©rtices representados por c√©lulas.</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Una vez que se genera una matriz de distancia, podemos realizar K-nearest neighbours para generar bordes dirigidos entre c√©lulas.</li>
  <li>Para cada fila de la matriz de distancia, se seleccionan K de las c√©lulas con los valores de distancia m√°s peque√±os que representan el vecino m√°s cercano que tiene la c√©lula de la fila actual a las c√©lulas de la columna seleccionada.</li>
  <li>Si los bordes se comparten mutuamente entre c√©lulas vecinas, esto se denomina enfoque de vecino m√°s cercano compartido.</li>
</ul>

<hr />

<h1 id="reducci√≥n-dimensional">Reducci√≥n dimensional</h1>

<p><img src="../../images/scrna-intro/raceid_dimred.svg" alt="La matriz de genes contra c√©lulas se traza en tantas dimensiones como genes y luego se reduce a 2 dimensiones." loading="lazy" /></p>

<p>.pull-left[
.reduce90[
<em>Objetivo:</em></p>
<ul>
  <li>Tomar un conjunto de datos de alta dimensi√≥n y reducirlo a una dimensi√≥n m√°s baja que podamos entender.
    <ul>
      <li>ejemplo: 10000-D ‚Üí 2D
]
]</li>
    </ul>
  </li>
</ul>

<p>.pull-right[
.reduce90[
<em>Restricci√≥n:</em></p>
<ul>
  <li>Conservar la topolog√≠a de alta dimensi√≥n en un espacio de baja dimensi√≥n.
    <ul>
      <li>ejemplo: si la celda A est√° lejos de la celda D pero cerca de la celda B en 3D, se deber√≠an replicar esas relaciones en 2D.</li>
    </ul>
  </li>
</ul>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Podemos representar este espacio tridimensional f√°cilmente como 3 ejes independientes con puntos que representen las c√©lulas.</li>
  <li>Y extrapolar este conjunto de ejemplos de dimensiones relativamente bajas a un conjunto de datos reales de miles de dimensiones que est√° m√°s all√° del alcance de la posibilidad humana.</li>
  <li>La reducci√≥n dimensional es un tipo de t√©cnica que toma un conjunto de datos de alta dimensi√≥n y produce una representaci√≥n de baja dimensi√≥n, generalmente bidimensional, que intenta preservar las distancias entre los puntos.</li>
  <li>Aqu√≠ las diferencias relativas entre c√©lulas se mantienen tanto en las representaciones de alta y baja dimensi√≥n.</li>
  <li>Hay muchos tipos diferentes de t√©cnicas de reducci√≥n de dimensiones, cada una con sus propias fortalezas y debilidades que dependen del tipo y la dimensionalidad de los datos.</li>
</ul>

<hr />

<h3 id="agrupamiento">Agrupamiento</h3>

<p>.pull-left[.image-100[<img src="../../images/scrna-intro/singlecellplot3.png" alt="Diagrama de dispersi√≥n con muchos grupos de celdas etiquetadas con diferentes colores. Las c√©lulas est√°n en gran parte agrupadas, con pocas c√©lulas perif√©ricas." loading="lazy" />]]</p>

<p>.pull-right[
.reduce90[</p>
<ol>
  <li>Proyecci√≥n en dos dimensiones
    <ul>
      <li>Cada punto es una c√©lula</li>
      <li>Agrupar puntos por color, donde las c√©lulas de diferentes colores pertenecen a diferentes grupos</li>
      <li>Diferentes grupos representan diferentes tipos de c√©lulas
]
]</li>
    </ul>
  </li>
</ol>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Una vez que el n√∫mero de variables del conjunto de datos se ha reducido lo suficiente mediante el filtrado y la reducci√≥n dimensional, la agrupaci√≥n se puede realizar m√°s f√°cilmente.</li>
  <li>Aqu√≠, en esta proyecci√≥n de dos dimensiones, cada c√≠rculo es una c√©lula y los colores √∫nicos representan los grupos a los que han sido asignadas.</li>
  <li>Las distancias f√≠sicas entre los grupos de c√©lulas coloreadas nos dicen qu√© tan bueno es el agrupamiento para esta proyecci√≥n.</li>
</ul>

<hr />

<h3 id="agrupamiento-1">Agrupamiento</h3>

<p>.pull-left[.image-100<a href="../../images/scrna-intro/singlecellplot4.png">![Mismo diagrama de dispersi√≥n mostrando el agrupamiento de c√©lulas, pero ahora los grupos est√°n etiquetados de acuerdo al tipo de c√©lula como ‚ÄòNeurons‚Äô, ‚ÄòNSC‚Äô, ‚ÄòGlial Prog.‚Äô, ‚ÄòAstrocytes‚Äô, etc.]</a>]]</p>

<p>.pull-right[
.reduce90[</p>
<ol>
  <li>Proyecci√≥n en dos dimensiones</li>
  <li>Tipos discretos de c√©lulas
    <ul>
      <li>Cada grupo debe representar un diferente tipo de c√©lula</li>
      <li>Buscar los genes expresados de manera m√°s diferencial en cada grupo</li>
    </ul>
    <ul>
      <li>Encontrar los genes marcadores ‚Üí Tipo de C√©lula
]
]</li>
    </ul>
  </li>
</ol>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Al inspeccionar los principales genes expresados diferencialmente en cada grupo frente a todos los dem√°s grupos, se pueden encontrar pistas sobre el tipo de c√©lula que describe el grupo.</li>
  <li>Los tipos de c√©lulas a menudo se caracterizan por la expresi√≥n de genes marcadores espec√≠ficos, y la presencia de estos genes son fuertes indicadores del tipo.</li>
  <li>El descubrimiento de genes marcadores se puede utilizar para anotar los grupos.</li>
</ul>

<hr />

<h3 id="agrupamiento-2">Agrupamiento</h3>

<p>.pull-left[.image-100[<img src="../../images/scrna-intro/singlecellplot6.png" alt="Mismo diagrama de dispersi√≥n mostrando el agrupamiento de c√©lulas con los grupos etiquetados de acuerdo al tipo de c√©lula y con flechas indicando al grupo vecino m√°s cercano. " loading="lazy" />]]</p>

<p>.pull-right[
.reduce90[</p>
<ol>
  <li>Proyecci√≥n en dos dimensiones</li>
  <li>Tipos discretos de c√©lulas</li>
  <li>Relaciones inferidas por Linaje
    <ul>
      <li>C√©lulas madre neuronales (Neural Stem Cells) diferenciadas en tipos de c√©lulas maduras</li>
      <li>Los √°rboles de linaje se construyen teniendo en cuenta:</li>
    </ul>
    <ul>
      <li>La entrop√≠a del grupo</li>
      <li>La proximidad del grupo
]
]</li>
    </ul>
  </li>
</ol>

<p><span>Speaker Notes</span>
Tambi√©n podemos derivar a√∫n m√°s las relaciones entre estos grupos calculando √°rboles de linaje en funci√≥n de la cantidad de ruido en cada grupo, con la expectativa de que las c√©lulas madre tengan perfiles de expresi√≥n ruidosos que produzcan grupos m√°s amplios, y las c√©lulas maduras tengan perfiles de expresi√≥n muy claros que produzcan grupos m√°s apretados.</p>

<hr />

<h2 id="agrupamiento-duro-vs-suave">Agrupamiento: Duro vs Suave</h2>

<table>
  <thead>
    <tr>
      <th>¬†</th>
      <th>¬†</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>.image-100<a href="../../images/scrna-intro/singlecellplot3.png">![Mismo conjunto de datos mostrando grupos distintos con una separaci√≥n muy clara]</a>]</td>
      <td>.image-100[<img src="../../images/scrna-intro/10xdata.png" alt="Los grupos ahora se mezclan entre s√≠ y la separaci√≥n no es clara." loading="lazy" />]</td>
    </tr>
    <tr>
      <td>.center[<strong>Duro</strong>]</td>
      <td>.center[<strong>Suave</strong>]</td>
    </tr>
    <tr>
      <td>Espacios grandes entre grupos</td>
      <td>Los grupos sobrelapan</td>
    </tr>
    <tr>
      <td>Los tipos de c√©lulas est√°n bien definidos y el agrupamiento lo refleja</td>
      <td>Los tipos de c√©lulas parecen entremezclarse</td>
    </tr>
  </tbody>
</table>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Los tipos de agrupaci√≥n que es probable que encuentres en un an√°lisis dependen de los conjuntos de datos de entrada, donde es menos probable que las c√©lulas tomadas de muestras en etapa tard√≠a se agrupen juntas y es m√°s probable que produzcan grandes lagunas visibles conocidas como agrupamiento duro que claramente definen diferentes tipos.</li>
  <li>Es m√°s probable que los conjuntos de datos de etapas tempranas produzcan grupos m√°s suaves, donde los grupos vecinos comparten l√≠mites suaves a medida que √©stos se entremezclan ligeramente entre s√≠.</li>
</ul>

<hr />

<h1 id="fenotipos-continuos">Fenotipos Continuos:</h1>

<p>.center[<img src="../../images/scrna-intro/raceid_contpheno.svg" alt="El gr√°fico muestra el tiempo de desarrollo de los reticulocitos a medida que pasan por una fase celular intermedia o rara hasta su forma final: gl√≥bulos rojos." loading="lazy" />]
.reduce90[</p>
<ul>
  <li>Los tipos de c√©lulas no son discretos, las c√©lulas est√°n en transici√≥n</li>
  <li>Cambio continuo en el tiempo de un tipo menos maduro a un tipo m√°s maduro
]</li>
</ul>

<p><span>Speaker Notes</span>
Es de esperar un agrupamiento suave, ya que aunque el agrupamiento es un m√©todo estad√≠stico para dividir datos de manera discreta, la biolog√≠a celular subyacente de los datos es un proceso continuo, donde las c√©lulas pasan de un estado bien definido a otro a trav√©s de etapas intermedias que se representan en entre dos centros de grupos.</p>

<hr />

<h2 id="agrupando">Agrupando</h2>

<p>.pull-left<a href="../../images/scrna-intro/raceid_mountains.svg">
![Perfiles de expresi√≥n discretos: Se muestran tres monta√±as con nubes de las que s√≥lo vemos tres picos. En rojo, verde y azul se representan tipos de c√©lulas en los picos. Paisaje de expresi√≥n continua: las nubes se eliminan y vemos que las monta√±as est√°n realmente conectadas y hay c√©lulas intermedias en varios colores de transici√≥n.]</a>
]</p>

<p>.pull-right[
.reduce90[
<em>Conjuntos de datos din√°micos con grupos continuamente din√°micos</em></p>
<ul>
  <li>Conjuntos de datos de single-cell</li>
  <li>PCA es demasiado discreto en la partici√≥n de datos</li>
  <li>M√∫ltiples algoritmos de aprendizaje, aprende el ‚Äúpanorama‚Äù</li>
</ul>

<p><em>Variedad de m√©todos de agrupaci√≥n</em></p>

<ul>
  <li>K-means (K-medias)</li>
  <li>K-medians (K-medianas)</li>
  <li>Agrupaci√≥n jer√°rquica</li>
  <li>Agrupaci√≥n comunitaria
]
]</li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>Debido a la naturaleza continua de estos conjuntos de datos single-cell y a su dimensionalidad extremadamente alta, la partici√≥n discreta es a menudo un modelo deficiente.</li>
  <li>Si, en cambio, asumimos que los grupos de c√©lulas est√°n relacionados entre s√≠ a trav√©s de c√©lulas de transici√≥n que naturalmente se encontrar√≠an entre grupos, entonces las m√∫ltiples t√©cnicas de aprendizaje son m√°s adecuadas.</li>
  <li>Estas t√©cnicas derivan un panorama de expresi√≥n que no solo se puede usar para relacionar grupos entre s√≠, sino que tambi√©n se puede usar para inferir linaje y jerarqu√≠a.</li>
  <li>Para realizar la agrupaci√≥n tal cu√°l, hay tres m√©todos de uso com√∫n: K-means, agrupaci√≥n jer√°rquica y agrupaci√≥n comunitaria.</li>
</ul>

<hr />

<h3 id="agrupando-k-means-k-medias">Agrupando: K-means (K-medias)</h3>

<p>.pull-right[<img src="../../images/scrna-intro/kmeans.gif" alt="Figura animada que muestra varias iteraciones de un algoritmo que optimiza una divisi√≥n de 3 v√≠as en un diagrama de dispersi√≥n de c√©lulas. No hay un l√≠mite claro que haga que el resultado final parezca solo un poco mejor." loading="lazy" />]</p>

<p>.pull-left[
.reduce90[
<em>K-means (K-medias)</em></p>
<ol>
  <li>Inicializar <em>k</em> posiciones aleatorias</li>
  <li>Paso de iteraci√≥n:
    <ol>
      <li>Calcule la distancia desde cada c√©lula a cada posici√≥n <em>k</em></li>
      <li>Asigna cada c√©lula a su <em>k</em> m√°s cercano</li>
      <li>Establecer nuevas posiciones <em>k</em> en la posici√≥n media de todas las c√©lulas de ese grupo</li>
    </ol>
  </li>
</ol>

<p><em>K-medians (K-medianas)</em></p>
<ul>
  <li>Igual que el anterior, pero usa la posici√≥n mediana en su lugar</li>
  <li>Menos influenciado por valores at√≠picos</li>
</ul>

<p>]
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>K-means (K-medias) y K-medians (K-medianas) siguen el mismo m√©todo: el n√∫mero de grupos se define de antemano y se inicializa en posiciones aleatorias.</li>
  <li>Las posiciones se actualizan luego por la contribuci√≥n de las c√©lulas m√°s cercanas a √©l que a otras posiciones.</li>
  <li>Este proceso ocurre varias veces hasta que las posiciones ya no cambian significativamente o hasta que se alcanza un n√∫mero determinado de iteraciones.</li>
  <li>La asignaci√≥n final de cada c√©lula se convierte en la asignaci√≥n del grupo.</li>
</ul>

<hr />

<h2 id="agrupando-tipo-jer√°rquico">Agrupando: Tipo jer√°rquico</h2>

<p>.pull-left[<img src="../../images/scrna-intro/hierarchal1.png" alt="Una figura de muchos pasos que comienza con varios grupos o ‚Äòclusters‚Äô individuales. El texto dice ‚ÄòIdentificar los dos grupos m√°s cercanos‚Äô y ‚ÄòFusionar los dos grupos m√°s similares‚Äô. El proceso se repite varias veces hasta que todos los grupos quedan absorbidos en uno solo." loading="lazy" />]</p>

<p>.pull-right[
.reduce90[</p>
<ul>
  <li>Usa la matriz de distancias para encontrar los dos puntos m√°s cercanos</li>
  <li>
    <p>Combina y repite</p>
  </li>
  <li>Produce un dendrograma
    <ul>
      <li>Jerarqu√≠a de grupos:</li>
    </ul>
  </li>
</ul>

<p>.pull-right[.image-90[<img src="../../images/scrna-intro/hierarchal2.png" alt="Varios puntos est√°n etiquetados de la A a la F, a la derecha se muestra un dendrograma donde las longitudes de las ramas indican la distancia entre las letras." loading="lazy" />]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>La agrupaci√≥n jer√°rquica es m√°s flexible y no necesita un par√°metro inicial para definir el n√∫mero de grupos resultantes.</li>
  <li>Aqu√≠ los dos puntos m√°s cercanos en una matriz de distancias se unen en un solo grupo, las distancias se recalculan y los siguientes dos puntos m√°s cercanos se vuelven a unir.</li>
  <li>Este proceso se repite hasta que todos los datos se han consumido en uno.</li>
  <li>Al rastrear el proceso hacia atr√°s, se puede establecer una jerarqu√≠a que est√° representada por un dendrograma.</li>
</ul>

<hr />

<h2 id="agrupaci√≥n-comunitaria-louvain">Agrupaci√≥n comunitaria: Louvain</h2>

<p>.center[<img src="../../images/scrna-intro/commgraph1.svg" alt="Se muestra un gr√°fico con puntos conectados por l√≠neas. Abajo, esos puntos se han expandido quedando el rosa muy cerca del naranja y del morado. Cuando se cuantifica el n√∫mero de enlaces que tiene el nodo rosa se obtienen 4 enlaces externos y 0 enlaces internos. A continuaci√≥n se muestran dos opciones hipot√©ticas: si el rosa absorbe el morado, vemos 5 conexiones externas y 1 interna, entonces, se agregan nuevas conexiones, que no es lo deseable. En cambio, si el rosa absorbe al naranja, vemos 3 conexiones externas y 1 interna, por lo que una conexi√≥n se ha convertido en interna y no hay nuevos nodos conectados. Esta reducci√≥n de enlaces externos es la opci√≥n correcta." loading="lazy" />]</p>

<p>.reduce90[
Objetivo: Maximizar los enlaces internos y minimizar los enlaces externos
]</p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>El agrupamiento de Louvain es un tipo de agrupamiento comunitario ampliamente utilizado para datos de single-cell.</li>
  <li>Aqu√≠ a cada c√©lula se le asigna un vecindario propio y se cuenta el n√∫mero de enlaces internos y externos entre vecindarios.</li>
  <li>Para cada iteraci√≥n, se selecciona una c√©lula aleatoria y se coloca dentro de la vecindad de otra c√©lula, y los enlaces internos y externos se cuentan una vez m√°s.</li>
  <li>Si la nueva configuraci√≥n ha reducido el n√∫mero de enlaces externos a favor de m√°s enlaces internos, entonces se mantiene la configuraci√≥n.</li>
</ul>

<hr />

<h2 id="agrupaci√≥n-comunitaria-louvain-1">Agrupaci√≥n comunitaria: Louvain</h2>

<p>.center[<img src="../../images/scrna-intro/commgraph2.svg" alt="El mismo gr√°fico de antes mostrando m√°s pasos permitidos de absorci√≥n entre los nodos, lo que deriva en un gr√°fico simplificado de 4 nodos con dos conexiones cada uno." loading="lazy" />]</p>

<p>.reduce90[</p>
<ul>
  <li>Elige una c√©lula al azar e intenta colocarla en el grupo de un vecino
    <ul>
      <li>Acepta si la relaci√≥n interno:externo aumenta</li>
      <li>Rechaza y elige otro
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span>
Si, en cambio, la nueva configuraci√≥n ha aumentado el n√∫mero de enlaces externos, la configuraci√≥n se rechaza y se selecciona y prueba otra c√©lula. Al realizar esto varias veces, se construye una estructura comunitaria de c√©lulas con el grado de especificidad que desee el usuario.</p>

<hr />

<h1 id="resumen">Resumen</h1>

<p>.pull-left[<img src="../../images/scrna-intro/rna_cells_singlerez.svg" alt="Se muestran grupos de c√©lulas rojas y azules que se asemejan a las manchas de tejido mostradas en las primeras diapositivas. A la derecha, se muestran gr√°ficos de la expresi√≥n de los genes A, B, X por c√©lula." loading="lazy" />]</p>

<p>.pull-right[
.reduce90[</p>
<ul>
  <li>
    <p>Los conjuntos de datos de una sola c√©lula son vastos y est√°n escasamente poblados</p>
  </li>
  <li>
    <p>Se requiere filtrado y normalizaci√≥n de calidad</p>
  </li>
  <li>
    <p>La selecci√≥n de funciones y la reducci√≥n de dimensiones reducen la complejidad</p>
  </li>
  <li>
    <p>La agrupaci√≥n denota tipos de c√©lulas y relaciones de c√©lulas</p>
  </li>
  <li>
    <p>scRNA-seq es un campo impulsado estad√≠sticamente</p>
  </li>
  <li>
    <p>Hay muchas formas de analizar los datos.</p>
    <ul>
      <li>¬°Juega con ello!
]
]</li>
    </ul>
  </li>
</ul>

<p><span>Speaker Notes</span></p>
<ul>
  <li>El an√°lisis de single-cell no es trivial, y cada etapa, desde el filtrado hasta la normalizaci√≥n, la reducci√≥n de dimensiones y el agrupamiento, puede afectar dr√°sticamente el resultado del an√°lisis.</li>
  <li>Debido a la variabilidad en el an√°lisis, uno no debe entrar en p√°nico ante la incertidumbre.</li>
  <li>El objetivo es jugar con los datos hasta que comiencen a reflejar la biolog√≠a.</li>
  <li>Esto puede requerir muchos intentos para lograrlo, y puede que nunca sea perfecto, pero la idea es probar tantas formas diferentes como sea posible para ver a qu√© conclusiones s√≥lidas se puede llegar.</li>
</ul>

<hr />

<h3 id="an√°lisis-adicionales-de-datos-de-scrna-seq">An√°lisis adicionales de datos de scRNA-seq</h3>

<p><img src="../../images/scrna-intro/training_single_cell.png" alt="Captura de pantalla de los materiales de apoyo disponibles en Galaxy que cubren el an√°lisis de datos de Single Cell." loading="lazy" /></p>

<p><span>Speaker Notes</span></p>
<ul>
  <li>En este sentido, los vastos recursos de UseGalaxy se pueden aprovechar probando diferentes caminos de an√°lisis, y Galaxy Training Network ofrece tutoriales y capacitaciones pr√°cticas para ayudarte.</li>
  <li>Exploralos para desarrollar mejor su comprensi√≥n del tema.</li>
</ul>


	<hr />


<h2>Key Points</h2>

<ul>

<li>Los datos scRNA-seq requieren ser pre-procesados antes que un an√°lisis sea llevado a cabo.</li>

<li>Los grupos de c√©lulas con perfiles similares son comparados contra otros grupos.</li>

<li>Los problemas de detectabilidad requieren una atenci√≥n especial en todas las etapas.</li>

<li>La clusterizaci√≥n es una etapa completa del an√°lisis.</li>

</ul>




<h2><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Do you want to extend your knowledge?</h2>
Follow one of our recommended follow-up trainings:



    
        
        
            
        
- [Transcriptomics](/training-material/topics/transcriptomics)
    - Pre-processing of Single-Cell RNA Data: [<i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides](/training-material/topics/transcriptomics/tutorials/scrna-preprocessing/slides.html) - [<i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on](/training-material/topics/transcriptomics/tutorials/scrna-preprocessing/tutorial.html)
    






<h2>Thank you!</h2>

This material is the result of a collaborative work. Thanks to the <a href="https://training.galaxyproject.org" aria-label="Visit the GTN">Galaxy Training Network</a> and all the contributors!




<img src="/training-material/assets/images/GTN.png" alt="Galaxy Training Network" style="height: 100px;"/>


This material is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</section>

        </div>
        
            <footer>
    <div class="container">
        <br><br>
        <p>
            The <a href="https://galaxyproject.org/teach/gtn/">Galaxy Training Network</a>
            provides researchers with online training materials, connects them with local trainers, and helps promoting open data analysis practices worldwide.
        </p>
        <p>
The content of the tutorials is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. The website and infrastructure is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>.
</p>
        <p>This is revision <a href="https://github.com/galaxyproject/training-material/commit/0edcefcd4d92351a00f589e8afc1495a26819797">0edcefcd4d92351a00f589e8afc1495a26819797</a></p>
    </div>
</footer>

        
    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
