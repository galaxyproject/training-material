<!DOCTYPE html>
<html>









  <head>
    <meta charset="utf-8">
    <title>Mass spectrometry: LC-MS preprocessing - advanced</title>
    
        <script async defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>

    
    <link rel="stylesheet" href="/training-material/assets/css/slides.css">
    <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

    
    
    
    
    <meta name="description" content="Training material to analyse Mass spectrometry data in Ga..." />
    <meta property="og:title" content="Galaxy Training: Mass spectrometry: LC-MS preprocessing - advanced" />
    <meta property="og:description" content="Training material to analyse Mass spectrometry data in Ga..." />
    <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    <script type="application/ld+json">
      


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Mass spectrometry: LC-MS preprocessing - advanced",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "https://github.com/galaxyproject/training-material/blob/master/LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Metabolomics",
    "description": "Training material to analyse Mass spectrometry data in Galaxy: Metabolomics (LCMS, FIAMS, GCMS, NMR) and imaging.",
    "url": "https://training.galaxyproject.org//training-material/topics/metabolomics/"
  },
  "courseCode": "metabolomics / lcms-preprocessing / slides",
  "learningResourceType": "slides",
  "name": "Slides for 'Mass spectrometry: LC-MS preprocessing - advanced' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/metabolomics/tutorials/lcms-preprocessing/slides.html",
  "description": "",
  "coursePrerequisites": [
    {
      "@type": "CreativeWork",
      "url": "https://training.galaxyproject.org//training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Jean-François Martin"
    },
    {
      "@type": "Person",
      "name": "Mélanie Petera"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Jean-François Martin"
    },
    {
      "@type": "Person",
      "name": "Mélanie Petera"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Metabolomics",
      "description": "Training material to analyse Mass spectrometry data in Galaxy: Metabolomics (LCMS, FIAMS, GCMS, NMR) and imaging.",
      "url": "https://training.galaxyproject.org//training-material/topics/metabolomics/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3172",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3172",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3172"
    }
  ]
}
    </script>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
  </head>
  <body>
    <textarea id="source">
name: inverse
layout: true
class: center, middle, inverse

<div class="my-header"><span>
<a href="/training-material/topics/metabolomics" title="Return to topic page" ><i class="fa fa-level-up" aria-hidden="true"></i></a>

<a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/metabolomics/tutorials/lcms-preprocessing/slides.html"><i class="fa fa-pencil" aria-hidden="true"></i></a>

</span></div>

<div class="my-footer"><span>

<img src="/training-material/assets/images/GTN-60px.png" alt="Galaxy Training Network" style="height: 40px;"/>

</span></div>

---

# Mass spectrometry: LC-MS preprocessing - advanced



---

## Requirements

Before diving into this slide deck, we recommend you to have a look at:



    
        
        
            
        
- [Introduction to Galaxy Analyses](/training-material/topics/introduction)
    






.footnote[Tip: press `P` to view the presenter notes]

???
Presenter notes contain extra information which might be useful if you
intend to use these slides for teaching.

Press `P` again to switch presenter notes off

Press `C` to create a new window where the same presentation will be displayed.
This window is linked to the main window. Changing slides on one will cause the
slide to change on the other. Useful when presenting.

---

name:raw-to-matrix

## From raw files to data matrix

![](../../images/lcmspreproc_slides_1.1.png)

---

## XCMS

![](../../images/lcmspreproc_slides_1.2.png)

---
name:findchrompeaks

## xcms - findChromPeaks

![](../../images/lcmspreproc_slides_2.1.png)

---

## xcms - findChromPeaks - CentWave algorithm

![](../../images/lcmspreproc_slides_2.2.png)

---

## xcms - findChromPeaks - CentWave algorithm

![](../../images/lcmspreproc_slides_2.3.png)

---

## xcms - findChromPeaks - CentWave algorithm

![](../../images/lcmspreproc_slides_2.4.png)

---

## xcms - findChromPeaks - CentWave algorithm

![](../../images/lcmspreproc_slides_2.5.png)

---

## xcms - findChromPeaks - CentWave parameters

![](../../images/lcmspreproc_slides_2.6.png)

---

## xcms - findChromPeaks - Parameters summary

xcms parameters | related to | description | examples
--- | --- | --- | ---
ppm | m/z | fluctuation of m/z value (ppm) from scan to scan - depends on the mass spectrometer accuracy | 5…
peakwidth | retention time | range of  chromatographic peak width (second) | UPLC 10,40  /  HPLC 20,120
mzdiff | m/z and retention time | minimum difference of m/z for peaks with overlapping retention time (coeluting peak) - must be negative to allow overlap |  -0.001 or 0.05
prefilter (k, I) | Intensity | a peak must be present in k scans with an intensity greater than I | k=3,I=1000
snthresh | Intensity | signal/noise ratio threshold | 5…
noise | Intensity | each centroid must be greater than the &quot;noise&quot; value | .

---
name:groupchrompeaks

## xcms - groupChromPeaks

![](../../images/lcmspreproc_slides_3.1.png)

---

## xcms - groupChromPeaks - Alignment group

![](../../images/lcmspreproc_slides_3.2.png)

---

## xcms - groupChromPeaks - Alignment group

![](../../images/lcmspreproc_slides_3.3.png)

---

## xcms - groupChromPeaks - Alignment group

![](../../images/lcmspreproc_slides_3.4.png)

---

## xcms - groupChromPeaks - minFraction parameter

![](../../images/lcmspreproc_slides_3.5.png)

---

## xcms - groupChromPeaks - Output

![](../../images/lcmspreproc_slides_3.6.png)

---

## xcms - groupChromPeaks - Output

![](../../images/lcmspreproc_slides_3.7.png)

---

## xcms - groupChromPeaks - Parameters summary

xcms parameters | related to | description | examples
--- | --- | --- | ---
binSize | m/z | Size of m/z slices (bins). Range of m/z to be included in a group. Depends on mass spectrometer accuracy. | 
bw | retention time | Standart deviation of the gaussian metapeak that group peaks together. | HPLC 30s  /  UPLC 5s
minFraction | samples | To be valid, a group must be found in at least minFraction*n samples, with n=number of samples **for each class of samples**. A minFraction=0.5 corresponds to 50%. | n=10, minFraction=0.5 =&gt; found in at least 5 samples
max | number of ions | Maximum number of groups detected in a single m/z slices. | 10 or 50

---
name:adjustrtime

## xcms - adjustRtime

![](../../images/lcmspreproc_slides_4.1.png)

---

## xcms - adjustRtime - PeakGroups algorithm

![](../../images/lcmspreproc_slides_4.2.png)

---

## xcms - adjustRtime - PeakGroups - Parameters summary

xcms parameters | related to | description | examples
--- | --- | --- | ---
smooth method | retention time | Regression model to model time deviation among samples (linear or loess). | linear or loess
span |  | Degree of smoothing of the loess model. | 0.2 to 1
extraPeaks | samples | Number of &quot;extra&quot; peaks used to define reference peaks (or well-behaved peaks) for modeling time deviation. Number of Peaks &gt; number of samples. | default=1
minFraction (previously missing) | samples | Minimum proportion of samples with reference peaks. If blank samples are used, minFraction &lt; (1 - proportion of blanks). | 1 - proportion of blank samples

---

## xcms - adjustRtime - Obiwrap algorithm

![](../../images/lcmspreproc_slides_4.3.png)

---
name:beforeafterrt

## xcms - adjustRtime - Output

![](../../images/lcmspreproc_slides_5.png)

---
name:fillchrompeaks

## xcms - fillChromPeaks

![](../../images/lcmspreproc_slides_6.png)

---


---

## Thank you!

This material is the result of a collaborative work. Thanks to the [Galaxy Training Network](https://wiki.galaxyproject.org/Teach/GTN) and all the contributors!


<div class="contributors-line">


<a href="/training-material/hall-of-fame/jfrancoismartin/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/jfrancoismartin" alt="Jean-François Martin">Jean-François Martin</a>, <a href="/training-material/hall-of-fame/melpetera/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/melpetera" alt="Mélanie Petera">Mélanie Petera</a>


</div>



<img src="/training-material/assets/images/GTN.png" alt="Galaxy Training Network" style="height: 100px;"/>


This material is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.


.footnote[Found a typo? Something is wrong in this tutorial? <br/>Edit it on [GitHub](https://github.com/galaxyproject/training-material/tree/master/topics/metabolomics/tutorials/lcms-preprocessing/slides.html)]

    </textarea>
	<script src="/training-material/assets/js/remark-latest.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
      var slideshow = remark.create({navigation: {scroll: false,}});
      var hljs = remark.highlighter.engine;
      var snippets = document.querySelectorAll('code.remark-code');
        [].forEach.call(snippets,function(snippet){
          snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
        });
      var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.parentElement;
      }});
    </script>

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('body').prepend("<div style='text-align: center'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>

  </body>
</html>
