<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Rule Based Uploader: Advanced</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="A collection of microtutorials explaining various feature..." />
        <meta property="og:title" content="Galaxy Training: Rule Based Uploader: Advanced" />
        <meta property="og:description" content="A collection of microtutorials explaining various feature..." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        











<!-- Gitter -->


<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'Galaxy-Training-Network/Lobby'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/galaxy-interface" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">topic</span> User Interface and Data Manipulation
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Language Selector">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Language
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fgalaxy-interface%2Ftutorials%2Fupload-rules-advanced%2Ftutorial.html&edit-text=&act=url" title="">
                                Fran√ßais
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fgalaxy-interface%2Ftutorials%2Fupload-rules-advanced%2Ftutorial.html&edit-text=&act=url" title="">
                                Êó•Êú¨Ë™û
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fgalaxy-interface%2Ftutorials%2Fupload-rules-advanced%2Ftutorial.html&edit-text=&act=url" title="">
                                Espa√±ol
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fgalaxy-interface%2Ftutorials%2Fupload-rules-advanced%2Ftutorial.html&edit-text=&act=url" title="">
                                Portugu√™s
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fgalaxy-interface%2Ftutorials%2Fupload-rules-advanced%2Ftutorial.html&edit-text=&act=url" title="">
                                ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fgalaxy-interface%2Ftutorials%2Fupload-rules-advanced%2Ftutorial.html&edit-text=&act=url" title="">
                                And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>

        <div class="dropdown-item">
            <div>
                Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> üéÉ
                </label>
            </div>

        </div>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/galaxy-interface/tutorials/upload-rules-advanced/tutorial.md">
                            <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Rule Based Uploader: Advanced",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "https://github.com/galaxyproject/training-material/blob/master/LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "User Interface and Data Manipulation",
    "description": "A collection of microtutorials explaining various features of the Galaxy user interface and manipulating data within Galaxy.",
    "url": "https://training.galaxyproject.org//training-material/topics/galaxy-interface/"
  },
  "courseCode": "galaxy-interface / upload-rules-advanced / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Rule Based Uploader: Advanced' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/galaxy-interface/tutorials/upload-rules-advanced/tutorial.html",
  "timeRequired": "PT20M",
  "keywords": "collections, tags",
  "description": "The questions this  addresses are:\n - How to use the rule based uploader to create complex collections\n\n\\nThe objectives are:\n - Learn even more about the Rule Based Uploader\n\n",
  "coursePrerequisites": [
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/galaxy-interface/tutorials/collections/tutorial.html",
      "name": "Using dataset collections",
      "description": "Hands-on for 'Using dataset collections' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    },
    {
      "@type": "Course",
      "url": "https://training.galaxyproject.org//training-material/topics/galaxy-interface/tutorials/upload-rules/tutorial.html",
      "name": "Rule Based Uploader",
      "description": "Hands-on for 'Rule Based Uploader' tutorial",
      "learningResourceType": "hands-on tutorial",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "url": "https://galaxyproject.org/teach/gtn/"
      }
    }
  ],
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "John Chilton"
    },
    {
      "@type": "Person",
      "name": "Helena Rasche"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "John Chilton"
    },
    {
      "@type": "Person",
      "name": "Helena Rasche"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "User Interface and Data Manipulation",
      "description": "A collection of microtutorials explaining various features of the Galaxy user interface and manipulating data within Galaxy.",
      "url": "https://training.galaxyproject.org//training-material/topics/galaxy-interface/"
    }
  ],
  "skillLevel": "Advanced"
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>Rule Based Uploader: Advanced</h1>
        

        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame/jmchilton/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/jmchilton" alt="John Chilton">John Chilton</a>, <a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/hexylena" alt="Helena Rasche">Helena Rasche</a>

</div>

        <blockquote class="overview">
            <h3>Overview</h3>
            <strong><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li><p>How to use the rule based uploader to create complex collections</p>
</li>
            
            </ul>

            <strong><i class="fas fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li><p>Learn even more about the Rule Based Uploader</p>
</li>
            
            </ul>

            
            <strong><i class="fas fa-check-circle" aria-hidden="true"></i><span class="visually-hidden">requirements</span> Requirements</strong>
            <ul>
            
            
    <li>
    
        
        
        <a href="/training-material/topics/galaxy-interface">User Interface and Data Manipulation</a>
        
            <ul>
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Using dataset collections:
                            
                            
                                
                                     <a href="/training-material/topics/galaxy-interface/tutorials/collections/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                            <li> Rule Based Uploader:
                            
                            
                                
                                     <a href="/training-material/topics/galaxy-interface/tutorials/upload-rules/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> hands-on</a>
                                
                            
                            </li>
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
            </ul>
        
    
    </li>

            </ul>
            

            
            <p><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 20 minutes</p>
            

            
            <p><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> Level: </strong>
             Advanced 
<span class="level advanced" title="Advanced Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span> <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">level</span>
</span>

</p>
            

            
            

            

            <p><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last modification:</strong> Jan 6, 2021 </p>
        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <h1 class="no_toc" id="introduction">Introduction</h1>

<p>This builds on the previous Rule Based Uploader tutorial to cover even more advanced topics.</p>

<blockquote class="comment">
  <h3 id="comment-audience"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Audience</h3>
  <p>This tutorial assumes a basic knowledge of using dataset collections in <span class="notranslate">Galaxy</span> but doesn‚Äôt assume any particular knowledge of biology or bioinformatics. If you have not used collections with <span class="notranslate">Galaxy</span> previously, please check out the <a href="/training-material/topics/galaxy-interface/tutorials/collections/tutorial.html">using dataset collections</a> tutorial.</p>
</blockquote>

<blockquote class="agenda">
  <h3 id="agenda">Agenda</h3>

  <p>In this tutorial, we will:</p>

<ol id="markdown-toc">
  <li><a href="#building-urls-from-accession-information" id="markdown-toc-building-urls-from-accession-information">Building URLs from Accession Information</a></li>
  <li><a href="#building-matched-collections" id="markdown-toc-building-matched-collections">Building Matched Collections</a></li>
  <li><a href="#building-nested-lists" id="markdown-toc-building-nested-lists">Building Nested Lists</a></li>
  <li><a href="#apply-rules-to-existing-collections" id="markdown-toc-apply-rules-to-existing-collections">Apply Rules to Existing Collections</a></li>
</ol>

</blockquote>

<h1 id="building-urls-from-accession-information">Building URLs from Accession Information</h1>

<p>In the previous examples the metadata we started with already contained URLs. In some cases such URLs will not be present in the available metadata and may need to be constructed dynamically from identifiers.</p>

<p>For this multiomics example, we will start with a uniprot query and build URLs from accession numbers contained within the supplied tabular data. Consider the uniprot query <a href="https://uniprot.org/uniprot/?query=proteome:UP000052092+AND+proteomecomponent:%22Genome%22">https://uniprot.org/uniprot/?query=proteome:UP000052092+AND+proteomecomponent:‚ÄùGenome‚Äù</a>, pictured below.</p>

<p><img src="../../images/rules/uniprot_url.png" alt="UniProt table screenshot" /></p>

<p>In order to make this data useful for the Rule Builder, we need to turn these accessoin IDs into URLs.</p>

<blockquote class="hands_on" id="example-3-metadata">
  <h3 id="hands_on-hands-on-turn-uniprot-accession-ids-into-urls"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Turn Uniprot Accession IDs into URLs</h3>

  <ol>
    <li>Open <a href="https://www.uniprot.org/uniprot/E7C0H6">Uniprot</a></li>
    <li><strong>Click</strong> on one of the entries in the table (e.g. <code class="language-plaintext highlighter-rouge">E7C0H6</code>)</li>
    <li><strong>Select</strong> <code class="language-plaintext highlighter-rouge">Format</code> from the top menu</li>
    <li>
      <p><strong>Click</strong> <code class="language-plaintext highlighter-rouge">FASTA (canonical)</code></p>

      <p><img src="../../images/rules/uniprot_fasta.png" alt="Link to access FASTA file" /></p>
    </li>
    <li>
      <p>Your browser will redirect to the fasta file</p>

      <p><img src="../../images/rules/uniprot_fasta_url.png" alt="Viewing the FASTA file" /></p>
    </li>
    <li>We can deduce that the FASTA files for the other accession IDs will be available from URLs of the form <code class="language-plaintext highlighter-rouge">https://www.uniprot.org/uniprot/{identifier}.fasta</code></li>
  </ol>

</blockquote>

<p>We will use this information to build a collection of FASTA files from our query.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-build-collection-from-uniprot-accession-ids"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Build Collection from Uniprot Accession IDs</h3>

  <ol>
    <li>Open the Rule Builder
      <ul>
        <li><em>‚ÄúUpload data as‚Äù</em>: <code class="language-plaintext highlighter-rouge">Collection(s)</code></li>
        <li><em>‚ÄúLoad tabular data from‚Äù</em>: <code class="language-plaintext highlighter-rouge">Pasted Table</code></li>
        <li>
          <p><strong>Paste</strong> the following table:</p>

          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Entry	Entry name	Status	Protein names	Gene names	Organism	Length
E7C0H6	E7C0H6_9PAPI	unreviewed	Major capsid protein L1	L1	Equus caballus papillomavirus 3	498
E7C0H0	E7C0H0_9PAPI	unreviewed	Protein E6	E6	Equus caballus papillomavirus 3	150
E7C0H5	E7C0H5_9PAPI	unreviewed	Minor capsid protein L2	L2	Equus caballus papillomavirus 3	498
E7C0H1	E7C0H1_9PAPI	unreviewed	Protein E7		Equus caballus papillomavirus 3	93
E7C0H3	E7C0H3_9PAPI	unreviewed	Regulatory protein E2	E2	Equus caballus papillomavirus 3	421
E7C0H4	E7C0H4_9PAPI	unreviewed	Putative E4 early protein (Fragment)		Equus caballus papillomavirus 3	175
E7C0H2	E7C0H2_9PAPI	unreviewed	Replication protein E1 (EC 3.6.4.12) (ATP-dependent helicase E1)	E1	Equus caballus papillomavirus 3	621
</code></pre></div>          </div>
        </li>
        <li>Click <code class="language-plaintext highlighter-rouge">Build</code>
<img src="../../images/rules/rules_example_4_2_initial_rules.png" alt="screenshot" /></li>
      </ul>
    </li>
    <li>Let‚Äôs apply some initial filtering to our data:
      <ul>
        <li>From <strong>Filter</strong> menu, select <code class="language-plaintext highlighter-rouge">First or Last N Rows</code>
          <ul>
            <li>Filter the first row</li>
          </ul>
        </li>
        <li>From <strong>Rules</strong> menu, select  <code class="language-plaintext highlighter-rouge">Remove Columns</code>
          <ul>
            <li>Remove columns B, C, E, F, and G.</li>
          </ul>
        </li>
        <li>From <strong>Rules</strong> menu, select  <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
          <ul>
            <li>
              <p>Click <code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">Info</code>, Column <code class="language-plaintext highlighter-rouge">B</code></p>

              <p>This is a block of text that will appear in the history panel when the dataset is expanded.
<img src="../../images/rules/rules_example_4_3_basic_rules.png" alt="screenshot" /></p>
            </li>
          </ul>
        </li>
      </ul>

      <p>These datasets appear in a seemingly random order, it will be easier to manage things in the history panel if we sort this data first.
<img src="../../images/rules/rules_example_4_4_sort.png" alt="screenshot" /></p>
    </li>
    <li>From <strong>Rules</strong> menu, select <code class="language-plaintext highlighter-rouge">Sort</code>
      <ul>
        <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
      </ul>

      <p>Next is the key step, we will build a URL from the pattern we described above using the accession ID in column A.</p>
    </li>
    <li>From <strong>Column</strong> menu, select <code class="language-plaintext highlighter-rouge">Using a Regular <span class="notranslate">Expression</span></code>
      <ul>
        <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
        <li>Select <code class="language-plaintext highlighter-rouge">Create column from <span class="notranslate">expression</span> replacement</code></li>
        <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">.*</code></li>
        <li><em>‚ÄúReplacement <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">https://www.uniprot.org/uniprot/\0.fasta</code></li>
        <li>
          <p>Click <code class="language-plaintext highlighter-rouge">Apply</code></p>

          <p><img src="../../images/rules/rules_example_4_5_url.png" alt="screenshot" /></p>
        </li>
      </ul>

      <blockquote class="comment">
        <h3 id="comment-regular-expression-explained"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Regular <span class="notranslate">expression</span> explained</h3>
        <p>In this regular <span class="notranslate">expression</span>, <code class="language-plaintext highlighter-rouge">.*</code> will capture the entire accession ID.</p>

        <p>In the replacement <span class="notranslate">expression</span>, <code class="language-plaintext highlighter-rouge">https://www.uniprot.org/uniprot/\0.fasta</code>, the <code class="language-plaintext highlighter-rouge">\0</code> will be replaced by the captured
regular <span class="notranslate">expression</span> (the accession ID) in the resulting column values.</p>
      </blockquote>

      <p>The new column C with the URL we built should appear as shown below.
<img src="../../images/rules/rules_example_4_6_url_built.png" alt="screenshot" /></p>

      <p>Finally, let us set our column definitions:</p>
    </li>
    <li>From <strong>Rules</strong> menu, select <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>, Select Column <code class="language-plaintext highlighter-rouge">A</code></li>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">URL</code>, Column <code class="language-plaintext highlighter-rouge">C</code></li>
      </ul>
    </li>
    <li>Finalize the collection:
      <ul>
        <li><em>‚ÄúName‚Äù</em>: for example <code class="language-plaintext highlighter-rouge">UP000052092</code></li>
        <li><em>‚ÄúType‚Äù</em>: <code class="language-plaintext highlighter-rouge">fasta</code></li>
        <li>Click <code class="language-plaintext highlighter-rouge">Upload</code>
<img src="../../images/rules/rules_example_4_7_mapping_extension_and_name.png" alt="screenshot" /></li>
      </ul>

      <blockquote class="comment">
        <h3 id="comment-json-rule-definitions"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> JSON Rule Definitions</h3>
        <p>This example is ready to go, but before clicking ‚ÄúBuild‚Äù it may be interesting to check out the rules <span class="notranslate">Galaxy</span> is following to clean and import your data. Click the little Wrench icon at the top of the list of rules. The result is a bunch of JavaScript object notation (JSON) text that you should never need to worry about but that you can build or modify by hand if you find it useful. We will use it the next example to quickly restore the list builder back to this state.</p>

        <p><img src="../../images/rules/rules_example_4_8_source.png" alt="screenshot" /></p>

        <p>This could additionally be copied and pasted if you need to do the same set of operations on multiple metadata inputs that are similarly formatted.</p>
      </blockquote>
    </li>
    <li>Click <code class="language-plaintext highlighter-rouge">Build</code> and wait for your list of FASTA files to appear.</li>
  </ol>
</blockquote>

<h1 id="building-matched-collections">Building Matched Collections</h1>

<p>This example will demonstrate creating multiple collections at the same time. We will use the same metadata generated from UniProt as the last example but we will build two collections with matching list identifiers - one collection of FASTA files and one collection of GFF files. This will also demonstrate reading the collection name and the target datatype from the metadata itself - important techniques if generating multiple collections with different names and datatypes.</p>

<p>For this example we will re-use the metadata from the <a href="#example-3-metadata">previous example</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-build-a-matched-collection"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Build a matched collection</h3>

  <ol>
    <li><strong>Open</strong> the Rule Builder
      <ul>
        <li><em>‚ÄúUpload data as‚Äù</em>: <code class="language-plaintext highlighter-rouge">Collection(s)</code></li>
        <li><em>‚ÄúLoad tabular data from‚Äù</em>: <code class="language-plaintext highlighter-rouge">Pasted Table</code></li>
        <li>Paste the table from the previous exercise:
          <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Entry	Entry name	Status	Protein names	Gene names	Organism	Length
E7C0H6	E7C0H6_9PAPI	unreviewed	Major capsid protein L1	L1	Equus caballus papillomavirus 3	498
E7C0H0	E7C0H0_9PAPI	unreviewed	Protein E6	E6	Equus caballus papillomavirus 3	150
E7C0H5	E7C0H5_9PAPI	unreviewed	Minor capsid protein L2	L2	Equus caballus papillomavirus 3	498
E7C0H1	E7C0H1_9PAPI	unreviewed	Protein E7		Equus caballus papillomavirus 3	93
E7C0H3	E7C0H3_9PAPI	unreviewed	Regulatory protein E2	E2	Equus caballus papillomavirus 3	421
E7C0H4	E7C0H4_9PAPI	unreviewed	Putative E4 early protein (Fragment)		Equus caballus papillomavirus 3	175
E7C0H2	E7C0H2_9PAPI	unreviewed	Replication protein E1 (EC 3.6.4.12) (ATP-dependent helicase E1)	E1	Equus caballus papillomavirus 3	621
</code></pre></div>          </div>
        </li>
        <li>Click <code class="language-plaintext highlighter-rouge">Build</code> and proceed to the rule builder.
<img src="../../images/rules/rules_example_5_1_inputs.png" alt="screenshot" /></li>
      </ul>
    </li>
    <li>
      <p>Instead of manually creating the rules this time, we will import an existing set of rules from some JSON. Copy the following text into your clipboard. These are the same rules as used in the <a href="#building-urls-from-accession-information">Building URLs from Accession Information</a> tutorial.</p>

      <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"rules"</span><span class="p">:[{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"add_filter_count"</span><span class="p">,</span><span class="nl">"count"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="nl">"which"</span><span class="p">:</span><span class="s2">"first"</span><span class="p">,</span><span class="nl">"invert"</span><span class="p">:</span><span class="kc">false</span><span class="p">},{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"remove_columns"</span><span class="p">,</span><span class="nl">"target_columns"</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]},{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"sort"</span><span class="p">,</span><span class="nl">"target_column"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"numeric"</span><span class="p">:</span><span class="kc">false</span><span class="p">},{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"add_column_regex"</span><span class="p">,</span><span class="nl">"target_column"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"<span class="notranslate">expression</span>"</span><span class="p">:</span><span class="s2">".*"</span><span class="p">,</span><span class="nl">"replacement"</span><span class="p">:</span><span class="s2">"http://www.uniprot.org/uniprot/</span><span class="se">\\</span><span class="s2">0.fasta"</span><span class="p">}],</span><span class="nl">"<span class="notranslate">mapping</span>"</span><span class="p">:[{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"info"</span><span class="p">,</span><span class="nl">"columns"</span><span class="p">:[</span><span class="mi">1</span><span class="p">]},{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"list_identifiers"</span><span class="p">,</span><span class="nl">"columns"</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span><span class="nl">"editing"</span><span class="p">:</span><span class="kc">false</span><span class="p">},{</span><span class="nl">"type"</span><span class="p">:</span><span class="s2">"url"</span><span class="p">,</span><span class="nl">"columns"</span><span class="p">:[</span><span class="mi">2</span><span class="p">]}],</span><span class="nl">"extension"</span><span class="p">:</span><span class="s2">"csfasta"</span><span class="p">}</span><span class="w">
</span></code></pre></div>      </div>
    </li>
    <li>In the ruler builder interface, select the <strong>wrench icon</strong> next to the word <code class="language-plaintext highlighter-rouge">Rules</code>
      <ul>
        <li>Paste the rules into the textbox</li>
        <li>Click <code class="language-plaintext highlighter-rouge">Apply</code></li>
      </ul>

      <p><img src="../../images/rules/rules_example_5_2_source.png" alt="screenshot" /></p>

      <p>You should now see the rules you created in the last example.
<img src="../../images/rules/rules_example_5_3_initial_rules.png" alt="screenshot" /></p>

      <p>This next part may seem a bit silly at first but we are going to add some columns with fixed values into the builder. When we split up the columns at a later step this will make sense.</p>
    </li>
    <li>From <strong>Column</strong> menu, select  <code class="language-plaintext highlighter-rouge">Fixed Value</code>
      <ul>
        <li><em>‚ÄúValue‚Äù</em>: <code class="language-plaintext highlighter-rouge">fasta</code></li>
        <li>Click <code class="language-plaintext highlighter-rouge">Apply</code>
This value will eventually be used for the datatype of the file.</li>
      </ul>
    </li>
    <li><strong>Repeat</strong> this process with:
      <ul>
        <li><em>‚ÄúValue‚Äù</em>:<code class="language-plaintext highlighter-rouge">UP000052092 FASTA</code></li>
      </ul>

      <p>Next we will repeat the process of adding URL, name, and datatype columns but for GFF files.</p>
    </li>
    <li>From <strong>Column</strong>, select <code class="language-plaintext highlighter-rouge">Using a Regular <span class="notranslate">Expression</span></code>
      <ul>
        <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
        <li>Select <code class="language-plaintext highlighter-rouge">Create column from <span class="notranslate">expression</span> replacement</code></li>
        <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">.*</code></li>
        <li><em>‚ÄúReplacement <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">https://www.uniprot.org/uniprot/\0.gff</code>.
 <img src="../../images/rules/rules_example_5_5_url.png" alt="screenshot" /></li>
      </ul>

      <p>Next we will add two more columns</p>
    </li>
    <li>From <strong>Column</strong> menu, select  <code class="language-plaintext highlighter-rouge">Fixed Value</code>
      <ul>
        <li><em>‚ÄúValue‚Äù</em>: <code class="language-plaintext highlighter-rouge">gff3</code></li>
        <li>Click <code class="language-plaintext highlighter-rouge">Apply</code></li>
      </ul>

      <p>This value will eventually be used for the datatype of the file.</p>
    </li>
    <li><strong>Repeat</strong> this process with:
      <ul>
        <li><em>‚ÄúValue‚Äù</em>: <code class="language-plaintext highlighter-rouge">UP000052092 GFF3</code></li>
      </ul>

      <p>Your very large list of rules should now look like the following screenshot.
<img src="../../images/rules/rules_example_5_6_presplit.png" alt="screenshot" /></p>

      <p>Notice we have two URLs, two collection names, and two datatype extensions for each accession ID we started with. Like in the example where we split the columns, here we will split these up to describe multiple collections.</p>
    </li>
    <li>From <strong>Rules</strong> menu, select  <code class="language-plaintext highlighter-rouge">Split Columns</code>
      <ul>
        <li><em>‚ÄúOdd Number Column(s)‚Äù</em>: <code class="language-plaintext highlighter-rouge">C</code>, <code class="language-plaintext highlighter-rouge">D</code>, and <code class="language-plaintext highlighter-rouge">E</code> (the fasta columns)</li>
        <li><em>‚ÄúEven Number Column(s)‚Äù</em>: <code class="language-plaintext highlighter-rouge">F</code>, <code class="language-plaintext highlighter-rouge">G</code>, and <code class="language-plaintext highlighter-rouge">H</code> (the gff3 columns)</li>
      </ul>

      <p>This will take the row consisting of the columns <code class="language-plaintext highlighter-rouge">ABCDEFGH</code> and build two rows, one with <code class="language-plaintext highlighter-rouge">ABCDEF</code> and the other with <code class="language-plaintext highlighter-rouge">ABFGH</code>
<img src="../../images/rules/rules_example_5_7_split_columns.png" alt="screenshot" /></p>
    </li>
    <li>
      <p>Click <code class="language-plaintext highlighter-rouge">Apply</code> and you should be returned the list of rules.
<img src="../../images/rules/rules_example_5_8_split.png" alt="screenshot" /></p>

      <p>Finally, we need to add some more column definitions for these new columns we just created:</p>
    </li>
    <li>From <strong>Rules</strong> menu, select <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier</code>, Column <code class="language-plaintext highlighter-rouge">A</code></li>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">Info</code>, Column <code class="language-plaintext highlighter-rouge">B</code></li>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">URL</code>, Column <code class="language-plaintext highlighter-rouge">C</code></li>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">Type</code>, Column <code class="language-plaintext highlighter-rouge">D</code></li>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">Collection Name</code>, Column <code class="language-plaintext highlighter-rouge">E</code></li>
      </ul>

      <p>Notice when these values are being generated from the metadata the option to specify them manually from the <strong>type</strong> and <strong>collection name</strong> boxes from the bottom of the form disappear.
<img src="../../images/rules/rules_example_5_9_mapping.png" alt="screenshot" /></p>
    </li>
    <li>
      <p>Click <code class="language-plaintext highlighter-rouge">Upload</code></p>

      <p><span class="notranslate">Galaxy</span> should make two collections - one containing FASTA files and one containing GFF3 files.</p>
    </li>
  </ol>

</blockquote>

<h1 id="building-nested-lists">Building Nested Lists</h1>

<p>In this example, we will be building a nested list using data from <a href="https://www.ncbi.nlm.nih.gov/sra">SRA</a>. This is a more sophisticated structure for organizing datasets in <span class="notranslate">Galaxy</span>. In the above examples we organized datasets into simple lists with a single ‚Äúlist identifier‚Äù describing the files in the collection. <span class="notranslate">Galaxy</span> allows lists to be organized into nested lists - where each level of the list has an identifier.</p>

<p>If two such identifiers are present, this is a list of lists (called <code class="language-plaintext highlighter-rouge">list:list</code> in the <span class="notranslate">workflow</span> editor). In such a structure the outer identifiers (or first level of identifiers) may describe sample names and the inner identifiers (or second level) may describe replicates. Alte<span class="notranslate">rna</span>tive the outer identifiers may describe conditions and the inner identifiers may describe individual samples. The structure of such collections should ideally be dictated by the study design.</p>

<p>If certain parts of your analysis require benefit from datasets being nested this way while other parts require feeding you data to a <span class="notranslate">Galaxy</span> tool all together without such a structure, then it is probably best to go ahead and build nested lists at the start of your analysis and then use the ‚ÄúFlatten Collection‚Äù tool on the resulting collection or a derivative collection to get the flat structure needed by certain tools in certain parts of your analysis.</p>

<p>For this example, we will describe analyzing the metadata of the <a href="https://www.ncbi.nlm.nih.gov/sra?term=PRJNA355367&amp;cmd=DetailsSearch">SRA project PRJNA355367</a>. Unlike the other examples, these SRA files are relatively large and not ideal for training purposes. So we‚Äôve pre-downloaded the project metadata and replaced all the links with simple text files that should download really quickly - the <a href="./PRJNA355367.tsv">result is here</a>.</p>

<p>So use either the SRA exporter tool or download the CSV file with fake URLs. If you download the data from the SRA exporter tool, select only the first 12 columns from the data (up to the column labeled ‚ÄúLibrary Name‚Äù) and copy the resulting data to your clipboard.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-building-nested-lists"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Building Nested Lists</h3>

  <ol>
    <li>Open the Rule Builder
      <ul>
        <li><em>‚ÄúUpload data as‚Äù</em>: <code class="language-plaintext highlighter-rouge">Collection(s)</code></li>
        <li><em>‚ÄúLoad tabular data from‚Äù</em>: <code class="language-plaintext highlighter-rouge">Pasted Table</code></li>
        <li>Paste the table</li>
      </ul>

      <blockquote class="solution">
        <h3 id="solution-show-table"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Show Table</h3>

        <p>Below is the table with pre-downloaded example data mentioned above:</p>

        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Run	ReleaseDate	LoadDate	spots	bases	spots_with_mates	avgLength	size_MB	AssemblyName	download_path	Experiment	LibraryName
SRR5363633	2017-03-21 11:40:07	2017-03-21 11:29:13	9942851	1993124486	9791175	200	809	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363633	SRX2659078	wtPA14
SRR5363634	2017-03-21 13:19:08	2017-03-21 13:17:11	1158307	232298840	1141697	200	81	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363634	SRX2659079	con10
SRR5363635	2017-03-21 13:19:08	2017-03-21 13:16:39	1270067	254490549	1249658	200	89	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363635	SRX2659080	con9
SRR5363636	2017-03-21 13:19:08	2017-03-21 13:16:56	1023725	205709452	1013013	200	74	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363636	SRX2659081	con8
SRR5363637	2017-03-21 11:37:06	2017-03-21 11:28:00	3179821	638410351	3141113	200	216	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363637	SRX2659082	con7
SRR5363638	2017-03-21 12:53:08	2017-03-21 12:04:58	3359498	675138344	3325080	200	288	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363638	SRX2659083	con6
SRR5363639	2017-03-21 13:19:08	2017-03-21 13:17:25	2074389	416191247	2046343	200	145	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363639	SRX2659084	con5
SRR5363640	2017-03-21 13:19:08	2017-03-21 13:17:46	2692438	540402576	2658118	200	187	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363640	SRX2659085	con4
SRR5363641	2017-03-21 13:19:08	2017-03-21 13:17:14	2271913	456015568	2243122	200	161	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363641	SRX2659086	con3
SRR5363642	2017-03-21 13:19:08	2017-03-21 13:16:58	2164949	434399488	2136063	200	151	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363642	SRX2659087	con2
SRR5363643	2017-03-21 11:37:06	2017-03-21 11:27:34	1999861	401313700	1973567	200	140	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363643	SRX2659088	con1
SRR5363644	2017-03-21 11:44:06	2017-03-21 11:36:06	13473203	2704705108	13306228	200	1076	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363644	SRX2659089	str10
SRR5363645	2017-03-21 11:37:06	2017-03-21 11:27:24	1801962	362038363	1782599	200	130	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363645	SRX2659090	str9
SRR5363646	2017-03-21 11:36:06	2017-03-21 11:26:22	39113	7861711	39106	200	4	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363646	SRX2659091	str8
SRR5363647	2017-03-21 11:36:06	2017-03-21 11:26:43	1255569	252289127	1242359	200	90	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363647	SRX2659092	str7
SRR5363648	2017-03-21 11:36:06	2017-03-21 11:26:42	903374	181362535	892308	200	64	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363648	SRX2659093	str6
SRR5363649	2017-03-21 11:37:06	2017-03-21 11:27:05	2059145	413598822	2035919	200	140	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363649	SRX2659094	str5
SRR5363650	2017-03-21 11:37:06	2017-03-21 11:27:37	1685689	338152407	1662375	200	119	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363650	SRX2659095	str4
SRR5363651	2017-03-21 11:36:06	2017-03-21 11:26:51	698470	140689157	694502	201	48	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363651	SRX2659096	str3
SRR5363652	2017-03-21 11:37:06	2017-03-21 11:27:53	755393	152119594	750753	201	52	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363652	SRX2659097	str2
SRR5363653	2017-03-21 11:37:06	2017-03-21 11:27:41	1651613	331529685	1630882	200	119	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363653	SRX2659098	str1
SRR5363654	2017-03-21 11:37:06	2017-03-21 11:27:37	1693765	340003252	1672625	200	118	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363654	SRX2659099	gen10
SRR5363655	2017-03-21 11:37:06	2017-03-21 11:28:30	2173449	436124391	2144642	200	153	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363655	SRX2659100	gen9
SRR5363656	2017-03-21 11:43:06	2017-03-21 11:33:05	9625215	1933561588	9519090	200	778	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363656	SRX2659101	gen8
SRR5363657	2017-03-21 11:37:06	2017-03-21 11:27:38	1106350	222126014	1092932	200	79	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363657	SRX2659102	gen7
SRR5363658	2017-03-21 11:37:07	2017-03-21 11:27:07	565475	113765064	560920	201	42	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363658	SRX2659103	gen6
SRR5363659	2017-03-21 11:37:07	2017-03-21 11:28:20	1320926	265553033	1308329	201	96	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363659	SRX2659104	gen5
SRR5363660	2017-03-21 11:37:07	2017-03-21 11:28:18	949047	190786413	939940	201	70	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363660	SRX2659105	gen4
SRR5363661	2017-03-21 11:39:07	2017-03-21 11:29:11	1609659	323469152	1593027	200	116	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363661	SRX2659106	gen3
SRR5363662	2017-03-21 11:37:07	2017-03-21 11:28:20	1244105	249942443	1230587	200	90	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363662	SRX2659107	gen2
SRR5363663	2017-03-21 11:44:06	2017-03-21 11:34:00	13546763	2714292352	13327595	200	1112	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363663	SRX2659108	gen1
SRR5363664	2017-03-21 11:37:07	2017-03-21 11:28:35	1995417	400617217	1971115	200	140	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363664	SRX2659109	pit9
SRR5363665	2017-03-21 11:39:07	2017-03-21 11:29:18	2098280	421450493	2074524	200	146	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363665	SRX2659110	pit10
SRR5363666	2017-03-21 11:39:07	2017-03-21 11:28:56	1624164	326200210	1605561	200	115	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363666	SRX2659111	pit8
SRR5363667	2017-03-21 11:39:07	2017-03-21 11:28:56	1765896	355178220	1750742	201	122	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363667	SRX2659112	pit7
SRR5363668	2017-03-21 11:39:07	2017-03-21 11:29:36	834144	167643900	825708	200	59	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363668	SRX2659113	pit6
SRR5363669	2017-03-21 11:42:06	2017-03-21 11:31:07	9524989	1913263017	9418320	200	780	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363669	SRX2659114	pit5
SRR5363670	2017-03-21 11:39:07	2017-03-21 11:28:48	1196456	240479817	1184548	200	84	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363670	SRX2659115	pit4
SRR5363671	2017-03-21 11:39:07	2017-03-21 11:29:21	1703068	341745049	1680568	200	119	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363671	SRX2659116	pit3
SRR5363672	2017-03-21 11:40:07	2017-03-21 11:29:21	1752519	352259586	1735224	201	122	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363672	SRX2659117	pit2
SRR5363673	2017-03-21 11:37:07	2017-03-21 11:28:40	1702102	341794907	1682027	200	121	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363673	SRX2659118	pit1
SRR5363674	2017-03-21 11:37:07	2017-03-21 11:28:41	2186337	438861929	2158858	200	155	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363674	SRX2659119	car10
SRR5363675	2017-03-21 11:37:07	2017-03-21 11:28:37	1806341	362679360	1784566	200	128	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363675	SRX2659120	car9
SRR5363676	2017-03-21 11:37:07	2017-03-21 11:28:29	1492644	299621613	1473926	200	106	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363676	SRX2659121	car8
SRR5363677	2017-03-21 11:40:07	2017-03-21 11:29:02	2139706	429729175	2115063	200	151	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363677	SRX2659122	car7
SRR5363678	2017-03-21 11:40:07	2017-03-21 11:29:13	1787521	358790286	1764881	200	124	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363678	SRX2659123	car6
SRR5363679	2017-03-21 11:38:06	2017-03-21 11:28:48	1500378	300767719	1477539	200	106	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363679	SRX2659124	car5
SRR5363680	2017-03-21 11:38:06	2017-03-21 11:28:54	879242	176495860	868255	200	63	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363680	SRX2659125	car4
SRR5363681	2017-03-21 11:40:07	2017-03-21 11:30:02	1852256	371663665	1827605	200	130	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363681	SRX2659126	car3
SRR5363682	2017-03-21 11:40:07	2017-03-21 11:29:40	996680	199979148	983324	200	72	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363682	SRX2659127	car2
SRR5363683	2017-03-21 11:40:07	2017-03-21 11:29:49	1089078	218680766	1076092	200	79	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363683	SRX2659128	car1
SRR5363684	2017-03-21 11:40:07	2017-03-21 11:29:57	1682993	337921519	1662784	200	118	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363684	SRX2659129	cef10
SRR5363685	2017-03-21 11:40:07	2017-03-21 11:29:46	1274849	255689623	1256747	200	92	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363685	SRX2659130	cef9
SRR5363686	2017-03-21 11:40:07	2017-03-21 11:29:22	1218188	244568636	1203299	200	87	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363686	SRX2659131	cef8
SRR5363687	2017-03-21 11:40:07	2017-03-21 11:30:06	2027741	406979584	2001785	200	142	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363687	SRX2659132	cef7
SRR5363688	2017-03-21 11:40:07	2017-03-21 11:29:38	998237	200918449	991068	201	72	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363688	SRX2659133	cef6
SRR5363689	2017-03-21 11:40:07	2017-03-21 11:29:26	518920	104507529	515814	201	41	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363689	SRX2659134	cef5
SRR5363690	2017-03-21 11:44:06	2017-03-21 11:33:47	11530820	2311357478	11354074	200	982	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363690	SRX2659135	cef4
SRR5363691	2017-03-21 11:40:07	2017-03-21 11:29:41	516125	103920037	512793	201	41	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363691	SRX2659136	cef3
SRR5363692	2017-03-21 11:40:07	2017-03-21 11:30:11	890572	179326220	884948	201	65	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363692	SRX2659137	cef2
SRR5363693	2017-03-21 11:40:07	2017-03-21 11:30:04	978135	196865238	971039	201	74	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363693	SRX2659138	cef1
SRR5363694	2017-03-21 11:40:07	2017-03-21 11:29:57	1959249	393031721	1932180	200	138	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363694	SRX2659139	imi2
SRR5363695	2017-03-21 11:40:07	2017-03-21 11:29:43	1074984	215595123	1059636	200	76	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363695	SRX2659140	imi1
SRR5363696	2017-03-21 11:41:07	2017-03-21 11:29:48	1288979	258545055	1270889	200	92	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363696	SRX2659141	dor10
SRR5363697	2017-03-21 11:42:06	2017-03-21 11:31:06	2908416	583478795	2868638	200	200	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363697	SRX2659142	dor9
SRR5363698	2017-03-21 11:49:07	2017-03-21 11:37:59	15442120	3097410993	15225523	200	1224	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363698	SRX2659143	dor8
SRR5363699	2017-03-21 11:40:07	2017-03-21 11:30:00	1718167	344971206	1697410	200	123	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363699	SRX2659144	dor7
SRR5363700	2017-03-21 11:41:07	2017-03-21 11:29:57	1739828	349655178	1722126	200	125	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363700	SRX2659145	dor6
SRR5363701	2017-03-21 11:45:06	2017-03-21 11:35:22	18584730	3732962863	18375556	200	1453	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363701	SRX2659146	dor5
SRR5363702	2017-03-21 11:44:06	2017-03-21 11:35:13	12158676	2438787680	11987886	200	981	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363702	SRX2659147	dor4
SRR5363703	2017-03-21 11:44:06	2017-03-21 11:34:44	11391713	2283748728	11219804	200	916	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363703	SRX2659148	dor3
SRR5363704	2017-03-21 11:42:06	2017-03-21 11:32:45	6155766	1236497552	6086854	200	513	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363704	SRX2659149	dor2
SRR5363705	2017-03-21 11:41:07	2017-03-21 11:30:25	1002355	201209957	989835	200	72	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363705	SRX2659150	dor1
SRR5363706	2017-03-21 11:41:07	2017-03-21 11:30:25	752409	151419028	746795	201	59	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363706	SRX2659151	cip10
SRR5363707	2017-03-21 11:44:06	2017-03-21 11:33:49	10594069	2127067244	10466132	200	870	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363707	SRX2659152	cip9
SRR5363708	2017-03-21 11:41:07	2017-03-21 11:30:31	1431059	287670501	1417182	201	105	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363708	SRX2659153	cip8
SRR5363709	2017-03-21 11:41:07	2017-03-21 11:30:41	1208297	242791534	1195595	200	88	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363709	SRX2659154	cip7
SRR5363710	2017-03-21 11:41:07	2017-03-21 11:30:35	1370364	275356971	1355960	200	100	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363710	SRX2659155	cip6
SRR5363711	2017-03-21 11:42:06	2017-03-21 11:31:24	1593545	320335049	1578109	201	116	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363711	SRX2659156	cip5
SRR5363712	2017-03-21 11:41:07	2017-03-21 11:31:00	1332160	267714312	1318490	200	99	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363712	SRX2659157	cip4
SRR5363713	2017-03-21 11:42:06	2017-03-21 11:31:02	1893119	379943269	1868718	200	134	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363713	SRX2659158	cip3
SRR5363714	2017-03-21 11:42:06	2017-03-21 11:31:01	1839276	369651139	1820660	200	129	assembly	https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>-examples/master/sra_PRJNA355367/SRR5363714	SRX2659159	cip2
SRR5363715	2017-03-21 11:26:06	2017-03-21 10:59:33	712060	142833136	702138	200	51	assembly	https://sra-download.ncbi.nlm.nih.gov/traces/sra46/SRR/005238/SRR5363715	SRX2659160	cip1
</code></pre></div>        </div>
      </blockquote>

      <p><img src="../../images/rules/rules_example_6_1_paste.png" alt="screenshot" /></p>

      <p>The resulting table should look something like the following:
<img src="../../images/rules/rules_example_6_2_rules_landing.png" alt="screenshot" /></p>

      <p>Navigate to the end of the table and notice that column J is the URL target we are hoping to download for each file.</p>
    </li>
    <li>As in the previous exercises, please:
      <ul>
        <li>Set this <code class="language-plaintext highlighter-rouge">Column definition</code> for the URL target</li>
        <li>
          <p>Strip the header row</p>

          <blockquote class="solution">
            <h3 id="solution-solution"><i class="far fa-eye" aria-hidden="true"></i><span class="visually-hidden">solution</span> Solution</h3>
            <p>From <strong>Filter</strong> menu, select <code class="language-plaintext highlighter-rouge">First or Last N Rows</code></p>
            <ul>
              <li>Filter first Row</li>
            </ul>

            <p>From <strong>Rules</strong> menu, select  <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code></p>
            <ul>
              <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">URL</code>, Column <code class="language-plaintext highlighter-rouge">J</code>.
  <img src="../../images/rules/rules_example_6_3_end_of_table.png" alt="screenshot" /></li>
            </ul>
          </blockquote>
        </li>
      </ul>

      <p>For the analysis we wish to do, we want to group these files based on the type indicated in column <code class="language-plaintext highlighter-rouge">L</code> (LibraryName) shown below.
The source data though adds numbers to the library type to to generate the <code class="language-plaintext highlighter-rouge">LibraryName</code>, we need to strip those out to use the type
as an identifier for grouping the datasets. To do this, use the regex column adder rule again.</p>
    </li>
    <li>From <strong>Column</strong> menu, select <code class="language-plaintext highlighter-rouge">Using a Regular <span class="notranslate">Expression</span></code>
      <ul>
        <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">L</code></li>
        <li>Select <code class="language-plaintext highlighter-rouge">Create column from regular <span class="notranslate">expression</span> groups</code></li>
        <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">([^\d]+)\d+</code>.</li>
        <li><em>‚ÄúNumber of Groups‚Äù</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
      </ul>

      <p>The result looks like:
<img src="../../images/rules/rules_example_6_4_regex.png" alt="screenshot" /></p>

      <blockquote class="comment">
        <h3 id="comment-regular-expression-explained-1"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Regular <span class="notranslate">expression</span> explained</h3>
        <p>In this regular <span class="notranslate">expression</span>, <code class="language-plaintext highlighter-rouge">\d</code> means any digit, so <code class="language-plaintext highlighter-rouge">[^...]</code> means match anything that is not inside the brackets.
So together <code class="language-plaintext highlighter-rouge">[^\d]+</code> means match one or more, non digits at the start of the column and the <code class="language-plaintext highlighter-rouge">()</code> around that means capture
them into a group. We‚Äôve add <code class="language-plaintext highlighter-rouge">\d+</code> at the end of the <span class="notranslate">expression</span> but it isn‚Äôt grouped so we are effectively ignoring the
digits at the end as we had hoped.</p>
      </blockquote>

      <p>Now we have two columns we need to assign list identifiers for, the new column <code class="language-plaintext highlighter-rouge">M</code> for the first, outer identifier and the
first column <code class="language-plaintext highlighter-rouge">A</code> for the inner, second identifier.</p>
    </li>
    <li>From <strong>Rules</strong> menu, select <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>, Column <code class="language-plaintext highlighter-rouge">M</code></li>
        <li>Click on <code class="language-plaintext highlighter-rouge">... Assign Another Column</code></li>
        <li>
          <p>Select column <code class="language-plaintext highlighter-rouge">A</code></p>

          <blockquote class="comment">
            <h3 id="comment-re-ordering-columns"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Re-ordering columns</h3>
            <p>If you make a mistake in the order you select columns in you can simple use the up and down arrows to re-arrange the list</p>
          </blockquote>
        </li>
      </ul>

      <p>The result should look something like this:
<img src="../../images/rules/rules_example_6_5_multiple_identifiers_edit.png" alt="screenshot" /></p>
    </li>
    <li>
      <p>Click <code class="language-plaintext highlighter-rouge">Apply</code> to return to the rule preview screen and notice there are two column listed for the list identifier definition
  <img src="../../images/rules/rules_example_6_6_multiple_identifiers.png" alt="screenshot" /></p>
    </li>
    <li>Finalize your collection:
      <ul>
        <li><em>‚ÄúType‚Äù</em>: <code class="language-plaintext highlighter-rouge">txt</code></li>
        <li>Name your Collection</li>
        <li>Click <code class="language-plaintext highlighter-rouge">Upload</code></li>
      </ul>

      <p>Note: set <em>‚ÄúType‚Äù</em> to <code class="language-plaintext highlighter-rouge">sra</code> if you used real data from SRA instead of the table from exercise.
  <img src="../../images/rules/rules_example_6_7_named.png" alt="screenshot" /></p>
    </li>
  </ol>

</blockquote>

<h1 id="apply-rules-to-existing-collections">Apply Rules to Existing Collections</h1>

<p>To start this example, we will first upload a simple, flat collection of data. The data files we will use
will be the same as those used by the <a href="https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html">DESeq2 Vignette</a>
from the <a href="https://bioconductor.org/packages/release/data/experiment/html/pasilla.html">Pasilla Bioconductor Package</a>.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-applying-rules-to-existing-collections"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on: Applying Rules to Existing Collections</h3>

  <ol>
    <li>Open the Rule Builder
      <ul>
        <li><em>‚ÄúUpload data as‚Äù</em>: <code class="language-plaintext highlighter-rouge">Collection(s)</code></li>
        <li><em>‚ÄúLoad tabular data from‚Äù</em>: <code class="language-plaintext highlighter-rouge">Pasted Table</code></li>
        <li>Paste the following table:</li>
      </ul>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/treated1fb.txt treated_single_1
https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/treated2fb.txt treated_paired_2
https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/treated3fb.txt treated_paired_3
https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/untreated1fb.txt untreated_single_4
https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/untreated2fb.txt untreated_single_5
https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/untreated3fb.txt untreated_paired_6
https://raw.githubusercontent.com/jmchilton/<span class="notranslate">galaxy</span>/apply_rules_tutorials/test-data/rules/untreated4fb.txt untreated_paired_7
</code></pre></div>      </div>

      <p>Next, we set up the column types:</p>
    </li>
    <li>From <strong>Rules</strong> menu, select  <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">URL</code>, column <code class="language-plaintext highlighter-rouge">A</code></li>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>, column <code class="language-plaintext highlighter-rouge">B</code>
<img src="../../images/rules/rules_apply_rules_example_4_2_input_rules.png" alt="screenshot" /></li>
      </ul>
    </li>
    <li>Finalize the collection:
      <ul>
        <li><em>‚ÄúType‚Äù</em>: <code class="language-plaintext highlighter-rouge">txt</code></li>
        <li>Give the collection a name.</li>
        <li>Click <code class="language-plaintext highlighter-rouge">Build</code>
<img src="../../images/rules/rules_apply_rules_example_4_4_input_list.png" alt="screenshot" /></li>
      </ul>

      <p>The first thing we will do to this new collection is add some levels or depth to its structure.
Lets assume we want to group it into ‚Äútreated‚Äù and ‚Äúuntreated‚Äù lists and ‚Äúpaired‚Äù and ‚Äúsingle‚Äù
sublists below that. We can do this with the <code class="language-plaintext highlighter-rouge">Apply Rules</code> collection operation tool, which will
likely be under the <code class="language-plaintext highlighter-rouge">Collection Operations</code> tool menu in your <span class="notranslate">Galaxy</span> interface.</p>
    </li>
    <li>
      <p>Open the <strong>Apply Rule to Collection</strong> tool</p>

      <p>The very simple interface should look something like this:
<img src="../../images/rules/rules_apply_rules_example_4_5_apply_rules_landing.png" alt="screenshot" /></p>

      <p>This interface simply lets one pick a collection to operate on and then launch the rule builder
window to work to describe and preview manipulating the metadata of that collection.</p>
    </li>
    <li><strong>Apply Rule to Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><em>‚ÄúInput Collection‚Äù</em>: the collection we just uploaded</li>
        <li>Click the <code class="language-plaintext highlighter-rouge">Edit</code> button
<img src="../../images/rules/rules_apply_rules_example_4_6_apply_rules_init_flat.png" alt="screenshot" /></li>
      </ul>

      <p>When a flat collection is used with this tool, the rule builder will initialize a default rule to pull
the list identifier out for each item of the collection as shown above. Next we will use regular <span class="notranslate">expression</span>s
to build two new columns, these columns will group the datasets into ‚Äútreated‚Äù and ‚Äúuntreated‚Äù sublists and
then ‚Äúsingle‚Äù and ‚Äúpaired‚Äù sublists of that. This rule is found under the <code class="language-plaintext highlighter-rouge">Column</code> menu.</p>

      <p>We‚Äôll transform column A into some more useful columns</p>
    </li>
    <li>From <strong>Column</strong>, select <code class="language-plaintext highlighter-rouge">Using a Regular <span class="notranslate">Expression</span></code>
      <ul>
        <li><em>‚ÄúColumn‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
        <li>Select <code class="language-plaintext highlighter-rouge">Create columns matching <span class="notranslate">expression</span> groups</code></li>
        <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">(.*)_(.*)_.*</code></li>
        <li><em>‚ÄúNumber of Groups‚Äù</em>: <code class="language-plaintext highlighter-rouge">2</code></li>
      </ul>

      <blockquote class="comment">
        <h3 id="comment-regular-expression-explained-2"><i class="far fa-comment-dots" aria-hidden="true"></i><span class="visually-hidden">comment</span> Regular <span class="notranslate">expression</span> explained</h3>
        <p>Here <code class="language-plaintext highlighter-rouge">.*</code> means match any number of any character - so basically match anything.
 The parentheses around <code class="language-plaintext highlighter-rouge">.*</code> means form a ‚Äúgroup‚Äù from whatever is matched.
 The <code class="language-plaintext highlighter-rouge">_</code> describes the literal <code class="language-plaintext highlighter-rouge">_</code> values in the identifier we are matching. The result is that
everything before the first <code class="language-plaintext highlighter-rouge">_</code> will be matched as the first group and everything between the <code class="language-plaintext highlighter-rouge">_</code>
characters will be matched as the second group. Click to apply this rule and two new columns should be created.</p>

        <p>We have defined two matching groups (the <code class="language-plaintext highlighter-rouge">(.*)</code> in the regex), so the number of groups is set to <code class="language-plaintext highlighter-rouge">2</code></p>
      </blockquote>
    </li>
    <li>From  <strong>Rules</strong>, select <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>, Column <code class="language-plaintext highlighter-rouge">B</code></li>
        <li><code class="language-plaintext highlighter-rouge">Assign another column</code>, column <code class="language-plaintext highlighter-rouge">C</code></li>
        <li><code class="language-plaintext highlighter-rouge">Assign another column</code>, column <code class="language-plaintext highlighter-rouge">A</code></li>
        <li>Click <code class="language-plaintext highlighter-rouge">Save</code></li>
      </ul>

      <p><img src="../../images/rules/rules_apply_rules_example_4_7_apply_rules_add_depth.png" alt="screenshot" /></p>

      <p>The resulting collection should have two new levels of depth for ‚Äúuntreated‚Äù vs ‚Äútreated‚Äù and ‚Äúpaired‚Äù vs ‚Äúsingle‚Äù as shown below:
<img src="../../images/rules/rules_apply_rules_example_4_8_nested.png" alt="screenshot" /></p>

      <p>Placing the ‚Äúsingle‚Äù and ‚Äúpaired‚Äù sublists inside the ‚Äútreated‚Äù and ‚Äúuntreated‚Äù lists was a bit arbitrary and depending on the
<span class="notranslate">workflow</span> these may need to be inverted at different parts of an analysis. The <strong>Apply Rules</strong> tool can be used to invert these levels
if that is needed.</p>
    </li>
    <li><strong>Apply Rule to Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><em>‚ÄúInput Collection‚Äù</em>: the new nested list we created in the previous step</li>
        <li>Click ‚ÄúEdit‚Äù.</li>
      </ul>

      <p><img src="../../images/rules/rules_apply_rules_example_4_9_apply_rules_init_nested.png" alt="screenshot" /></p>

      <p>Notice when loading a nested collection into the rule builder, there is a column for each layer of the list for each element.
One can pretty easily invert the outer two layers of the list by simply assigning the list identifiers in a new order. So select to assign ‚ÄúList Identifiers‚Äù and this time assign them to columns ‚ÄúB‚Äù, ‚ÄúA‚Äù, and ‚ÄúC‚Äù - in that order.</p>
    </li>
    <li>From <strong>Rules</strong>, select <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
      <ul>
        <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>, Column <code class="language-plaintext highlighter-rouge">B</code></li>
        <li><code class="language-plaintext highlighter-rouge">Assign another column</code>, Column <code class="language-plaintext highlighter-rouge">A</code></li>
        <li><code class="language-plaintext highlighter-rouge">Assign another column</code>, Column <code class="language-plaintext highlighter-rouge">C</code></li>
        <li>Click <code class="language-plaintext highlighter-rouge">Save</code></li>
      </ul>

      <p><img src="../../images/rules/rules_apply_rules_example_4_10_apply_rules_inverted.png" alt="screenshot" /></p>

      <p>The resulting collection should be inverted.</p>

      <p><img src="../../images/rules/rules_apply_rules_example_4_11_inverted.png" alt="screenshot" /></p>

      <p>In addition to structural re-organizations of a collection, the Apply Rules tool can be used to
filter elements out of the collection.</p>
    </li>
    <li><strong>Apply Rule to Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li><em>‚ÄúInput Collection‚Äù</em>: the original flat list created</li>
        <li>Click <code class="language-plaintext highlighter-rouge">Edit</code></li>
        <li>From <strong>Filter</strong> menu, select <code class="language-plaintext highlighter-rouge">From a regular <span class="notranslate">expression</span></code>
          <ul>
            <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
            <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">.*_single_.*</code></li>
          </ul>
        </li>
        <li>From <strong>Rules</strong> menu, select <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
          <ul>
            <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>, Column <code class="language-plaintext highlighter-rouge">A</code></li>
          </ul>
        </li>
      </ul>

      <p><img src="../../images/rules/rules_apply_rules_example_4_12_apply_rules_filter.png" alt="screenshot" /></p>

      <p>The resulting collection should be a filtered version of the original list.</p>

      <p><img src="../../images/rules/rules_apply_rules_example_4_13_filtered.png" alt="screenshot" /></p>

      <p>Structural re-organizations of collections can also be combined with filtering. To demonstrate this, reopen the original flat list created for this example again in the rule builder of the Apply Rules tool. Use the same regular <span class="notranslate">expression</span> as last time to filter the result but also add a column for ‚Äútreated‚Äù and ‚Äúuntreated‚Äù list identifiers.</p>
    </li>
    <li><strong>Apply Rule to Collection</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> with the following parameters:
      <ul>
        <li>From <strong>Filter</strong> menu, select <code class="language-plaintext highlighter-rouge">Using a Regular <span class="notranslate">Expression</span></code>
          <ul>
            <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
            <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>: <code class="language-plaintext highlighter-rouge">.*_single_.*</code></li>
          </ul>
        </li>
        <li>From <strong>Column</strong> menu, select <code class="language-plaintext highlighter-rouge">Using a Regular <span class="notranslate">Expression</span></code>
          <ul>
            <li><em>‚ÄúFrom Column‚Äù</em>: <code class="language-plaintext highlighter-rouge">A</code></li>
            <li>Select <code class="language-plaintext highlighter-rouge">Create column from regular <span class="notranslate">expression</span> groups</code></li>
            <li><em>‚ÄúRegular <span class="notranslate">Expression</span>‚Äù</em>:  <code class="language-plaintext highlighter-rouge">(.*)_single_.*</code></li>
            <li><em>‚ÄúNumber of Groups‚Äù</em>: <code class="language-plaintext highlighter-rouge">1</code></li>
          </ul>
        </li>
        <li>From <strong>Rules</strong> menu, select  <code class="language-plaintext highlighter-rouge">Add / Modify Column Definitions</code>
          <ul>
            <li><code class="language-plaintext highlighter-rouge">Add Definition</code>, <code class="language-plaintext highlighter-rouge">List Identifier(s)</code>. Column <code class="language-plaintext highlighter-rouge">B</code></li>
            <li><code class="language-plaintext highlighter-rouge">Assign another column</code>, Column <code class="language-plaintext highlighter-rouge">A</code></li>
          </ul>
        </li>
      </ul>

      <p><img src="../../images/rules/rules_apply_rules_example_4_14_apply_rules_filtered_and_nested.png" alt="screenshot" /></p>

      <p>The resulting collection should be a filtered to only include the ‚Äúsingle‚Äù data and broken into ‚Äútreated‚Äù and ‚Äúuntreated‚Äù sublists.</p>

      <p><img src="../../images/rules/rules_apply_rules_example_4_15_filtered_and_nested.png" alt="screenshot" /></p>
    </li>
  </ol>
</blockquote>



                    

                    

                    

                    <h1>Feedback</h1>
                    <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">how it went</a>.</p>

                    <div id="feedback-button">
                        <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                    </div>
                    <div id="feedback-form">
                    </div>
                    <script type="text/javascript">
                        (function (window, document) {
                            function onDocumentReady(fn) {
                                if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                    fn();
                                } else {
                                    document.addEventListener('DOMContentLoaded', fn);
                                }
                            }

                            onDocumentReady(function () {
                                $("#feedback-button").click(function(evt){
                                    var e = $(evt.target)
                                    e.hide();

                                    $("#feedback-form").html(`
                                        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Rule Based Uploader: Advanced (User Interface and Data Manipulation)">Loading...</iframe>
                                    `)
                                })
                            });
                        })(window, document);
                    </script>



                    <h1>Citing this Tutorial</h1>
                    <p>
                        <ol>
                            <li id="citation-text">John Chilton, Helena Rasche, 2021 <b>Rule Based Uploader: Advanced (Galaxy Training Materials)</b>. <a href="/training-material/topics/galaxy-interface/tutorials/upload-rules-advanced/tutorial.html">/training-material/topics/galaxy-interface/tutorials/upload-rules-advanced/tutorial.html</a> Online; accessed TODAY
                            </li>
                            <li>
                            Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                            </li>
                        </ol>
                    </p>


                    <blockquote class="details">
                      <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                      <p style="display: none;">

                    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{galaxy-interface-upload-rules-advanced,
    author = "John Chilton and Helena Rasche",
    title = "Rule Based Uploader: Advanced (Galaxy Training Materials)",
    year = "2021",
    month = "01",
    day = "06"
    url = "\url{/training-material/topics/galaxy-interface/tutorials/upload-rules-advanced/tutorial.html}",
    note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
        doi = {10.1016/j.cels.2018.05.012},
        url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
        year = 2018,
        month = {jun},
        publisher = {Elsevier {BV}},
        volume = {6},
        number = {6},
        pages = {752--758.e1},
        author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and Bj√∂rn Gr√ºning},
        title = {Community-Driven Data Analysis Training for Biology},
        journal = {Cell Systems}
}</code>
                    </pre></div></div>
                    </p>
                    </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                </div>
            </div>
        </div>

        <h3><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (John Chilton, Helena Rasche)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/galaxy-interface/tutorials/upload-rules-advanced/tutorial.md">GitHub</a>.
        </p>
        <p>
    The content of the tutorials and website is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
