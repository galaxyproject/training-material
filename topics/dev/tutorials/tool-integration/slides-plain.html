<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Slides: Tool development and integration into Galaxy / Tool development and integration into Galaxy / Development in Galaxy</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@e3baa75521bc8bb347ef199d6e7b8913000d9651",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/dev/tutorials/tool-integration/slides-plain.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.20cf1f17.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Tool development and integration into Galaxy">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2023-04-21 10:33:01 +0000">
<meta name="DC.creator" content="Saskia Hiltemann">
<meta name="DC.creator" content="Bérénice Batut">
<meta name="DC.creator" content="Anthony Bretaudeau">
<meta name="DC.creator" content="John Chilton">
<meta name="DC.creator" content="Nicola Soranzo">
<meta name="DC.creator" content="Björn Grüning">
<meta name="DC.creator" content="Gildas Le Corguillé"><meta name="description" content="# Galaxy tools  ---  ## Tools in the Galaxy UI  ![Screenshot of galaxy with the three main panels labelled list of available tools on left, 'wrapper' in center, and history with results as datasets on right](../../images/galaxy_instance_detailed_screenshot.png)  ---  ## Galaxy tool / wrapper  ![Screenshot of tool interface in Galaxy for GraPhlAn showing a variety of input types like file selection, select, text, numbers.](../../images/graphlan_screenshot.png)  ```bash graphlan.py --format png --size 7 'input_tree.txt' 'png_image.png' ```  --- class: left  ## So what is a tool?  Link between the Galaxy UI and the underlying tool: - Description of the user interface - How to invoke the tool - Which files and options to pass - Which files the tool will produce as output  ---  ## Tool execution  ![A flowchart is depicated with the galaxy interface pointing to a bowtie2-wrapper.xml file which has a command, inputs, and outputs. Inputs points back to the tool interface. The command block ...">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Development in Galaxy / Tool development and integration into Galaxy / Slides: Tool development and integration into Galaxy">
        <meta property="og:description" content="# Galaxy tools  ---  ## Tools in the Galaxy UI  ![Screenshot of galaxy with the three main panels labelled list of available tools on left, 'wrapper' in center, and history with results as datasets on right](../../images/galaxy_instance_detailed_screenshot.png)  ---  ## Galaxy tool / wrapper  ![Screenshot of tool interface in Galaxy for GraPhlAn showing a variety of input types like file selection, select, text, numbers.](../../images/graphlan_screenshot.png)  ```bash graphlan.py --format png --size 7 'input_tree.txt' 'png_image.png' ```  --- class: left  ## So what is a tool?  Link between the Galaxy UI and the underlying tool: - Description of the user interface - How to invoke the tool - Which files and options to pass - Which files the tool will produce as output  ---  ## Tool execution  ![A flowchart is depicated with the galaxy interface pointing to a bowtie2-wrapper.xml file which has a command, inputs, and outputs. Inputs points back to the tool interface. The command block ...">
        
	<meta property="og:image" content="https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png"></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
			

                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/./topics/dev/tutorials/tool-integration/slides.html">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/dev/tutorials/tool-integration/slides-plain.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            <a class="dropdown-item" href="/training-material/feedback.html">
                <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
            </a>
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        <section class="tutorial">
	<a href="https://github.com/galaxyproject/training-material/blob/main//topics/dev/tutorials/tool-integration/slides.html">View markdown source on GitHub</a>
	<h1>Tool development and integration into Galaxy</h1>
		<h2>Contributors</h2>
<div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/shiltemann/" class="contributor-badge contributor-shiltemann"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/shiltemann?s=36" alt="Saskia Hiltemann avatar" width="36" class="avatar" />
    Saskia Hiltemann</a><a href="/training-material/hall-of-fame/bebatut/" class="contributor-badge contributor-bebatut"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bebatut?s=36" alt="Bérénice Batut avatar" width="36" class="avatar" />
    Bérénice Batut</a><a href="/training-material/hall-of-fame/abretaud/" class="contributor-badge contributor-abretaud"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/abretaud?s=36" alt="Anthony Bretaudeau avatar" width="36" class="avatar" />
    Anthony Bretaudeau</a><a href="/training-material/hall-of-fame/jmchilton/" class="contributor-badge contributor-jmchilton"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/jmchilton?s=36" alt="John Chilton avatar" width="36" class="avatar" />
    John Chilton</a><a href="/training-material/hall-of-fame/nsoranzo/" class="contributor-badge contributor-nsoranzo"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/nsoranzo?s=36" alt="Nicola Soranzo avatar" width="36" class="avatar" />
    Nicola Soranzo</a><a href="/training-material/hall-of-fame/bgruening/" class="contributor-badge contributor-bgruening"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/bgruening?s=36" alt="Björn Grüning avatar" width="36" class="avatar" />
    Björn Grüning</a><a href="/training-material/hall-of-fame/lecorguille/" class="contributor-badge contributor-lecorguille"><img src="https://avatars.githubusercontent.com/lecorguille?s=36" alt="Gildas Le Corguillé avatar" width="36" class="avatar" />
    Gildas Le Corguillé</a>
	</div>

</div>


		
		<h2>Questions</h2>
		<ul>
		
		<li><p>What is a tool for Galaxy?</p>
</li>
		
		<li><p>How to write a best-practice tool?</p>
</li>
		
		<li><p>How to deal with the tool environment?</p>
</li>
		
		</ul>
		

		
		<h2>Objectives</h2>
		<ul>
		
		<li><p>Learn what a tool is and its structure</p>
</li>
		
		<li><p>Use the Planemo utilities to develop a tool</p>
</li>
		
		<li><p>Deal with the dependencies</p>
</li>
		
		<li><p>Write functional tests</p>
</li>
		
		<li><p>Make a tool ready for publishing in a ToolShed</p>
</li>
		
		</ul>
		

		

		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Published:</strong> Sep 30, 2016 </div>
		<div><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last Updated:</strong> Apr 21, 2023 </div>

	<hr />


	<h1 id="galaxy-tools">Galaxy tools</h1>

<hr />

<h2 id="tools-in-the-galaxy-ui">Tools in the Galaxy UI</h2>

<p><img src="../../images/galaxy_instance_detailed_screenshot.png" alt="Screenshot of galaxy with the three main panels labelled list of available tools on left, 'wrapper' in center, and history with results as datasets on right" /></p>

<hr />

<h2 id="galaxy-tool--wrapper">Galaxy tool / wrapper</h2>

<p><img src="../../images/graphlan_screenshot.png" alt="Screenshot of tool interface in Galaxy for GraPhlAn showing a variety of input types like file selection, select, text, numbers." /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graphlan.py <span class="nt">--format</span> png <span class="nt">--size</span> 7 <span class="s1">'input_tree.txt'</span> <span class="s1">'png_image.png'</span>
</code></pre></div></div>

<hr />
<p>class: left</p>

<h2 id="so-what-is-a-tool">So what is a tool?</h2>

<p>Link between the Galaxy UI and the underlying tool:</p>
<ul>
  <li>Description of the user interface</li>
  <li>How to invoke the tool</li>
  <li>Which files and options to pass</li>
  <li>Which files the tool will produce as output</li>
</ul>

<hr />

<h2 id="tool-execution">Tool execution</h2>

<p><img src="../../images/wrapper_layers.png" alt="A flowchart is depicated with the galaxy interface pointing to a bowtie2-wrapper.xml file which has a command, inputs, and outputs. Inputs points back to the tool interface. The command block points to the Operating System with an image of servers and the bowtie2 binary. This points back to outputs, and back to the history within the galaxy interface" /></p>

<p><span>Speaker Notes</span></p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">&lt;inputs&gt;</code> (datasets and parameters) specified in the tool XML are exposed in the Galaxy tool UI</li>
  <li>When the user fills the form and click the <code class="language-plaintext highlighter-rouge">Execute</code> button, Galaxy fills the <code class="language-plaintext highlighter-rouge">&lt;command&gt;</code> template in the XML with the inputs entered by the user and execute the Cheetah code, producing a script as output</li>
  <li>Galaxy creates a job for the generated script and executes it somewhere (bowtie2 is run in this case)</li>
  <li>Some (not necessarily all) output files become new history datasets, as specified in the <code class="language-plaintext highlighter-rouge">&lt;outputs&gt;</code> XML tag set</li>
</ol>

<hr />

<h2 id="tool-execution-1">Tool execution</h2>

<p><img src="../../images/wrapper_big_picture_1.png" alt="An XML file as an image. The tool id is on the first line, then a description element, a command block running &quot;echo Hello World $mystring to $output&quot;, an inputs section with a mystring text input, and an output1 tabular data file. A help block is shown last." /></p>

<p><span>Speaker Notes</span></p>

<ul>
  <li>CDATA tags are used to prevent the interpretation of ampersands and less-than signs as XML special characters</li>
  <li>The tool name and description are combined in the left panel (tool menu), keep them short!</li>
</ul>

<hr />

<h2 id="tool-execution-2">Tool execution</h2>

<p><img src="../../images/wrapper_big_picture_2.png" alt="The previous image, but the input parameter named 'mystring' is shown pointing to its place in the command block. Same for the output pointing to the command block. An overlay shows the Job Command Line /bin/echo Hello world you are amazing &gt; a/path.dat" /></p>

<hr />

<h2 id="tool-execution-3">Tool execution</h2>

<p><img src="../../images/wrapper_big_picture_3.png" alt="The previous image but now there is an overlay showing the output text Hello world you are amazing" /></p>

<hr />

<h2 id="tool-xml">Tool XML</h2>

<p>Galaxy tool XML format is formally defined in a XML Schema Definition (XSD), used to generate the corresponding <a href="https://docs.galaxyproject.org/en/latest/dev/schema.html">online documentation</a></p>

<hr />

<h2 id="xml-editor">XML Editor</h2>

<p>You are free to use your prefered code editor to write Galaxy tools.</p>

<p>If you use Visual Studio Code (or Codium), we recommend to install the <a href="https://marketplace.visualstudio.com/items?itemName=davelopez.galaxy-tools">dedicated extension</a>.</p>

<p>It provides XML validation, tags and attributes completion, help/documentation on hover, and other smart features to assist in following best practices.</p>

<p><img src="../../images/vscode_tool.gif" alt="An animation showing someone writing a tool XML file, while being assisted by the VSCode extension." /></p>

<hr />

<h2 id="tool"><code class="language-plaintext highlighter-rouge">tool</code></h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tool</span> <span class="na">id=</span><span class="s">"graphlan"</span> <span class="na">name=</span><span class="s">"GraPhlAn"</span> <span class="na">version=</span><span class="s">"1.1.3+galaxy2"</span> <span class="na">profile=</span><span class="s">"22.05"</span><span class="nt">&gt;</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">id</code>: unique identifier of your tool, should contain only <code class="language-plaintext highlighter-rouge">[a-z0-9_-]</code></li>
  <li><code class="language-plaintext highlighter-rouge">name</code>: shown to the user, displayed in the tool box</li>
  <li><code class="language-plaintext highlighter-rouge">version</code>: the version of the wrapped tool, followed by a <code class="language-plaintext highlighter-rouge">+galaxyX</code> suffix for wrapper version</li>
  <li><code class="language-plaintext highlighter-rouge">profile</code>: minimum Galaxy version that should be required to run this tool (IUC recommends not older than 1 year)</li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>The top level <code class="language-plaintext highlighter-rouge">tool</code> tag defines the tool naming and version</li>
  <li>The <code class="language-plaintext highlighter-rouge">id</code> attribute is the unique identifier of your tool, it should contain only letters, digits, underscores or dashes</li>
  <li>The <code class="language-plaintext highlighter-rouge">name</code> attribute is shown to the user and displayed in the tool box</li>
  <li>The <code class="language-plaintext highlighter-rouge">version</code> attribute contains the version of the wrapped tool, followed by a <code class="language-plaintext highlighter-rouge">+galaxyX</code> suffix for wrapper version</li>
  <li>The <code class="language-plaintext highlighter-rouge">profile</code> attribute should be set to the minimum Galaxy version that should be required to run this tool (IUC recommends not older than 1 year)</li>
</ul>

<hr />

<h2 id="command"><code class="language-plaintext highlighter-rouge">command</code></h2>

<p>How to invoke the tool?</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;requirements&gt;</span>
    <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"1.1.3"</span><span class="nt">&gt;</span>graphlan<span class="nt">&lt;/requirement&gt;</span>
<span class="nt">&lt;/requirements&gt;</span>
<span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
graphlan.py
--format $format
...
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<p>If the script is provided with the tool xml:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;requirements&gt;</span>
    <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"2.7"</span><span class="nt">&gt;</span>python<span class="nt">&lt;/requirement&gt;</span>
<span class="nt">&lt;/requirements&gt;</span>
<span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
python '$__tool_directory__/graphlan.py'
--format $format
...
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>In the first case, <code class="language-plaintext highlighter-rouge">graphlan.py</code> is expected to be on the PATH and executable when the job executes. This is usually accomplished by specifying some <code class="language-plaintext highlighter-rouge">&lt;requirement/&gt;</code> tags.</li>
  <li>In the second case, <code class="language-plaintext highlighter-rouge">$__tool_directory__</code> is a special variable which is substituted by Galaxy with the directory where the tool XML is</li>
</ul>

<hr />

<h2 id="inputs--param-to-command"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> to <code class="language-plaintext highlighter-rouge">command</code></h2>

<p>Parameters are directly linked to variables in <code class="language-plaintext highlighter-rouge">&lt;command&gt;</code> by the <code class="language-plaintext highlighter-rouge">name</code> or <code class="language-plaintext highlighter-rouge">argument</code> attribute</p>

<p>Parameters can be optional or required.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
graphlan.py
...
#if str($dpi):
    --dpi $dpi
#end if
'$input_tree'
...
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;inputs&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"input_tree"</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">label=</span><span class="s">"..."</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;param</span> <span class="na">argument=</span><span class="s">"--dpi"</span> <span class="na">type=</span><span class="s">"integer"</span> <span class="na">optional=</span><span class="s">"true"</span> <span class="na">label=</span><span class="s">"..."</span>
        <span class="na">help=</span><span class="s">"For non vectorial formats"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/inputs&gt;</span>
</code></pre></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">#if ... #end if</code> syntax comes from the <a href="https://cheetahtemplate.org/">Cheetah</a> template language, which has a Python-like syntax</li>
</ul>

<p><span>Speaker Notes</span></p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">name</code> or <code class="language-plaintext highlighter-rouge">argument</code> attribute identifies a parameter (details of <code class="language-plaintext highlighter-rouge">argument</code> later).</li>
  <li>Parameters have different types (<code class="language-plaintext highlighter-rouge">data</code>, <code class="language-plaintext highlighter-rouge">data_collection</code>, <code class="language-plaintext highlighter-rouge">integer</code>, <code class="language-plaintext highlighter-rouge">float</code>, <code class="language-plaintext highlighter-rouge">text</code>, <code class="language-plaintext highlighter-rouge">select</code>, <code class="language-plaintext highlighter-rouge">boolean</code>, <code class="language-plaintext highlighter-rouge">color</code>, <code class="language-plaintext highlighter-rouge">data_column</code>,…)
and can be optional.</li>
</ul>

<hr />

<h2 id="inputs--param--data"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">data</code></h2>

<p><img src="../../images/input_data.png" alt="Screenshot of the file selection input in Galaxy permitting selection of a single file, multiple files, or a collection. In bold text a label appears above the component describing its use. Below the component in light grey is a help message. This applies to every input in Galaxy" /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"txt"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>.footnote[<a href="https://github.com/galaxyproject/galaxy/blob/dev/config/datatypes_conf.xml.sample">List of possible formats</a>]</p>

<hr />

<h2 id="inputs--param--integer--float"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">integer</code> | <code class="language-plaintext highlighter-rouge">float</code></h2>

<p><img src="../../images/input_integer.png" alt="Screenshot of an integer input, it's just an input field set to 7." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"integer"</span> <span class="na">value=</span><span class="s">"7"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p><img src="../../images/input_float_range.png" alt="Screenshot of a float input from the cd_hit tool. This time also a slider appears due to addition of min and max" /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"float"</span> <span class="na">min=</span><span class="s">"0.4"</span> <span class="na">max=</span><span class="s">"1.0"</span> <span class="na">value=</span><span class="s">"0.9"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<ul>
  <li>In the first case, Galaxy creates a text box which accepts only integer values</li>
  <li>In the second case, since <em>both</em> <code class="language-plaintext highlighter-rouge">min</code> and <code class="language-plaintext highlighter-rouge">max</code> are specified, a slider is shown in addition</li>
</ul>

<hr />

<h2 id="inputs--param--text"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">text</code></h2>

<p><img src="../../images/input_text.png" alt="Screenshot of a textbox from the cd_hit tool." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"..."</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="inputs--param--select"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">select</code></h2>

<p><img src="../../images/input_select.png" alt="Screenshot of a select drop down with several image formats from the bedtools_bedtoigv tool." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"select"</span> <span class="na">label=</span><span class="s">"..."</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"png"</span> <span class="na">selected=</span><span class="s">"true"</span><span class="nt">&gt;</span>PNG<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"eps"</span><span class="nt">&gt;</span>EPS<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"svg"</span><span class="nt">&gt;</span>SVG<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/param&gt;</span>
</code></pre></div></div>

<p>If no <code class="language-plaintext highlighter-rouge">option</code> has <code class="language-plaintext highlighter-rouge">selected="true"</code>, the first one is selected by default.</p>

<hr />

<h2 id="inputs--param--select-1"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">select</code></h2>

<p><img src="../../images/input_select_checkboxes.png" alt="The select is now a set of checkboxes." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"select"</span> <span class="na">display=</span><span class="s">"radio"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"min"</span> <span class="na">selected=</span><span class="s">"true"</span><span class="nt">&gt;</span>Minimum<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"mean"</span><span class="nt">&gt;</span>Mean<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"max"</span><span class="nt">&gt;</span>Max<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"sum"</span><span class="nt">&gt;</span>Sum<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/param&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="inputs--param--select-2"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">select</code></h2>

<p><img src="../../images/input_select_multiple.png" alt="A select/unselect all checkbox appears before a box with numerous selections inside, appearing as badges that can be added or removed." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"select"</span> <span class="na">multiple=</span><span class="s">"true"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"ld"</span> <span class="na">selected=</span><span class="s">"true"</span><span class="nt">&gt;</span>Length distribution<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"gc"</span> <span class="na">selected=</span><span class="s">"true"</span><span class="nt">&gt;</span>GC content distribution<span class="nt">&lt;/option&gt;</span>
    ...
<span class="nt">&lt;/param&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="inputs--param--boolean"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">boolean</code></h2>

<p><img src="../../images/input_boolean.png" alt="A yes/no switch from the bg_sortmerna tool." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"boolean"</span> <span class="na">checked=</span><span class="s">"false"</span> <span class="na">truevalue=</span><span class="s">"--log"</span> <span class="na">falsevalue=</span><span class="s">""</span>
    <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<hr />

<p>class: reduce70</p>

<h2 id="inputs--param--conditional"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">conditional</code></h2>

<p>.pull-left[<img src="../../images/input_conditional.png" alt="Screenshot of a conditional select box set to Paired, and two file inputs appear below it." />]
.pull-right[<img src="../../images/input_conditional_single.png" alt="Screenshot of a conditional select box set to Single, and only a single file input appears below it." />]</p>

<p><br style="clear:left;" /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
#if $fastq_input.selector == 'paired':
    '$fastq_input.input1' '$fastq_input.input2'
#else:
    '$fastq_input.input'
#end if
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
<span class="nt">&lt;inputs&gt;</span>
    <span class="nt">&lt;conditional</span> <span class="na">name=</span><span class="s">"fastq_input"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"selector"</span> <span class="na">type=</span><span class="s">"select"</span> <span class="na">label=</span><span class="s">"Single or paired-end reads?"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"paired"</span><span class="nt">&gt;</span>Paired-end<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"single"</span><span class="nt">&gt;</span>Single-end<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;/param&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">value=</span><span class="s">"paired"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"input1"</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"fastq"</span> <span class="na">label=</span><span class="s">"Forward reads"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"input2"</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"fastq"</span> <span class="na">label=</span><span class="s">"Reverse reads"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/when&gt;</span>
        <span class="nt">&lt;when</span> <span class="na">value=</span><span class="s">"single"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"input"</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"fastq"</span> <span class="na">label=</span><span class="s">"Single reads"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/when&gt;</span>
    <span class="nt">&lt;/conditional&gt;</span>
<span class="nt">&lt;/inputs&gt;</span>
</code></pre></div></div>

<hr />

<p>class: reduce70</p>

<h2 id="inputs--param--repeat"><code class="language-plaintext highlighter-rouge">inputs</code> &gt; <code class="language-plaintext highlighter-rouge">param</code> &gt; <code class="language-plaintext highlighter-rouge">repeat</code></h2>

<p><img src="../../images/input_repeat.png" alt="Two boxes appear labelled 1: Series and 2: Series, with an insert series button below them. Each series box has two inputs in it, a file input and a select box." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
#for $i, $s in enumerate($series):
    rank_of_series=$i
    input_path=${s.input}
    x_column=${s.xcol}
#end for
]]&gt;</span><span class="nt">&lt;/command&gt;</span>

<span class="nt">&lt;inputs&gt;</span>
    <span class="nt">&lt;repeat</span> <span class="na">name=</span><span class="s">"series"</span> <span class="na">title=</span><span class="s">"Series"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"input"</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"tabular"</span> <span class="na">label=</span><span class="s">"Dataset"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"xcol"</span> <span class="na">type=</span><span class="s">"data_column"</span> <span class="na">data_ref=</span><span class="s">"input"</span> <span class="na">label=</span><span class="s">"Column for x axis"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/repeat&gt;</span>
<span class="nt">&lt;/inputs&gt;</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<p>It makes sense to use a <code class="language-plaintext highlighter-rouge">&lt;repeat&gt;</code> block only if it contains multiple related parameters, otherwise adding <code class="language-plaintext highlighter-rouge">multiple="true"</code> is preferable.</p>

<hr />

<h2 id="outputs"><code class="language-plaintext highlighter-rouge">outputs</code></h2>

<p>.image-25[<img src="../../images/output.png" alt="Screenshot of a galaxy history with two outputs." />]</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;outputs&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"tree"</span> <span class="na">format=</span><span class="s">"txt"</span> <span class="na">label=</span><span class="s">"${tool.name} on ${on_string}: Tree"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"annotation"</span> <span class="na">format=</span><span class="s">"txt"</span>
        <span class="na">label=</span><span class="s">"${tool.name} on ${on_string}: Annotation"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/outputs&gt;</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<p><code class="language-plaintext highlighter-rouge">${tool.name} on ${on_string}</code> is the default output label, need to modify this if the tool generates more than 1 output</p>

<hr />

<h2 id="outputs--filter"><code class="language-plaintext highlighter-rouge">outputs</code> &gt; <code class="language-plaintext highlighter-rouge">filter</code></h2>

<p>Output is collected only if the <code class="language-plaintext highlighter-rouge">filter</code> evaluates to True</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;inputs&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">type=</span><span class="s">"select"</span> <span class="na">name=</span><span class="s">"format"</span> <span class="na">label=</span><span class="s">"Output format"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"png"</span><span class="nt">&gt;</span>PNG<span class="nt">&lt;/option&gt;</span>
        <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"pdf"</span><span class="nt">&gt;</span>PDF<span class="nt">&lt;/option&gt;</span>
    <span class="nt">&lt;/param&gt;</span>
<span class="nt">&lt;/inputs&gt;</span>
<span class="nt">&lt;outputs&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"png_output"</span> <span class="na">format=</span><span class="s">"png"</span> <span class="na">label=</span><span class="s">"${tool.name} on ${on_string}: PNG"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;filter&gt;</span>format == "png"<span class="nt">&lt;/filter&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"pdf_output"</span> <span class="na">format=</span><span class="s">"pdf"</span> <span class="na">label=</span><span class="s">"${tool.name} on ${on_string}: PDF"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;filter&gt;</span>format == "pdf"<span class="nt">&lt;/filter&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/outputs&gt;</span>
</code></pre></div></div>

<p><span>Speaker Notes</span></p>

<p>N.B. If the filter expression raises an Exception, the dataset will NOT be filtered out</p>

<hr />

<h2 id="detect_errors"><code class="language-plaintext highlighter-rouge">detect_errors</code></h2>

<p>Legacy tools (i.e. with <code class="language-plaintext highlighter-rouge">profile</code> unspecified or less than 16.04) by default fail only if the tool writes to stderr</p>

<p>Non-legacy tools by default fail if the tool exit code is not 0, which is equivalent to specify:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command</span> <span class="na">detect_errors=</span><span class="s">"exit_code"</span><span class="nt">&gt;</span> ... <span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<p>To fail if either the tool exit code is not 0 or “Exception:”/”Error:” appears in standard error/output:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command</span> <span class="na">detect_errors=</span><span class="s">"aggressive"</span><span class="nt">&gt;</span> ... <span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="stdio"><code class="language-plaintext highlighter-rouge">stdio</code></h2>

<p>If you need more precision:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;stdio&gt;</span>
    <span class="nt">&lt;exit_code</span> <span class="na">range=</span><span class="s">":-2"</span> <span class="na">level=</span><span class="s">"warning"</span> <span class="na">description=</span><span class="s">"Low disk space"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;exit_code</span> <span class="na">range=</span><span class="s">"1:"</span> <span class="na">level=</span><span class="s">"fatal"</span>  <span class="nt">/&gt;</span>
    <span class="nt">&lt;regex</span> <span class="na">match=</span><span class="s">"Error:"</span>  <span class="na">level=</span><span class="s">"fatal"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/stdio&gt;</span>
<span class="nt">&lt;command&gt;</span> ... <span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<p><small>“Warning” level allows to add information to <code class="language-plaintext highlighter-rouge">stderr</code> without marking the dataset as failed</small></p>

<hr />

<h2 id="help"><code class="language-plaintext highlighter-rouge">help</code></h2>

<p><img src="../../images/help.png" alt="Screenshot of a help block in a galaxy tool, it shows the below text block rendered according to restructured text rules. What it does is bold, and user manual is a hyperlink to the bitbucket url." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;help&gt;</span><span class="cp">&lt;![CDATA[
**What it does**
GraPhlAn is a software tool for producing high-quality circular
representations of taxonomic and phylogenetic trees. GraPhlAn focuses
on concise, integrative, informative, and publication-ready
representations of phylogenetically- and taxonomically-driven
investigation.

For more information, check the `user manual
&lt;https://bitbucket.org/nsegata/graphlan/overview&gt;</span>`_.
]]&gt;<span class="nt">&lt;/help&gt;</span>
</code></pre></div></div>

<p>Content should be in <a href="https://docutils.sourceforge.io/rst.html">reStructuredText markup format</a></p>

<hr />

<h2 id="citations"><code class="language-plaintext highlighter-rouge">citations</code></h2>

<p><img src="../../images/citations.png" alt="Screenshot of the citations box showing 5 nicely formatted citations with italics, and hyperlinked DOIs." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;citations&gt;</span>
    <span class="nt">&lt;citation</span> <span class="na">type=</span><span class="s">"doi"</span><span class="nt">&gt;</span>10.1093/bioinformatics/bts611<span class="nt">&lt;/citation&gt;</span>
    <span class="nt">&lt;citation</span> <span class="na">type=</span><span class="s">"doi"</span><span class="nt">&gt;</span>10.1093/nar/gks1219<span class="nt">&lt;/citation&gt;</span>
    <span class="nt">&lt;citation</span> <span class="na">type=</span><span class="s">"doi"</span><span class="nt">&gt;</span>10.1093/nar/gks1005<span class="nt">&lt;/citation&gt;</span>
    <span class="nt">&lt;citation</span> <span class="na">type=</span><span class="s">"doi"</span><span class="nt">&gt;</span>10.1093/bioinformatics/btq461<span class="nt">&lt;/citation&gt;</span>
    <span class="nt">&lt;citation</span> <span class="na">type=</span><span class="s">"doi"</span><span class="nt">&gt;</span>10.1038/nbt.2198<span class="nt">&lt;/citation&gt;</span>
<span class="nt">&lt;/citations&gt;</span>
</code></pre></div></div>

<p><small>If no DOI is available, a BibTeX citation can be specified with <code class="language-plaintext highlighter-rouge">type="bibtex"</code></small></p>

<hr />

<h2 id="quoting-params">Quoting params</h2>

<p>Always quote <code class="language-plaintext highlighter-rouge">text</code> and <code class="language-plaintext highlighter-rouge">data</code> parameters and output <code class="language-plaintext highlighter-rouge">data</code> in <code class="language-plaintext highlighter-rouge">&lt;command&gt;</code></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
graphlan.py
...
'$input_tree'
'$png_output_image'
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<ul>
  <li>For security reasons</li>
  <li>Paths may contain spaces</li>
  <li>Prefer single quotes over double quotes</li>
</ul>

<hr />

<h2 id="multiple-commands">Multiple commands</h2>

<p>Use <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> to concatenate them</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
graphlan.py
--format '$format'
&amp;&amp;
echo "Yeah it worked!"
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<p><small>The job will exit on the first error encountered.</small></p>

<p><small>You can use <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> or <code class="language-plaintext highlighter-rouge">;</code> if using a <code class="language-plaintext highlighter-rouge">profile</code> &gt;= 20.09 (the <code class="language-plaintext highlighter-rouge">set -e</code> shell directive is now used by default).</small></p>

<hr />

<h2 id="param-argument">Param argument</h2>

<p>Use the <code class="language-plaintext highlighter-rouge">argument</code> tag when a <code class="language-plaintext highlighter-rouge">param</code> name reflects the command line argument</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">argument=</span><span class="s">"--size"</span> <span class="na">type=</span><span class="s">"integer"</span> <span class="na">value=</span><span class="s">"7"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<ul>
  <li>It will be appended at the end of the displayed param help</li>
  <li>When <code class="language-plaintext highlighter-rouge">argument</code> is specified and <code class="language-plaintext highlighter-rouge">name</code> is not, <code class="language-plaintext highlighter-rouge">name</code> is derived from <code class="language-plaintext highlighter-rouge">argument</code> by removing the initial dashes and replacing internal dashes with underscores</li>
</ul>

<hr />

<h2 id="section"><code class="language-plaintext highlighter-rouge">section</code></h2>

<p>Use sections to group related parameters</p>

<p><img src="../../images/input_section.png" alt="Screenshot of the same section twice, in the first it shows Additional Options and is collapsed. In the second it is expanded and an integer input can be seen." /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;section</span> <span class="na">name=</span><span class="s">"advanced"</span> <span class="na">title=</span><span class="s">"Advanced options"</span> <span class="na">expanded=</span><span class="s">"False"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">argument=</span><span class="s">"--size"</span> <span class="na">type=</span><span class="s">"integer"</span> <span class="na">value=</span><span class="s">"7"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span><span class="nt">/&gt;</span>
    ...
<span class="nt">&lt;/section&gt;</span>
</code></pre></div></div>

<hr />

<p><img src="../../images/planemo-logo.png" alt="Planemo logo, the E mimics the galaxy logo with three bars, the bottom most offset" /></p>

<blockquote>
  <p>Command-line utilities to assist in building and publishing Galaxy tools.</p>
</blockquote>

<ul>
  <li><a href="https://planemo.readthedocs.io/en/latest/">Documentation</a></li>
  <li><a href="https://planemo.readthedocs.io/en/latest/writing_standalone.html">Tutorial</a></li>
</ul>

<hr />

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="Planemo logo" />]</p>

<p><img src="../../images/big_picture.png" alt="An overly complicated flowchart with 11 steps and a three level hierarchy. The gist is that planemo tool_init lets a wrapper be created, planemo lint is then used. Planemo conda installs packages from a conda repository. This is then run with planemo test and planemo serve. Afterwards planemo shed_test, shed_create, and shed_update upload the wrapper to the galaxy toolshed. Then it is installed to a galaxy instance where it can be tested, and fetches the conda env from conda." /></p>

<hr />

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="planemo logo again" />]</p>

<p><code class="language-plaintext highlighter-rouge">planemo tool_init</code></p>

<p>Creates a skeleton of xml file</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir </span>new_tool
<span class="nv">$ </span><span class="nb">cd </span>new_tool
<span class="nv">$ </span>planemo tool_init <span class="nt">--id</span> <span class="s1">'some_short_id'</span> <span class="nt">--name</span> <span class="s1">'My super tool'</span>
</code></pre></div></div>

<p>Complicated version:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>planemo tool_init <span class="nt">--id</span> <span class="s1">'samtools_sort'</span> <span class="nt">--name</span> <span class="s1">'Samtools sort'</span> <span class="se">\</span>
          <span class="nt">--description</span> <span class="s1">'order of storing aligned sequences'</span> <span class="se">\</span>
          <span class="nt">--requirement</span> <span class="s1">'samtools@1.3.1'</span> <span class="se">\</span>
          <span class="nt">--example_command</span> <span class="s2">"samtools sort -o '1_sorted.bam' '1.bam'"</span> <span class="se">\</span>
          <span class="nt">--example_input</span> 1.bam <span class="se">\</span>
          <span class="nt">--example_output</span> 1_sorted.bam <span class="se">\</span>
          <span class="nt">--test_case</span> <span class="se">\</span>
          <span class="nt">--version_command</span> <span class="s1">'samtools --version | head -1'</span> <span class="se">\</span>
          <span class="nt">--help_from_command</span> <span class="s1">'samtools sort'</span> <span class="se">\</span>
          <span class="nt">--doi</span> <span class="s1">'10.1093/bioinformatics/btp352'</span>
</code></pre></div></div>

<hr />

<p>class: packed</p>

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="planemo logo again" />]</p>

<p><code class="language-plaintext highlighter-rouge">planemo lint</code>: Checks the syntax of a tool</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>planemo lint
Linting tool /opt/galaxy/tools/seqtk_seq.xml
Applying linter tests... CHECK
.. CHECK: 1 <span class="nb">test</span><span class="o">(</span>s<span class="o">)</span> found.
Applying linter output... CHECK
.. INFO: 1 outputs found.
Applying linter inputs... CHECK
.. INFO: Found 1 input parameters.
Applying linter help... CHECK
.. CHECK: Tool contains <span class="nb">help </span>section.
.. CHECK: Help contains valid reStructuredText.
Applying linter general... CHECK
.. CHECK: Tool defines a version <span class="o">[</span>0.1.0].
.. CHECK: Tool defines a name <span class="o">[</span>Convert to FASTA <span class="o">(</span>seqtk<span class="o">)]</span><span class="nb">.</span>
.. CHECK: Tool defines an <span class="nb">id</span> <span class="o">[</span>seqtk_seq].
Applying linter command... CHECK
.. INFO: Tool contains a command.
Applying linter citations... CHECK
.. CHECK: Found 1 likely valid citations.
</code></pre></div></div>

<hr />

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="planemo logo again" />]</p>

<p><code class="language-plaintext highlighter-rouge">planemo serve</code></p>

<p>View your new tool in a local Galaxy instance</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>planemo serve
</code></pre></div></div>

<p>Open http://127.0.0.1:9090/ in your web browser to view your new tool</p>

<hr />

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="planemo logo again" />]</p>

<p>Building Galaxy Tools</p>

<p><img src="../../images/planemo_tool_building_lint.png" alt="flowchart with planemo tool_init creating a wrapper tool.xml and planemo lint being run repeatedly." /></p>

<hr />

<h1 id="functional-tests">Functional tests</h1>

<hr />

<h2 id="functional-tests-1">Functional tests</h2>

<ul>
  <li>Functional testing is a quality assurance (QA) process.</li>
  <li>The tests comfort developers and users that the tools can run across different servers/architectures. And that the latest modifications don’t break older features.</li>
  <li>Tools are tested by feeding them inputs and parameters and verifying the outputs (typically a diff)</li>
</ul>

<hr />

<h2 id="tests"><code class="language-plaintext highlighter-rouge">tests</code></h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tests&gt;</span>
    <span class="nt">&lt;test&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"input_tree"</span> <span class="na">value=</span><span class="s">"input_tree.txt"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"format"</span> <span class="na">value=</span><span class="s">"png"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"dpi"</span> <span class="na">value=</span><span class="s">"100"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"size"</span> <span class="na">value=</span><span class="s">"7"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"pad"</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;output</span> <span class="na">name=</span><span class="s">"png_output_image"</span> <span class="na">file=</span><span class="s">"png_image.png"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/tests&gt;</span>
</code></pre></div></div>

<p><small><code class="language-plaintext highlighter-rouge">input_tree.txt</code> and <code class="language-plaintext highlighter-rouge">png_image.png</code> must be in the <code class="language-plaintext highlighter-rouge">test-data/</code> directory</small></p>

<hr />

<h2 id="tool-directory-tree">Tool directory tree</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graphlan/
├── graphlan.xml
├── graphlan.py
└── test-data/
    ├── input_tree.txt
    └── png_image.png

</code></pre></div></div>

<hr />

<h2 id="comparing-to-an-expected-result">Comparing to an expected result</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;output</span> <span class="err">...</span> <span class="na">compare=</span><span class="s">"diff|re_match|sim_size|contains|re_match_multiline"</span> <span class="err">...</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;output</span> <span class="na">name=</span><span class="s">"out_file1"</span> <span class="na">file=</span><span class="s">"cf_maf2fasta_concat.dat"</span> <span class="na">ftype=</span><span class="s">"fasta"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;output</span> <span class="err">...</span> <span class="na">md5=</span><span class="s">"68b329da9893e34099c7d8ad5cb9c940"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;output</span> <span class="err">...</span> <span class="na">lines_diff=</span><span class="s">"4"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;output</span> <span class="err">...</span> <span class="na">compare=</span><span class="s">"sim_size"</span> <span class="na">delta=</span><span class="s">"1000"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>.footnote[<a href="https://docs.galaxyproject.org/en/latest/dev/schema.html#tool-tests-test-output">Complete documentation</a>]</p>

<p><span>Speaker Notes</span></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">diff</code> is the default</li>
  <li><code class="language-plaintext highlighter-rouge">ftype</code> also checks the output datatype</li>
  <li>With <code class="language-plaintext highlighter-rouge">md5</code> the test output file doesn’t need to be distributed (useful for big output files)</li>
  <li><code class="language-plaintext highlighter-rouge">lines_diff</code> is useful for tools that output version number, current date, …</li>
  <li><code class="language-plaintext highlighter-rouge">sim_size</code> is useful for binary files that vary at each execution (e.g. PDF)</li>
</ul>

<hr />

<h2 id="checking-the-output-content">Checking the output content</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;output</span> <span class="na">name=</span><span class="s">"out_file1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;assert_contents&gt;</span>
        <span class="nt">&lt;has_text</span> <span class="na">text=</span><span class="s">"chr7"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;not_has_text</span> <span class="na">text=</span><span class="s">"chr8"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;has_text_matching</span> <span class="na">expression=</span><span class="s">"1274\d+53"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;has_line_matching</span> <span class="na">expression=</span><span class="s">".*\s+127489808\s+127494553"</span> <span class="nt">/&gt;</span>
        <span class="c">&lt;!-- &amp;#009; is XML escape code for tab --&gt;</span>
        <span class="nt">&lt;has_line</span> <span class="na">line=</span><span class="s">"chr7&amp;#009;127471195&amp;#009;127489808"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;has_n_columns</span> <span class="na">n=</span><span class="s">"3"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/assert_contents&gt;</span>
<span class="nt">&lt;/output&gt;</span>
</code></pre></div></div>

<p>.footnote[<a href="https://docs.galaxyproject.org/en/latest/dev/schema.html#tool-tests-test-output-assert-contents">Complete documentation</a>]</p>

<hr />

<h2 id="checking-tool-stdoutstderr">Checking tool stdout/stderr</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;assert_stdout&gt;</span>
    <span class="nt">&lt;has_text</span> <span class="na">text=</span><span class="s">"Step 1... determine cutoff point"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;has_text</span> <span class="na">text=</span><span class="s">"Step 2... estimate parameters of null distribution"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/assert_stdout&gt;</span>
</code></pre></div></div>

<p>.footnote[<a href="https://docs.galaxyproject.org/en/latest/dev/schema.html#tool-tests-test-output-assert-contents">Complete documentation</a>]</p>

<hr />

<h2 id="nested-inputs-in-test">Nested inputs in <code class="language-plaintext highlighter-rouge">test</code></h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tests&gt;</span>
    <span class="nt">&lt;test&gt;</span>
        <span class="nt">&lt;section</span> <span class="na">name=</span><span class="s">"advanced"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;repeat</span> <span class="na">name=</span><span class="s">"names"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"first"</span> <span class="na">value=</span><span class="s">"Abraham"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"last"</span> <span class="na">value=</span><span class="s">"Lincoln"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/repeat&gt;</span>
            <span class="nt">&lt;repeat</span> <span class="na">name=</span><span class="s">"names"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"first"</span> <span class="na">value=</span><span class="s">"Donald"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"last"</span> <span class="na">value=</span><span class="s">"Trump"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/repeat&gt;</span>
            <span class="nt">&lt;conditional</span> <span class="na">name=</span><span class="s">"image"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"output_image"</span> <span class="na">value=</span><span class="s">"yes"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"format"</span> <span class="na">value=</span><span class="s">"png"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/conditional&gt;</span>
        <span class="nt">&lt;/section&gt;</span>
        ...
    <span class="nt">&lt;/test&gt;</span>
<span class="nt">&lt;/tests&gt;</span>
</code></pre></div></div>

<hr />

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="planemo logo yet again" />]</p>

<p><code class="language-plaintext highlighter-rouge">planemo test</code></p>

<p>Runs all functional tests</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>planemo <span class="nb">test</span>
</code></pre></div></div>

<p>An HTML report (<code class="language-plaintext highlighter-rouge">tool_test_output.html</code>) is automatically created with logs in case of failing test</p>

<hr />

<p>##.image-25[<img src="../../images/planemo-logo.png" alt="planemo logo" />]</p>

<p>Test Galaxy Tools</p>

<p><img src="../../images/planemo_tool_building_test.png" alt="flowchart with planemo tool_init creating a wrapper tool.xml and planemo lint being run repeatedly, and now planemo test as well." /></p>

<hr />

<h1 id="dependencies">Dependencies</h1>

<hr />

<h2 id="dependencies-1">Dependencies</h2>

<p>How Galaxy will deal with dependencies?</p>

<p><img src="../../images/galaxy_instance.png" alt="schematic of a galaxy server with dependency resolution via requirement tags at the top. On the left is the tool box with a number of xml files listed like seqtk_seq and seqtk_subseq. On the right is applications &amp; libraries showing only a few tools like seqtk, all of the 3 multipoe subtools were collapsed" /></p>

<hr />

<h2 id="requirements"><code class="language-plaintext highlighter-rouge">requirements</code></h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;requirements&gt;</span>
    <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"1.66"</span><span class="nt">&gt;</span>biopython<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"1.0.0"</span><span class="nt">&gt;</span>graphlan<span class="nt">&lt;/requirement&gt;</span>
<span class="nt">&lt;/requirements&gt;</span>
</code></pre></div></div>

<p>Local installation using Conda packages</p>

<hr />

<p>.image-50[<img src="../../../../shared/images/conda_logo.png" alt="Conda logo, the C is textured." />]</p>

<ul>
  <li>Package, dependency and environment manager</li>
  <li>Based on recipes describing how to install the software which are then built for their distribution</li>
  <li>No compilation at installation: binaries with their dependencies, libraries…</li>
  <li>Not restricted to Galaxy</li>
</ul>

<p>See <a href="../conda/slides.html">Tool Dependencies and Conda</a></p>

<hr />

<h1 id="advanced-features">Advanced features</h1>

<hr />

<h2 id="configfiles"><code class="language-plaintext highlighter-rouge">configfiles</code></h2>

<p>A <code class="language-plaintext highlighter-rouge">configfile</code> creates a text file which can then be used inside the <code class="language-plaintext highlighter-rouge">command</code> as:</p>

<ul>
  <li>A script or a module</li>
  <li>A file needed to run the tool (e.g. a config file)</li>
</ul>

<p>Cheetah code and param/output variables can be used inside <code class="language-plaintext highlighter-rouge">configfile</code> (like
inside <code class="language-plaintext highlighter-rouge">command</code>).</p>

<hr />

<p>class: packed</p>

<h2 id="configfiles-1"><code class="language-plaintext highlighter-rouge">configfiles</code></h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[ mb $script_nexus ]]&gt;</span><span class="nt">&lt;/command&gt;</span>

<span class="nt">&lt;configfiles&gt;</span>
    <span class="nt">&lt;configfile</span> <span class="na">name=</span><span class="s">"script_nexus"</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[
set autoclose = yes;
execute $input_data;
#if str($data_type.type) == "nuc“
    lset nst=$data_type.lset_params.lset_Nst;
#end if
mcmcp ngen=$mcmcp_ngen;
mcmc;
quit
    ]]&gt;</span><span class="nt">&lt;/configfile&gt;</span>
<span class="nt">&lt;/configfiles&gt;</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">set </span>autoclose <span class="o">=</span> <span class="nb">yes</span><span class="p">;</span>
execute dataset_42.dat<span class="p">;</span>
lset <span class="nv">nst</span><span class="o">=</span>2 <span class="p">;</span>
mcmcp <span class="nv">ngen</span><span class="o">=</span>100000<span class="p">;</span>
mcmc<span class="p">;</span>
quit
</code></pre></div></div>

<hr />

<h2 id="macros"><code class="language-plaintext highlighter-rouge">macros</code></h2>

<p>![Another schemating with many arrows. Macros.xml is on the left with token and xml blocks. The token block points to examples like @THREADS@ and @HELP_ABOUT@. The xml block points to examples like <expand macro="requirements">. Both of these examples point to three blast tools which make use of the macros.](../../images/macro.png)</expand></p>

<p>.footnote[<a href="https://planemo.readthedocs.io/en/latest/writing_advanced.html#macros-reusable-elements">Planemo documentation about macros</a>]</p>

<hr />

<p>class: packed</p>

<h2 id="macros--xml"><code class="language-plaintext highlighter-rouge">macros</code> &gt; <code class="language-plaintext highlighter-rouge">xml</code></h2>

<p>macros.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;macros&gt;</span>
    <span class="nt">&lt;xml</span> <span class="na">name=</span><span class="s">"requirements"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;requirements&gt;</span>
            <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"2.5.0"</span><span class="nt">&gt;</span>blast<span class="nt">&lt;/requirement&gt;</span>
        <span class="nt">&lt;/requirements&gt;</span>
    <span class="nt">&lt;/xml&gt;</span>
    <span class="nt">&lt;xml</span> <span class="na">name=</span><span class="s">"stdio"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;stdio&gt;</span>
            <span class="nt">&lt;exit_code</span> <span class="na">range=</span><span class="s">"1"</span> <span class="na">level=</span><span class="s">"fatal"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/stdio&gt;</span>
    <span class="nt">&lt;/xml&gt;</span>
<span class="nt">&lt;/macros&gt;</span>
</code></pre></div></div>

<p>ncbi_blastn_wrapper.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;macros&gt;</span>
    <span class="nt">&lt;import&gt;</span>macros.xml<span class="nt">&lt;/import&gt;</span>
<span class="nt">&lt;/macros&gt;</span>
<span class="nt">&lt;expand</span> <span class="na">macro=</span><span class="s">"requirements"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;expand</span> <span class="na">macro=</span><span class="s">"stdio"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="macros--token"><code class="language-plaintext highlighter-rouge">macros</code> &gt; <code class="language-plaintext highlighter-rouge">token</code></h2>

<p>macros.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;macros&gt;</span>
    <span class="nt">&lt;token</span> <span class="na">name=</span><span class="s">"@THREADS@"</span><span class="nt">&gt;</span>-num_threads "\${GALAXY_SLOTS:-8}"<span class="nt">&lt;/token&gt;</span>
<span class="nt">&lt;/macros&gt;</span>
</code></pre></div></div>

<p>ncbi_blastn_wrapper.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span>
blastn -query '$query' @THREADS@ [...]
<span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="macros--xml--yield"><code class="language-plaintext highlighter-rouge">macros</code> &gt; <code class="language-plaintext highlighter-rouge">xml</code> &gt; <code class="language-plaintext highlighter-rouge">yield</code></h2>

<p>macros.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;macros&gt;</span>
    <span class="nt">&lt;xml</span> <span class="na">name=</span><span class="s">"requirements"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;requirements&gt;</span>
            <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"2.2.0"</span><span class="nt">&gt;</span>trinity<span class="nt">&lt;/requirement&gt;</span>
            <span class="nt">&lt;yield/&gt;</span>
        <span class="nt">&lt;/requirements&gt;</span>
    <span class="nt">&lt;/xml&gt;</span>
<span class="nt">&lt;/macros&gt;</span>
</code></pre></div></div>

<p>trinity.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;expand</span> <span class="na">macro=</span><span class="s">"requirements"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"1.1.2"</span><span class="nt">&gt;</span>bowtie<span class="nt">&lt;/requirement&gt;</span>
<span class="nt">&lt;/expand&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="tool_version-token"><code class="language-plaintext highlighter-rouge">@TOOL_VERSION@</code> token</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;macros&gt;</span>
    <span class="nt">&lt;token</span> <span class="na">name=</span><span class="s">"@TOOL_VERSION@"</span><span class="nt">&gt;</span>1.2<span class="nt">&lt;/token&gt;</span>
    <span class="nt">&lt;token</span> <span class="na">name=</span><span class="s">"@VERSION_SUFFIX@"</span><span class="nt">&gt;</span>3<span class="nt">&lt;/token&gt;</span>
<span class="nt">&lt;/macros&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;tool</span> <span class="na">id=</span><span class="s">"seqtk_seq"</span> <span class="na">name=</span><span class="s">"Convert to FASTA"</span> <span class="na">version=</span><span class="s">"@TOOL_VERSION@+galaxy@VERSION_SUFFIX@"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;requirements&gt;</span>
        <span class="nt">&lt;requirement</span> <span class="na">type=</span><span class="s">"package"</span> <span class="na">version=</span><span class="s">"@TOOL_VERSION@"</span><span class="nt">&gt;</span>seqtk<span class="nt">&lt;/requirement&gt;</span>
    <span class="nt">&lt;/requirements&gt;</span>
</code></pre></div></div>

<p>This means: the 3rd revision of the Galaxy tool for Seqtk 1.2 .</p>

<p><a href="https://galaxy-iuc-standards.readthedocs.io/en/latest/best_practices/tool_xml.html#tool-versions">Best practice documentation</a></p>

<hr />

<h2 id="command--reserved-variables"><code class="language-plaintext highlighter-rouge">command</code> &gt; Reserved variables</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
# Email’s numeric ID (id column of galaxy_user table in the database)
echo '$__user_id__'

# User’s email address
echo '$__user_email__'

# The galaxy.app.UniverseApplication instance, gives access to all other configuration file variables.
# Should be used as a last resort, may go away in future releases.
echo '$__app__.config.user_library_import_dir'

# Check a dataset type
#if $input1.is_of_type('gff'):
    echo 'input1 type is ${input1.datatype}'
#end if
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>
<p>.footnote[<a href="https://docs.galaxyproject.org/en/latest/dev/schema.html#reserved-variables">Reserved Variables List</a>]</p>

<hr />

<h2 id="multiple-inputs---mapping-over">Multiple inputs - Mapping over</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"txt"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p><img src="../../images/input_data.png" alt="File selector input" /></p>

<p>Possible to select multiple dataset:</p>

<p><img src="../../images/input_data_multiple.png" alt="File selector input screenshot, but now the middle &quot;multiple files&quot; button is checked." /></p>

<ul>
  <li>Useful to launch the same tool on multiple datasets independently</li>
  <li>One job per dataset</li>
</ul>

<hr />

<h2 id="multiple-inputs---single-execution">Multiple inputs - Single execution</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"..."</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"txt"</span> <span class="na">multiple=</span><span class="s">"true"</span> <span class="na">label=</span><span class="s">"..."</span> <span class="na">help=</span><span class="s">"..."</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p><img src="../../images/input_data_multiple2.png" alt="A multi-select file input field is shown, different than the normal file input there is no single file option." /></p>

<p>In the command:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[
...
#for $input in $inputs
    --input "$input"
#end for
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<p>One job for all selected dataset</p>

<hr />

<h2 id="multiple-outputs">Multiple outputs</h2>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;outputs&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"output"</span> <span class="na">format=</span><span class="s">"txt"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;discover_datasets</span> <span class="na">pattern=</span><span class="s">"__designation_and_ext__"</span>
            <span class="na">directory=</span><span class="s">"output_dir"</span> <span class="na">visible=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/outputs&gt;</span>
</code></pre></div></div>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">__designation_and_ext__</code>: a predefined regexp,</p>
  </li>
  <li>
    <p>catches the dataset identifier + the datatype</p>
  </li>
</ul>

<p>If the output file extension is not present/usable:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;outputs&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"output"</span> <span class="na">format=</span><span class="s">"txt"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;discover_datasets</span> <span class="na">pattern=</span><span class="s">"__designation__"</span> <span class="na">format=</span><span class="s">"txt"</span>
            <span class="na">directory=</span><span class="s">"output_dir"</span> <span class="na">visible=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/outputs&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="dataset-collections">Dataset collections</h2>

<p>A dataset collection combines numerous datasets in a single entity that can be manipulated together</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">list</code>: a simple list of datasets</li>
  <li><code class="language-plaintext highlighter-rouge">paired</code>: a pair of datasets, <code class="language-plaintext highlighter-rouge">forward</code> and <code class="language-plaintext highlighter-rouge">reverse</code> for NGS</li>
  <li>composite: e.g. <code class="language-plaintext highlighter-rouge">list:paired</code> for a list of dataset pairs</li>
</ul>

<p>Usage</p>

<ul>
  <li>Useful to launch a workflow on many samples</li>
  <li>Sample names are kept along the workflow: <code class="language-plaintext highlighter-rouge">element_identifier</code></li>
  <li>Galaxy tools are available to manipulate collections</li>
</ul>

<hr />

<h2 id="dataset-collections-as-input">Dataset collections as input</h2>

<p>Mapping over (1 job per collection element):</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"inputs"</span> <span class="na">type=</span><span class="s">"data"</span> <span class="na">format=</span><span class="s">"bam"</span> <span class="na">label=</span><span class="s">"Input BAM(s)"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p><img src="../../images/input_data_collection.png" alt="The normal file selector is shown however now the collection input is clicked." /></p>

<p>Single execution:</p>
<ul>
  <li>accepted with <code class="language-plaintext highlighter-rouge">multiple="true"</code> as described in previous slides</li>
  <li>or you can accept only collections:</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"inputs"</span> <span class="na">type=</span><span class="s">"data_collection"</span> <span class="na">collection_type=</span><span class="s">"list|paired|list:paired|..."</span>
    <span class="na">format=</span><span class="s">"bam"</span> <span class="na">label=</span><span class="s">"Input BAM(s)"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;command&gt;</span><span class="cp">&lt;![CDATA[ ...
#for $input in $inputs
    --input '$input'
    --sample_name '$input.element_identifier'
#end for
]]&gt;</span><span class="nt">&lt;/command&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="dataset-collections-as-output">Dataset collections as output</h2>

<p>A single paired collection:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;collection</span> <span class="na">name=</span><span class="s">"paired_output"</span> <span class="na">type=</span><span class="s">"paired"</span> <span class="na">label=</span><span class="s">"Split Pair"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"forward"</span> <span class="na">format=</span><span class="s">"txt"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">name=</span><span class="s">"reverse"</span> <span class="na">format_source=</span><span class="s">"input1"</span> <span class="na">from_work_dir=</span><span class="s">"reverse.txt"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/collection&gt;</span>
</code></pre></div></div>

<p>Unknown number of files:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;collection</span> <span class="na">name=</span><span class="s">"output"</span> <span class="na">type=</span><span class="s">"list"</span> <span class="na">label=</span><span class="s">"Unknown number of files"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;discover_datasets</span> <span class="na">pattern=</span><span class="s">"__name_and_ext__"</span> <span class="na">directory=</span><span class="s">"outputs"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/collection&gt;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">__name_and_ext__</code>: a predefined regexp,</li>
  <li>catches the dataset identifier + the datatype</li>
</ul>

<hr />

<h2 id="using-multiple-cpus">Using multiple CPUs</h2>

<p><img src="../../images/job_conf.xml_2.png" alt="Screenshot of two xml files. In the top is the jb_conf.xml where a command line job submission specification indicates that it will be submitted with 4 threads. A single tool, ncbi blastn wrapper is assigned to that destination. In the second xml file the blastn command uses the GALAXY_SLOTS variable to control how many threads are supplied to the tool." /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>blastn <span class="nt">-query</span> foo_bar <span class="nt">-num_threads</span> 4
</code></pre></div></div>
<p>8 is the default value if not set in destination</p>

<hr />

<h2 id="data-tables">Data tables</h2>

<ul>
  <li>They list all reference data used by tools</li>
  <li>e.g.: Blast databases, BWA indexes, Fasta files</li>
  <li>Stored in <code class="language-plaintext highlighter-rouge">.loc</code> files</li>
  <li>Populated by hand or using Data Managers</li>
  <li>Data Managers are dedicated kind of Galaxy tools</li>
</ul>

<hr />

<h2 id="using-a-data-table-in-a-tool">Using a data table in a tool</h2>

<p><img src="../../images/tool_data_table_conf.xml.png" alt="Three xml files are shown. At the top is the tool data table conf which mentions a tool-data/bowtie2_indices.loc. Below is that bowtie2 loc file which indicates that hg19 will be found at a specific location in the /db directory. And the third is the bowtie2 wrapper which loads options from a data table, and points to the bowtie2_indexes named table in the first xml." /></p>

<hr />

<h2 id="datatypes">Datatypes</h2>

<ul>
  <li>Every Galaxy dataset is associated with a datatype</li>
  <li>Datatype can be detected or user specified</li>
  <li>Gain of usability</li>
</ul>

<p>.footnote[<a href="https://galaxyproject.org/admin/datatypes/adding-datatypes/">Documentation: Adding Datatypes</a>]</p>

<hr />

<h1 id="publishing-tools">Publishing tools</h1>

<hr />

<h2 id="contributing-to-a-community">Contributing to a community</h2>

<p>Many tools developed by the community on GitHub repositories</p>
<ul>
  <li><a href="https://github.com/galaxyproject/tools-iuc">Intergalactic Utilities Commission</a></li>
  <li><a href="https://github.com/galaxyproteomics/tools-galaxyp">GalaxyP</a></li>
  <li>…</li>
</ul>

<p>Added value:</p>
<ul>
  <li>Easier development</li>
  <li>Easier contribution for user</li>
  <li>Avoid duplications of efforts</li>
  <li>Automated tests on each contribution</li>
  <li>Automated publishing to ToolShed</li>
  <li>
    <h2 id="principle-of-many-eyes-if-something-is-visible-to-many-people-then-collectively-they-are-more-likely-to-find-errors-in-it">Principle of many eyes: if something is visible to many people then, collectively, they are more likely to find errors in it</h2>
  </li>
</ul>

<h2 id="iuc-intergalactic-utilities-commission">IUC: Intergalactic Utilities Commission</h2>

<p>.image-50[<img src="../../images/iuc_logo.png" alt="IUC logo" />]</p>

<ul>
  <li>A team maintaining high quality tools</li>
  <li>Establishing and following <a href="https://galaxy-iuc-standards.readthedocs.io/">best practices</a> for tool development</li>
  <li>Open to contributions: bug fixes, new tools, …</li>
</ul>

<p>https://github.com/galaxyproject/tools-iuc</p>

<hr />

<h2 id="how-should-i-publish-my-tool">How should I publish my tool?</h2>

<p>Adding to an existing GitHub repository (IUC, GalaxyP, …)</p>

<ul>
  <li>Read the guidelines</li>
  <li>Open a pull request</li>
  <li>Respond to review comments</li>
</ul>

<hr />

<h2 id="how-should-i-publish-my-tool-1">How should I publish my tool?</h2>

<p>Using your own GitHub repository</p>

<ul>
  <li>Reasons: ownership, specific practices, exotic tools</li>
  <li>Follow the same structure as IUC</li>
  <li>Automate tests and ToolShed publishing by reusing <code class="language-plaintext highlighter-rouge">.github/</code> configuration</li>
</ul>

<hr />

<h2 id="how-should-i-publish-my-tool-2">How should I publish my tool?</h2>

<p>Using planemo by hand</p>

<ul>
  <li>Ok for few tools</li>
  <li>Makes contributing harder</li>
  <li>Not recommended</li>
</ul>

<p><a href="/training-material/topics/dev/tutorials/toolshed/slides.html">Check out our tutorial to publish to the ToolShed using Planemo</a></p>

<hr />

<h2 id="continuous-integration">Continuous Integration</h2>

<p>.image-50[<img src="../../images/github_logo.png" alt="Github logo" />]</p>

<p>.image-50[<img src="../../images/planemo-logo.png" alt="Planemo logo" />]</p>

<p>.image-50[<img src="../../../../shared/images/conda_logo.png" alt="Conda logo" />]</p>

<hr />

<h2 id="continuous-integration-1">Continuous Integration</h2>

<ul>
  <li>Create a Pull Request on a GitHub repository</li>
  <li>Tests are automatically run on GitHub Actions</li>
  <li>Other contributors review your tool</li>
  <li>The Pull Request is accepted when all the lights are green</li>
  <li>The tool is automatically uploaded to the ToolShed</li>
</ul>

<hr />

<h2 id="github-actions-configuration">GitHub Actions configuration</h2>

<p>GitHub Actions configured in the <code class="language-plaintext highlighter-rouge">.github/</code> directory</p>

<p><img src="../../images/github_actions_iuc.png" alt="Screenshot of a CI configuration file. It runs several planemo commands during before install, install, and script portions." /></p>

<p>Uses a standard GitHub Action developed on https://github.com/galaxyproject/planemo-ci-action</p>

<hr />

<h2 id="github-actions-execution">GitHub Actions execution</h2>

<p><img src="../../images/github_actions_executed1.png" alt="Screenshot of a CI execution showing a tool test passing." />
<img src="../../images/github_actions_executed2.png" alt="Screenshot of a CI execution showing details of test logs." /></p>

<hr />

<h2 id="github-actions-test-reports">GitHub Actions: test reports</h2>

<p>Downloadable HTML report, open it with a web browser to see the details</p>

<p>.pull-left[<img src="../../images/github_actions_artifacts.png" alt="Screenshot of a CI execution artifacts, with a link to download an HTML report of the tests." />]</p>

<p>.pull-right[<img src="../../images/github_actions_artifacts2.png" alt="Screenshot of an example of HTML report of the tests." />]</p>

<hr />

<h2 id="toolshed">ToolShed</h2>

<ul>
  <li>Need to create a <code class="language-plaintext highlighter-rouge">.shed.yml</code> file in the tool directory of the GitHub repository:</li>
</ul>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">categories</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">Sequence Analysis</span><span class="pi">]</span>
<span class="na">description</span><span class="pi">:</span> <span class="s">Tandem Repeats Finder description</span>
<span class="na">long_description</span><span class="pi">:</span> <span class="s">A long long description.</span>
<span class="s">&lt;span id="tandem_repeats_finder_2"&gt;&lt;i class="fas fa-link" aria-hidden="true"&gt;&lt;/i&gt; tandem_repeats_finder_2&lt;/span&gt;</span>
<span class="na">owner</span><span class="pi">:</span> <span class="s">gandres</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>planemo shed_init <span class="nt">--name</span><span class="o">=</span><span class="s2">"tandem_repeats_finder_2"</span>
                     <span class="nt">--owner</span><span class="o">=</span><span class="s2">"gandres"</span>
                     <span class="nt">--description</span><span class="o">=</span><span class="s2">"Tandem Repeats Finder description"</span>
                     <span class="nt">--long_description</span><span class="o">=</span><span class="s2">"A long long description."</span>
                     <span class="nt">--category</span><span class="o">=</span><span class="s2">"Sequence Analysis"</span>
                     <span class="o">[</span><span class="nt">--remote_repository_url</span><span class="o">=</span>&lt;URL to .shed.yml on github&gt;]
                     <span class="o">[</span><span class="nt">--homepage_url</span><span class="o">=</span>&lt;Homepage <span class="k">for </span>tool.&gt;]
</code></pre></div></div>

<hr />

<h2 id="tool-suites">Tool suites</h2>

<p>A tool suite is a group of related tools that can all be installed at once.</p>

<p>Defined in <code class="language-plaintext highlighter-rouge">.shed.yml</code>: implicitly define repositories for each individual tool in the directory and build a suite for those tools.</p>

<p>Example: <code class="language-plaintext highlighter-rouge">trinity/.shed.yml</code></p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">[</span><span class="nv">...</span><span class="pi">]</span>
<span class="na">auto_tool_repositories</span><span class="pi">:</span>
    <span class="na">name_template</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
    <span class="na">description_template</span><span class="pi">:</span> <span class="s2">"</span><span class="nv"> </span><span class="s">(from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">Trinity</span><span class="nv"> </span><span class="s">tool</span><span class="nv"> </span><span class="s">suite)"</span>
<span class="na">suite</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">suite_trinity"</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s">Trinity tools to assemble transcript sequences from Illumina RNA-Seq data.</span>
</code></pre></div></div>

<hr />

<h2 id="check">Check</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>planemo shed_lint <span class="nt">--tools</span> <span class="nt">--ensure_metadata</span>
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Linting repository <span class="o">[</span>…]/tandem_repeats_finder
Applying linter expansion... CHECK
.. INFO: Included files all found.
Applying linter tool_dependencies_xsd... CHECK
.. INFO: tool_dependencies.xml found and appears to be valid XML
Applying linter tool_dependencies_actions... CHECK
.. INFO: Parsed tool dependencies.
Applying linter repository_dependencies... CHECK
.. INFO: No repository_dependencies.xml, skipping.
Applying linter shed_yaml... CHECK
.. INFO: .shed.yml found and appears to be valid YAML.
Applying linter readme... CHECK
.. INFO: No README found skipping.
+Linting tool <span class="o">[</span>…]/tandem_repeats_finder/tandem_repeats_finder_wrapper.xml
<span class="o">[</span>…]
</code></pre></div></div>


	<hr />


<h2>Key Points</h2>

<ul>

<li>Galaxy Tool Syntax</li>

<li>Use Planemo</li>

<li>Use Conda</li>

<li>Use GitHub</li>

<li>Use GitHub Actions</li>

<li>No more excuse to develop crappy Galaxy tools</li>

</ul>




<h2><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Do you want to extend your knowledge?</h2>
Follow one of our recommended follow-up trainings:



    
        
        
            
        
- [Development in Galaxy](/training-material/topics/dev)
    - Tool Dependencies and Conda: [<i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> slides](/training-material/topics/dev/tutorials/conda/slides.html)
    






<h2>Thank you!</h2>

This material is the result of a collaborative work. Thanks to the <a href="https://training.galaxyproject.org" aria-label="Visit the GTN">Galaxy Training Network</a> and all the contributors!


<img src="/training-material/assets/images/GTNLogo1000.png" alt="Galaxy Training Network" style="height: 100px;"/>


Tutorial Content is licensed under

  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

</section>






        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/./topics/dev/tutorials/tool-integration/slides.html">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/./topics/dev/tutorials/tool-integration/slides.html">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/e3baa75521bc8bb347ef199d6e7b8913000d9651">e3baa75</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.20cf1f17.js'></script>

	
	

    </body>
</html>
