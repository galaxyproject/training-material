<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Galaxy Webhooks</title>
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap.min.css?v=3">
        <link rel="stylesheet" href="/training-material/assets/css/bootstrap-toc.min.css">
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=2">
        <script src="https://kit.fontawesome.com/67b3f98409.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="/training-material/assets/css/academicons.css">
        <link rel="stylesheet" href="/training-material/assets/css/syntax_highlighting.css">
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon" />

        
        
        
        
        
        <meta name="description" content="Galaxy is an open-source project. Everyone can contribute..." />
        <meta property="og:title" content="Galaxy Training: Galaxy Webhooks" />
        <meta property="og:description" content="Galaxy is an open-source project. Everyone can contribute..." />
        <meta property="og:image" content="/training-material/assets/images/GTNLogo1000.png" />
    </head>
    <body data-spy="scroll" data-target="#toc">
        











<!-- Gitter -->


<script>
  ((window.gitter = {}).chat = {}).options = {
  room: 'galaxyproject/dev'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                Galaxy Training!
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/training-material/topics/dev" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i><span class="visually-hidden">topic</span> Development in Galaxy
                        </a>
                    </li>

                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Language Selector">
                            <i class="fas fa-language" aria-hidden="true"></i><span class="visually-hidden">language</span> Language
                        </a>
                        <div class="dropdown-menu">
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=fr&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fdev%2Ftutorials%2Fwebhooks%2Ftutorial.html&edit-text=&act=url" title="">
                                FranÃ§ais
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ja&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fdev%2Ftutorials%2Fwebhooks%2Ftutorial.html&edit-text=&act=url" title="">
                                æ—¥æœ¬èªž
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=es&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fdev%2Ftutorials%2Fwebhooks%2Ftutorial.html&edit-text=&act=url" title="">
                                EspaÃ±ol
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=pt&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fdev%2Ftutorials%2Fwebhooks%2Ftutorial.html&edit-text=&act=url" title="">
                                PortuguÃªs
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=ar&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fdev%2Ftutorials%2Fwebhooks%2Ftutorial.html&edit-text=&act=url" title="">
                                Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
                            </a>
                            
                            <a class="dropdown-item" href="https://translate.google.com/translate?hl=jp&sl=en&tl=&u=https%3A%2F%2Ftraining.galaxyproject.org%2Ftopics%2Fdev%2Ftutorials%2Fwebhooks%2Ftutorial.html&edit-text=&act=url" title="">
                                And more!
                            </a>
                        </div>
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
        <form method="get" action="https://tess.elixir-europe.org/materials">
            <input type="text" id="search" name="q" value="" style="margin-left: 0.5em;/*! border-radius: 0px; */">
            <input type="hidden" value="Galaxy Training" name="content_provider">
            <input type="submit" value="Search on TeSS" style="width: 92%;border-radius: 0px;margin: 0.5em;background: #f47d20;border: 0px;padding: 0.25em;" class="">
        </form>

        <div class="dropdown-divider"></div>
        <a class="dropdown-item" href="/training-material/faq" title="Check our FAQ">
            FAQ
        </a>
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            Discuss on Galaxy Help
        </a>

        <div class="dropdown-item">
            <div>
                Theme
            </div>

            <div id="theme-selector" data-toggle="buttons">
                <label data-value="default" class="btn btn-secondary">
                    <input type="radio" name="options" id="default" autocomplete="off"> Default
                </label>
                <label data-value="night" class="btn btn-secondary">
                    <input type="radio" name="options" id="night" autocomplete="off"> Night
                </label>
                <label data-value="midnight" class="btn btn-secondary">
                    <input type="radio" name="options" id="midnight" autocomplete="off"> Midnight
                </label>
                <label data-value="rainbow" class="btn btn-secondary">
                    <input type="radio" name="options" id="rainbow" autocomplete="off"> Rainbow
                </label>
                <label data-value="halloween" class="btn btn-secondary">
                    <input type="radio" name="options" id="halloween" autocomplete="off"> ðŸŽƒ
                </label>
            </div>

        </div>
    </div>
</li>


                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/galaxyproject/training-material/edit/master/topics/dev/tutorials/webhooks/tutorial.md">
                            <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container main-content">
    <script type="application/ld+json">
        


{
  "@context": "http://schema.org",
  "@type": "Course",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "Short descriptions are present but long descriptions will be needed for non-visual users",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "students"
  },
  "citation": {
    "@type": "CreativeWork",
    "name": "Community-Driven Data Analysis Training for Biology",
    "url": "https://doi.org/10.1016/j.cels.2018.05.012"
  },
  "copyrightHolder": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Galaxy Webhooks",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "license": "https://github.com/galaxyproject/training-material/blob/master/LICENSE.md",
  "producer": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "provider": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "url": "https://galaxyproject.org/teach/gtn/"
  },
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Development in Galaxy",
    "description": "Galaxy is an open-source project. Everyone can contribute to its development with core Galaxy development, integration of softwares in Galaxy environment, ...",
    "url": "https://training.galaxyproject.org//training-material/topics/dev/"
  },
  "courseCode": "dev / webhooks / hands-on",
  "learningResourceType": "hands-on tutorial",
  "name": "Hands-on for 'Galaxy Webhooks' tutorial",
  "url": "https://training.galaxyproject.org//training-material/topics/dev/tutorials/webhooks/tutorial.html",
  "timeRequired": "PT1H",
  "description": "The questions this  addresses are:\n - What are Galaxy Webhooks?\n - How to create them?\n\n\\nThe objectives are:\n - Discover what Galaxy Webhooks are\n - Be able to create Webhooks\n - Be able to add a Galaxy Webhook in a Galaxy instance\n\n",
  "hasPart": [

  ],
  "author": [
    {
      "@type": "Person",
      "name": "Clemens Blank"
    },
    {
      "@type": "Person",
      "name": "Martin ÄŒech"
    },
    {
      "@type": "Person",
      "name": "BjÃ¶rn GrÃ¼ning"
    }
  ],
  "contributor": [
    {
      "@type": "Person",
      "name": "Clemens Blank"
    },
    {
      "@type": "Person",
      "name": "Martin ÄŒech"
    },
    {
      "@type": "Person",
      "name": "BjÃ¶rn GrÃ¼ning"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Development in Galaxy",
      "description": "Galaxy is an open-source project. Everyone can contribute to its development with core Galaxy development, integration of softwares in Galaxy environment, ...",
      "url": "https://training.galaxyproject.org//training-material/topics/dev/"
    }
  ]
}
    </script>

    <section class="tutorial">
        <h1 data-toc-skip>Galaxy Webhooks</h1>
        

        <div class="contributors-line">By: 

<a href="/training-material/hall-of-fame/blankclemens/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/blankclemens" alt="Clemens Blank">Clemens Blank</a>, <a href="/training-material/hall-of-fame/martenson/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/martenson" alt="Martin ÄŒech">Martin ÄŒech</a>, <a href="/training-material/hall-of-fame/bgruening/" class="contributor-badge"><img src="https://avatars.githubusercontent.com/bgruening" alt="BjÃ¶rn GrÃ¼ning">BjÃ¶rn GrÃ¼ning</a>

</div>

        <blockquote class="overview">
            <h3>Overview</h3>
            <strong><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Questions</strong>
            <ul>
            
            <li><p>What are Galaxy Webhooks?</p>
</li>
            
            <li><p>How to create them?</p>
</li>
            
            </ul>

            <strong><i class="fas fa-bullseye" aria-hidden="true"></i><span class="visually-hidden">objectives</span> Objectives</strong>
            <ul>
            
            <li><p>Discover what Galaxy Webhooks are</p>
</li>
            
            <li><p>Be able to create Webhooks</p>
</li>
            
            <li><p>Be able to add a Galaxy Webhook in a Galaxy instance</p>
</li>
            
            </ul>

            

            
            <p><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i><span class="visually-hidden">time</span> Time estimation:</strong> 1 hour</p>
            

            

            
            

            
            <p id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials</strong></p>
            <ul>
                <div class="supporting_material">
                
                    <li class="btn btn-default"><a href="/training-material/topics/dev/tutorials/webhooks/slides.html" title="Slides for this tutorial">
                        <i class="fab fa-slideshare" aria-hidden="true"></i><span class="visually-hidden">slides</span> Slides
                    </a></li>
                

                

                

                

                
                    <li class="btn btn-default supporting_material">

    <a href="#" class="btn btn-default dropdown-toggle topic-icon" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span> Available on these Galaxies
    </a>
    <ul class="dropdown-menu">
    
        <li>
            <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/tree/master/topics/dev/docker" title="Docker image for this tutorial">
                <i class="fab fa-docker" aria-hidden="true"></i><span class="visually-hidden">docker_image</span> Docker image
            </a>
        </li>
    
    
    </ul>


</li>
                
                </div>
            </ul>
            

            <p><strong> <i class="far fa-calendar" aria-hidden="true"></i><span class="visually-hidden">last_modification</span> Last modification:</strong> Jan 6, 2021 </p>
        </blockquote>

        <div class="container">
            <div class="row">
                <!-- sidebar, which will move to the top on a small screen -->
                <div class="col-sm-2">
                    <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
                </div>
                <div class="col-sm-10">
                    <h2 id="introduction">Introduction</h2>

<p>In this tutorial we are going to demonstrate how to add a webhook to the tool-execution endpoint. This is the web-page that appears
after you have executed a tool. As a more useful example we are going to ask <a href="http://phdcomics.com">phdcomics</a> for a random comic that we can
display to entertain our users.</p>

<p>At first letâ€™s create a config file that defines the name and the type of your webhook. The <code class="language-plaintext highlighter-rouge">name</code> is <code class="language-plaintext highlighter-rouge">phdcomics</code> and with the type we define the entry-points
at which we modify the <span class="notranslate">Galaxy</span> user-interface. In our case we want to display an image at the <code class="language-plaintext highlighter-rouge">tool</code> and <code class="language-plaintext highlighter-rouge"><span class="notranslate">workflow</span></code> entry-point.
The key <code class="language-plaintext highlighter-rouge">activate</code> gives you control per-webhook to activate or deactivate it.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li>
      <p>Create a file named <code class="language-plaintext highlighter-rouge">config/phdcomics.yaml</code> with the following content:</p>

      <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="na">name</span><span class="pi">:</span> <span class="s">phdcomics</span>
   <span class="na">type</span><span class="pi">:</span>
     <span class="pi">-</span> <span class="s">tool</span>
     <span class="pi">-</span> <span class="s"><span class="notranslate">workflow</span></span>
   <span class="na">activate</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div>      </div>
    </li>
  </ol>
</blockquote>

<p>The next step is to define HTML/JS part which will control the part of the <span class="notranslate">Galaxy</span> UI. We create a new PHDComicsAppView view extended from Backbone.
Inside this view we define a simple <code class="language-plaintext highlighter-rouge">div</code>-container with a button and a placeholder for our image called <code class="language-plaintext highlighter-rouge">phdcomics-img</code>. You can add additional
functionality to your view, for example getting a new image on button click. The essential functionality however is stored getRandomComic.
The big problem with phdcomics is that there is no nice API to retrive the comics, so we need to fallback to parse the HTML pages. We decided to do this
in Python to demonstrate webhooks abilitity to call self-defined python functions. Please note the <code class="language-plaintext highlighter-rouge">url = <span class="notranslate">galaxy</span>Root + 'api/webhooks/phdcomics/get_data';</code>, which
calls an REST endpoint defined by use in the next step. The return value of this endpoint is retrived in JS and can be displayed or modified.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-1"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li>
      <p>Create a file named <code class="language-plaintext highlighter-rouge">static/script.js</code> with the following content:</p>

      <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx"><span class="notranslate">galaxy</span>Root</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx"><span class="notranslate">Galaxy</span></span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span> <span class="p">?</span> <span class="nx"><span class="notranslate">Galaxy</span></span><span class="p">.</span><span class="nx">root</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">PHDComicsAppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
            <span class="na">el</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#phdcomics</span><span class="dl">'</span><span class="p">,</span>

            <span class="na">appTemplate</span><span class="p">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span>
                <span class="dl">'</span><span class="s1">&lt;div id="phdcomics-header"&gt;</span><span class="dl">'</span> <span class="o">+</span>
                   <span class="dl">'</span><span class="s1">&lt;div id="phdcomics-name"&gt;PHD Comics&lt;/div&gt;</span><span class="dl">'</span> <span class="o">+</span>
                    <span class="dl">'</span><span class="s1">&lt;button id="phdcomics-random"&gt;Random&lt;/button&gt;</span><span class="dl">'</span> <span class="o">+</span>
                <span class="dl">'</span><span class="s1">&lt;/div&gt;</span><span class="dl">'</span> <span class="o">+</span>
                <span class="dl">'</span><span class="s1">&lt;div id="phdcomics-img"&gt;&lt;/div&gt;</span><span class="dl">'</span>
            <span class="p">),</span>

            <span class="na">imgTemplate</span><span class="p">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;img src="&lt;%= src %&gt;""&gt;</span><span class="dl">'</span><span class="p">),</span>

            <span class="na">events</span><span class="p">:</span> <span class="p">{</span>
                <span class="dl">'</span><span class="s1">click #phdcomics-random</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">getRandomComic</span><span class="dl">'</span>
            <span class="p">},</span>

            <span class="na">initialize</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
            <span class="p">},</span>

            <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">appTemplate</span><span class="p">());</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$comicImg</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#phdcomics-img</span><span class="dl">'</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">getRandomComic</span><span class="p">();</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">},</span>

            <span class="na">getRandomComic</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
                    <span class="nx">url</span> <span class="o">=</span> <span class="nx"><span class="notranslate">galaxy</span>Root</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">api/webhooks/phdcomics/get_data</span><span class="dl">'</span><span class="p">;</span>

                <span class="k">this</span><span class="p">.</span><span class="nx">$comicImg</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;div/&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
                    <span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">phdcomics-loader</span><span class="dl">'</span>
                <span class="p">}));</span>

                <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">me</span><span class="p">.</span><span class="nx">renderImg</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">src</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">[ERROR] "</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">url</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">":</span><span class="se">\n</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
            <span class="p">},</span>

            <span class="na">renderImg</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$comicImg</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">imgTemplate</span><span class="p">({</span><span class="na">src</span><span class="p">:</span> <span class="nx">src</span><span class="p">}));</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="k">new</span> <span class="nx">PHDComicsAppView</span><span class="p">();</span>
    <span class="p">});</span>
</code></pre></div>      </div>
    </li>
  </ol>
</blockquote>

<p>The following hands-on will define an API endpoint that is called from the JS code of your webhook.
Make sure you name the python function <code class="language-plaintext highlighter-rouge">main</code> and that all third-party requirements are installed in your <span class="notranslate">Galaxy</span> virtual environment.
Please note that the <code class="language-plaintext highlighter-rouge">main()</code> can consume <code class="language-plaintext highlighter-rouge">params</code> from your client but also the <span class="notranslate">Galaxy</span> <code class="language-plaintext highlighter-rouge">trans</code> object, which will give you access to the
entire user-object, including histories and datasets.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-2"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li>
      <p>Create a file named <code class="language-plaintext highlighter-rouge">helper/__init__.py</code> with the following content:</p>

      <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span> <span class="n">webhook</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">error</span> <span class="o">=</span> <span class="s">''</span>
    <span class="n">comic_src</span> <span class="o">=</span> <span class="s">''</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Third-party dependencies
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
        <span class="k">except</span> <span class="nb">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">log</span><span class="p">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s">'success'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">'error'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

        <span class="c1"># Get latest id
</span>        <span class="k">if</span> <span class="s">'latest_id'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">webhook</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s">'https://phdcomics.com/gradfeed.php'</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
            <span class="n">soap</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="s">'(?:https://www\.phdcomics\.com/comics\.php\?f=)(\d+)'</span>
            <span class="n">webhook</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="s">'latest_id'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">link</span><span class="p">.</span><span class="n">text</span><span class="p">).</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">soap</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'link'</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">))</span>
            <span class="p">])</span>

        <span class="n">random_id</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">webhook</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="s">'latest_id'</span><span class="p">])</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">'https://www.phdcomics.com/comics/archive.php?comicid=%d'</span> <span class="o">%</span> \
            <span class="n">random_id</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
        <span class="n">comic_img</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'img'</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">'comic2'</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">comic_src</span> <span class="o">=</span> <span class="n">comic_img</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="s">'&lt;img id=comic2 name=comic2 src=([\w:\/\.]+)'</span>
            <span class="n">comic_src</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">content</span><span class="p">).</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">'success'</span><span class="p">:</span> <span class="ow">not</span> <span class="n">error</span><span class="p">,</span> <span class="s">'error'</span><span class="p">:</span> <span class="n">error</span><span class="p">,</span> <span class="s">'src'</span><span class="p">:</span> <span class="n">comic_src</span><span class="p">}</span>
</code></pre></div>      </div>
    </li>
  </ol>
</blockquote>

<p>To make your webhook appealing you can also add custom CSS which you can use in your HTML/JS code.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-3"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li>
      <p>Create a file named <code class="language-plaintext highlighter-rouge">static/styles.css</code> with the following content:</p>

      <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nf">#phdcomics</span> <span class="p">{</span>
        <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#52697d</span><span class="p">;</span>
        <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
        <span class="nl">border-radius</span><span class="p">:</span> <span class="m">3px</span><span class="p">;</span>
        <span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-header</span> <span class="p">{</span>
        <span class="nl">background</span><span class="p">:</span> <span class="m">#52697d</span><span class="p">;</span>
        <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#52697d</span><span class="p">;</span>
        <span class="nl">padding</span><span class="p">:</span> <span class="m">15px</span> <span class="m">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-name</span> <span class="p">{</span>
        <span class="nl">color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
        <span class="nl">padding-bottom</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-header</span> <span class="nt">button</span> <span class="p">{</span>
        <span class="nl">color</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
        <span class="nl">font-size</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
        <span class="nl">background-color</span><span class="p">:</span> <span class="m">#768fa5</span><span class="p">;</span>
        <span class="nl">border</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
        <span class="nl">border-radius</span><span class="p">:</span> <span class="m">7px</span><span class="p">;</span>
        <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">5px</span> <span class="m">#5c768c</span><span class="p">;</span>
        <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span> <span class="m">10px</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-header</span> <span class="nt">button</span><span class="nd">:focus</span> <span class="p">{</span>
        <span class="nl">outline</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-header</span> <span class="nt">button</span><span class="nd">:hover</span> <span class="p">{</span>
        <span class="nl">background-color</span><span class="p">:</span> <span class="m">#67839b</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-header</span> <span class="nt">button</span><span class="nd">:active</span> <span class="p">{</span>
        <span class="nl">background-color</span><span class="p">:</span> <span class="m">#67839b</span><span class="p">;</span>
        <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">#5c768c</span><span class="p">;</span>
        <span class="nl">transform</span><span class="p">:</span> <span class="n">translateY</span><span class="p">(</span><span class="m">5px</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-img</span> <span class="p">{</span>
        <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-img</span> <span class="nt">img</span> <span class="p">{</span>
        <span class="nl">padding</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
        <span class="nl">max-width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
        <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">-4px</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nf">#phdcomics-loader</span> <span class="p">{</span>
        <span class="nl">border</span><span class="p">:</span> <span class="m">5px</span> <span class="nb">solid</span> <span class="m">#f3f3f3</span><span class="p">;</span>
        <span class="nl">border-top</span><span class="p">:</span> <span class="m">5px</span> <span class="nb">solid</span> <span class="m">#52697d</span><span class="p">;</span>
        <span class="nl">border-radius</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
        <span class="nl">width</span><span class="p">:</span> <span class="m">25px</span><span class="p">;</span>
        <span class="nl">height</span><span class="p">:</span> <span class="m">25px</span><span class="p">;</span>
        <span class="nl">animation</span><span class="p">:</span> <span class="n">spin</span> <span class="m">1.5s</span> <span class="n">linear</span> <span class="n">infinite</span><span class="p">;</span>
        <span class="nl">margin</span><span class="p">:</span> <span class="m">15px</span> <span class="nb">auto</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">@keyframes</span> <span class="n">spin</span> <span class="p">{</span>
        <span class="err">0</span><span class="o">%</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">0deg</span><span class="p">);</span> <span class="p">}</span>
        <span class="err">100</span><span class="o">%</span> <span class="p">{</span> <span class="nl">transform</span><span class="p">:</span> <span class="n">rotate</span><span class="p">(</span><span class="m">360deg</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>      </div>
    </li>
  </ol>
</blockquote>

<p>Please make sure you have activated webhooks in your <code class="language-plaintext highlighter-rouge">config/<span class="notranslate">galaxy</span>.yml</code> file by setting the <code class="language-plaintext highlighter-rouge">webhooks_dir</code> to the path in which your <code class="language-plaintext highlighter-rouge">phdcomics</code> folder is located.</p>

<blockquote class="notranslate hands_on">
  <h3 id="hands_on-hands-on-4"><i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">hands_on</span> Hands-on</h3>

  <ol>
    <li>Submit one tool and see if your webhook is working on the tool-submit page.</li>
  </ol>

</blockquote>

<p>If successful it should look like this:</p>

<p><img src="../../images/phdcomics.png" alt="First view" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>First of all, thank you for completing this tutorial. We have learned how to add webhooks to your <span class="notranslate">Galaxy</span>.</p>


                    
                    <blockquote class="key_points">
                        <h3><i class="fas fa-key" aria-hidden="true"></i><span class="visually-hidden">keypoints</span> Key points</h3>
                        <ul>
                            
                            <li><p>A Galaxy Webhook provides an easy way to customize the Galaxy UI with plugins</p>
</li>
                            
                            <li><p>Right now there are 4 entry points: tool, workflow, masthead, history-menu</p>
</li>
                            
                            <li><p>With a minimal amount of code you can extend Galaxyâ€™s user-interace.</p>
</li>
                            
                        </ul>
                    </blockquote>
                    

                    

                    

                    <h1>Feedback</h1>
                    <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452" target="_blank">how it went</a>.</p>

                    <div id="feedback-button">
                        <img src="/training-material/shared/images/feedback.png" title="Click to activate" alt="Click here to load Google feedback frame" />
                    </div>
                    <div id="feedback-form">
                    </div>
                    <script type="text/javascript">
                        (function (window, document) {
                            function onDocumentReady(fn) {
                                if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
                                    fn();
                                } else {
                                    document.addEventListener('DOMContentLoaded', fn);
                                }
                            }

                            onDocumentReady(function () {
                                $("#feedback-button").click(function(evt){
                                    var e = $(evt.target)
                                    e.hide();

                                    $("#feedback-form").html(`
                                        <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=Galaxy Webhooks (Development in Galaxy)">Loading...</iframe>
                                    `)
                                })
                            });
                        })(window, document);
                    </script>



                    <h1>Citing this Tutorial</h1>
                    <p>
                        <ol>
                            <li id="citation-text">Clemens Blank, Martin ÄŒech, BjÃ¶rn GrÃ¼ning, 2021 <b>Galaxy Webhooks (Galaxy Training Materials)</b>. <a href="/training-material/topics/dev/tutorials/webhooks/tutorial.html">/training-material/topics/dev/tutorials/webhooks/tutorial.html</a> Online; accessed TODAY
                            </li>
                            <li>
                            Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                            </li>
                        </ol>
                    </p>


                    <blockquote class="details">
                      <h3><i class="fa fa-info-circle" aria-hidden="true"></i><span class="visually-hidden">details</span> BibTeX</h3>
                      <p style="display: none;">

                    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">
<code id="citation-code">@misc{dev-webhooks,
    author = "Clemens Blank and Martin ÄŒech and BjÃ¶rn GrÃ¼ning",
    title = "Galaxy Webhooks (Galaxy Training Materials)",
    year = "2021",
    month = "01",
    day = "06"
    url = "\url{/training-material/topics/dev/tutorials/webhooks/tutorial.html}",
    note = "[Online; accessed TODAY]"
}
@article{Batut_2018,
        doi = {10.1016/j.cels.2018.05.012},
        url = {https://doi.org/10.1016%2Fj.cels.2018.05.012},
        year = 2018,
        month = {jun},
        publisher = {Elsevier {BV}},
        volume = {6},
        number = {6},
        pages = {752--758.e1},
        author = {B{\'{e}}r{\'{e}}nice Batut and Saskia Hiltemann and Andrea Bagnacani and Dannon Baker and Vivek Bhardwaj and Clemens Blank and Anthony Bretaudeau and Loraine Brillet-Gu{\'{e}}guen and Martin {\v{C}}ech and John Chilton and Dave Clements and Olivia Doppelt-Azeroual and Anika Erxleben and Mallory Ann Freeberg and Simon Gladman and Youri Hoogstrate and Hans-Rudolf Hotz and Torsten Houwaart and Pratik Jagtap and Delphine Larivi{\`{e}}re and Gildas Le Corguill{\'{e}} and Thomas Manke and Fabien Mareuil and Fidel Ram{\'{\i}}rez and Devon Ryan and Florian Christoph Sigloch and Nicola Soranzo and Joachim Wolff and Pavankumar Videm and Markus Wolfien and Aisanjiang Wubuli and Dilmurat Yusuf and James Taylor and Rolf Backofen and Anton Nekrutenko and BjÃ¶rn GrÃ¼ning},
        title = {Community-Driven Data Analysis Training for Biology},
        journal = {Cell Systems}
}</code>
                    </pre></div></div>
                    </p>
                    </blockquote>


<script type="text/javascript">
// update the date on load, or leave fallback of 'today'
d = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", d.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", d.toDateString());
</script>

                </div>
            </div>
        </div>

        <h3><i class="far fa-thumbs-up" aria-hidden="true"></i><span class="visually-hidden">congratulations</span> Congratulations on successfully completing this tutorial!</h3>

        

        
    </section>
</div>


<footer>
    <div class="container">
        <p>
            This material is the result of a collaborative work. Thanks to the
            <a href="https://wiki.galaxyproject.org/Teach/GTN">Galaxy Training Network</a>
            and all the <a href="/training-material/hall-of-fame">contributors</a> (Clemens Blank, Martin ÄŒech, BjÃ¶rn GrÃ¼ning)!
        </p>
        <p>
            Found a typo? Something is wrong in this tutorial? Edit it on
            <a href="https://github.com/galaxyproject/training-material/tree/master/topics/dev/tutorials/webhooks/tutorial.md">GitHub</a>.
        </p>
        <p>
    The content of the tutorials and website is licensed under the <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</p>
    </div>
</footer>

    </body>
    <script type="text/javascript" src="/training-material/assets/js/jquery.slim.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/popper.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap.min.js?v=3"></script>
    <script type="text/javascript" src="/training-material/assets/js/details-element-polyfill.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="/training-material/assets/js/bootstrap-toc.min.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/main.js"></script>
    <script type="text/javascript" src="/training-material/assets/js/theme.js"></script>

    <script type="text/javascript" src="/training-material/assets/js/clipboard.min.js"></script>
    <script type="text/javascript">
    var snippets=document.querySelectorAll('div.highlight');
    [].forEach.call(snippets,function(snippet){
        snippet.firstChild.insertAdjacentHTML('beforebegin','<button class="btn btn-light" data-clipboard-snippet><i class="fa fa-copy"></i>&nbsp;Copy</button>');
    });

    var clipboardSnippets=new ClipboardJS('[data-clipboard-snippet]',{
        target:function(trigger){return trigger.nextElementSibling;
    }});
    </script>
    

    <script type="text/javascript">
        if(window.location.hostname === "galaxyproject.github.io") {
            // Redirect
            var redirect = "https://training.galaxyproject.org" + window.location.pathname + window.location.search;
            $('div.container.main-content').prepend("<div class='alert alert-warning'><strong>Note: </strong>This content has a new home at <a href=\"" + redirect + "\">" + redirect + "</a>, which you will be redirected to in 5 seconds.</div>");

            window.setTimeout(function(){
                window.location.href = redirect;
            }, 5000)

        }
    </script>
</html>
