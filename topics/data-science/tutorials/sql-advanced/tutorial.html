<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hands-on: Advanced SQL / Advanced SQL / Foundations of Data Science</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@ad6223c35f36ee0601c96f2adfbb4c5ee3a6e9d6",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.40d4e218.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Advanced SQL">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-09-26 09:20:01 +0000">
<meta name="DC.creator" content="The Carpentries">
<meta name="DC.creator" content="Helena Rasche">
<meta name="DC.creator" content="Avans Hogeschool"><meta name="description" content="These lessons will help you get your feet in data science and give you tools to help you slice and dice your data into results.">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Foundations of Data Science / Advanced SQL / Hands-on: Advanced SQL">
        <meta property="og:description" content="These lessons will help you get your feet in data science and give you tools to help you slice and dice your data into results.">
        <meta property="og:image" content="https://galaxy-training.s3.amazonaws.com/social/topics/data-science/tutorials/sql-advanced/tutorial.png">
	<script type="application/ld+json">


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": [
    {
      "@type": "CreativeWork",
      "name": "Galaxy Training: A Powerful Framework for Teaching!",
      "url": "https://doi.org/10.1371/journal.pcbi.1010752"
    },
    {
      "@type": "CreativeWork",
      "name": "Community-Driven Data Analysis Training for Biology",
      "url": "https://doi.org/10.1016/j.cels.2018.05.012"
    }
  ],
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Advanced SQL",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "provider": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "dateModified": "2024-09-26 09:20:01 +0000",
  "datePublished": "2021-10-11 14:22:29 +0000",
  "copyrightHolder": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "funder": [

  ],
  "funding": [

  ],
  "identifier": "https://gxy.io/GTN:T00106",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Foundations of Data Science",
    "description": "These lessons will help you get your feet in data science and give you tools to help you slice and dice your data into results.",
    "url": "https://training.galaxyproject.org/training-material/topics/data-science/"
  },
  "abstract": "",
  "learningResourceType": "e-learning",
  "name": "Advanced SQL",
  "url": "https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/tutorial.html",
  "version": 8,
  "timeRequired": "PT3H",
  "teaches": "- Define aggregation and give examples of its use.\n- Write queries that compute aggregated values.\n- Trace the execution of a query that performs aggregation.\n- Explain how missing data is handled during aggregation.\n- Explain the operation of a query that joins two tables.\n- Explain how to restrict the output of a query containing a join to only include meaningful combinations of values.\n- Write queries that join tables on equal keys.\n- Explain what primary and foreign keys are, and why they are useful.\n- Explain what an atomic value is.\n- Distinguish between atomic and non-atomic values.\n- Explain why every value in a database should be atomic.\n- Explain what a primary key is and why every record should have one.\n- Identify primary keys in database tables.\n- Explain why database entries should not contain redundant information.\n- Identify redundant information in databases.\n- Write statements that create tables.\n- Write statements to insert, modify, and delete records.\n- Write short programs that execute SQL queries.\n- Trace the execution of a program that contains an SQL query.\n- Explain why most database applications are written in a general-purpose language rather than in SQL.",
  "keywords": [
    "Foundations of Data Science",
    "SQL",
    "jupyter-notebook"
  ],
  "description": "## Abstract\n\n\n\n\n## About This Material\n\nThis is a Hands-on Tutorial from the GTN which is usable either for individual self-study, or as a teaching material in a classroom.\n\n\n## Questions this  will address\n\n - How can I calculate sums, averages, and other summary values?\n - How can I combine data from multiple tables?\n - How should I format data in a database, and why?\n - How can I create, modify, and delete tables and data?\n - How can I access databases from programs written in Python?\n\n\n## Learning Objectives\n\n- Define aggregation and give examples of its use.\n- Write queries that compute aggregated values.\n- Trace the execution of a query that performs aggregation.\n- Explain how missing data is handled during aggregation.\n- Explain the operation of a query that joins two tables.\n- Explain how to restrict the output of a query containing a join to only include meaningful combinations of values.\n- Write queries that join tables on equal keys.\n- Explain what primary and foreign keys are, and why they are useful.\n- Explain what an atomic value is.\n- Distinguish between atomic and non-atomic values.\n- Explain why every value in a database should be atomic.\n- Explain what a primary key is and why every record should have one.\n- Identify primary keys in database tables.\n- Explain why database entries should not contain redundant information.\n- Identify redundant information in databases.\n- Write statements that create tables.\n- Write statements to insert, modify, and delete records.\n- Write short programs that execute SQL queries.\n- Trace the execution of a program that contains an SQL query.\n- Explain why most database applications are written in a general-purpose language rather than in SQL.\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-basic/tutorial.html",
      "name": "Introduction to SQL",
      "description": "Hands-on for 'Introduction to SQL' tutorial",
      "learningResourceType": "e-learning",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    }
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/carpentries/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/carpentries/",
      "name": "The Carpentries",
      "image": "https://avatars.githubusercontent.com/carpentries",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/",
      "name": "Helena Rasche",
      "image": "https://avatars.githubusercontent.com/hexylena",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/erasmusmc/",
          "name": "Erasmus Medical Center",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusmc.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/gallantries/",
          "name": "Gallantries: Bridging Training Communities in Life Science, Environment and Health",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.erasmusplus.nl"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/by-covid/",
          "name": "BeYond-COVID",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://by-covid.org/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-converge/",
          "name": "ELIXIR-CONVERGE",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org/about-us/how-funded/eu-projects/converge"
        }
      ],
      "identifier": "https://orcid.org/0000-0001-9760-8992",
      "orcid": "https://orcid.org/0000-0001-9760-8992"
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/avans-atgm/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/avans-atgm/",
      "name": "Avans Hogeschool",
      "image": "https://avatars.githubusercontent.com/avans-atgm",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Foundations of Data Science",
      "description": "These lessons will help you get your feet in data science and give you tools to help you slice and dice your data into results.",
      "url": "https://training.galaxyproject.org/training-material/topics/data-science/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3372",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3372",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3372"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [
    {
      "@type": "Thing",
      "url": "https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/data-science-sql-advanced.ipynb",
      "name": "Jupyter Notebook (with Solutions)"
    },
    {
      "@type": "Thing",
      "url": "https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/data-science-sql-advanced-course.ipynb",
      "name": "Jupyter Notebook (without Solutions)"
    }
  ]
}</script></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/data-science" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Foundations of Data Science
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/data-science/faqs/" title="Check our FAQs for the Foundations of Data Science topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/data-science/tutorials/sql-advanced/tutorial.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/data-science/tutorials/sql-advanced/tutorial.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html">
                    <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-data-science">
    <h1 data-toc-skip>Advanced SQL</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		Authors: <a href="/training-material/hall-of-fame/carpentries/" class="contributor-badge contributor-carpentries"><img src="https://avatars.githubusercontent.com/carpentries?s=36" alt="The Carpentries avatar" width="36" class="avatar" />
    The Carpentries</a><a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge contributor-hexylena"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/hexylena?s=36" alt="Helena Rasche avatar" width="36" class="avatar" />
    Helena Rasche</a><a href="/training-material/hall-of-fame/avans-atgm/" class="contributor-badge contributor-avans-atgm"><img src="/training-material/shared/images/logo-avans.png" alt="Avans Hogeschool avatar" width="36" class="avatar" />
    Avans</a>
	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png" width="88" height="31"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>How can I calculate sums, averages, and other summary values?</p>
</li>
        
        <li><p>How can I combine data from multiple tables?</p>
</li>
        
        <li><p>How should I format data in a database, and why?</p>
</li>
        
        <li><p>How can I create, modify, and delete tables and data?</p>
</li>
        
        <li><p>How can I access databases from programs written in Python?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Define aggregation and give examples of its use.</p>
</li>
        
        <li><p>Write queries that compute aggregated values.</p>
</li>
        
        <li><p>Trace the execution of a query that performs aggregation.</p>
</li>
        
        <li><p>Explain how missing data is handled during aggregation.</p>
</li>
        
        <li><p>Explain the operation of a query that joins two tables.</p>
</li>
        
        <li><p>Explain how to restrict the output of a query containing a join to only include meaningful combinations of values.</p>
</li>
        
        <li><p>Write queries that join tables on equal keys.</p>
</li>
        
        <li><p>Explain what primary and foreign keys are, and why they are useful.</p>
</li>
        
        <li><p>Explain what an atomic value is.</p>
</li>
        
        <li><p>Distinguish between atomic and non-atomic values.</p>
</li>
        
        <li><p>Explain why every value in a database should be atomic.</p>
</li>
        
        <li><p>Explain what a primary key is and why every record should have one.</p>
</li>
        
        <li><p>Identify primary keys in database tables.</p>
</li>
        
        <li><p>Explain why database entries should not contain redundant information.</p>
</li>
        
        <li><p>Identify redundant information in databases.</p>
</li>
        
        <li><p>Write statements that create tables.</p>
</li>
        
        <li><p>Write statements to insert, modify, and delete records.</p>
</li>
        
        <li><p>Write short programs that execute SQL queries.</p>
</li>
        
        <li><p>Trace the execution of a program that contains an SQL query.</p>
</li>
        
        <li><p>Explain why most database applications are written in a general-purpose language rather than in SQL.</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        

        
    
        
        
        
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                        
                            
                                <li>
                                  <a href="/training-material/topics/data-science/tutorials/sql-basic/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> Hands-on: Introduction to SQL</a>
                                </li>
                            
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
    


        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 3 hours</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Level: </strong>
        


 Introductory <span class="visually-hidden">Introductory</span>
<span class="level introductory" title="Introductory Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            

            

            

            

            

            
                <li class="btn btn-default supporting_material">


    <a class="topic-icon" href="/training-material/topics/data-science/tutorials/sql-advanced/data-science-sql-advanced.ipynb" title="Jupyter Notebook" alt="Advanced SQL Notebook">
        <i class="far fa-file-code" aria-hidden="true"></i> Jupyter Notebook
    </a>
    

</li>
            

            
            
            
                <li class="btn btn-default supporting_material">    <a class="topic-icon" href="/training-material/topics/data-science/tutorials/sql-advanced/faqs/" title="Frequently Asked Questions">
        <i class="far fa-question-circle" aria-hidden="true"></i> FAQs
    </a>
</li>
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            












            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
    
	<li class="dropdown-header">
		<b>Possibly Working</b>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.eu" title="">
			UseGalaxy.eu
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.org" title="">
			UseGalaxy.org
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.org.au" title="">
			UseGalaxy.org.au
		</a>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.fr" title="">
			UseGalaxy.fr
		</a>
	</li>
    
    

    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Published:</strong> Oct 11, 2021 </div>
        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Sep 26, 2024 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            Tutorial Content is licensed under
            
              <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
            The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span> <abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00106">https://gxy.io/GTN:T00106</a> </div>
        

	
	

	
	
	<div><strong><i class="fas fa-code-commit" aria-hidden="true"></i><span class="visually-hidden">version</span> Revision:</strong> 8 </div>

    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 
                <section aria-label="Tutorial Notebook access information" id="tutorial-notebook">
                     
                     
                     
                     
                    
                        <blockquote class="comment">
                            <div class="box-title">Best viewed in a Jupyter Notebook</div>
                            <p>
                                This tutorial is best viewed in a Jupyter notebook! You can load this notebook one of the following ways<!--, or you can click to run it in MyBinder-->
                            </p>
                            <!--
                            <p><b>Launching on MyBinder</b>
                                Click here and the notebook will launch on MyBinder.org
                                <a href="https://mybinder.org/v2/gh/galaxyproject/training-material/main?filepath=training-material%2Ftopics%2Fdata-science%2Ftutorials%2Fsql-advanced%2Ftutorial.md.ipynb" title="Launch notebook on MyBinder"><img src="https://mybinder.org/badge_logo.svg" alt="My Binder Logo"/></a>
                            </p>
                            -->
                            
                            <p><b>Launching the notebook in Jupyter in Galaxy</b>
                                <ol>
                                    <li><a href="/training-material/faqs/galaxy/interactive_tools_jupyter_launch.html">Instructions to Launch JupyterLab</a></li>
                                    <li>Open a Terminal in JupyterLab with <b>File -> New -> Terminal</b></li>
                                    <li>Run <code>wget https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/data-science-sql-advanced.ipynb</code></li>
                                    <li>Select the notebook that appears in the list of files on the left.</li>
                                </ol>
                            </p>
                            <p><b>Downloading the notebook</b>
                                <ol>
                                    <li>Right click one of these links: <a href="https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/data-science-sql-advanced.ipynb">Jupyter Notebook (With Solutions)</a>, <a href="https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/data-science-sql-advanced-course.ipynb">Jupyter Notebook (Without Solutions)</a></li>
                                    <li>Save Link As..</li>
                                </ol>
                            </p>
                        </blockquote>
                    
                </section>
                

                <section aria-label="Tutorial Content" id="tutorial-content">
                
<div>
  <blockquote class="question">
    <div class="box-title" aria-label="quiz box: SQL Advanced Recap"><i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden"></span> Quiz: SQL Advanced Recap</div>
    <p>Check your knowledge with a quiz!</p>

    <ul>
      <li><a href="/training-material/quiz/quiz.html?mode=self&amp;quiz=/training-material/topics/data-science/tutorials/sql-advanced/quiz/recap.yml">Self Study Mode</a> - do the quiz at your own pace, to check your understanding.</li>
      <li><a href="/training-material/quiz/quiz.html?mode=teacher&amp;quiz=/training-material/topics/data-science/tutorials/sql-advanced/quiz/recap.yml">Classroom Mode</a> - do the quiz synchronously with a classroom of students.</li>
    </ul>
  </blockquote>
</div>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-1"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>

  <p>This tutorial is <strong>significantly</strong> based on <a href="https://carpentries.org">the Carpentries</a> <a href="https://github.com/swcarpentry/sql-novice-survey/">Databases and SQL</a> lesson, which is licensed CC-BY 4.0.</p>

  <p>Abigail Cabunoc and Sheldon McKay (eds): “Software Carpentry: Using Databases and SQL.”  Version 2017.08, August 2017,
<a href="https://github.com/swcarpentry/sql-novice-survey">github.com/swcarpentry/sql-novice-survey</a>, <a href="https://doi.org/10.5281/zenodo.838776">https://doi.org/10.5281/zenodo.838776</a></p>

  <p>Adaptations have been made to make this work better in a GTN/Galaxy environment.</p>
</blockquote>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda-1">Agenda</div>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#aggregation" id="markdown-toc-aggregation">Aggregation</a></li>
  <li><a href="#combining-data" id="markdown-toc-combining-data">Combining Data</a></li>
  <li><a href="#data-hygiene" id="markdown-toc-data-hygiene">Data Hygiene</a></li>
  <li><a href="#creating-and-modifying-data" id="markdown-toc-creating-and-modifying-data">Creating and Modifying Data</a></li>
</ol>

</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="n">This</span> <span class="n">preamble</span> <span class="k">sets</span> <span class="n">up</span> <span class="n">the</span> <span class="k">sql</span> <span class="nv">"magic"</span> <span class="k">for</span> <span class="n">jupyter</span><span class="p">.</span> <span class="n">Use</span> <span class="o">%%</span><span class="k">sql</span> <span class="k">in</span> <span class="n">your</span> <span class="n">cells</span> <span class="k">to</span> <span class="k">write</span> <span class="k">sql</span><span class="o">!</span>
<span class="o">!</span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">ipython</span><span class="o">-</span><span class="k">sql</span> <span class="n">sqlalchemy</span>
<span class="o">!</span><span class="n">wget</span> <span class="o">-</span><span class="k">c</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">swcarpentry</span><span class="p">.</span><span class="n">github</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="k">sql</span><span class="o">-</span><span class="n">novice</span><span class="o">-</span><span class="n">survey</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">survey</span><span class="p">.</span><span class="n">db</span>
<span class="n">import</span> <span class="n">sqlalchemy</span>
<span class="n">engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="p">.</span><span class="n">create_engine</span><span class="p">(</span><span class="nv">"sqlite:///survey.db"</span><span class="p">)</span>
<span class="o">%</span><span class="n">load_ext</span> <span class="k">sql</span>
<span class="o">%</span><span class="k">sql</span> <span class="n">sqlite</span><span class="p">:</span><span class="o">///</span><span class="n">survey</span><span class="p">.</span><span class="n">db</span>
<span class="o">%</span><span class="n">config</span> <span class="n">SqlMagic</span><span class="p">.</span><span class="n">displaycon</span><span class="o">=</span><span class="k">False</span>
</code></pre></div></div>

<h1 id="aggregation">Aggregation</h1>

<p>We now want to calculate ranges and averages for our data.
We know how to select all of the dates from the <code class="language-plaintext highlighter-rouge">Visited</code> table:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">dated</span> <span class="k">FROM</span> <span class="n">Visited</span><span class="p">;</span>
</code></pre></div></div>

<p>but to combine them,
we must use an aggregation function
such as <code class="language-plaintext highlighter-rouge">min</code> or <code class="language-plaintext highlighter-rouge">max</code>.
Each of these functions takes a set of records as input,
and produces a single record as output:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">dated</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Visited</span><span class="p">;</span>
</code></pre></div></div>

<p><a href="../../images/carpentries-sql/sql-aggregation.svg" rel="noopener noreferrer"><img src="../../images/carpentries-sql/sql-aggregation.svg" alt="SQL Aggregation. " width="128" height="85" loading="lazy" /></a></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="n">dated</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Visited</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">min</code> and <code class="language-plaintext highlighter-rouge">max</code> are just two of
the aggregation functions built into SQL.
Three others are <code class="language-plaintext highlighter-rouge">avg</code>,
<code class="language-plaintext highlighter-rouge">count</code>,
and <code class="language-plaintext highlighter-rouge">sum</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">reading</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Survey</span> <span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'sal'</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="n">reading</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Survey</span> <span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'sal'</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">reading</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Survey</span> <span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'sal'</span><span class="p">;</span>
</code></pre></div></div>

<p>We used <code class="language-plaintext highlighter-rouge">count(reading)</code> here,
but we could just as easily have counted <code class="language-plaintext highlighter-rouge">quant</code>
or any other field in the table,
or even used <code class="language-plaintext highlighter-rouge">count(*)</code>,
since the function doesn’t care about the values themselves,
just how many values there are.</p>

<p>SQL lets us do several aggregations at once.
We can,
for example,
find the range of sensible salinity measurements:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="k">max</span><span class="p">(</span><span class="n">reading</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Survey</span> <span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'sal'</span> <span class="k">AND</span> <span class="n">reading</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
</code></pre></div></div>

<p>We can also combine aggregated results with raw results,
although the output might surprise you:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">person</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Survey</span> <span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'sal'</span> <span class="k">AND</span> <span class="n">reading</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
</code></pre></div></div>

<p>Why does Lake’s name appear rather than Roerich’s or Dyer’s?
The answer is that when it has to aggregate a field,
but isn’t told how to,
the database manager chooses an actual value from the input set.
It might use the first one processed,
the last one,
or something else entirely.</p>

<p>Another important fact is that when there are no values to aggregate —
for example, where there are no rows satisfying the <code class="language-plaintext highlighter-rouge">WHERE</code> clause —
aggregation’s result is “don’t know”
rather than zero or some other arbitrary value:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">person</span><span class="p">,</span> <span class="k">max</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="k">sum</span><span class="p">(</span><span class="n">reading</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Survey</span> <span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'missing'</span><span class="p">;</span>
</code></pre></div></div>

<p>One final important feature of aggregation functions is that
they are inconsistent with the rest of SQL in a very useful way.
If we add two values,
and one of them is null,
the result is null.
By extension,
if we use <code class="language-plaintext highlighter-rouge">sum</code> to add all the values in a set,
and any of those values are null,
the result should also be null.
It’s much more useful,
though,
for aggregation functions to ignore null values
and only combine those that are non-null.
This behavior lets us write our queries as:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">dated</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Visited</span><span class="p">;</span>
</code></pre></div></div>

<p>instead of always having to filter explicitly:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">min</span><span class="p">(</span><span class="n">dated</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">Visited</span> <span class="k">WHERE</span> <span class="n">dated</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<p>Aggregating all records at once doesn’t always make sense.
For example,
suppose we suspect that there is a systematic bias in our data,
and that some scientists’ radiation readings are higher than others.
We know that this doesn’t work:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">person</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">FROM</span>  <span class="n">Survey</span>
<span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'rad'</span><span class="p">;</span>
</code></pre></div></div>

<p>because the database manager selects a single arbitrary scientist’s name
rather than aggregating separately for each scientist.
Since there are only five scientists,
we could write five queries of the form:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">person</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">FROM</span>  <span class="n">Survey</span>
<span class="k">WHERE</span> <span class="n">quant</span> <span class="o">=</span> <span class="s1">'rad'</span>
<span class="k">AND</span>   <span class="n">person</span> <span class="o">=</span> <span class="s1">'dyer'</span><span class="p">;</span>
</code></pre></div></div>

<p>but this would be tedious,
and if we ever had a data set with fifty or five hundred scientists,
the chances of us getting all of those queries right is small.</p>

<p>What we need to do is
tell the database manager to aggregate the hours for each scientist separately
using a <code class="language-plaintext highlighter-rouge">GROUP BY</code> clause:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>   <span class="n">person</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">FROM</span>     <span class="n">Survey</span>
<span class="k">WHERE</span>    <span class="n">quant</span> <span class="o">=</span> <span class="s1">'rad'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">person</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">GROUP BY</code> does exactly what its name implies:
groups all the records with the same value for the specified field together
so that aggregation can process each batch separately.
Since all the records in each batch have the same value for <code class="language-plaintext highlighter-rouge">person</code>,
it no longer matters that the database manager
is picking an arbitrary one to display
alongside the aggregated <code class="language-plaintext highlighter-rouge">reading</code> values.</p>

<blockquote class="tip">
  <div class="box-title tip-title" id="tip-know-excel-it-s-just-a-pivot-table-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-know-excel-it-s-just-a-pivot-table-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Know Excel? It's just a pivot table.</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p><code class="language-plaintext highlighter-rouge">GROUP BY</code> is basically just a pivot table for Excel users, it lets you build
nice summary tables which aggregate your results.</p>

  <p>And if you didn’t already know the Excel equivalent, now you know what to
look for when you need it!</p>
</blockquote>

<p>Just as we can sort by multiple criteria at once,
we can also group by multiple criteria.
To get the average reading by scientist and quantity measured,
for example,
we just add another field to the <code class="language-plaintext highlighter-rouge">GROUP BY</code> clause:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>   <span class="n">person</span><span class="p">,</span> <span class="n">quant</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">FROM</span>     <span class="n">Survey</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">person</span><span class="p">,</span> <span class="n">quant</span><span class="p">;</span>
</code></pre></div></div>

<p>Note that we have added <code class="language-plaintext highlighter-rouge">quant</code> to the list of fields displayed,
since the results wouldn’t make much sense otherwise.</p>

<p>Let’s go one step further and remove all the entries
where we don’t know who took the measurement:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span>   <span class="n">person</span><span class="p">,</span> <span class="n">quant</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="n">round</span><span class="p">(</span><span class="k">avg</span><span class="p">(</span><span class="n">reading</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">FROM</span>     <span class="n">Survey</span>
<span class="k">WHERE</span>    <span class="n">person</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">person</span><span class="p">,</span> <span class="n">quant</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">person</span><span class="p">,</span> <span class="n">quant</span><span class="p">;</span>
</code></pre></div></div>

<p>Looking more closely,
this query:</p>

<ol>
  <li>selected records from the <code class="language-plaintext highlighter-rouge">Survey</code> table where the <code class="language-plaintext highlighter-rouge">person</code> field was not null;</li>
  <li>grouped those records into subsets so that the <code class="language-plaintext highlighter-rouge">person</code> and <code class="language-plaintext highlighter-rouge">quant</code> values in each subset were the same;</li>
  <li>ordered those subsets first by <code class="language-plaintext highlighter-rouge">person</code>, and then within each sub-group by <code class="language-plaintext highlighter-rouge">quant</code>; and</li>
  <li>counted the number of records in each subset, calculated the average <code class="language-plaintext highlighter-rouge">reading</code> in each, and chose a <code class="language-plaintext highlighter-rouge">person</code> and <code class="language-plaintext highlighter-rouge">quant</code> value from each (it doesn’t matter which ones, since they’re all equal).</li>
</ol>

<blockquote class="question">
  <div class="box-title question-title" id="question-counting-temperature-readings-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Counting Temperature Readings</div>

  <p>How many temperature readings did Frank Pabodie record,
and what was their average value?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-10"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-10" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT count(reading), avg(reading) FROM Survey WHERE quant = 'temp' AND person = 'pb';
</code></pre></div>    </div>

    <table>
      <thead>
        <tr>
          <th>count(reading)</th>
          <th>avg(reading)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2</td>
          <td>-20.0</td>
        </tr>
      </tbody>
    </table>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-averaging-with-null-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Averaging with NULL</div>

  <p>The average of a set of values is the sum of the values
divided by the number of values.
Does this mean that the <code class="language-plaintext highlighter-rouge">avg</code> function returns 2.0 or 3.0
when given the values 1.0, <code class="language-plaintext highlighter-rouge">null</code>, and 5.0?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-11"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-11" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>The answer is 3.0.
<code class="language-plaintext highlighter-rouge">NULL</code> is not a value; it is the absence of a value.
As such it is not included in the calculation.</p>

    <p>You can confirm this, by executing this code:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT AVG(a) FROM (
    SELECT 1 AS a
    UNION ALL SELECT NULL
    UNION ALL SELECT 5);
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-what-does-this-query-do-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: What Does This Query Do?</div>

  <p>We want to calculate the difference between
each individual radiation reading
and the average of all the radiation readings.
We write the query:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT reading - avg(reading) FROM Survey WHERE quant = 'rad';
</code></pre></div>  </div>

  <p>What does this actually produce, and can you think of why?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-12"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-12" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>The query produces only one row of results when we what we really want is a result for each of the readings.
The <code class="language-plaintext highlighter-rouge">avg()</code> function produces only a single value, and because it is run first, the table is reduced to a single row.
The <code class="language-plaintext highlighter-rouge">reading</code> value is simply an arbitrary one.</p>

    <p>To achieve what we wanted, we would have to run two queries:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT avg(reading) FROM Survey WHERE quant='rad';
</code></pre></div>    </div>

    <p>This produces the average value (6.5625), which we can then insert into a second query:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT reading - 6.5625 FROM Survey WHERE quant = 'rad';
</code></pre></div>    </div>

    <p>This produces what we want, but we can combine this into a single query using subqueries.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT reading - (SELECT avg(reading) FROM Survey WHERE quant='rad') FROM Survey WHERE quant = 'rad';
</code></pre></div>    </div>

    <p>This way we don’t have execute two queries.</p>

    <p>In summary what we have done is to replace <code class="language-plaintext highlighter-rouge">avg(reading)</code> with <code class="language-plaintext highlighter-rouge">(SELECT avg(reading) FROM Survey WHERE quant='rad')</code> in the original query.</p>

  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-ordering-when-concatenating-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Ordering When Concatenating</div>

  <p>The function <code class="language-plaintext highlighter-rouge">group_concat(field, separator)</code>
concatenates all the values in a field
using the specified separator character
(or ‘,’ if the separator isn’t specified).
Use this to produce a one-line list of scientists’ names,
such as:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>William Dyer, Frank Pabodie, Anderson Lake, Valentina Roerich, Frank Danforth
</code></pre></div>  </div>

  <p>Can you find a way to order the list by surname?</p>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<h1 id="combining-data">Combining Data</h1>

<p>In order to submit our data to a web site
that aggregates historical meteorological data,
we might need to format it as
latitude, longitude, date, quantity, and reading.
However,
our latitudes and longitudes are in the <code class="language-plaintext highlighter-rouge">Site</code> table,
while the dates of measurements are in the <code class="language-plaintext highlighter-rouge">Visited</code> table
and the readings themselves are in the <code class="language-plaintext highlighter-rouge">Survey</code> table.
We need to combine these tables somehow.</p>

<p>This figure shows the relations between the tables:</p>

<p><a href="../../images/carpentries-sql/sql-join-structure.svg" rel="noopener noreferrer"><img src="../../images/carpentries-sql/sql-join-structure.svg" alt="Survey Database Structure. " loading="lazy" /></a></p>

<p>The SQL command to do this is <code class="language-plaintext highlighter-rouge">JOIN</code>.
To see how it works,
let’s start by joining the <code class="language-plaintext highlighter-rouge">Site</code> and <code class="language-plaintext highlighter-rouge">Visited</code> tables:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Site</span> <span class="k">JOIN</span> <span class="n">Visited</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">JOIN</code> creates
the cross product
of two tables,
i.e.,
it joins each record of one table with each record of the other table
to give all possible combinations.
Since there are three records in <code class="language-plaintext highlighter-rouge">Site</code>
and eight in <code class="language-plaintext highlighter-rouge">Visited</code>,
the join’s output has 24 records (3 * 8 = 24) .
And since each table has three fields,
the output has six fields (3 + 3 = 6).</p>

<p>What the join <em>hasn’t</em> done is
figure out if the records being joined have anything to do with each other.
It has no way of knowing whether they do or not until we tell it how.
To do that,
we add a clause specifying that
we’re only interested in combinations that have the same site name,
thus we need to use a filter:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Site</span> <span class="k">JOIN</span> <span class="n">Visited</span> <span class="k">ON</span> <span class="n">Site</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">Visited</span><span class="p">.</span><span class="n">site</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">ON</code> is very similar to <code class="language-plaintext highlighter-rouge">WHERE</code>,
and for all the queries in this lesson you can use them interchangeably.
There are differences in how they affect <a href="https://en.wikipedia.org/wiki/Join_%28SQL%29#Outer_join">outer joins</a>,
but that’s beyond the scope of this lesson.
Once we add this to our query,
the database manager throws away records
that combined information about two different sites,
leaving us with just the ones we want.</p>

<p>Notice that we used <code class="language-plaintext highlighter-rouge">Table.field</code> to specify field names
in the output of the join.
We do this because tables can have fields with the same name,
and we need to be specific which ones we’re talking about.
For example,
if we joined the <code class="language-plaintext highlighter-rouge">Person</code> and <code class="language-plaintext highlighter-rouge">Visited</code> tables,
the result would inherit a field called <code class="language-plaintext highlighter-rouge">id</code>
from each of the original tables.</p>

<p>We can now use the same dotted notation
to select the three columns we actually want
out of our join:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">Site</span><span class="p">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">Site</span><span class="p">.</span><span class="n">long</span><span class="p">,</span> <span class="n">Visited</span><span class="p">.</span><span class="n">dated</span>
<span class="k">FROM</span>   <span class="n">Site</span> <span class="k">JOIN</span> <span class="n">Visited</span>
<span class="k">ON</span>     <span class="n">Site</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">Visited</span><span class="p">.</span><span class="n">site</span><span class="p">;</span>
</code></pre></div></div>

<p>If joining two tables is good,
joining many tables must be better.
In fact,
we can join any number of tables
simply by adding more <code class="language-plaintext highlighter-rouge">JOIN</code> clauses to our query,
and more <code class="language-plaintext highlighter-rouge">ON</code> tests to filter out combinations of records
that don’t make sense:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">Site</span><span class="p">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">Site</span><span class="p">.</span><span class="n">long</span><span class="p">,</span> <span class="n">Visited</span><span class="p">.</span><span class="n">dated</span><span class="p">,</span> <span class="n">Survey</span><span class="p">.</span><span class="n">quant</span><span class="p">,</span> <span class="n">Survey</span><span class="p">.</span><span class="n">reading</span>
<span class="k">FROM</span>   <span class="n">Site</span> <span class="k">JOIN</span> <span class="n">Visited</span> <span class="k">JOIN</span> <span class="n">Survey</span>
<span class="k">ON</span>     <span class="n">Site</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">Visited</span><span class="p">.</span><span class="n">site</span>
<span class="k">AND</span>    <span class="n">Visited</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">Survey</span><span class="p">.</span><span class="n">taken</span>
<span class="k">AND</span>    <span class="n">Visited</span><span class="p">.</span><span class="n">dated</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<p>We can tell which records from <code class="language-plaintext highlighter-rouge">Site</code>, <code class="language-plaintext highlighter-rouge">Visited</code>, and <code class="language-plaintext highlighter-rouge">Survey</code>
correspond with each other
because those tables contain
primary keys
and foreign keys.
A primary key is a value,
or combination of values,
that uniquely identifies each record in a table.
A foreign key is a value (or combination of values) from one table
that identifies a unique record in another table.
Another way of saying this is that
a foreign key is the primary key of one table
that appears in some other table.
In our database,
<code class="language-plaintext highlighter-rouge">Person.id</code> is the primary key in the <code class="language-plaintext highlighter-rouge">Person</code> table,
while <code class="language-plaintext highlighter-rouge">Survey.person</code> is a foreign key
relating the <code class="language-plaintext highlighter-rouge">Survey</code> table’s entries
to entries in <code class="language-plaintext highlighter-rouge">Person</code>.</p>

<p>Most database designers believe that
every table should have a well-defined primary key.
They also believe that this key should be separate from the data itself,
so that if we ever need to change the data,
we only need to make one change in one place.
One easy way to do this is
to create an arbitrary, unique ID for each record
as we add it to the database.
This is actually very common:
those IDs have names like “student numbers” and “patient numbers”,
and they almost always turn out to have originally been
a unique record identifier in some database system or other.
As the query below demonstrates,
SQLite <a href="https://www.sqlite.org/lang_createtable.html#rowid">automatically numbers records</a> as they’re added to tables,
and we can use those record numbers in queries:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">rowid</span><span class="p">,</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Person</span><span class="p">;</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-listing-radiation-readings-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Listing Radiation Readings</div>

  <p>Write a query that lists all radiation readings from the DR-1 site.</p>
  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-13"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-13" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT Survey.reading
FROM Site JOIN Visited JOIN Survey
ON Site.name = Visited.site
AND Visited.id = Survey.taken
WHERE Site.name = 'DR-1'
AND Survey.quant = 'rad';
</code></pre></div>    </div>

    <table>
      <thead>
        <tr>
          <th>reading</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>9.82</td>
        </tr>
        <tr>
          <td>7.8</td>
        </tr>
        <tr>
          <td>11.25</td>
        </tr>
      </tbody>
    </table>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-where-s-frank-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Where's Frank?</div>

  <p>Write a query that lists all sites visited by people named “Frank”.</p>
  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-14"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-14" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT DISTINCT Site.name
FROM Site JOIN Visited JOIN Survey JOIN Person
ON Site.name = Visited.site
AND Visited.id = Survey.taken
AND Survey.person = Person.id
WHERE Person.personal = 'Frank';
</code></pre></div>    </div>

    <table>
      <thead>
        <tr>
          <th>name</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>DR-3</td>
        </tr>
      </tbody>
    </table>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-reading-queries-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Reading Queries</div>

  <p>Describe in your own words what the following query produces:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT Site.name FROM Site JOIN Visited
ON Site.lat &lt; -49.0 AND Site.name = Visited.site AND Visited.dated &gt;= '1932-01-01';
</code></pre></div>  </div>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-who-has-been-where-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Who Has Been Where?</div>

  <p>Write a query that shows each site with exact location (lat, long) ordered by visited date,
followed by personal name and family name of the person who visited the site
and the type of measurement taken and its reading. Please avoid all null values.
Tip: you should get 15 records with 8 fields.</p>
  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-15"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-15" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT Site.name, Site.lat, Site.long, Person.personal, Person.family, Survey.quant, Survey.reading, Visited.dated
FROM Site JOIN Visited JOIN Survey JOIN Person
ON Site.name = Visited.site
AND Visited.id = Survey.taken
AND Survey.person = Person.id
WHERE Survey.person IS NOT NULL
AND Visited.dated IS NOT NULL
ORDER BY Visited.dated;
</code></pre></div>    </div>

    <table>
      <thead>
        <tr>
          <th>name</th>
          <th>lat</th>
          <th>long</th>
          <th>personal</th>
          <th>family</th>
          <th>quant</th>
          <th>reading</th>
          <th>dated</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>DR-1</td>
          <td>-49.85</td>
          <td>-128.57</td>
          <td>William</td>
          <td>Dyer</td>
          <td>rad</td>
          <td>9.82</td>
          <td>1927-02-08</td>
        </tr>
        <tr>
          <td>DR-1</td>
          <td>-49.85</td>
          <td>-128.57</td>
          <td>William</td>
          <td>Dyer</td>
          <td>sal</td>
          <td>0.13</td>
          <td>1927-02-08</td>
        </tr>
        <tr>
          <td>DR-1</td>
          <td>-49.85</td>
          <td>-128.57</td>
          <td>William</td>
          <td>Dyer</td>
          <td>rad</td>
          <td>7.8</td>
          <td>1927-02-10</td>
        </tr>
        <tr>
          <td>DR-1</td>
          <td>-49.85</td>
          <td>-128.57</td>
          <td>William</td>
          <td>Dyer</td>
          <td>sal</td>
          <td>0.09</td>
          <td>1927-02-10</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Anderson</td>
          <td>Lake</td>
          <td>sal</td>
          <td>0.05</td>
          <td>1930-01-07</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Frank</td>
          <td>Pabodie</td>
          <td>rad</td>
          <td>8.41</td>
          <td>1930-01-07</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Frank</td>
          <td>Pabodie</td>
          <td>temp</td>
          <td>-21.5</td>
          <td>1930-01-07</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Frank</td>
          <td>Pabodie</td>
          <td>rad</td>
          <td>7.22</td>
          <td>1930-01-12</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Anderson</td>
          <td>Lake</td>
          <td>sal</td>
          <td>0.1</td>
          <td>1930-02-26</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Frank</td>
          <td>Pabodie</td>
          <td>rad</td>
          <td>4.35</td>
          <td>1930-02-26</td>
        </tr>
        <tr>
          <td>DR-3</td>
          <td>-47.15</td>
          <td>-126.72</td>
          <td>Frank</td>
          <td>Pabodie</td>
          <td>temp</td>
          <td>-18.5</td>
          <td>1930-02-26</td>
        </tr>
        <tr>
          <td>MSK-4</td>
          <td>-48.87</td>
          <td>-123.4</td>
          <td>Anderson</td>
          <td>Lake</td>
          <td>rad</td>
          <td>1.46</td>
          <td>1932-01-14</td>
        </tr>
        <tr>
          <td>MSK-4</td>
          <td>-48.87</td>
          <td>-123.4</td>
          <td>Anderson</td>
          <td>Lake</td>
          <td>sal</td>
          <td>0.21</td>
          <td>1932-01-14</td>
        </tr>
        <tr>
          <td>MSK-4</td>
          <td>-48.87</td>
          <td>-123.4</td>
          <td>Valentina</td>
          <td>Roerich</td>
          <td>sal</td>
          <td>22.5</td>
          <td>1932-01-14</td>
        </tr>
        <tr>
          <td>DR-1</td>
          <td>-49.85</td>
          <td>-128.57</td>
          <td>Valentina</td>
          <td>Roerich</td>
          <td>rad</td>
          <td>11.25</td>
          <td>1932-03-22</td>
        </tr>
      </tbody>
    </table>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<p>A good visual explanation of joins can be found <a href="https://sql-joins.leopard.in.ua/">in the SQL Join Visualizer</a></p>

<h1 id="data-hygiene">Data Hygiene</h1>

<p>Now that we have seen how joins work, we can see why the relational
model is so useful and how best to use it.  The first rule is that
every value should be atomic, i.e., not
contain parts that we might want to work with separately.  We store
personal and family names in separate columns instead of putting the
entire name in one column so that we don’t have to use substring
operations to get the name’s components.  More importantly, we store
the two parts of the name separately because splitting on spaces is
unreliable: just think of a name like “Eloise St. Cyr” or “Jan Mikkel
Steubart”.</p>

<p>The second rule is that every record should have a unique primary key.
This can be a serial number that has no intrinsic meaning,
one of the values in the record (like the <code class="language-plaintext highlighter-rouge">id</code> field in the <code class="language-plaintext highlighter-rouge">Person</code> table),
or even a combination of values:
the triple <code class="language-plaintext highlighter-rouge">(taken, person, quant)</code> from the <code class="language-plaintext highlighter-rouge">Survey</code> table uniquely identifies every measurement.</p>

<p>The third rule is that there should be no redundant information.
For example,
we could get rid of the <code class="language-plaintext highlighter-rouge">Site</code> table and rewrite the <code class="language-plaintext highlighter-rouge">Visited</code> table like this:</p>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>lat</th>
      <th>long</th>
      <th>dated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>619</td>
      <td>-49.85</td>
      <td>-128.57</td>
      <td>1927-02-08</td>
    </tr>
    <tr>
      <td>622</td>
      <td>-49.85</td>
      <td>-128.57</td>
      <td>1927-02-10</td>
    </tr>
    <tr>
      <td>734</td>
      <td>-47.15</td>
      <td>-126.72</td>
      <td>1930-01-07</td>
    </tr>
    <tr>
      <td>735</td>
      <td>-47.15</td>
      <td>-126.72</td>
      <td>1930-01-12</td>
    </tr>
    <tr>
      <td>751</td>
      <td>-47.15</td>
      <td>-126.72</td>
      <td>1930-02-26</td>
    </tr>
    <tr>
      <td>752</td>
      <td>-47.15</td>
      <td>-126.72</td>
      <td>None</td>
    </tr>
    <tr>
      <td>837</td>
      <td>-48.87</td>
      <td>-123.40</td>
      <td>1932-01-14</td>
    </tr>
    <tr>
      <td>844</td>
      <td>-49.85</td>
      <td>-128.57</td>
      <td>1932-03-22</td>
    </tr>
  </tbody>
</table>

<p>In fact,
we could use a single table that recorded all the information about each reading in each row,
just as a spreadsheet would.
The problem is that it’s very hard to keep data organized this way consistent:
if we realize that the date of a particular visit to a particular site is wrong,
we have to change multiple records in the database.
What’s worse,
we may have to guess which records to change,
since other sites may also have been visited on that date.</p>

<p>The fourth rule is that the units for every value should be stored explicitly.
Our database doesn’t do this,
and that’s a problem:
Roerich’s salinity measurements are several orders of magnitude larger than anyone else’s,
but we don’t know if that means she was using parts per million instead of parts per thousand,
or whether there actually was a saline anomaly at that site in 1932.</p>

<p>Stepping back,
data and the tools used to store it have a symbiotic relationship:
we use tables and joins because it’s efficient,
provided our data is organized a certain way,
but organize our data that way because we have tools to manipulate it efficiently.
As anthropologists say,
the tool shapes the hand that shapes the tool.</p>

<blockquote class="question">
  <div class="box-title question-title" id="question-identifying-atomic-values-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Identifying Atomic Values</div>

  <p>Which of the following are atomic values? Which are not? Why?</p>

  <ul>
    <li>New Zealand</li>
    <li>87 Turing Avenue</li>
    <li>January 25, 1971</li>
    <li>the XY coordinate (0.5, 3.3)</li>
  </ul>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-16"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-16" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>New Zealand is the only clear-cut atomic value.</p>

    <p>The address and the XY coordinate contain more than one piece of information
which should be stored separately:</p>
    <ul>
      <li>House number, street name</li>
      <li>X coordinate, Y coordinate</li>
    </ul>

    <p>The date entry is less clear cut, because it contains month, day, and year elements.
However, there is a <code class="language-plaintext highlighter-rouge">DATE</code> datatype in SQL, and dates should be stored using this format.
If we need to work with the month, day, or year separately, we can use the SQL functions available for our database software
(for example <a href="https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions050.htm"><code class="language-plaintext highlighter-rouge">EXTRACT</code></a> or <a href="http://www.sqlite.org/lang_datefunc.html"><code class="language-plaintext highlighter-rouge">STRFTIME</code></a> for SQLite).</p>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-identifying-a-primary-key-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Identifying a Primary Key</div>

  <p>What is the primary key in this table?
I.e., what value or combination of values uniquely identifies a record?</p>

  <table>
    <thead>
      <tr>
        <th>latitude</th>
        <th>longitude</th>
        <th>date</th>
        <th>temperature</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>57.3</td>
        <td>-22.5</td>
        <td>2015-01-09</td>
        <td>-14.2</td>
      </tr>
    </tbody>
  </table>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-17"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-17" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
    <p>Latitude, longitude, and date are all required to uniquely identify the temperature record.</p>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<h1 id="creating-and-modifying-data">Creating and Modifying Data</h1>

<p>So far we have only looked at how to get information out of a database,
both because that is more frequent than adding information,
and because most other operations only make sense
once queries are understood.
If we want to create and modify data,
we need to know two other sets of commands.</p>

<p>The first pair are <a href="https://www.sqlite.org/lang_createtable.html"><code class="language-plaintext highlighter-rouge">CREATE TABLE</code></a> and <a href="https://www.sqlite.org/lang_droptable.html"><code class="language-plaintext highlighter-rouge">DROP TABLE</code></a>.
While they are written as two words,
they are actually single commands.
The first one creates a new table;
its arguments are the names and types of the table’s columns.
For example,
the following statements create the four tables in our survey database:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Person</span><span class="p">(</span><span class="n">id</span> <span class="nb">text</span><span class="p">,</span> <span class="n">personal</span> <span class="nb">text</span><span class="p">,</span> <span class="n">family</span> <span class="nb">text</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Site</span><span class="p">(</span><span class="n">name</span> <span class="nb">text</span><span class="p">,</span> <span class="n">lat</span> <span class="nb">real</span><span class="p">,</span> <span class="n">long</span> <span class="nb">real</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Visited</span><span class="p">(</span><span class="n">id</span> <span class="nb">integer</span><span class="p">,</span> <span class="n">site</span> <span class="nb">text</span><span class="p">,</span> <span class="n">dated</span> <span class="nb">text</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Survey</span><span class="p">(</span><span class="n">taken</span> <span class="nb">integer</span><span class="p">,</span> <span class="n">person</span> <span class="nb">text</span><span class="p">,</span> <span class="n">quant</span> <span class="nb">text</span><span class="p">,</span> <span class="n">reading</span> <span class="nb">real</span><span class="p">);</span>
</code></pre></div></div>

<p>We can get rid of one of our tables using:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">Survey</span><span class="p">;</span>
</code></pre></div></div>

<p>Be very careful when doing this:
if you drop the wrong table, hope that the person maintaining the database has a backup,
but it’s better not to have to rely on it.</p>

<p>Different database systems support different data types for table columns,
but most provide the following:</p>

<table>
  <thead>
    <tr>
      <th>data type</th>
      <th>use</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>INTEGER</td>
      <td>a signed integer</td>
    </tr>
    <tr>
      <td>REAL</td>
      <td>a floating point number</td>
    </tr>
    <tr>
      <td>TEXT</td>
      <td>a character string</td>
    </tr>
    <tr>
      <td>BLOB</td>
      <td>a “binary large object”, such as an image</td>
    </tr>
  </tbody>
</table>

<p>Most databases also support Booleans and date/time values;
SQLite uses the integers 0 and 1 for the former,
and represents the latter as text or numeric fields.</p>

<p>An increasing number of databases also support geographic data types,
such as latitude and longitude.
Keeping track of what particular systems do or do not offer,
and what names they give different data types,
is an unending portability headache.</p>

<blockquote class="tip">
  <div class="box-title tip-title" id="tip-which-database-should-i-use-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-which-database-should-i-use-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Which database should I use?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p>SQLite is fantastic for small databases or embedded into applications where
you want to be able to use SQL to query and process data.</p>

  <p>However for any real analysis PostgreSQL is usually the best choice, it
scales incredibly well and can meet a wide range of use cases. It has good
data type support.</p>
</blockquote>

<blockquote class="tip">
  <div class="box-title tip-title" id="tip-do-you-have-geographic-data-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-do-you-have-geographic-data-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Do you have geographic data?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
  <p>Use Postgres. The <a href="https://postgis.net/">PostGIS</a> library is fantastic and industry standard for storing geographic data in a database.</p>
</blockquote>

<p>When we create a table,
we can specify several kinds of constraints on its columns.
For example,
a better definition for the <code class="language-plaintext highlighter-rouge">Survey</code> table would be:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Survey</span><span class="p">(</span>
    <span class="n">taken</span>   <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span> <span class="c1">-- where reading taken</span>
    <span class="n">person</span>  <span class="nb">text</span><span class="p">,</span>             <span class="c1">-- may not know who took it</span>
    <span class="n">quant</span>   <span class="nb">text</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>    <span class="c1">-- the quantity measured</span>
    <span class="n">reading</span> <span class="nb">real</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>    <span class="c1">-- the actual reading</span>
    <span class="k">primary</span> <span class="k">key</span><span class="p">(</span><span class="n">taken</span><span class="p">,</span> <span class="n">quant</span><span class="p">),</span>
    <span class="k">foreign</span> <span class="k">key</span><span class="p">(</span><span class="n">taken</span><span class="p">)</span> <span class="k">references</span> <span class="n">Visited</span><span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="k">foreign</span> <span class="k">key</span><span class="p">(</span><span class="n">person</span><span class="p">)</span> <span class="k">references</span> <span class="n">Person</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Once again,
exactly what constraints are available
and what they’re called
depends on which database manager we are using.</p>

<p>Once tables have been created,
we can add, change, and remove records using our other set of commands,
<code class="language-plaintext highlighter-rouge">INSERT</code>, <code class="language-plaintext highlighter-rouge">UPDATE</code>, and <code class="language-plaintext highlighter-rouge">DELETE</code>.</p>

<p>Here is an example of inserting rows into the <code class="language-plaintext highlighter-rouge">Site</code> table:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Site</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'DR-1'</span><span class="p">,</span> <span class="o">-</span><span class="mi">49</span><span class="p">.</span><span class="mi">85</span><span class="p">,</span> <span class="o">-</span><span class="mi">128</span><span class="p">.</span><span class="mi">57</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Site</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'DR-3'</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">126</span><span class="p">.</span><span class="mi">72</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Site</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">'MSK-4'</span><span class="p">,</span> <span class="o">-</span><span class="mi">48</span><span class="p">.</span><span class="mi">87</span><span class="p">,</span> <span class="o">-</span><span class="mi">123</span><span class="p">.</span><span class="mi">40</span><span class="p">);</span>
</code></pre></div></div>

<p>We can also insert values into one table directly from another:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">JustLatLong</span><span class="p">(</span><span class="n">lat</span> <span class="nb">real</span><span class="p">,</span> <span class="n">long</span> <span class="nb">real</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">JustLatLong</span> <span class="k">SELECT</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long</span> <span class="k">FROM</span> <span class="n">Site</span><span class="p">;</span>
</code></pre></div></div>

<p>Modifying existing records is done using the <code class="language-plaintext highlighter-rouge">UPDATE</code> statement.
To do this we tell the database which table we want to update,
what we want to change the values to for any or all of the fields,
and under what conditions we should update the values.</p>

<p>For example, if we made a mistake when entering the lat and long values
of the last <code class="language-plaintext highlighter-rouge">INSERT</code> statement above, we can correct it with an update:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">Site</span> <span class="k">SET</span> <span class="n">lat</span> <span class="o">=</span> <span class="o">-</span><span class="mi">47</span><span class="p">.</span><span class="mi">87</span><span class="p">,</span> <span class="n">long</span> <span class="o">=</span> <span class="o">-</span><span class="mi">122</span><span class="p">.</span><span class="mi">40</span> <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'MSK-4'</span><span class="p">;</span>
</code></pre></div></div>

<p>Be careful to not forget the <code class="language-plaintext highlighter-rouge">WHERE</code> clause or the update statement will
modify <em>all</em> of the records in the database.</p>

<p>Deleting records can be a bit trickier,
because we have to ensure that the database remains internally consistent.
If all we care about is a single table,
we can use the <code class="language-plaintext highlighter-rouge">DELETE</code> command with a <code class="language-plaintext highlighter-rouge">WHERE</code> clause
that matches the records we want to discard.
For example,
once we realize that Frank Danforth didn’t take any measurements,
we can remove him from the <code class="language-plaintext highlighter-rouge">Person</code> table like this:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">Person</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="o">=</span> <span class="s1">'danforth'</span><span class="p">;</span>
</code></pre></div></div>

<p>But what if we removed Anderson Lake instead?
Our <code class="language-plaintext highlighter-rouge">Survey</code> table would still contain seven records
of measurements he’d taken,
but that’s never supposed to happen:
<code class="language-plaintext highlighter-rouge">Survey.person</code> is a foreign key into the <code class="language-plaintext highlighter-rouge">Person</code> table,
and all our queries assume there will be a row in the latter
matching every value in the former.</p>

<p>This problem is called referential integrity:
we need to ensure that all references between tables can always be resolved correctly.
One way to do this is to delete all the records
that use <code class="language-plaintext highlighter-rouge">'lake'</code> as a foreign key
before deleting the record that uses it as a primary key.
If our database manager supports it,
we can automate this
using cascading delete.
However,
this technique is outside the scope of this chapter.</p>

<blockquote class="tip">
  <div class="box-title tip-title" id="tip-hybrid-storage-models-1"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-hybrid-storage-models-1" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Hybrid Storage Models</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>Many applications use a hybrid storage model
instead of putting everything into a database:
the actual data (such as astronomical images) is stored in files,
while the database stores the files’ names,
their modification dates,
the region of the sky they cover,
their spectral characteristics,
and so on.
This is also how most music player software is built:
the database inside the application keeps track of the MP3 files,
but the files themselves live on disk.</p>
</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question-replacing-null-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Replacing NULL</div>

  <p>Write an SQL statement to replace all uses of <code class="language-plaintext highlighter-rouge">null</code> in
<code class="language-plaintext highlighter-rouge">Survey.person</code> with the string <code class="language-plaintext highlighter-rouge">'unknown'</code>.</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-18"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-18" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>UPDATE Survey SET person = 'unknown' WHERE person IS NULL;
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>

<blockquote class="question">
  <div class="box-title question-title" id="question-backing-up-with-sql-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Backing Up with SQL</div>

  <p>SQLite has several administrative commands that aren’t part of the
SQL standard.  One of them is <code class="language-plaintext highlighter-rouge">.dump</code>, which prints the SQL commands
needed to re-create the database.  Another is <code class="language-plaintext highlighter-rouge">.read</code>, which reads a
file created by <code class="language-plaintext highlighter-rouge">.dump</code> and restores the database.  A colleague of
yours thinks that storing dump files (which are text) in version
control is a good way to track and manage changes to the database.
What are the pros and cons of this approach?  (Hint: records aren’t
stored in any particular order.)</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-19"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-19" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>
    <h4 id="advantages">Advantages</h4>
    <ul>
      <li>A version control system will be able to show differences between versions
of the dump file; something it can’t do for binary files like databases</li>
      <li>A VCS only saves changes between versions, rather than a complete copy of
each version (save disk space)</li>
      <li>The version control log will explain the reason for the changes in each version
of the database</li>
    </ul>

    <h4 id="disadvantages">Disadvantages</h4>
    <ul>
      <li>Artificial differences between commits because records don’t have a fixed order</li>
    </ul>
  </blockquote>
</blockquote>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Try solutions here!</span>
</code></pre></div></div>


                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                        <h3>You've Finished the Tutorial</h3>
                        <button id="tutorial-finish-button" class="btn btn-primary" onclick="tutorial_finish()">I finished this tutorial 👍</button>
                        <p style="display: none" id="tutorial-finish-text">Please also consider filling out the <a href="#gtn-feedback">Feedback Form</a> as well!</p>
                        <script>
                        function tutorial_finish() {
                          if(typeof plausible !== 'undefined'){
                            // Plausible may be undefined (script blocked)
                            // or it may be defined, but opted-out (select box/DNT),
                            // which means `plausible()` will work but not send data, *nor* execute the callback.
                            plausible('TutorialComplete', {props: {path: document.location.pathname}})
                          }
                          // since the callback is completely cosmetic, we'll just issue it optimistically.
                          tutorial_finish_finish();
                        }
                        function tutorial_finish_finish() {
                          document.getElementById("tutorial-finish-button").innerText = 'Congrats! Thanks for letting us know! 🎉'
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-text").style.display = 'block'
                        }
                        </script>

                
                <blockquote class="key_points">
                    <div class="box-title"><i class="fas fa-key" aria-hidden="true"></i> Key points</div>
                    <ul>
                        
                        <li><p>Use aggregation functions to combine multiple values.</p>
</li>
                        
                        <li><p>Aggregation functions ignore <code class="language-plaintext highlighter-rouge">null</code> values.</p>
</li>
                        
                        <li><p>Aggregation happens after filtering.</p>
</li>
                        
                        <li><p>Use GROUP BY to combine subsets separately.</p>
</li>
                        
                        <li><p>If no aggregation function is specified for a field, the query may return an arbitrary value for that field.</p>
</li>
                        
                        <li><p>Use JOIN to combine data from two tables.</p>
</li>
                        
                        <li><p>Use table.field notation to refer to fields when doing joins.</p>
</li>
                        
                        <li><p>Every fact should be represented in a database exactly once.</p>
</li>
                        
                        <li><p>A join produces all combinations of records from one table with records from another.</p>
</li>
                        
                        <li><p>A primary key is a field (or set of fields) whose values uniquely identify the records in a table.</p>
</li>
                        
                        <li><p>A foreign key is a field (or set of fields) in one table whose values are a primary key in another table.</p>
</li>
                        
                        <li><p>We can eliminate meaningless combinations of records by matching primary keys and foreign keys between tables.</p>
</li>
                        
                        <li><p>The most common join condition is matching keys.</p>
</li>
                        
                        <li><p>Every value in a database should be atomic.</p>
</li>
                        
                        <li><p>Every record should have a unique primary key.</p>
</li>
                        
                        <li><p>A database should not contain redundant information.</p>
</li>
                        
                        <li><p>Units and similar metadata should be stored with the data.</p>
</li>
                        
                        <li><p>Use CREATE and DROP to create and delete tables.</p>
</li>
                        
                        <li><p>Use INSERT to add data.</p>
</li>
                        
                        <li><p>Use UPDATE to modify existing data.</p>
</li>
                        
                        <li><p>Use DELETE to remove data.</p>
</li>
                        
                        <li><p>It is simpler and safer to modify data when every record has a unique primary key.</p>
</li>
                        
                        <li><p>Do not create dangling references by deleting records that other records refer to.</p>
</li>
                        
                        <li><p>General-purpose languages have libraries for accessing databases.</p>
</li>
                        
                        <li><p>To connect to a database, a program must use a library specific to that database manager.</p>
</li>
                        
                        <li><p>These libraries use a connection-and-cursor model.</p>
</li>
                        
                        <li><p>Programs can read query results in batches or all at once.</p>
</li>
                        
                        <li><p>Queries should be written using parameter substitution, not string formatting.</p>
</li>
                        
                    </ul>
                </blockquote>
                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the <a href="faqs/">tutorial FAQ page</a> or the  <a href="/training-material/topics/data-science/faqs/">FAQ page for the Foundations of Data Science topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                
                <h1 data-toc-skip>Quizzes</h1>
                <p>Check your understanding with these quizzes</p>
                    
                    <h2>SQL Advanced Recap</h2>
                    <div class="contributors-line"><a href="/training-material/hall-of-fame/hexylena/" class="contributor-badge contributor-hexylena"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/hexylena?s=36" alt="Helena Rasche avatar" width="36" class="avatar" />
    Helena Rasche</a></div>
                    <ul>
                        <li>
                            <a href="/training-material/quiz/quiz.html?mode=self&quiz=/training-material/topics/data-science/tutorials/sql-advanced/quiz/recap.yml">Self Study Mode</a> - do the quiz at your own pace, to check your understanding.
                        </li>
                        <li>
                            <a href="/training-material/quiz/quiz.html?mode=teacher&quiz=/training-material/topics/data-science/tutorials/sql-advanced/quiz/recap.yml">Classroom Mode</a> - do the quiz synchronously with a classroom of students.
                        </li>
                    </ul>
                    
                

                


                

                
                <h1 data-toc-skip>Glossary</h1>
                <dl>
                    
                    
                    <dt>SQL</dt>
                    <dd>Structured Query Language</dd>
                    
                </dl>
                

                <h1 id="gtn-feedback">Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=data-science/sql-advanced"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=data-science/sql-advanced">Feedback Form</a></iframe>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            carpentries, Helena Rasche, avans-atgm,  <b>Advanced SQL (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/tutorial.html">https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{data-science-sql-advanced,
author = "carpentries and Helena Rasche and avans-atgm",
	title = "Advanced SQL (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/data-science/tutorials/sql-advanced/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

        


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                
                <blockquote class="agenda follow-up">
                    <div class="box-title">Go Further</div>
                    <strong class="follow-up"><i class="fas fa-graduation-cap" aria-hidden="true"></i> Do you want to extend your knowledge? Follow one of our recommended follow-up trainings:</strong>
                    <ul>
                        
    
        
        
        
            
                
                    
                
                    
                
                    
                
                    
                        
                        
                            
                                <li>
                                  <a href="/training-material/topics/data-science/tutorials/sql-python/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> Hands-on: SQL with Python</a>
                                </li>
                            
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
    


                    </ul>
                </blockquote>
                

		
                <blockquote class="details follow-up" id="admins-install-missing-tools">
                  <div id="admin-missing-tools" class="box-title">
                    <button type="button" aria-controls="admin-missing-tools" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Galaxy Administrators: Install the missing tools<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>


			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/data-science/tutorials/sql-advanced/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools: []
</code></pre></div>
                </blockquote>
		

		<blockquote class="details hide-when-printing" id="feedback-responses">
                  <div id="feedback-response-c" class="box-title">
                    <button type="button" aria-controls="feedback-response-c" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Feedback<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>

		   <p>
		   
		   <table class="charts-css bar show-labels" style="--labels-size: 8rem; overflow-y: hidden">
		   
		   </table>
		   </p>
		
        
        
            <p>No feedback has been recieved yet for this training. Be the first one by filling in the feedback form from <a href="#gtn-feedback">above</a>. </p>
        
		</blockquote>




		
		
		

                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					
					<li><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00106">gxy.io/GTN:T00106</a></li>
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/data-science/tutorials/sql-advanced/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/data-science/tutorials/sql-advanced/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/ad6223c35f36ee0601c96f2adfbb4c5ee3a6e9d6">ad6223c</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.40d4e218.js'></script>

	
	

    </body>
</html>