<!DOCTYPE html>
<html lang="en" dir="auto">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Hands-on: Tree thinking for tuberculosis evolution and epidemiology / Tree thinking for tuberculosis evolution and epidemiology / Evolution</title>
        
            <meta name="google-site-verification" content="9mOXn2JL833-i7-aioCCEuIdG4_tb6qjwUozB5GJnPQ" />

<!-- JavaScript Error Monitoring, and performance tracking. -->
<script
  src="https://browser.sentry-cdn.com/7.52.1/bundle.tracing.min.js"
  integrity="sha384-muuFXKS3752PNA4rPm9Uq6BLvOfV4CXyr9MHDBPvozOJJUWLKkogEFWOIRoVps43"
  crossorigin="anonymous"
></script>
<script type="text/javascript">
if(localStorage.getItem('sentry-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	console.log("Sentry: opt-in");
	Sentry.init({
		dsn: "https://45e0ec6e4373462b92969505df37cf40@sentry.galaxyproject.org/10",
		release: "galaxy-training-network@a66aac79f9b4ad1679bbe669de6e367461819e29",
		integrations: [new Sentry.BrowserTracing(), new Sentry.Replay()],
		sampleRate: 0.1,
		tracesSampleRate: 0.1,
		// Capture Replay for no sessions by default
		replaysSessionSampleRate: 0.01,
		// plus for 1% of sessions with an error
		replaysOnErrorSampleRate: 0.01,
		// PII OFF
		sendDefaultPii: false, // Off by default but just in case.
		environment: "production",
	});
}
</script>

<!-- Page view tracking -->
<script defer data-domain="training.galaxyproject.org" src="https://plausible.galaxyproject.eu/js/plausible.js"></script>
<script>
if(localStorage.getItem('plausible-opt-out') !== 'opt-out' && navigator.doNotTrack !== "1") {
	localStorage.removeItem("plausible_ignore")
	console.log("Plausible: opt-in");
	window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }
} else {
	// if they're opting-out, or DNT
	// we might get one page by accident but we won't get future ones.
	localStorage.setItem("plausible_ignore", "true")
}
</script>

        
        <link rel="shortcut icon" href="/training-material/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" href="/training-material/feed.xml">
        <link rel="canonical" href="https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_phylogeny/tutorial.html">
        <link rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Regular-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Bold-102a.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/training-material/assets/fonts/AtkinsonHyperlegible/Atkinson-Hyperlegible-Italic-102a.woff2" as="font" type="font/woff2" crossorigin>
        
        <link rel="preload" href="/training-material/assets/css/main.css?v=3" as="style">
        <link rel='preload' href='/training-material/assets/js/bundle.theme.f1f2de89.js' as='script'>
<link rel='preload' href='/training-material/assets/js/bundle.main.40d4e218.js' as='script'>
        <link rel="stylesheet" href="/training-material/assets/css/main.css?v=3">
        <link rel="manifest" href="/training-material/manifest.json">
        <meta name="theme-color" content="#2c3143"/>
	

        <meta name="DC.identifier" content="https://github.com/galaxyproject/training-material">
<meta name="DC.type" content="text">
<meta name="DC.title" content="Tree thinking for tuberculosis evolution and epidemiology">
<meta name="DC.publisher" content="Galaxy Training Network">
<meta name="DC.date" content="2024-03-12 16:38:55 +0000">
<meta name="DC.creator" content="Christoph Stritt">
<meta name="DC.creator" content="Daniela Brites">
<meta name="DC.creator" content="Galo A. Goig"><meta name="description" content="phylogenetics">
        <meta property="og:site_name" content="Galaxy Training Network">
	<meta property="og:title" content="Evolution / Tree thinking for tuberculosis evolution and epidemiology / Hands-on: Tree thinking for tuberculosis evolution and epidemiology">
        <meta property="og:description" content="phylogenetics">
        <meta property="og:image" content="https://galaxy-training.s3.amazonaws.com/social/topics/evolution/tutorials/mtb_phylogeny/tutorial.png">
	<script type="application/ld+json">


{
  "@context": "http://schema.org",
  "@type": "LearningResource",
  "http://purl.org/dc/terms/conformsTo": {
    "@id": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
    "@type": "CreativeWork"
  },
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "Students"
  },
  "citation": [
    {
      "@type": "CreativeWork",
      "name": "Galaxy Training: A Powerful Framework for Teaching!",
      "url": "https://doi.org/10.1371/journal.pcbi.1010752"
    },
    {
      "@type": "CreativeWork",
      "name": "Community-Driven Data Analysis Training for Biology",
      "url": "https://doi.org/10.1016/j.cels.2018.05.012"
    }
  ],
  "discussionUrl": "https://gitter.im/Galaxy-Training-Network/Lobby",
  "headline": "Tree thinking for tuberculosis evolution and epidemiology",
  "interactivityType": "mixed",
  "isAccessibleForFree": true,
  "isFamilyFriendly": true,
  "license": "https://spdx.org/licenses/CC-BY-4.0.html",
  "producer": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "provider": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "sourceOrganization": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "workTranslation": [

  ],
  "creativeWorkStatus": "Active",
  "dateModified": "2024-03-12 16:38:55 +0000",
  "datePublished": "2022-03-16 10:37:17 +0000",
  "copyrightHolder": {
    "@type": "Organization",
    "http://purl.org/dc/terms/conformsTo": {
      "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
      "@type": "Organization"
    },
    "id": "https://training.galaxyproject.org",
    "email": "galaxytrainingnetwork@gmail.com",
    "name": "Galaxy Training Network",
    "legalName": "Galaxy Training Network",
    "alternateName": "GTN",
    "url": "https://training.galaxyproject.org",
    "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
    "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
    "keywords": [
      "galaxy",
      "bioinformatics",
      "training",
      "fair",
      "accessible"
    ],
    "status": "active",
    "foundingDate": "2015-06-29",
    "socialMedia": "https://mstdn.science/@gtn",
    "type": "project"
  },
  "funder": [

  ],
  "funding": [

  ],
  "identifier": "https://gxy.io/GTN:T00144",
  "accessMode": [
    "textual",
    "visual"
  ],
  "accessModeSufficient": [
    "textual",
    "visual"
  ],
  "accessibilityControl": [
    "fullKeyboardControl",
    "fullMouseControl"
  ],
  "accessibilityFeature": [
    "alternativeText",
    "tableOfContents"
  ],
  "accessibilitySummary": "The text aims to be as accessible as possible. Image descriptions will vary per tutorial, from images being completely inaccessible, to images with good descriptions for non-visual users.",
  "isPartOf": {
    "@type": "CreativeWork",
    "name": "Evolution",
    "description": "phylogenetics",
    "url": "https://training.galaxyproject.org/training-material/topics/evolution/"
  },
  "abstract": "> \"Nothing in biology makes sense except in the light of evolution.\"",
  "learningResourceType": "e-learning",
  "name": "Tree thinking for tuberculosis evolution and epidemiology",
  "url": "https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_phylogeny/tutorial.html",
  "version": 11,
  "timeRequired": "PT1H",
  "teaches": "- Understand the basic concepts behind phylogenetic trees, as applied to *Mycobacterium tuberculosis*\n- Be able to read and interrogate a phylogeny encountered in the literature",
  "keywords": [
    "Evolution",
    "prokaryote",
    "one-health",
    "phylogenetics",
    "microgalaxy"
  ],
  "description": "## Abstract\n\n> \"Nothing in biology makes sense except in the light of evolution.\"\n\n\n## About This Material\n\nThis is a Hands-on Tutorial from the GTN which is usable either for individual self-study, or as a teaching material in a classroom.\n\n\n## Questions this  will address\n\n - What information can I get from a phylogenetic tree?\n - How do I estimate a phylogeny?\n\n\n## Learning Objectives\n\n- Understand the basic concepts behind phylogenetic trees, as applied to *Mycobacterium tuberculosis*\n- Be able to read and interrogate a phylogeny encountered in the literature\n\n",
  "inLanguage": {
    "@type": "Language",
    "name": "English",
    "alternateName": "en"
  },
  "competencyRequired": [
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/introduction/",
      "name": "Introduction to Galaxy Analyses",
      "description": "Introduction to Galaxy Analyses",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.html",
      "name": "M. tuberculosis Variant Analysis",
      "description": "Hands-on for 'M. tuberculosis Variant Analysis' tutorial",
      "learningResourceType": "e-learning",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    },
    {
      "@context": "http://schema.org",
      "@type": "LearningResource",
      "url": "https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_transmission/tutorial.html",
      "name": "Identifying tuberculosis transmission links: from SNPs to transmission clusters",
      "description": "Hands-on for 'Identifying tuberculosis transmission links: from SNPs to transmission clusters' tutorial",
      "learningResourceType": "e-learning",
      "interactivityType": "expositive",
      "provider": {
        "@type": "Organization",
        "http://purl.org/dc/terms/conformsTo": {
          "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
          "@type": "Organization"
        },
        "id": "https://training.galaxyproject.org",
        "email": "galaxytrainingnetwork@gmail.com",
        "name": "Galaxy Training Network",
        "legalName": "Galaxy Training Network",
        "alternateName": "GTN",
        "url": "https://training.galaxyproject.org",
        "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
        "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
        "keywords": [
          "galaxy",
          "bioinformatics",
          "training",
          "fair",
          "accessible"
        ],
        "status": "active",
        "foundingDate": "2015-06-29",
        "socialMedia": "https://mstdn.science/@gtn",
        "type": "project"
      }
    }
  ],
  "author": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/cstritt/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/cstritt/",
      "name": "Christoph Stritt",
      "image": "https://avatars.githubusercontent.com/cstritt",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/dbrites/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/dbrites/",
      "name": "Daniela Brites",
      "image": "https://avatars.githubusercontent.com/dbrites",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/GaloGS/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/GaloGS/",
      "name": "Galo A. Goig",
      "image": "https://avatars.githubusercontent.com/GaloGS",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        }
      ]
    }
  ],
  "contributor": [
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "http://purl.org/dc/terms/conformsTo": {
        "@id": "https://bioschemas.org/profiles/Person/0.3-DRAFT",
        "@type": "CreativeWork"
      },
      "url": "https://training.galaxyproject.org/training-material/hall-of-fame/wm75/",
      "mainEntityOfPage": "https://training.galaxyproject.org/training-material/hall-of-fame/wm75/",
      "name": "Wolfgang Maier",
      "image": "https://avatars.githubusercontent.com/wm75",
      "description": "A contributor to the GTN project.",
      "memberOf": [
        {
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.2-DRAFT-2019_07_19",
            "@type": "Organization"
          },
          "id": "https://training.galaxyproject.org",
          "email": "galaxytrainingnetwork@gmail.com",
          "name": "Galaxy Training Network",
          "legalName": "Galaxy Training Network",
          "alternateName": "GTN",
          "url": "https://training.galaxyproject.org",
          "logo": "https://training.galaxyproject.org/training-material/assets/images/GTNLogo1000.png",
          "fundingModel": "The GTN's infrastructure relies on GitHub and the Galaxy Project for hosting costs. There are no full time paid staff members of the GTN. Individuals are occasionally funded on GTN-adjacent projects.",
          "keywords": [
            "galaxy",
            "bioinformatics",
            "training",
            "fair",
            "accessible"
          ],
          "status": "active",
          "foundingDate": "2015-06-29",
          "socialMedia": "https://mstdn.science/@gtn",
          "type": "project"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/by-covid/",
          "name": "BeYond-COVID",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://by-covid.org/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/uni-freiburg/",
          "name": "University of Freiburg",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://www.uni-freiburg.de/"
        },
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "http://purl.org/dc/terms/conformsTo": {
            "@id": "https://bioschemas.org/profiles/Organization/0.3-DRAFT",
            "@type": "CreativeWork"
          },
          "id": "https://training.galaxyproject.org/training-material/hall-of-fame/elixir-europe/",
          "name": "ELIXIR Europe",
          "description": "An organization supporting the Galaxy Training Network",
          "url": "https://elixir-europe.org"
        }
      ],
      "identifier": "https://orcid.org/0000-0002-9464-6640",
      "orcid": "https://orcid.org/0000-0002-9464-6640"
    }
  ],
  "about": [
    {
      "@type": "CreativeWork",
      "name": "Evolution",
      "description": "phylogenetics",
      "url": "https://training.galaxyproject.org/training-material/topics/evolution/"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3299",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3299",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3299"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0622",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0622",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0622"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3301",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3301",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3301"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_0084",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_0084",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_0084"
    },
    {
      "@type": "DefinedTerm",
      "@id": "http://edamontology.org/topic_3324",
      "inDefinedTermSet": "http://edamontology.org",
      "termCode": "topic_3324",
      "url": "https://bioportal.bioontology.org/ontologies/EDAM/?p=classes&conceptid=http%3A%2F%2Fedamontology.org%2Ftopic_3324"
    }
  ],
  "educationalLevel": "Beginner",
  "mentions": [
    {
      "@type": "Thing",
      "url": "https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_phylogeny/workflows/",
      "name": "Associated Workflows"
    },
    {
      "@type": "Thing",
      "url": "https://zenodo.org/record/6010176",
      "name": "Associated Training Datasets"
    }
  ]
}</script></head>
    <body data-spy="scroll" data-target="#toc" data-brightness="auto" data-contrast="auto">
        <script  src='/training-material/assets/js/bundle.theme.f1f2de89.js'></script>
        <header>
    <nav class="navbar navbar-expand-md navbar-dark" aria-label="Site Navigation">
        <div class="container">
            <a class="navbar-brand" href="/training-material/">
                <img src="/training-material/assets/images/GTN-60px.png" height="30" alt="Galaxy Training Network logo">
                
                    Galaxy Training!
                
            </a>

            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/topics/evolution" title="Go back to list of tutorials">
                            <i class="far fa-folder" aria-hidden="true"></i> Evolution
                        </a>
                        
                    </li>

                    <li class="nav-item">
                        
                        <a class="nav-link" href="/training-material/learning-pathways" title="Learning Pathways">
                           <i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="visually-hidden">curriculum</span> Learning Pathways
                        </a>
                        
                    </li>

                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Help">
        <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">help</span> Help
    </a>
    <div class="dropdown-menu dropdown-menu-right">
	<a class="dropdown-item" href="/training-material/faqs/index.html" title="Check our FAQs">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="/training-material/topics/evolution/faqs/" title="Check our FAQs for the Evolution topic">
           <i class="far fa-question-circle" aria-hidden="true"></i><span class="visually-hidden">question</span> Topic FAQs
        </a>
        
        
        
        <a class="dropdown-item" href="https://help.galaxyproject.org/" title="Discuss on Galaxy Help">
            <i class="far fa-comments" aria-hidden="true"></i><span class="visually-hidden">feedback</span> Galaxy Help Forum
        </a>
        <a class="dropdown-item" href="https://gitter.im/Galaxy-Training-Network/Lobby" title="Discuss on gitter">
           <i class="fab fa-gitter" aria-hidden="true"></i><span class="visually-hidden">gitter</span> Discuss on Matrix
        </a>
    </div>
</li>


                    <li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Settings">
	<i class="fas fa-cog" aria-hidden="true"></i><span class="visually-hidden">galaxy-gear</span> Settings
    </a>
    <div class="dropdown-menu dropdown-menu-right">

	<h6 class="dropdown-header">Preferences</h6>

	<a href="/training-material/user/theme.html" class="dropdown-item">
		<i class="fas fa-palette" aria-hidden="true"></i><span class="visually-hidden">gtn-theme</span> Theme
	</a>

	<a href="/training-material/user/privacy.html" class="dropdown-item">
		<i class="fas fa-lock" aria-hidden="true"></i><span class="visually-hidden">pref-dataprivate</span> Data Privacy
	</a>

	<div class="dropdown-divider"></div>

	<h6 class="dropdown-header">For Everyone</h6>

        <a class="dropdown-item" href="https://github.com/galaxyproject/training-material/edit/main/topics/evolution/tutorials/mtb_phylogeny/tutorial.md">
          <i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Propose a change or correction
        </a>

	<h6 class="dropdown-header">Instructor Utilities</h6>

        <a class="dropdown-item" href="/training-material/stats.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN statistics
        </a>

        <a class="dropdown-item" href="https://plausible.galaxyproject.eu/training.galaxyproject.org?period=12mo&page=/training-material/topics/evolution/tutorials/mtb_phylogeny/tutorial.html">
            <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> Page View Metrics
        </a>

        <!-- link to feedback -->
        
            
            
                <a class="dropdown-item" href="/training-material/feedback.html">
                    <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> GTN feedback
                </a>
            
        

        <div class="dropdown-item">
            <div>
                <i class="fas fa-history" aria-hidden="true"></i><span class="visually-hidden">galaxy-rulebuilder-history</span> Previous Versions
            </div>

            <div id="archive-selector">
            
                <a class="btn btn-warning" href="https://training.galaxyproject.org/archive/">Older Versions</a>
            </div>

        </div>

    </div>
</li>


                    <!-- Search bar-->
                    <li class="nav-item">
                      <div id="navbarSupportedContent" role="search">
                        <!-- Search form -->
                        <form class="form-inline mr-auto" method="GET" action="/training-material/search2">
                          <i class="fas fa-search nav-link" aria-hidden="true"></i>
                          <div class="md-form mb-2">
                            <input name="query" class="form-control nicer" type="text" placeholder="Search Tutorials" aria-label="Search">
                          </div>
                        </form>
                      </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

        
        <div class="container main-content" role="main">
        














<!-- Gitter -->






<article class="tutorial topic-evolution">
    <h1 data-toc-skip>Tree thinking for tuberculosis evolution and epidemiology</h1>
    

    <section aria-labelledby="overview-box" id="tutorial-metadata">
    <div markdown="0">

	<div class="contributors-line">
		
<table class="contributions">
	
	<tr>
		<td><abbr title="These people wrote the bulk of the tutorial, they may have done the analysis, built the workflow, and wrote the text themselves.">Author(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/cstritt/" class="contributor-badge contributor-cstritt"><img src="https://avatars.githubusercontent.com/cstritt?s=36" alt="Christoph Stritt avatar" width="36" class="avatar" />
    Christoph Stritt</a><a href="/training-material/hall-of-fame/dbrites/" class="contributor-badge contributor-dbrites"><img src="https://avatars.githubusercontent.com/dbrites?s=36" alt="Daniela Brites avatar" width="36" class="avatar" />
    Daniela Brites</a><a href="/training-material/hall-of-fame/GaloGS/" class="contributor-badge contributor-GaloGS"><img src="https://avatars.githubusercontent.com/GaloGS?s=36" alt="Galo A. Goig avatar" width="36" class="avatar" />
    Galo A. Goig</a>
		</td>
	</tr>
	

	

	

	

	

	
	<tr>
		<td><abbr title="These people edited the text, either for spelling and grammar, flow, GTN-fit, or other similar editing categories">Editor(s)</abbr></td>
		<td>
			<a href="/training-material/hall-of-fame/wm75/" class="contributor-badge contributor-wm75"><img src="/training-material/assets/images/orcid.png" alt="orcid logo" width="36" height="36"/><img src="https://avatars.githubusercontent.com/wm75?s=36" alt="Wolfgang Maier avatar" width="36" class="avatar" />
    Wolfgang Maier</a></td>
	</tr>
	

	

	

	

</table>


	</div>

</div>


    <blockquote class="overview">
        <div id="overview-box" class="box-title">Overview</div>
        
        <img alt="Creative Commons License: CC-BY" class="float-right" style="border-width:0; display: inline-block; margin:0" src="/training-material/assets/images/cc-by.png" width="88" height="31"/>
        
        <strong><i class="far fa-question-circle" aria-hidden="true"></i> Questions:</strong>
        <ul>
        
        <li><p>What information can I get from a phylogenetic tree?</p>
</li>
        
        <li><p>How do I estimate a phylogeny?</p>
</li>
        
        </ul>

        <strong><i class="fas fa-bullseye" aria-hidden="true"></i> Objectives: </strong>
        <ul>
        
        <li><p>Understand the basic concepts behind phylogenetic trees, as applied to <em>Mycobacterium tuberculosis</em></p>
</li>
        
        <li><p>Be able to read and interrogate a phylogeny encountered in the literature</p>
</li>
        
        </ul>

        
        <strong><i class="fas fa-check-circle" aria-hidden="true"></i> Requirements:</strong>
        <ul>
        
    
        
        
        
        <li>
          <a href="/training-material/topics/introduction">Introduction to Galaxy Analyses</a>
        </li>
        
    


        
    
        
        
        
            
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        
                        
                            
                                <li>
                                  <a href="/training-material/topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> Hands-on: M. tuberculosis Variant Analysis</a>
                                </li>
                            
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
    

    
        
        
        
            
                
                    
                
                    
                
                    
                        
                        
                            
                                <li>
                                  <a href="/training-material/topics/evolution/tutorials/mtb_transmission/tutorial.html"><i class="fas fa-laptop" aria-hidden="true"></i><span class="visually-hidden">tutorial</span> Hands-on: Identifying tuberculosis transmission links: from SNPs to transmission clusters</a>
                                </li>
                            
                        
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            
        
    


        </ul>
        

        
        <div><strong><i class="fas fa-hourglass-half" aria-hidden="true"></i> Time estimation:</strong> 1 hour</div>
        

        
        <div><strong><i class="fas fa-graduation-cap" aria-hidden="true"></i> Level: </strong>
        


 Introductory <span class="visually-hidden">Introductory</span>
<span class="level introductory" title="Introductory Tutorial">
  <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i> <i class="fas fa-graduation-cap" aria-hidden="true"></i>
</span>

</div>
        

        

        

        <div id="supporting-materials"><strong><i class="fa fa-external-link" aria-hidden="true"></i> Supporting Materials:</strong></div>
        <ul class="supporting_material">
            

            
                <li class="btn btn-default supporting_material">


<a class="btn btn-default topic-icon" title="Zenodo datasets used in this tutorial" href="https://zenodo.org/record/6010176">
    <i class="far fa-copy" aria-hidden="true"></i>&nbsp;Datasets
</a>

</li>
            

            
                <li class="btn btn-default supporting_material">


    <a class="btn btn-default topic-icon" href="/training-material/topics/evolution/tutorials/mtb_phylogeny/workflows/" title="Tree thinking for tuberculosis evolution and epidemiology workflows">
        <i class="fas fa-share-alt" aria-hidden="true"></i>&nbsp;Workflows
    </a>

</li>
            

            

            

            

            

            
            
            

            <!-- Check the GTN Video Library for recordings of this tutorial or associated slides -->
            












            
                
                <li class="btn btn-default supporting_material">






    <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false" title="Where to run the tutorial">
        <i class="fas fa-globe" aria-hidden="true"></i><span class="visually-hidden">instances</span>&nbsp;Available on these Galaxies 
    </a>
    <ul class="dropdown-menu">
        
	<li class="dropdown-header">
		<b>Known Working</b>
	</li>
	
	

    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.eu" title="">
			UseGalaxy.eu <abbr title="This instance supports the precise tool versions used in this tutorial">✅</abbr> <abbr title="This is a UseGalaxy.* server which meets minimum requirements for a public Galaxy">⭐️</abbr>
		</a>
	</li>
    
    
    
    
	<li class="dropdown-header">
		<b>Possibly Working</b>
	</li>
    
	<li>
		<a class="dropdown-item" href="https://usegalaxy.org" title="">
			UseGalaxy.org (Main)
		</a>
	</li>
    
    

    </ul>

</li>
                
            
        </ul>

        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Published:</strong> Mar 16, 2022 </div>
        <div><strong><i class="far fa-calendar" aria-hidden="true"></i> Last modification:</strong> Mar 12, 2024 </div>
        <div><strong><i class="fas fa-balance-scale" aria-hidden="true"></i> License:</strong>
		
            Tutorial Content is licensed under
            
              <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
            The GTN Framework is licensed under <a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a>
        </div>
        
        <div><strong><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span> <abbr title="Persistent URL">PURL</abbr>:</strong> <a href="https://gxy.io/GTN:T00144">https://gxy.io/GTN:T00144</a> </div>
        

	
	

	
	
	<div><strong><i class="far fa-star" aria-hidden="true"></i><span class="visually-hidden">rating</span> Rating:</strong> <a href="#feedback-responses">5.0</a> (1 recent ratings, 7 all time)</div>
	
	<div><strong><i class="fas fa-code-commit" aria-hidden="true"></i><span class="visually-hidden">version</span> Revision:</strong> 11 </div>

    </blockquote>
    </section>

    <div class="container">
        <div class="row">
            <!-- sidebar, which will move to the top on a small screen -->
            <div class="col-sm-2 hide-when-printing">
                <nav id="toc" data-toggle="toc" class="sticky-top" aria-label="Table of Contents"></nav>
            </div>
            <div class="col-sm-10">
                 

                <section aria-label="Tutorial Content" id="tutorial-content">
                <blockquote class="quote" author="Theodosius Dobzhansky" year="1973">
  <p>“Nothing in biology makes sense except in the light of evolution.”</p>
</blockquote>

<p>Phylogenetic trees are a tool for organizing biological diversity. Just as maps provide a spatial framework to the geographer, phylogenies provide an evolutionary context to the biologist: they capture the relationship among “things” (species, individuals, genes), represented as tips in the tree, based on common ancestry.</p>

<p>In evolutionary and epidemiological studies of <em>Mycobacterium tuberculosis</em>, it is now common to encounter large phylogenetic trees. Being able to read and critically examine them is extremely useful. Phylogenies can be used to understand the origin of a disease or the onset of an epidemic, to distinguish ongoing transmission from imported cases, to investigate how specific traits like antibiotic resistance evolve <em>et cetera et cetera</em>. Many research ideas originate from looking at and discussing patterns present in phylogenies.</p>

<p>This tutorial provides an introduction to phylogenetic trees in the context of whole genome sequencing of <em>Mycobacterium tuberculosis</em> strains. Phylogenetics is a vast topic, and we can only scratch its surface here. For those motivated to delve deeper into the topic, the <a href="#resources">Resources section</a> contains links and reading suggestions.</p>

<h2 id="basic-concepts-how-to-read-a-phylogeny">Basic concepts: How to read a phylogeny</h2>

<p>Below are two phylogenies of the <em>Mycobacterium tuberculosis</em> complex (MTBC) to illustrate some basic vocabulary and concepts.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-need-a-more-thorough-introduction-to-the-topic"><button class="gtn-boxify-button details" type="button" aria-controls="details-need-a-more-thorough-introduction-to-the-topic" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Need a more thorough introduction to the topic?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>If the following discussion sounds a bit too esoteric, you might be interested in a more thorough introduction to the topic of phylogeny like provided, for example, by the <a href="https://www.ebi.ac.uk/training/online/courses/introduction-to-phylogenetics/">introduction to phylogenetics</a> from the <a href="https://www.ebi.ac.uk/training/on-demand?facets=type:Online%20tutorial">EMBL-EBI collection of online tutorials</a>.</p>

</blockquote>

<h3 id="rooted-trees-and-tree-topology">Rooted trees and tree topology</h3>

<figure id="figure-1" style="max-width: 90%;"><div style="overflow-x: auto"><object data="./images/mtbc_1strainPerLineage.nwk.COMB.svg" type="image/svg+xml" alt="Phylogeny. ">Phylogeny.</object></div><a target="_blank" href="./images/mtbc_1strainPerLineage.nwk.COMB.svg" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 1</strong>:</span> Rooted [A] and unrooted [B] phylogeny of the MTBC. Some basic tree vocabulary is shown in red.</figcaption></figure>

<p>The trees in figure 1 look rather different at a first glance, but they are identical except for one key aspect: tree A is <strong>rooted</strong> while tree B is not.</p>

<p>What is the difference between the two? First, let’s state what is the same in the two trees: the tree <strong>topology</strong>, that is, the relative branching order. The same groupings are present in the two trees: they both contain the same information about the <strong>relatedness</strong> of strains. An example: TB isolated from Peruvian mummies is most similar to <em>M. pinnipedii</em> known from marine mammals; they share a most recent common ancestor. This can be seen in the rooted as well as in the unrooted tree.</p>

<p>The key difference between the rooted and the unrooted tree is that only the rooted tree shows the <strong>direction</strong> and sequence of branching events. The unrooted tree does not tell us, for example, whether <em>M. bovis</em> diverged early or late in the history of the MTBC. It is thus compatible with the old hypothesis that human TB evolved from animal TB. The rooted tree shows that this hypothesis is most likely wrong: animal-associated strains are not ancestral to human-associated strains.</p>

<p>The best way to root a tree is by including an <strong>outgroup</strong>: a species or lineage which we know <em>a priori</em> to lay outside the phylogeny we’re interested in. <em>M. canettii</em> usually serves this purpose for studying the MTBC, but you can also root, for example, a phylogeny of lineage 2 by including a lineage 4 strain.</p>

<h3 id="branch-lengths">Branch lengths</h3>

<p>Besides relatedness and direction, a third important piece of information contained in a phylogeny is the branch length. When a phylogeny has been estimated from DNA or protein sequences, branch lengths usually reflect the evolutionary distance between nodes in the tree. This information can be used to translate distance in terms of expected nucleotide changes into years, and thus to connect evolutionary change to historical events.</p>

<figure id="figure-2" style="max-width: 90%;"><img src="./images/eldholm2016_tree.png" alt="Phylogeny. " width="310" height="734" loading="lazy" /><a target="_blank" href="./images/eldholm2016_tree.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 2</strong>:</span> Phylogeny of the central Asian clade, including the Oslo outbreak. Modified Eldholm et al. 2016.</figcaption></figure>

<p>As branch lengths reflect evolutionary distances, they can also be used to identify transmission clusters and outbreaks. Figure 2 shows a (rooted) tree of the Central Asian Clade (CAC), which is part of lineage 2 (<span class="citation"><a href="#Eldholm2016">Eldholm <i>et al.</i> 2016</a></span>). The orange color highlights the Afghan strain family within the CAC. At the bottom of the tree, note the clade with short branch lengths. This is how one would expect an outbreak to look in a phylogenetic tree: a set of strains clustering together and separated by extremely short branches, reflecting their almost identical genomes.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-phylogenetics-with-i-mycobacterium-tuberculosis-i"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Phylogenetics with <i>Mycobacterium tuberculosis</i></div>

  <p>Phylogenetics with MTB has some particularities rarely encountered with other organisms.</p>

  <ol>
    <li>
      <p>There seems to be <strong>no horizontal gene transfer</strong> (HGT) in the MTBC. HGT complicates phylogenetic inference in many bacteria because a piece of DNA introduced by HGT has a different history and thus phylogeny than genes not affected by HGT.</p>
    </li>
    <li>
      <p>There is <strong>little genetic diversity</strong> in the MTBC: any two strains differ by only around 2,500 SNPs over the whole genome. To achieve a good resolution of recent evolution (e.g. during an outbreak), whole genome sequences are thus extremely useful.</p>
    </li>
    <li>
      <p>A large proportion of DNA polymorphisms in the MTBC are <strong>singletons</strong>, that is, variants present only in a single strain. This adds to the problem of low diversity, since singletons are not informative about tree topology.</p>
    </li>
    <li>
      <p>In this workshop, and indeed in many studies of the MTBC, SNPs are called not against the reference strain H37Rv, but against a reconstructed ancestral genome. This means that the number of SNPs identified does not reflect the evolutionary distance from some random strain like H37Rv, but from the most recent common ancestor of the MTBC. Take a look at Figure 3 in <span class="citation"><a href="#Goig2018">Goig <i>et al.</i> 2018</a></span> to see how this affects the number of SNPs identified in a genome. Below we will see that this has implications for the interpretation of a tree.</p>
    </li>
  </ol>

</blockquote>

<h2 id="infering-phylogeny-from-snp-alignments">Infering phylogeny from SNP alignments</h2>

<p>Aligned DNA or protein sequences are the starting material for phylogenetic inference with molecular data.</p>

<p>In this tutorial we will explore the phylogenetic relationship between 19 MTBC strains and 1 strain of <em>M. canettii</em>, where the latter is included as outgroup, allowing us to root the phylogeny. Our starting point will be an alignment of all SNPs identified from whole-genome sequencing data of these 20 strains. This <em>SNP alignment</em> was generated by</p>

<ol>
  <li>mapping short sequenced reads from each sample to the infered sequence of the most recent common ancestor of the MTBC as the reference</li>
  <li>calling variants against that reference from the mapped reads of each sample</li>
  <li>incorporating the SNP variants of each sample into the reference to obtain a consensus genome of that sample</li>
  <li>combining the consensus genomes into a single multi-sequence fasta dataset</li>
  <li>discarding bases found to be identical in all samples from all sequences</li>
</ol>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-recommended-tutorials"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: Recommended tutorials</div>

  <p>Steps 1 and 2 are explained in detail in the tutorial <a href="/training-material/topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.html">MTB variant analysis</a>.
Steps 3 - 5 are conducted for the exact same 20 samples used here in the <a href="/training-material/topics/evolution/tutorials/mtb_transmission/tutorial.html">tutorial on transmission clusters</a>.</p>

  <p>If you want to gain a complete understanding of the whole process of sequencing-based analysis of MTBC strains, we recommend you, if you have not done so yet, to work through these two tutorials in the order above before continuing with this one here.</p>

</blockquote>

<p>Figure 3 shows a snapshot of an illustrative SNP alignment.
Each row in the alignment represents a different strain, each column a position in the reference genome.</p>

<figure id="figure-3" style="max-width: 90%;"><img src="./images/MEGA_alignment.png" alt="Alignment. " width="1478" height="840" loading="lazy" /><a target="_blank" href="./images/MEGA_alignment.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 3</strong>:</span> Illustrative example of a SNP alignment. Note the absence of conserved positions.</figcaption></figure>

<p>Because this alignment is based on SNPs, it contains <em>only variable positions</em>. This is important to keep in mind! Genetic distances between strains will be hugely overestimated if we leave out all the positions which show no variation!</p>

<p>Near the end of this tutorial, we will show and discuss ways to correct for this.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment-the-alternative-approach-genome-assembly"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment: The alternative approach: genome assembly</div>

  <p>A frequently used alternative approach to obtain a phylogeny from short read data is to a) assemble the genomes (see the numerous <a href="/training-material/topics/assembly/index.html">Galaxy tutorials</a> on this topic), b) annotate genes, c) extract genes present in all strains (the “core” genes), d) align the core genes. This approach underlies core genome multilocus sequence typing (cgMLST), which is often used to genotype bacterial pathogens (e.g. <span class="citation"><a href="#Zhou2021">Zhou <i>et al.</i> 2021</a></span>).</p>

</blockquote>

<p>With this bit of introduction you should, hopefully, be prepared to follow the flow and purpose of the analysis presented here.</p>

<blockquote class="agenda">
  <div class="box-title agenda-title" id="agenda">Agenda</div>

  <p>In this tutorial, we will cover:</p>

<ol id="markdown-toc">
  <li><a href="#basic-concepts-how-to-read-a-phylogeny" id="markdown-toc-basic-concepts-how-to-read-a-phylogeny">Basic concepts: How to read a phylogeny</a></li>
  <li><a href="#infering-phylogeny-from-snp-alignments" id="markdown-toc-infering-phylogeny-from-snp-alignments">Infering phylogeny from SNP alignments</a></li>
  <li><a href="#phylogenetic-analysis-of-mtbc-strains-with-galaxy-and-rstudio" id="markdown-toc-phylogenetic-analysis-of-mtbc-strains-with-galaxy-and-rstudio">Phylogenetic analysis of MTBC strains with Galaxy and Rstudio</a>    <ol>
      <li><a href="#get-the-data" id="markdown-toc-get-the-data">Get the data</a></li>
      <li><a href="#estimate-a-phylogeny" id="markdown-toc-estimate-a-phylogeny">Estimate a phylogeny</a></li>
      <li><a href="#visualize-and-manipulate-the-tree" id="markdown-toc-visualize-and-manipulate-the-tree">Visualize and manipulate the tree</a></li>
      <li><a href="#plot-the-raxml-output" id="markdown-toc-plot-the-raxml-output">Plot the RAxML output</a></li>
      <li><a href="#root-the-tree" id="markdown-toc-root-the-tree">Root the tree</a></li>
      <li><a href="#create-tree-with-lineage-as-tip-label-instead-of-strain-name" id="markdown-toc-create-tree-with-lineage-as-tip-label-instead-of-strain-name">Create tree with lineage as tip label instead of strain name</a></li>
      <li><a href="#first-round-of-exercises" id="markdown-toc-first-round-of-exercises">First round of exercises</a></li>
      <li><a href="#map-a-trait-onto-the-tree" id="markdown-toc-map-a-trait-onto-the-tree">Map a trait onto the tree</a></li>
      <li><a href="#exercises-continued" id="markdown-toc-exercises-continued">Exercises continued</a></li>
      <li><a href="#date-the-phylogeny-advanced" id="markdown-toc-date-the-phylogeny-advanced">Date the phylogeny (advanced)</a></li>
      <li><a href="#final-exercise" id="markdown-toc-final-exercise">Final exercise</a></li>
    </ol>
  </li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
  <li><a href="#resources" id="markdown-toc-resources">Resources</a>    <ol>
      <li><a href="#books" id="markdown-toc-books">Books</a></li>
      <li><a href="#useful-links" id="markdown-toc-useful-links">Useful links</a></li>
    </ol>
  </li>
</ol>

</blockquote>

<h1 id="phylogenetic-analysis-of-mtbc-strains-with-galaxy-and-rstudio">Phylogenetic analysis of MTBC strains with Galaxy and Rstudio</h1>

<h2 id="get-the-data">Get the data</h2>

<p>If you have worked at least through the first part of the <a href="/training-material/topics/evolution/tutorials/mtb_transmission/tutorial.html">tutorial on transmission clusters</a> before coming here, you are all set.</p>

<p>You can continue working in the same history you created for the other tutorial, or copy the <em>SNP alignment</em> (the output of <strong>Finds SNP sites</strong> <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span>) over to a new one, and can safely skip the following first hands-on part.</p>

<p>If you are not interested in that other tutorial, here are the instructions for setting up a history for the analysis here, and for obtaining a copy of the SNP alignment from <a href="https://zenodo.org/record/6010176">Zenodo</a>.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-create-a-new-history-and-prepare-the-input-data"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Create a new history and prepare the input data</div>

  <ol>
    <li>
      <p>Create a new history for this analysis</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-creating-a-new-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-creating-a-new-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Creating a new history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>To create a new history simply click the <i class="fas fa-plus" aria-hidden="true"></i><span class="visually-hidden">new-history</span> icon at the top of the history panel:</p>   <p><img src="/training-material/shared/images/history_create_new.svg" alt="UI for creating new history" /></p>   <!-- the original drawing can be found here https://docs.google.com/drawings/d/1cCBrLAo4kDGic5QyB70rRiWJAKTenTU8STsKDaLcVU8/edit?usp=sharing --> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Give the history a suitable name</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-history"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-history" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Renaming a history</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ol>   <li>Click on <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which by default is “Unnamed history”)</li>   <li>Type the new name: <code class="language-plaintext highlighter-rouge">MTB tree thinking tutorial</code></li>   <li>Click on <strong>Save</strong></li>   <li>To cancel renaming, click the <i class="fas fa-undo" aria-hidden="true"></i><span class="visually-hidden">galaxy-undo</span> “Cancel” button</li> </ol>   <p>If you do not have the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> (<strong>Edit</strong>) next to the history name (which can be the case if you are using an older version of Galaxy) do the following:</p>   <ol>   <li>Click on <strong>Unnamed history</strong> (or the current name of the history) (<strong>Click to rename history</strong>) at the top of your history panel</li>   <li>Type the new name: <code class="language-plaintext highlighter-rouge">MTB tree thinking tutorial</code></li>   <li>Press <kbd>Enter</kbd></li> </ol> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p><span class="tool" data-tool="upload1" title="Upload tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Upload</strong></span> a version of the SNP alignment via this URL</p>

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://zenodo.org/record/6010176/files/SNP_alignment.fasta
</code></pre></div>      </div>

      <p>and make sure the dataset format is set to <code class="language-plaintext highlighter-rouge">fasta</code>.</p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-importing-via-links"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-importing-via-links" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Importing via links</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Copy the link location</li>   <li>     <p>Click <i class="fas fa-upload" aria-hidden="true"></i><span class="visually-hidden">galaxy-upload</span> <strong>Upload Data</strong> at the top of the tool panel</p>   </li>   <li>Select <i class="fa fa-edit" aria-hidden="true"></i><span class="visually-hidden">galaxy-wf-edit</span> <strong>Paste/Fetch Data</strong></li>   <li>     <p>Paste the link(s) into the text field</p>   </li>   <li>     <p>Change <strong>Type (set all):</strong> from “Auto-detect” to <code class="language-plaintext highlighter-rouge">fasta</code></p>   </li>   <li>     <p>Press <strong>Start</strong></p>   </li>   <li><strong>Close</strong> the window</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_replace_in_line/1.1.2" title="Replace Text in entire line tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Replace Text in entire line</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 1.1.2)</span> to clean up the aligned sequence names</p>

      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“File to process”</em>: the uploaded SNP alignment</li>
        <li>In <i class="far fa-plus-square" aria-hidden="true"></i><span class="visually-hidden">param-repeat</span> <em>“1. Replacement”</em>:
          <ul>
            <li><em>“Find pattern”</em>: <code class="language-plaintext highlighter-rouge">^(&gt;.+)\.fastq.*</code></li>
            <li><em>“Replace with”</em>: <code class="language-plaintext highlighter-rouge">\1</code></li>
          </ul>
        </li>
      </ul>

      <p>From just a brief inspection of the downloaded SNP alignment, you should see that the sequence names in that file carry a <code class="language-plaintext highlighter-rouge">.fastq.vcf</code> or <code class="language-plaintext highlighter-rouge">.fastq.gz.vcf</code> suffix on the actual sample names.
The above replacement operation, drops these unnecessary endings, which we would otherwise carry over to all outputs generated in the analysis.</p>
    </li>
    <li>
      <p>When the Replace Text tool run is finished, <strong>rename</strong> the output dataset to, for example, <strong>SNP alignment</strong></p>

      <!--SNIPPET-->
      <blockquote class="tip">   <div class="box-title tip-title" id="tip-renaming-a-dataset"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-renaming-a-dataset" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true"></i> <span>Tip: Renaming a dataset</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <ul>   <li>Click on the <i class="fas fa-pencil-alt" aria-hidden="true"></i><span class="visually-hidden">galaxy-pencil</span> <strong>pencil icon</strong> for the dataset to edit its attributes</li>   <li>In the central panel, change the <strong>Name</strong> field  to <code class="language-plaintext highlighter-rouge">SNP alignment</code></li>   <li>Click the <strong>Save</strong> button</li> </ul> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>
      <p>Take a look at the alignment</p>

      <p>Click on the dataset that you just renamed to expand it in the history, then click on <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> <strong>Visualize</strong> and try both, the “Editor” and the “Multiple Sequence Alignment”.</p>

      <p>Can you see one of the MTBC particularities mentioned above, the predominance of singletons?</p>

      <p>How many sites are there in the alignment?</p>

      <p>Also take a look at the M. canettii sequence: being the outgroup, it has a large number of SNPs.</p>
    </li>
  </ol>

</blockquote>

<h2 id="estimate-a-phylogeny">Estimate a phylogeny</h2>

<p>There are numerous methods to infer phylogenetic trees, but the most frequently used with large-scale molecular data are based on maximum likelihood and Bayesian inference. The details of how these methods construct trees from an alignment are beyond the scope of this introductory course. To be able to read trees, it is not necessary to know the statistical and computational details of how the trees are estimated. The books listed in the <a href="#resources">Resources</a> section provide in-depth introductions into the different principles of phylogenetic inference, in particular Baum &amp; Smith 2013 and Yang 2014.</p>

<p>In this tutorial, we will use the maximum likelihood method <a href="https://cme.h-its.org/exelixis/web/software/raxml/">RAxML</a> to estimate a phylogenetic tree for the 20 strains.</p>

<p>An aspect we ignore in this tutorial is the uncertainty involved in phylogenetic inference. While RAxML will deliver a single tree, not all aspects of this tree are equally well supported by the data. This uncertainty can be quantified through <strong>bootstrapping</strong>, a procedure where a large number of trees are estimated from random samples of the original data. If a certain split in the original tree is present in all the bootstrapped trees, then we can be confident about this split. Published phylogenies should always include a measure of uncertainty, while for this tutorial you will have to believe me that we are looking at a solid phylogeny…</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-estimate-a-phylogeny-for-20-mtbc-strains"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Estimate a phylogeny for 20 MTBC strains</div>

  <ol>
    <li><span class="tool" data-tool="toolshed.g2.bx.psu.edu/repos/iuc/raxml/raxml/8.2.12+galaxy0" title="Phyogenetic reconstruction with RAxML tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>Phyogenetic reconstruction with RAxML</strong> (<i class="fas fa-cubes" aria-hidden="true"></i> Galaxy version 8.2.12+galaxy0)</span> with the following parameters:
      <ul>
        <li><i class="far fa-file" aria-hidden="true"></i><span class="visually-hidden">param-file</span> <em>“Source file with aligned sequences”</em>: <code class="language-plaintext highlighter-rouge">output</code> (Input dataset)</li>
        <li><em>“Model type”</em>: <code class="language-plaintext highlighter-rouge">Nucleotide</code></li>
        <li><em>“RAxML options to use”</em>: <code class="language-plaintext highlighter-rouge">Required options only</code></li>
      </ul>
    </li>
    <li>
      <p>The RAxML output we are interested in is the <em>“Best-scoring ML tree”</em>.</p>

      <p>Select it in you Galaxy history and take a look at it with the different <i class="fas fa-chart-column" aria-hidden="true"></i><span class="visually-hidden">galaxy-barchart</span> visualization options offered by Galaxy.</p>

      <figure id="figure-4" style="max-width: 90%;"><img src="./images/tree_unrooted_galaxy_vis.png" alt="Unrooted tree Galaxy visualization. " width="500" height="746" loading="lazy" /><a target="_blank" href="./images/tree_unrooted_galaxy_vis.png" rel="noopener noreferrer"><small>Open image in new tab</small></a><br /><br /><figcaption><span class="figcaption-prefix"><strong>Figure 4</strong>:</span> (Unrooted) RAxML tree in Galaxy's Phylogenetic Tree Visualization</figcaption></figure>
    </li>
  </ol>

</blockquote>

<h2 id="visualize-and-manipulate-the-tree">Visualize and manipulate the tree</h2>

<p>Phylogenetic trees are great tools because they are at the same time quantitative (we can do calculations on branch lengths, estimate uncertainty of a tree topology etc.) and visually appealing, allowing to actually “see” biologically interesting patterns. Often this requires some tweaking of the tree, for example by coloring parts of the tree according to some background information we have about the samples.</p>

<p>We will use R to plot and manipulate the phylogeny obtained from RAxML. We will provide you with the exact code to produce the figures we need, and, conveniently, you can run this code from an RStudio session that you can start as an interactive tool inside Galaxy.</p>

<blockquote class="details">
  <div class="box-title details-title" id="details-can-i-use-my-own-coding-environment"><button class="gtn-boxify-button details" type="button" aria-controls="details-can-i-use-my-own-coding-environment" aria-expanded="true"><i class="fas fa-info-circle" aria-hidden="true" ></i> <span>Details: Can I use my own coding environment?</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

  <p>If you have worked with R or RStudio previously, feel free to use any kind of coding environment for exploring and manipulating the RAxML tree we have produced - just download it from your history and import it into any R session you have access to.</p>

</blockquote>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-starting-an-rstudio-session-and-setting-things-up"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Starting an RStudio session and setting things up</div>

  <ol>
    <li>
      <p>Note the dataset number (the number in front of and separated with a <strong>:</strong> from the dataset name) of the <em>“Best-scoring ML tree”</em> output of RAxML</p>
    </li>
    <li>
      <p>Run <span class="tool" data-tool="interactive_tool_rstudio" title="RStudio tool" aria-role="button"><i class="fas fa-wrench" aria-hidden="true"></i> <strong>RStudio</strong></span></p>

      <!--SNIPPET-->
      <blockquote class="notranslate hands_on">   <div class="box-title hands_on-title" id="hands-on-launch-rstudio"><i class="fas fa-pencil-alt" aria-hidden="true"></i> Hands-on: Launch RStudio</div>   <p>Depending on which server you are using, you may be able to run RStudio directly in Galaxy. If that is not available, RStudio Cloud can be an alternative.</p>   <blockquote class="tip">   <div class="box-title tip-title" id="tip-launch-rstudio-in-galaxy"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-launch-rstudio-in-galaxy" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Launch RStudio in Galaxy</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>Currently RStudio in Galaxy is only available on <a href="https://usegalaxy.eu">UseGalaxy.eu</a> and <a href="https://usegalaxy.org">UseGalaxy.org</a></p>   <ol>     <li>Open the Rstudio tool <i class="fas fa-wrench" aria-hidden="true"></i><span class="visually-hidden">tool</span> by clicking <a href="https://usegalaxy.eu/?tool_id=interactive_tool_rstudio">here to launch RStudio</a></li>     <li>Click Run Tool</li>     <li>The tool will start running and will stay running permanently</li>     <li>Click on the “User” menu at the top and go to “Active InteractiveTools” and locate the RStudio instance you started.</li>   </ol> </blockquote>   <blockquote class="tip">   <div class="box-title tip-title" id="tip-launch-rstudio-cloud-if-not-available-on-galaxy"><button class="gtn-boxify-button tip" type="button" aria-controls="tip-launch-rstudio-cloud-if-not-available-on-galaxy" aria-expanded="true"><i class="far fa-lightbulb" aria-hidden="true" ></i> <span>Tip: Launch RStudio Cloud if not available on Galaxy</span><span class="fold-unfold fa fa-minus-square"></span></button></div>   <p>If RStudio is not available on the Galaxy instance:</p>   <ol>     <li>Register for <a href="https://client.login.rstudio.cloud/oauth/login?show_auth=0&amp;show_login=1&amp;show_setup=1">RStudio Cloud</a>, or login if you already have an account</li>     <li>Create a new project</li>   </ol> </blockquote> </blockquote>
      <p><!--END_SNIPPET--></p>
    </li>
    <li>Install and use the <a href="https://cran.r-project.org/web/packages/ape/index.html">ape R package</a>
      <ol>
        <li>Click on the <strong>Terminal</strong> tab (at the top of the Rstudio window)</li>
        <li>
          <p>Execute the command: <code class="language-plaintext highlighter-rouge">conda install r-ape</code></p>

          <p>This will install the ape package into the environment of the running session.</p>
        </li>
        <li>
          <p>When the previous step has finished, switch back to the <strong>Console</strong> tab and run the command</p>

          <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"ape"</span><span class="p">)</span><span class="w">
</span></code></pre></div>          </div>

          <p>You might get a warning about R versions, which you can ignore.</p>
        </li>
      </ol>
    </li>
    <li>
      <p>Import the RAxML *“Best-scoring ML tree into the Rstudio session</p>

      <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">treefile</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gx_get</span><span class="p">(</span><span class="c1">###)</span><span class="w">
</span></code></pre></div>      </div>

      <p>where you have to replace <code class="language-plaintext highlighter-rouge">###</code> with the dataset number of the RAxML output in your history.</p>
    </li>
  </ol>

</blockquote>

<h2 id="plot-the-raxml-output">Plot the RAxML output</h2>

<p>We have now set up our R session and are ready to start exploring the tree interactively.</p>

<p>As a first step we would like to parse the tree information from the imported dataset and plot the tree.</p>

<blockquote class="comment">
  <div class="box-title comment-title" id="comment"><i class="far fa-comment-dots" aria-hidden="true" ></i> Comment</div>

  <p>If you are experienced with R, you are encouraged also to start playing with all the code from here on, to modify it, and to explore the numerous phylogenetics packages and functions available in R.</p>

</blockquote>

<blockquote class="hands-on">
  <div class="box-title hands-on-title" id="hands-on-parse-the-tree-and-plot-it"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Parse the tree and plot it</div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Parse the tree</span><span class="w">
</span><span class="n">tree</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.tree</span><span class="p">(</span><span class="n">treefile</span><span class="p">)</span><span class="w">
</span><span class="c1"># Plot it</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="question">
    <div class="box-title question-title" id="question"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <ol>
      <li>Take a look at the tree generated by RAxML. Is it rooted or unrooted? What is the strain far apart from all other strains?</li>
    </ol>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution: 1</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

      <p><a href="./images/tree_unrooted.svg" rel="noopener noreferrer"><img src="./images/tree_unrooted.svg" alt="Unrooted tree. " width="449" height="234" loading="lazy" /></a></p>

      <ol>
        <li>The tree is unrooted, and the outlier strain is <em>M. canettii</em>, our outgroup. The much longer branch leading to this strain shows that many SNPs separate <em>M. canettii</em> from the common ancestor of the MTBC.</li>
      </ol>

    </blockquote>
  </blockquote>
</blockquote>

<h2 id="root-the-tree">Root the tree</h2>

<p>To make the phylogeny more interpretable, we will now root the tree using the <em>M. canettii</em> strain as the outgroup, then exclude that strain, such that patterns <em>within</em> the MTBC become clearer.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-root-the-tree-and-drop-its-outgroup"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Root the tree and drop its outgroup</div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Root the tree</span><span class="w">
</span><span class="n">tree_rooted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">root</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="s2">"ERR313115"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Remove the outgroup to make distances within MTB clearer</span><span class="w">
</span><span class="n">tree_rooted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drop.tip</span><span class="p">(</span><span class="n">tree_rooted</span><span class="p">,</span><span class="w"> </span><span class="s2">"ERR313115"</span><span class="p">)</span><span class="w">
</span><span class="n">tree_rooted</span><span class="o">$</span><span class="n">root.edge</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.005</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_rooted</span><span class="p">,</span><span class="w"> </span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.6</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>

<p><a href="./images/tree_rooted.svg" rel="noopener noreferrer"><img src="./images/tree_rooted.svg" alt="Rooted tree. " width="522" height="429" loading="lazy" /></a></p>

<p>This already looks better, the tree topology stands out more clearly now, and we can identify groups of closely related strains.</p>

<h2 id="create-tree-with-lineage-as-tip-label-instead-of-strain-name">Create tree with lineage as tip label instead of strain name</h2>

<p>A first piece of information we now want to add to the phylogeny is to which lineage the strains belong. This will allow us to assess whether our tree is consistent with the known phylogeny of the MTBC, shown in Figure 1A, and to visualize which lineages are present in our sample. The information to which lineage a strain belongs can be found in the output of TB-profiler, as explained in the <a href="/training-material/topics/variant-analysis/tutorials/tb-variant-analysis/tutorial.html">tutorial on TB variant analysis</a>.</p>

<blockquote class="hands-on">
  <div class="box-title hands-on-title" id="hands-on-generate-a-tree-with-lineage-labels"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Generate a tree with lineage labels</div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Assign lineages to samples, as identified by TB-profiler</span><span class="w">

</span><span class="n">mtbc_lineages</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
  </span><span class="s2">"ERR181435"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L7"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR313115"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"canettii"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR551620"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L5"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR1203059"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L5"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2659153"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"orygis"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2704678"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2704679"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2704687"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L6"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR5987300"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR5987352"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L4"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362078"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362138"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362139"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L4"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362156"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362253"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362333"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362484"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L4"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362653"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"SRR998584"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"L5"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"SRR13046689"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bovis"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="c1"># Replace the tree labels</span><span class="w">
</span><span class="n">tree_lineages</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tree_rooted</span><span class="w">
</span><span class="n">tree_lineages</span><span class="o">$</span><span class="n">tip.label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">mtbc_lineages</span><span class="p">[</span><span class="n">tree_rooted</span><span class="o">$</span><span class="n">tip.label</span><span class="p">])</span><span class="w">

</span><span class="c1"># Define some colors for the lineages</span><span class="w">

</span><span class="n">color_code_lineages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
  </span><span class="n">L1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#ff00ff"</span><span class="p">,</span><span class="w">
  </span><span class="n">L2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0000ff"</span><span class="p">,</span><span class="w">
  </span><span class="n">L3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#a000cc"</span><span class="p">,</span><span class="w">
  </span><span class="n">L4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#ff0000"</span><span class="p">,</span><span class="w">
  </span><span class="n">L5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#663200"</span><span class="p">,</span><span class="w">
  </span><span class="n">L6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#00cc33"</span><span class="p">,</span><span class="w">
  </span><span class="n">L7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#ede72e"</span><span class="p">,</span><span class="w">
  </span><span class="n">bovis</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w">
  </span><span class="n">orygis</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span><span class="w">

</span><span class="n">pal_lineages</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">color_code_lineages</span><span class="p">[</span><span class="n">tree_lineages</span><span class="o">$</span><span class="n">tip.label</span><span class="p">])</span><span class="w">

</span><span class="c1"># Plot the old and new tree version next to each other</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_rooted</span><span class="p">,</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_lineages</span><span class="p">,</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">tip.color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal_lineages</span><span class="p">,</span><span class="w"> </span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

  <blockquote class="question">
    <div class="box-title question-title" id="question-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question</div>

    <p>Looking at the different lineages present in the tree, does our phylogeny make sense? Or asked differently: does our phylogeny show the same branching patterns between lineages as the established phylogeny in Fig. 1A?</p>

    <blockquote class="solution">
      <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution: 2</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

      <p><a href="./images/tree_rooted_lineages.svg" rel="noopener noreferrer"><img src="./images/tree_rooted_lineages.svg" alt="Colored lineages. " width="473" height="286" loading="lazy" /></a></p>

      <p>There is indeed a problem with our phylogeny: one L2 and one L5 strain do not cluster with the other strains of these lineages. Instead, they appear near the root of the tree, with very short (ERR5987300) to non-existent (ERR1203059) branches. Other parts of the tree are consistent with Fig. 1A, suggesting that we can focus our first round of troubleshooting on these two strains.</p>

    </blockquote>
  </blockquote>
</blockquote>

<h2 id="first-round-of-exercises">First round of exercises</h2>

<blockquote class="question">
  <div class="box-title question-title" id="question-exercise-1"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Exercise 1</div>

  <p>An important part of bioinformatics consists in trying to find out whether a surprising observation has biological significance — or reflects a mistake somewhere in the numerous steps leading to the result. Have we just discovered two new lineages of MTB, or did we commit a stupid mistake? To find out, take a look a the TB-profiler and the VCF files for the two strange strains, which should be present in your Galaxy history if you’ve followed the previous tutorial. Compare them with “normal” strains. Do you notice something?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution"><button class="gtn-boxify-button solution" type="button" aria-controls="solution" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>The VCF files hold an important hint to explain our puzzling observation: ERR1203059.vcf contains not a single SNP, ERR5987300.vcf only 81 SNPs. By contrast, the other strains have between 750 and 1250 SNPs. What happened here? To find out, we would have to take a closer look at the steps leading from BAM to VCF files. One possibility is that the sequencing depth for these samples was so low that most SNPs were filtered out because they did not pass the quality filtering.</p>

  </blockquote>

</blockquote>

<blockquote class="question">
  <div class="box-title question-title" id="question-exercise-2"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Exercise 2</div>

  <p>In the <a href="/training-material/topics/evolution/tutorials/mtb_transmission/tutorial.html">tutorial on transmission clusters</a> two clusters of samples got identified and are reproduced below. How do these clusters show up in the phylogenetic tree? What additional information does the tree contain?</p>

  <table>
    <thead>
      <tr>
        <th>Sample</th>
        <th>Cluster_id</th>
        <th>DR profile</th>
        <th>Clustering</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ERR5987352</td>
        <td>10</td>
        <td>Pre-MDR</td>
        <td>Clustered</td>
      </tr>
      <tr>
        <td>ERR6362484</td>
        <td>10</td>
        <td>Pre-MDR</td>
        <td>Clustered</td>
      </tr>
      <tr>
        <td>ERR6362138</td>
        <td>12</td>
        <td>MDR</td>
        <td>Clustered</td>
      </tr>
      <tr>
        <td>ERR6362156</td>
        <td>12</td>
        <td>Pre-XDR</td>
        <td>Clustered</td>
      </tr>
      <tr>
        <td>ERR6362253</td>
        <td>12</td>
        <td>MDR</td>
        <td>Clustered</td>
      </tr>
    </tbody>
  </table>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-1"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-1" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p>Clusters 10 and 12 appear as clades of closely related strains in the phylogeny: cluster 12 being part of lineage 2, cluster 10 of lineage 4. The phylogeny additionally reveals that cluster 12 is part of a larger clade of rather closely related lineage 2 strains. While clustering with a fixed SNP threshold produces a binary outcome (clustered/unclustered), the phylogeny reveals the gradual nature of relatedness. With a more permissive SNP threshold for clustering, or a different pipeline to call SNPs, we might well identify a larger cluster of L2 strains.</p>

  </blockquote>

</blockquote>

<h2 id="map-a-trait-onto-the-tree">Map a trait onto the tree</h2>

<p>Phylogenies are particularly useful when combined with additional information. For our 19 MTB strains, for example, we might know such things as the country of origin, the sampling date, or various phenotypes determined in the lab, for example the virulence of the strains in an animal model. By mapping this additional information onto the phylogeny, we can gain insights into how, where and when these traits evolved.</p>

<p>For our 20 samples, a trait you previously identified (if you have been doing the <a href="/training-material/topics/evolution/tutorials/mtb_transmission/tutorial.html">tutorial on transmission clusters</a>, is the DR profile. Let us map this trait onto the tree and see if we can learn something from the observed patterns.</p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-generate-a-tree-with-dr-profiles-as-labels"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Generate a tree with DR profiles as labels</div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Same as before, but with DR profiles instead of lineages</span><span class="w">

</span><span class="n">mtbc_dr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
  </span><span class="s2">"ERR181435"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR313115"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR551620"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR1203059"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2659153"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2704678"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2704679"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR2704687"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR5987300"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PreXDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR5987352"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PreMDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362078"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362138"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362139"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PreMDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362156"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PreXDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362253"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362333"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PreXDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362484"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PreMDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"ERR6362653"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MDR"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"SRR998584"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sensitive"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"SRR13046689"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Other"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">tree_dr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tree_rooted</span><span class="w">
</span><span class="n">tree_dr</span><span class="o">$</span><span class="n">tip.label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">mtbc_dr</span><span class="p">[</span><span class="n">tree_rooted</span><span class="o">$</span><span class="n">tip.label</span><span class="p">])</span><span class="w">

</span><span class="n">color_code_dr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
  </span><span class="n">Sensitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#ff00ff"</span><span class="p">,</span><span class="w">
  </span><span class="n">PreXDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#0000ff"</span><span class="p">,</span><span class="w">
  </span><span class="n">PreMDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#a000cc"</span><span class="p">,</span><span class="w">
  </span><span class="n">MDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#ff0000"</span><span class="p">,</span><span class="w">
  </span><span class="n">Other</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#663200"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">pal_dr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">color_code_dr</span><span class="p">[</span><span class="n">tree_dr</span><span class="o">$</span><span class="n">tip.label</span><span class="p">])</span><span class="w">

</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_rooted</span><span class="p">,</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_dr</span><span class="p">,</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">tip.color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal_dr</span><span class="p">,</span><span class="w"> </span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>

</blockquote>

<h2 id="exercises-continued">Exercises continued</h2>

<blockquote class="question">
  <div class="box-title question-title" id="question-exercise-3"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Exercise 3</div>

  <p>In the previous tutorial on clustering, you have come across the hypothesis that unclustered cases of DR represent <em>de novo</em> evolution of DR, while clustered cases of DR represent instances of DR transmission. Looking at lineage 2 in the phylogeny above, does this hypothesis hold? How many times would MDR have evolved independently in lineage 2? Is there an alternative explanation for the prevalence of MDR in lineage 2?</p>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-2"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-2" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <p><a href="./images/tree_rooted_dr.svg" rel="noopener noreferrer"><img src="./images/tree_rooted_dr.svg" alt="Colored DR profiles. " width="490" height="286" loading="lazy" /></a></p>

    <p>MDR would have evolved three times according to the clustering perspective mentioned above: once in cluster 12, once in ERR6362078, and once in ERR6362653. The phylogeny suggest a simpler alternative: MDR could have been already present in the common ancestor of the six L2 strains in our sample; it could have evolved only once, along the long branch leading from the split from lineage 3 to the most recent common ancestor of the six samples. This picture, however, might change with a more extensive sampling of lineage 2. Six samples are hardly sufficient to make claims about the prevalence and evolution of MDR in lineage 2. As for the interpretation of clustering, sampling design is crucial for the interpretation of phylogenies and should always be kept in mind in order to avoid overinterpretation.</p>

  </blockquote>

</blockquote>

<h2 id="date-the-phylogeny-advanced">Date the phylogeny (advanced)</h2>

<p>As a last exercise, we are going to put a timescale on our phylogeny, assuming that mutations accumulate in a regular, clock-wise manner. In the tree, phylogenetic distance = time*rate. As we know the phylogenetic distance, we can get an estimate of time by assuming a mutation rate. This sounds simple in theory, but will require some big assumptions:</p>

<ul>
  <li>
    <p>As noted above, the starting alignment only contains variable positions, phylogenetic distances in the trees are thus overestimated. To correct for this, we assume that all other sites in the genome are invariant, and rescale branch lengths according to <code class="language-plaintext highlighter-rouge">rescaled branch lengths = (branch lengths * alignment length) / genome size</code>, as in <span class="citation"><a href="#Menardo2019">Menardo <i>et al.</i> 2019</a></span>.</p>
  </li>
  <li>
    <p>We assume that all strains were sampled at time point 0, in the present.</p>
  </li>
  <li>
    <p>We assume a mutation rate of 2.01e-10 mutations per site per generation (<span class="citation"><a href="#Ford2013">Ford <i>et al.</i> 2013</a></span>)</p>
  </li>
  <li>
    <p>To translate generations into years, we assume 200 generations per year.</p>
  </li>
</ul>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-rescale-branches"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Rescale branches</div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Rescale branch lengths (here called edge lenghts)</span><span class="w">
</span><span class="n">genome_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4411532</span><span class="w">
</span><span class="n">alignment_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18077</span><span class="w">
</span><span class="n">invariant_sites</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genome_size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">alignment_length</span><span class="w">

</span><span class="n">tree_rescaled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tree_rooted</span><span class="w">
</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">edge.length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">((</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">edge.length</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">alignment_length</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">genome_size</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">root.edge</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">((</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">root.edge</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">alignment_length</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">genome_size</span><span class="w"> </span><span class="p">)</span><span class="w">

</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_rooted</span><span class="p">,</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="w"> </span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"original"</span><span class="p">)</span><span class="w">
</span><span class="n">axisPhylo</span><span class="p">()</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_rescaled</span><span class="p">,</span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">,</span><span class="n">root.edge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rescaled"</span><span class="p">)</span><span class="w">
</span><span class="n">axisPhylo</span><span class="p">()</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>

</blockquote>

<p>Look at the scale bars of the two trees. Accounting for invariable sites has a huge effect on phylogenetic distances!</p>

<p><a href="./images/tree_rescaled.svg" rel="noopener noreferrer"><img src="./images/tree_rescaled.svg" alt="Rescaled phylogeny. " width="436" height="300" loading="lazy" /></a></p>

<blockquote class="notranslate hands_on">
  <div class="box-title hands-on-title" id="hands-on-remove-outliers-perform-dates-estimation-and-plot-with-time-scale"><i class="fas fa-pencil-alt" aria-hidden="true" ></i> Hands-on: Remove outliers, perform dates estimation and plot with time-scale</div>

  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Let's also remove the two outlier strains, they would cause troubles and are anyway useless</span><span class="w">
</span><span class="n">tree_rescaled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">drop.tip</span><span class="p">(</span><span class="n">tree_rescaled</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"ERR1203059"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ERR5987300"</span><span class="p">))</span><span class="w">

</span><span class="c1"># Estimate dates: translate phylogenetic distance into years by assuming a mutation rate and the number of generations per year</span><span class="w">
</span><span class="n">mutation_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.01e-10</span><span class="w">
</span><span class="n">generations_per_year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">200</span><span class="w">

</span><span class="c1">## Ape has a function, estimate.dates(), to date a tree by assuming a specific mutation rate</span><span class="w">
</span><span class="n">node.date</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">estimate.dates</span><span class="p">(</span><span class="w">
  </span><span class="n">tree_rescaled</span><span class="p">,</span><span class="w">
  </span><span class="n">node.dates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">tip.label</span><span class="p">)),</span><span class="w"> </span><span class="c1"># set sampling dates to 0</span><span class="w">
  </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mutation_rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">generations_per_year</span><span class="p">)</span><span class="w"> </span><span class="c1"># mutation rate per year</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">edge.length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">node.date</span><span class="p">[</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">edge</span><span class="p">[,</span><span class="w"> </span><span class="m">2</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">node.date</span><span class="p">[</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">edge</span><span class="p">[,</span><span class="w"> </span><span class="m">1</span><span class="p">]]</span><span class="w">
</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">tip.label</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="n">mtbc_lineages</span><span class="p">[</span><span class="n">tree_rescaled</span><span class="o">$</span><span class="n">tip.label</span><span class="p">])</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">tree_rescaled</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Dated phylogeny (years)"</span><span class="p">)</span><span class="w">
</span><span class="n">axisPhylo</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>

</blockquote>

<p><a href="./images/tree_dated.svg" rel="noopener noreferrer"><img src="./images/tree_dated.svg" alt="Dated phylogeny. " width="406" height="333" loading="lazy" /></a></p>

<h2 id="final-exercise">Final exercise</h2>

<blockquote class="question">
  <div class="box-title question-title" id="question-exercise-4-advanced"><i class="far fa-question-circle" aria-hidden="true" ></i> Question: Exercise 4 (advanced)</div>

  <ol>
    <li>
      <p>What could be the problem with the assumption that all sites in the reference genome which do not appear in our SNP alignment are invariable?</p>
    </li>
    <li>
      <p>Imagine that a recent breakthrough study has found that the mutation rate in MTB is 10 times higher than we assumed. How would this change the estimated dates?</p>
    </li>
  </ol>

  <blockquote class="solution">
    <div class="box-title solution-title" id="solution-3"><button class="gtn-boxify-button solution" type="button" aria-controls="solution-3" aria-expanded="true"><i class="far fa-eye" aria-hidden="true" ></i> <span>Solution</span><span class="fold-unfold fa fa-minus-square"></span></button></div>

    <ol>
      <li>
        <p>About 5 % of the MTB reference genome consists of repetitive or otherwise complicated regions where mapping and SNP calling cannot be done reliably. Most SNP calling pipelines exclude such regions, also the one used in this course. Rather than to assume that these regions are invariant, we should ignore them in our calculations. By not doing this, genomes seem more similar than they are; we underestimate phylogenetic distances.</p>
      </li>
      <li>
        <p>A rate 10 times higher implies that there will be 10 times more mutations observed in the same time span, or, the other way around, that it will take a time span 10 times shorter to observe the same number of mutations. The timescale of the phylogeny would thus shift one order of magnitude, to hundreds rather than thousands of years. As this example shows, there are considerable uncertainties associated with molecular dating. This is also true for more sophisticated methods (see <span class="citation"><a href="#Menardo2019">Menardo <i>et al.</i> 2019</a></span> for a recent discussion of molecular dating with MTB).</p>
      </li>
    </ol>

  </blockquote>

</blockquote>

<h1 id="conclusion">Conclusion</h1>

<p>Any phylogenetic analysis requires careful exploration of results and an understanding of its limitations to avoid overinterpretaion. The combination of Galaxy and R accessed through an interactive tool is very powerful because the Galaxy platform provides the compute resources and tools necessary to calculate the phylogenetic tree, and offers straightforward access to RStudio. The flexibility of R and its packages then lets you take a deep dive into the results.</p>

<h1 id="resources">Resources</h1>
<p>To develop a deeper understanding of phylogenetic trees, there is no better way than estimating phylogenies yourself — and work through a book on the topic in your own mind’s pace.</p>

<h2 id="books">Books</h2>
<ul>
  <li><em>Phylogenetics in the genomics era</em>, 2020. An <a href="https://hal.inria.fr/PGE">open access book</a> covering a variety of contemporary topics.</li>
  <li><em>Tree Thinking</em>, 2013, by David A. Baum &amp; Stacey D. Smith</li>
  <li><em>Molecular Evolution</em>, 2014, by Ziheng Yang</li>
</ul>

<h2 id="useful-links">Useful links</h2>
<ul>
  <li><a href="https://megasoftware.net/">MEGA Software</a></li>
  <li><a href="https://artic.network/how-to-read-a-tree.html">Tutorial on how to read a tree, with a virus example</a></li>
  <li><a href="http://tolweb.org">Tree Of Life web project</a></li>
  <li><a href="https://plato.stanford.edu/entries/phylogenetic-inference/">Phylogenetic Inference in the Stanford Encyclopedia</a></li>
</ul>

                </section>

                <section aria-label="Tutorial Footer, Feedback, Citation" id="tutorial-footer">
                        <h3>You've Finished the Tutorial</h3>
                        <button id="tutorial-finish-button" class="btn btn-primary" onclick="tutorial_finish()">I finished this tutorial 👍</button>
                        <p style="display: none" id="tutorial-finish-text">Please also consider filling out the <a href="#gtn-feedback">Feedback Form</a> as well!</p>
                        <script>
                        function tutorial_finish() {
                          if(typeof plausible !== 'undefined'){
                            // Plausible may be undefined (script blocked)
                            // or it may be defined, but opted-out (select box/DNT),
                            // which means `plausible()` will work but not send data, *nor* execute the callback.
                            plausible('TutorialComplete', {props: {path: document.location.pathname}})
                          }
                          // since the callback is completely cosmetic, we'll just issue it optimistically.
                          tutorial_finish_finish();
                        }
                        function tutorial_finish_finish() {
                          document.getElementById("tutorial-finish-button").innerText = 'Congrats! Thanks for letting us know! 🎉'
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-button").disabled = true
                          document.getElementById("tutorial-finish-text").style.display = 'block'
                        }
                        </script>

                

                <h1>Frequently Asked Questions</h1>
                Have questions about this tutorial? Check out the  <a href="/training-material/topics/evolution/faqs/">FAQ page for the Evolution topic</a> to see if your question is listed there.
                If not, please ask your question on the <a href="https://gitter.im/Galaxy-Training-Network/Lobby">GTN Gitter Channel</a> or the
                <a href="https://help.galaxyproject.org">Galaxy Help Forum</a>

                

                


                
                <h1 id="bibliography">References</h1>
                <ol class="bibliography"><li id="Ford2013">Ford, C. B., R. R. Shah, M. K. Maeda, S. Gagneux, M. B. Murray <i>et al.</i>, 2013 <b>Mycobacterium tuberculosis mutation rate estimates from different lineages predict substantial differences in the emergence of drug-resistant tuberculosis</b>. Nature Genetics 45: 784–790. <a href="https://doi.org/10.1038/ng.2656">10.1038/ng.2656</a></li>
<li id="Eldholm2016">Eldholm, V., J. H.-O. Pettersson, O. B. Brynildsrud, A. Kitchen, E. M. Rasmussen <i>et al.</i>, 2016 <b>Armed conflict and population displacement as drivers of the evolution and dispersal of \lessi\greaterMycobacterium tuberculosis\less/i\greater</b>. Proceedings of the National Academy of Sciences 113: 13881–13886. <a href="https://doi.org/10.1073/pnas.1611283113">10.1073/pnas.1611283113</a></li>
<li id="Goig2018">Goig, G. A., S. Blanco, A. L. Garcia-Basteiro, and I. Comas, 2018 <b>Contaminant DNA in bacterial sequencing experiments is a major source of false genetic variability</b>. <a href="https://doi.org/10.1101/403824">10.1101/403824</a></li>
<li id="Menardo2019">Menardo, F., S. Duchêne, D. Brites, and S. Gagneux, 2019 <b>The molecular clock of Mycobacterium tuberculosis</b> (R. Biek, Ed.). PLOS Pathogens 15: e1008067. <a href="https://doi.org/10.1371/journal.ppat.1008067">10.1371/journal.ppat.1008067</a></li>
<li id="Zhou2021">Zhou, Z., J. Charlesworth, and M. Achtman, 2021 <b>HierCC: a multi-level clustering scheme for population assignments based on core genome MLST</b> (J. Kelso, Ed.). Bioinformatics 37: 3645–3646. <a href="https://doi.org/10.1093/bioinformatics/btab234">10.1093/bioinformatics/btab234</a></li></ol>
                

                

                <h1 id="gtn-feedback">Feedback</h1>
                <p class="text-muted">Did you use this material as an instructor? Feel free to give us feedback on <a href="https://github.com/galaxyproject/training-material/issues/1452">how it went</a>.
                <br>Did you use this material as a learner or student? Click the form below to leave feedback.<i class="fas fa-hand-point-down"></i>
                </p>

                <iframe id="feedback-google" class="google-form" src="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=evolution/mtb_phylogeny"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4VZptFTQ03kHkMz0JyW9b6_S8geU5KjNE_tLM0dixT3ZQmA/viewform?embedded=true&entry.1235803833=evolution/mtb_phylogeny">Feedback Form</a></iframe>

                <h1>Citing this Tutorial</h1>
                <p>
                    <ol>
                        <li id="citation-text">
                            Christoph Stritt, Daniela Brites, Galo A. Goig,  <b>Tree thinking for tuberculosis evolution and epidemiology (Galaxy Training Materials)</b>. <a href="https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_phylogeny/tutorial.html">https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_phylogeny/tutorial.html</a> Online; accessed TODAY
                        </li>
                        <li>
                        Hiltemann, Saskia, Rasche, Helena et al., 2023 <b>Galaxy Training: A Powerful Framework for Teaching!</b> PLOS Computational Biology <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010752">10.1371/journal.pcbi.1010752</a>
                        </li>
                        <li>
                        Batut et al., 2018 <b>Community-Driven Data Analysis Training for Biology</b> Cell Systems <a href="https://doi.org/10.1016%2Fj.cels.2018.05.012">10.1016/j.cels.2018.05.012</a>
                        </li>
                    </ol>
                </p>

                <!-- collapsible boxcontaining the BibTeX-formatted citation -->
                <blockquote class="details">

                  <div id="citation-bibtex" class="box-title">
                    <button type="button" aria-controls="citation-bibtex" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> BibTeX<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>
                   <p style="display: none;">

                   <div class="highlighter-rouge"><div class="highlight"><pre class="highlight">


<code id="citation-code">@misc{evolution-mtb_phylogeny,
author = "Christoph Stritt and Daniela Brites and Galo A. Goig",
	title = "Tree thinking for tuberculosis evolution and epidemiology (Galaxy Training Materials)",
	year = "",
	month = "",
	day = ""
	url = "\url{https://training.galaxyproject.org/training-material/topics/evolution/tutorials/mtb_phylogeny/tutorial.html}",
	note = "[Online; accessed TODAY]"
}
@article{Hiltemann_2023,
	doi = {10.1371/journal.pcbi.1010752},
	url = {https://doi.org/10.1371%2Fjournal.pcbi.1010752},
	year = 2023,
	month = {jan},
	publisher = {Public Library of Science ({PLoS})},
	volume = {19},
	number = {1},
	pages = {e1010752},
	author = {Saskia Hiltemann and Helena Rasche and Simon Gladman and Hans-Rudolf Hotz and Delphine Larivi{\`{e}}re and Daniel Blankenberg and Pratik D. Jagtap and Thomas Wollmann and Anthony Bretaudeau and Nadia Gou{\'{e}} and Timothy J. Griffin and Coline Royaux and Yvan Le Bras and Subina Mehta and Anna Syme and Frederik Coppens and Bert Droesbeke and Nicola Soranzo and Wendi Bacon and Fotis Psomopoulos and Crist{\'{o}}bal Gallardo-Alba and John Davis and Melanie Christine Föll and Matthias Fahrner and Maria A. Doyle and Beatriz Serrano-Solano and Anne Claire Fouilloux and Peter van Heusden and Wolfgang Maier and Dave Clements and Florian Heyl and Björn Grüning and B{\'{e}}r{\'{e}}nice Batut and},
	editor = {Francis Ouellette},
	title = {Galaxy Training: A powerful framework for teaching!},
	journal = {PLoS Comput Biol} Computational Biology}
}
</code>
                   </pre></div></div>
                   </p>
                </blockquote>

        


<script>
// update the date on load, or leave fallback of 'today'
const citationTodaysDate = new Date();
document.getElementById("citation-code").innerHTML = document.getElementById("citation-code").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
document.getElementById("citation-text").innerHTML = document.getElementById("citation-text").innerHTML.replace("TODAY", citationTodaysDate.toDateString());
</script>

                <i class="far fa-thumbs-up" aria-hidden="true"></i> Congratulations on successfully completing this tutorial!

                

                

		
                <blockquote class="details follow-up" id="admins-install-missing-tools">
                  <div id="admin-missing-tools" class="box-title">
                    <button type="button" aria-controls="admin-missing-tools" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Galaxy Administrators: Install the missing tools<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>


			<p>You can use Ephemeris's <code>shed-tools install</code> command to install the tools used in this tutorial.</p>
<div class="highlight"><pre class="highlight"><code>shed-tools install [-g GALAXY] [-a API_KEY] -t &lt;(curl https://training.galaxyproject.org/training-material/api/topics/evolution/tutorials/mtb_phylogeny/tutorial.json | jq .admin_install_yaml -r)</code></pre></div>
<p>Alternatively you can copy and paste the following YAML</p>
<div class="highlight"><pre class="highlight"><code>---
install_tool_dependencies: true
install_repository_dependencies: true
install_resolver_dependencies: true
tools:
- name: raxml
  owner: iuc
  revisions: ea30d3089354
  tool_panel_section_label: Phylogenetics
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
- name: raxml
  owner: iuc
  revisions: 73a469f7dc96
  tool_panel_section_label: Phylogenetics
  tool_shed_url: https://toolshed.g2.bx.psu.edu/
</code></pre></div>
                </blockquote>
		

		<blockquote class="details hide-when-printing" id="feedback-responses">
                  <div id="feedback-response-c" class="box-title">
                    <button type="button" aria-controls="feedback-response-c" aria-expanded="false">
                      <i class="fas fa-info-circle" aria-hidden="true"></i>
                      <span class="visually-hidden"></span> Feedback<span role="button" class="fold-unfold fa fa-minus-square" aria-hidden="true"></span>
                    </button>
                   </div>

		   <p>
		   
		   <table class="charts-css bar show-labels" style="--labels-size: 8rem; overflow-y: hidden">
		   
			<tr>
				<th scope="row"><span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 1.0">5</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.2">1</td>
			</tr>
		   
			<tr>
				<th scope="row"><span class="sr-only">2 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i></th>
				<td style="--size: 0.2">1</td>
			</tr>
		   
		   </table>
		   </p>
		
        
        
		    
		    <b>June 2024</b>
		    <ul>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: the ease of using RStudio to manipulate the phylogenetic tree
					<b>Disliked</b>: It would have been an added bonus to show how to map multiple metadata (origin, time of sampling, DR-mutation, etc...at the same time)  on the tree in R.
				</li>
				
		    </ul>
		    
		    <b>October 2023</b>
		    <ul>
				
				<li>
					<span class="sr-only">4 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: How to develop and analyse a phylogenetic tree
					
				</li>
				
				<li>
					<span class="sr-only">5 stars</span><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>:
					<b>Liked</b>: The pipelines
					<b>Disliked</b>: Time to go through all tutorial.
				</li>
				
		    </ul>
		    
        
		</blockquote>




		
		
		

                </section>

            </div>
        </div>
    </div>
</article>
<br/>
<br/>
<br/>

        </div>
        <footer>
	<hr />
	<div class="container">
		<div class="row">
			<div class="col-sm-3">
				<span style="font-size: 2em">GTN</span>
				<p>
					The GTN provides researchers with a free, open repository of online training
					materials, with a focus on hands-on training that aims to be directly applicable for learners.
					We aim to connect researchers and learners with local trainers, and events worldwide.
				</p>
				<p>
					We promote FAIR and Open Science practices worldwide, are committed to the accessibility of this platform and training for everyone.
				</p>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">About Us</span>
				<ul class="no-bullets">
					<li><a href="/training-material/faqs/gtn/gtn-what-is-it.html">About</a></li>
					<li><a rel="code-of-conduct" href="https://galaxyproject.org/community/coc/">Code of Conduct</a></li>
					<li><a href="/training-material/accessibility.html">Accessibility</a></li>
					<li><a href="/training-material/faqs/gtn/fair_training.html">100% FAIR Training</a></li>
					<li><a href="/training-material/faqs/gtn/collaborative_development.html">Collaborative Development</a></li>
				</ul>
				<span style="font-size: 1.3em">Page</span>
				<ul class="no-bullets">
					
					<li><i class="fas fa-fingerprint" aria-hidden="true"></i><span class="visually-hidden">purl</span><abbr title="Persistent URL">PURL</abbr>: <a href="https://gxy.io/GTN:T00144">gxy.io/GTN:T00144</a></li>
					

					

					<li>
						<a rel="license" href="https://spdx.org/licenses/CC-BY-4.0">
							Content licensed under Creative Commons Attribution 4.0 International License
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/edit/main/topics/evolution/tutorials/mtb_phylogeny/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> Edit on GitHub
						</a>
					</li>
					<li>
						<a href="https://github.com/galaxyproject/training-material/commits/main/topics/evolution/tutorials/mtb_phylogeny/tutorial.md">
						<i class="fab fa-github" aria-hidden="true"></i><span class="visually-hidden">github</span> View Changes on GitHub
						</a>
					</li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Support</span>
				<ul class="no-bullets">
					<li><a rel="me" href="/training-material/faqs/galaxy/">Galaxy FAQs</a></li>
					<li><a rel="me" href="https://help.galaxyproject.org">Galaxy Help Forum</a></li>
					<li><a rel="me" href="http://gxy.io/gtn-slack">GTN Slack Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/%23Galaxy-Training-Network_Lobby%3Agitter.im">GTN Matrix Chat</a></li>
					<li><a rel="me" href="https://matrix.to/#/#galaxyproject_Lobby:gitter.im">Galaxy Matrix Chat</a></li>
				</ul>
				<span style="font-size: 1.3em">Framework</span>
				<ul class="no-bullets">
					<li>Revision <a href="https://github.com/galaxyproject/training-material/commit/a66aac79f9b4ad1679bbe669de6e367461819e29">a66aac7</a></li>
					<li><a rel="license" href="https://github.com/galaxyproject/training-material/blob/main/LICENSE.md">MIT</a> Licensed</li>
					<li><a href="https://jekyllrb.com/">Jekyll(4.3.2 | production)</a></li>
				</ul>
			</div>
			<div class="col-sm-3">
				<span style="font-size: 1.3em">Follow Us!</span>
				<ul class="no-bullets">
					<li><span style="fill: var(--hyperlink);"><?xml version="1.0" encoding="UTF-8" standalone="no"?><svg   width="1em"   height="1em"   viewBox="0 0 8.4937906 9.1084023"   version="1.1"   id="svg356"   xmlns="http://www.w3.org/2000/svg"   xmlns:svg="http://www.w3.org/2000/svg">  <g     id="layer1"     transform="translate(-70.566217,-144.26757)">    <path       style="fill-opacity:1;stroke:none;stroke-width:0.0179182"       d="m 76.39081,152.24155 c -0.737138,0.20763 -1.554999,0.29101 -2.311453,0.14333 -0.475335,-0.0928 -0.891898,-0.32923 -1.031589,-0.82423 -0.04356,-0.15434 -0.06132,-0.32388 -0.06142,-0.48378 0.353724,0.0457 0.702251,0.1304 1.057176,0.17407 0.701338,0.0864 1.394702,0.0784 2.096434,0.008 0.744056,-0.0745 1.433711,-0.21546 2.060598,-0.64854 0.243974,-0.16855 0.474672,-0.39133 0.603487,-0.66252 0.181421,-0.38195 0.175886,-0.89336 0.204447,-1.30803 0.0923,-1.34029 0.20588,-2.98599 -1.076708,-3.846 -0.499561,-0.33497 -1.208891,-0.39913 -1.791824,-0.45742 -0.987026,-0.0987 -1.971078,-0.0946 -2.956509,0.0338 -0.841146,0.10961 -1.595223,0.31468 -2.1065,1.0443 -0.493296,0.70396 -0.509564,1.52563 -0.509564,2.34729 0,1.37831 -0.05534,2.87744 0.595934,4.13911 0.504703,0.97774 1.498709,1.29589 2.52184,1.41832 0.473239,0.0566 0.96049,0.0849 1.434158,0.0172 0.328853,-0.0471 0.650325,-0.0999 0.966886,-0.20511 0.08957,-0.0298 0.266911,-0.0614 0.322027,-0.14486 0.04089,-0.0618 0.0099,-0.15812 0.0035,-0.22545 -0.01611,-0.16924 -0.02094,-0.34967 -0.02096,-0.51963 m -1.594723,-5.48298 c 0.214822,-0.25951 0.315898,-0.56088 0.60922,-0.75705 0.687899,-0.46006 1.692038,-0.11202 1.992096,0.63161 0.214571,0.5317 0.140174,1.15913 0.140174,1.72017 v 1.03925 c 0,0.0911 0.04009,0.30954 -0.01842,0.38339 -0.04193,0.053 -0.173018,0.0287 -0.232436,0.0287 h -0.698809 v -1.88142 c 0,-0.28413 0.04813,-0.63823 -0.09912,-0.89591 -0.234746,-0.4108 -0.875019,-0.36105 -1.092116,0.0358 -0.123368,0.22555 -0.116792,0.50369 -0.116792,0.75257 v 1.0751 h -0.931726 v -1.05718 c 0,-0.2555 0.0024,-0.53932 -0.121773,-0.77049 -0.21432,-0.39919 -0.857782,-0.44403 -1.090217,-0.0358 -0.147324,0.25871 -0.09604,0.61056 -0.09604,0.89591 v 1.88142 H 72.09042 v -1.98893 c 0,-0.4711 -0.01604,-0.95902 0.233201,-1.3797 0.585269,-0.98786 2.133584,-0.74836 2.472454,0.32253 z"       id="path2318" />  </g></svg></span> <a rel="me" href="https://mstdn.science/@gtn">Mastodon</a></li>
					<li><span style="fill: var(--hyperlink);"><svg  viewBox="0 0 64 57" width="1em" ><path style="fill-opacity:1;stroke:none;stroke-width:0.0179182" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805ZM50.127 3.805C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745Z"></path></svg></span><a rel="me" href="https://bsky.app/profile/galaxytraining.bsky.social"> Bluesky</a></li>
				</ul>
			</div>
		</div>
	</div>
</footer>


        <script  async defer src='/training-material/assets/js/bundle.main.40d4e218.js'></script>

	
	

    </body>
</html>